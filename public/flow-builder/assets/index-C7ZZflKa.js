(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(c){if(c.ep)return;c.ep=!0;const u=s(c);fetch(c.href,u)}})();function Yh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yf={exports:{}},to={};var hx;function tj(){if(hx)return to;hx=1;var t=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(o,c,u){var d=null;if(u!==void 0&&(d=""+u),c.key!==void 0&&(d=""+c.key),"key"in c){u={};for(var m in c)m!=="key"&&(u[m]=c[m])}else u=c;return c=u.ref,{$$typeof:t,type:o,key:d,ref:c!==void 0?c:null,props:u}}return to.Fragment=a,to.jsx=s,to.jsxs=s,to}var mx;function nj(){return mx||(mx=1,Yf.exports=tj()),Yf.exports}var r=nj(),Pf={exports:{}},je={};var px;function aj(){if(px)return je;px=1;var t=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),b=Symbol.iterator;function N(B){return B===null||typeof B!="object"?null:(B=b&&B[b]||B["@@iterator"],typeof B=="function"?B:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,_={};function E(B,P,ae){this.props=B,this.context=P,this.refs=_,this.updater=ae||S}E.prototype.isReactComponent={},E.prototype.setState=function(B,P){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,P,"setState")},E.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function D(){}D.prototype=E.prototype;function T(B,P,ae){this.props=B,this.context=P,this.refs=_,this.updater=ae||S}var A=T.prototype=new D;A.constructor=T,C(A,E.prototype),A.isPureReactComponent=!0;var w=Array.isArray;function O(){}var M={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function H(B,P,ae){var G=ae.ref;return{$$typeof:t,type:B,key:P,ref:G!==void 0?G:null,props:ae}}function F(B,P){return H(B.type,P,B.props)}function Q(B){return typeof B=="object"&&B!==null&&B.$$typeof===t}function Z(B){var P={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ae){return P[ae]})}var ne=/\/+/g;function $(B,P){return typeof B=="object"&&B!==null&&B.key!=null?Z(""+B.key):P.toString(36)}function I(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(O,O):(B.status="pending",B.then(function(P){B.status==="pending"&&(B.status="fulfilled",B.value=P)},function(P){B.status==="pending"&&(B.status="rejected",B.reason=P)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function z(B,P,ae,G,re){var de=typeof B;(de==="undefined"||de==="boolean")&&(B=null);var ue=!1;if(B===null)ue=!0;else switch(de){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(B.$$typeof){case t:case a:ue=!0;break;case y:return ue=B._init,z(ue(B._payload),P,ae,G,re)}}if(ue)return re=re(B),ue=G===""?"."+$(B,0):G,w(re)?(ae="",ue!=null&&(ae=ue.replace(ne,"$&/")+"/"),z(re,P,ae,"",function(he){return he})):re!=null&&(Q(re)&&(re=F(re,ae+(re.key==null||B&&B.key===re.key?"":(""+re.key).replace(ne,"$&/")+"/")+ue)),P.push(re)),1;ue=0;var V=G===""?".":G+":";if(w(B))for(var ce=0;ce<B.length;ce++)G=B[ce],de=V+$(G,ce),ue+=z(G,P,ae,de,re);else if(ce=N(B),typeof ce=="function")for(B=ce.call(B),ce=0;!(G=B.next()).done;)G=G.value,de=V+$(G,ce++),ue+=z(G,P,ae,de,re);else if(de==="object"){if(typeof B.then=="function")return z(I(B),P,ae,G,re);throw P=String(B),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return ue}function R(B,P,ae){if(B==null)return B;var G=[],re=0;return z(B,G,"","",function(de){return P.call(ae,de,re++)}),G}function U(B){if(B._status===-1){var P=B._result;P=P(),P.then(function(ae){(B._status===0||B._status===-1)&&(B._status=1,B._result=ae)},function(ae){(B._status===0||B._status===-1)&&(B._status=2,B._result=ae)}),B._status===-1&&(B._status=0,B._result=P)}if(B._status===1)return B._result.default;throw B._result}var L=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},K={map:R,forEach:function(B,P,ae){R(B,function(){P.apply(this,arguments)},ae)},count:function(B){var P=0;return R(B,function(){P++}),P},toArray:function(B){return R(B,function(P){return P})||[]},only:function(B){if(!Q(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return je.Activity=x,je.Children=K,je.Component=E,je.Fragment=s,je.Profiler=c,je.PureComponent=T,je.StrictMode=o,je.Suspense=p,je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,je.__COMPILER_RUNTIME={__proto__:null,c:function(B){return M.H.useMemoCache(B)}},je.cache=function(B){return function(){return B.apply(null,arguments)}},je.cacheSignal=function(){return null},je.cloneElement=function(B,P,ae){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var G=C({},B.props),re=B.key;if(P!=null)for(de in P.key!==void 0&&(re=""+P.key),P)!q.call(P,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&P.ref===void 0||(G[de]=P[de]);var de=arguments.length-2;if(de===1)G.children=ae;else if(1<de){for(var ue=Array(de),V=0;V<de;V++)ue[V]=arguments[V+2];G.children=ue}return H(B.type,re,G)},je.createContext=function(B){return B={$$typeof:d,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:u,_context:B},B},je.createElement=function(B,P,ae){var G,re={},de=null;if(P!=null)for(G in P.key!==void 0&&(de=""+P.key),P)q.call(P,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(re[G]=P[G]);var ue=arguments.length-2;if(ue===1)re.children=ae;else if(1<ue){for(var V=Array(ue),ce=0;ce<ue;ce++)V[ce]=arguments[ce+2];re.children=V}if(B&&B.defaultProps)for(G in ue=B.defaultProps,ue)re[G]===void 0&&(re[G]=ue[G]);return H(B,de,re)},je.createRef=function(){return{current:null}},je.forwardRef=function(B){return{$$typeof:m,render:B}},je.isValidElement=Q,je.lazy=function(B){return{$$typeof:y,_payload:{_status:-1,_result:B},_init:U}},je.memo=function(B,P){return{$$typeof:g,type:B,compare:P===void 0?null:P}},je.startTransition=function(B){var P=M.T,ae={};M.T=ae;try{var G=B(),re=M.S;re!==null&&re(ae,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(O,L)}catch(de){L(de)}finally{P!==null&&ae.types!==null&&(P.types=ae.types),M.T=P}},je.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},je.use=function(B){return M.H.use(B)},je.useActionState=function(B,P,ae){return M.H.useActionState(B,P,ae)},je.useCallback=function(B,P){return M.H.useCallback(B,P)},je.useContext=function(B){return M.H.useContext(B)},je.useDebugValue=function(){},je.useDeferredValue=function(B,P){return M.H.useDeferredValue(B,P)},je.useEffect=function(B,P){return M.H.useEffect(B,P)},je.useEffectEvent=function(B){return M.H.useEffectEvent(B)},je.useId=function(){return M.H.useId()},je.useImperativeHandle=function(B,P,ae){return M.H.useImperativeHandle(B,P,ae)},je.useInsertionEffect=function(B,P){return M.H.useInsertionEffect(B,P)},je.useLayoutEffect=function(B,P){return M.H.useLayoutEffect(B,P)},je.useMemo=function(B,P){return M.H.useMemo(B,P)},je.useOptimistic=function(B,P){return M.H.useOptimistic(B,P)},je.useReducer=function(B,P,ae){return M.H.useReducer(B,P,ae)},je.useRef=function(B){return M.H.useRef(B)},je.useState=function(B){return M.H.useState(B)},je.useSyncExternalStore=function(B,P,ae){return M.H.useSyncExternalStore(B,P,ae)},je.useTransition=function(){return M.H.useTransition()},je.version="19.2.3",je}var gx;function Eo(){return gx||(gx=1,Pf.exports=aj()),Pf.exports}var j=Eo();const zr=Yh(j);var If={exports:{}},no={},Xf={exports:{}},Gf={};var xx;function sj(){return xx||(xx=1,(function(t){function a(z,R){var U=z.length;z.push(R);e:for(;0<U;){var L=U-1>>>1,K=z[L];if(0<c(K,R))z[L]=R,z[U]=K,U=L;else break e}}function s(z){return z.length===0?null:z[0]}function o(z){if(z.length===0)return null;var R=z[0],U=z.pop();if(U!==R){z[0]=U;e:for(var L=0,K=z.length,B=K>>>1;L<B;){var P=2*(L+1)-1,ae=z[P],G=P+1,re=z[G];if(0>c(ae,U))G<K&&0>c(re,ae)?(z[L]=re,z[G]=U,L=G):(z[L]=ae,z[P]=U,L=P);else if(G<K&&0>c(re,U))z[L]=re,z[G]=U,L=G;else break e}}return R}function c(z,R){var U=z.sortIndex-R.sortIndex;return U!==0?U:z.id-R.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;t.unstable_now=function(){return u.now()}}else{var d=Date,m=d.now();t.unstable_now=function(){return d.now()-m}}var p=[],g=[],y=1,x=null,b=3,N=!1,S=!1,C=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function A(z){for(var R=s(g);R!==null;){if(R.callback===null)o(g);else if(R.startTime<=z)o(g),R.sortIndex=R.expirationTime,a(p,R);else break;R=s(g)}}function w(z){if(C=!1,A(z),!S)if(s(p)!==null)S=!0,O||(O=!0,Z());else{var R=s(g);R!==null&&I(w,R.startTime-z)}}var O=!1,M=-1,q=5,H=-1;function F(){return _?!0:!(t.unstable_now()-H<q)}function Q(){if(_=!1,O){var z=t.unstable_now();H=z;var R=!0;try{e:{S=!1,C&&(C=!1,D(M),M=-1),N=!0;var U=b;try{t:{for(A(z),x=s(p);x!==null&&!(x.expirationTime>z&&F());){var L=x.callback;if(typeof L=="function"){x.callback=null,b=x.priorityLevel;var K=L(x.expirationTime<=z);if(z=t.unstable_now(),typeof K=="function"){x.callback=K,A(z),R=!0;break t}x===s(p)&&o(p),A(z)}else o(p);x=s(p)}if(x!==null)R=!0;else{var B=s(g);B!==null&&I(w,B.startTime-z),R=!1}}break e}finally{x=null,b=U,N=!1}R=void 0}}finally{R?Z():O=!1}}}var Z;if(typeof T=="function")Z=function(){T(Q)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,$=ne.port2;ne.port1.onmessage=Q,Z=function(){$.postMessage(null)}}else Z=function(){E(Q,0)};function I(z,R){M=E(function(){z(t.unstable_now())},R)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(z){switch(b){case 1:case 2:case 3:var R=3;break;default:R=b}var U=b;b=R;try{return z()}finally{b=U}},t.unstable_requestPaint=function(){_=!0},t.unstable_runWithPriority=function(z,R){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var U=b;b=z;try{return R()}finally{b=U}},t.unstable_scheduleCallback=function(z,R,U){var L=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?L+U:L):U=L,z){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=U+K,z={id:y++,callback:R,priorityLevel:z,startTime:U,expirationTime:K,sortIndex:-1},U>L?(z.sortIndex=U,a(g,z),s(p)===null&&z===s(g)&&(C?(D(M),M=-1):C=!0,I(w,U-L))):(z.sortIndex=K,a(p,z),S||N||(S=!0,O||(O=!0,Z()))),z},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(z){var R=b;return function(){var U=b;b=R;try{return z.apply(this,arguments)}finally{b=U}}}})(Gf)),Gf}var yx;function rj(){return yx||(yx=1,Xf.exports=sj()),Xf.exports}var Qf={exports:{}},St={};var bx;function ij(){if(bx)return St;bx=1;var t=Eo();function a(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)g+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var o={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},c=Symbol.for("react.portal");function u(p,g,y){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:x==null?null:""+x,children:p,containerInfo:g,implementation:y}}var d=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return St.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,St.createPortal=function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(a(299));return u(p,g,null,y)},St.flushSync=function(p){var g=d.T,y=o.p;try{if(d.T=null,o.p=2,p)return p()}finally{d.T=g,o.p=y,o.d.f()}},St.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,o.d.C(p,g))},St.prefetchDNS=function(p){typeof p=="string"&&o.d.D(p)},St.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var y=g.as,x=m(y,g.crossOrigin),b=typeof g.integrity=="string"?g.integrity:void 0,N=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;y==="style"?o.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:b,fetchPriority:N}):y==="script"&&o.d.X(p,{crossOrigin:x,integrity:b,fetchPriority:N,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},St.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var y=m(g.as,g.crossOrigin);o.d.M(p,{crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&o.d.M(p)},St.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var y=g.as,x=m(y,g.crossOrigin);o.d.L(p,y,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},St.preloadModule=function(p,g){if(typeof p=="string")if(g){var y=m(g.as,g.crossOrigin);o.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else o.d.m(p)},St.requestFormReset=function(p){o.d.r(p)},St.unstable_batchedUpdates=function(p,g){return p(g)},St.useFormState=function(p,g,y){return d.H.useFormState(p,g,y)},St.useFormStatus=function(){return d.H.useHostTransitionStatus()},St.version="19.2.3",St}var vx;function cb(){if(vx)return Qf.exports;vx=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(a){console.error(a)}}return t(),Qf.exports=ij(),Qf.exports}var wx;function oj(){if(wx)return no;wx=1;var t=rj(),a=Eo(),s=cb();function o(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function d(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function m(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function p(e){if(u(e)!==e)throw Error(o(188))}function g(e){var n=e.alternate;if(!n){if(n=u(e),n===null)throw Error(o(188));return n!==e?null:e}for(var i=e,l=n;;){var f=i.return;if(f===null)break;var h=f.alternate;if(h===null){if(l=f.return,l!==null){i=l;continue}break}if(f.child===h.child){for(h=f.child;h;){if(h===i)return p(f),e;if(h===l)return p(f),n;h=h.sibling}throw Error(o(188))}if(i.return!==l.return)i=f,l=h;else{for(var v=!1,k=f.child;k;){if(k===i){v=!0,i=f,l=h;break}if(k===l){v=!0,l=f,i=h;break}k=k.sibling}if(!v){for(k=h.child;k;){if(k===i){v=!0,i=h,l=f;break}if(k===l){v=!0,l=h,i=f;break}k=k.sibling}if(!v)throw Error(o(189))}}if(i.alternate!==l)throw Error(o(190))}if(i.tag!==3)throw Error(o(188));return i.stateNode.current===i?e:n}function y(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=y(e),n!==null)return n;e=e.sibling}return null}var x=Object.assign,b=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),T=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function Z(e){return e===null||typeof e!="object"?null:(e=Q&&e[Q]||e["@@iterator"],typeof e=="function"?e:null)}var ne=Symbol.for("react.client.reference");function $(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ne?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case C:return"Fragment";case E:return"Profiler";case _:return"StrictMode";case w:return"Suspense";case O:return"SuspenseList";case H:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case S:return"Portal";case T:return e.displayName||"Context";case D:return(e._context.displayName||"Context")+".Consumer";case A:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case M:return n=e.displayName||null,n!==null?n:$(e.type)||"Memo";case q:n=e._payload,e=e._init;try{return $(e(n))}catch{}}return null}var I=Array.isArray,z=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},L=[],K=-1;function B(e){return{current:e}}function P(e){0>K||(e.current=L[K],L[K]=null,K--)}function ae(e,n){K++,L[K]=e.current,e.current=n}var G=B(null),re=B(null),de=B(null),ue=B(null);function V(e,n){switch(ae(de,n),ae(re,e),ae(G,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Bg(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Bg(n),e=Lg(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}P(G),ae(G,e)}function ce(){P(G),P(re),P(de)}function he(e){e.memoizedState!==null&&ae(ue,e);var n=G.current,i=Lg(n,e.type);n!==i&&(ae(re,e),ae(G,i))}function ve(e){re.current===e&&(P(G),P(re)),ue.current===e&&(P(ue),Wi._currentValue=U)}var ge,be;function Se(e){if(ge===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);ge=n&&n[1]||"",be=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ge+e+be}var Ae=!1;function Ee(e,n){if(!e||Ae)return"";Ae=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(n){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(se){var te=se}Reflect.construct(e,[],le)}else{try{le.call()}catch(se){te=se}e.call(le.prototype)}}else{try{throw Error()}catch(se){te=se}(le=e())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(se){if(se&&te&&typeof se.stack=="string")return[se.stack,te.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=l.DetermineComponentFrameRoot(),v=h[0],k=h[1];if(v&&k){var Y=v.split(`
`),ee=k.split(`
`);for(f=l=0;l<Y.length&&!Y[l].includes("DetermineComponentFrameRoot");)l++;for(;f<ee.length&&!ee[f].includes("DetermineComponentFrameRoot");)f++;if(l===Y.length||f===ee.length)for(l=Y.length-1,f=ee.length-1;1<=l&&0<=f&&Y[l]!==ee[f];)f--;for(;1<=l&&0<=f;l--,f--)if(Y[l]!==ee[f]){if(l!==1||f!==1)do if(l--,f--,0>f||Y[l]!==ee[f]){var ie=`
`+Y[l].replace(" at new "," at ");return e.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",e.displayName)),ie}while(1<=l&&0<=f);break}}}finally{Ae=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?Se(i):""}function $e(e,n){switch(e.tag){case 26:case 27:case 5:return Se(e.type);case 16:return Se("Lazy");case 13:return e.child!==n&&n!==null?Se("Suspense Fallback"):Se("Suspense");case 19:return Se("SuspenseList");case 0:case 15:return Ee(e.type,!1);case 11:return Ee(e.type.render,!1);case 1:return Ee(e.type,!0);case 31:return Se("Activity");default:return""}}function De(e){try{var n="",i=null;do n+=$e(e,i),i=e,e=e.return;while(e);return n}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var yt=Object.prototype.hasOwnProperty,pt=t.unstable_scheduleCallback,hn=t.unstable_cancelCallback,En=t.unstable_shouldYield,Cn=t.unstable_requestPaint,rt=t.unstable_now,Pn=t.unstable_getCurrentPriorityLevel,mn=t.unstable_ImmediatePriority,en=t.unstable_UserBlockingPriority,In=t.unstable_NormalPriority,pn=t.unstable_LowPriority,Xn=t.unstable_IdlePriority,cs=t.log,oi=t.unstable_setDisableYieldValue,us=null,Ct=null;function Tn(e){if(typeof cs=="function"&&oi(e),Ct&&typeof Ct.setStrictMode=="function")try{Ct.setStrictMode(us,e)}catch{}}var Tt=Math.clz32?Math.clz32:Au,Tu=Math.log,Mu=Math.LN2;function Au(e){return e>>>=0,e===0?32:31-(Tu(e)/Mu|0)|0}var Is=256,Xs=262144,Gs=4194304;function Gn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Qs(e,n,i){var l=e.pendingLanes;if(l===0)return 0;var f=0,h=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var k=l&134217727;return k!==0?(l=k&~h,l!==0?f=Gn(l):(v&=k,v!==0?f=Gn(v):i||(i=k&~e,i!==0&&(f=Gn(i))))):(k=l&~h,k!==0?f=Gn(k):v!==0?f=Gn(v):i||(i=l&~e,i!==0&&(f=Gn(i)))),f===0?0:n!==0&&n!==f&&(n&h)===0&&(h=f&-f,i=n&-n,h>=i||h===32&&(i&4194048)!==0)?n:f}function ds(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function ku(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uo(){var e=Gs;return Gs<<=1,(Gs&62914560)===0&&(Gs=4194304),e}function li(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function fs(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ru(e,n,i,l,f,h){var v=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var k=e.entanglements,Y=e.expirationTimes,ee=e.hiddenUpdates;for(i=v&~i;0<i;){var ie=31-Tt(i),le=1<<ie;k[ie]=0,Y[ie]=-1;var te=ee[ie];if(te!==null)for(ee[ie]=null,ie=0;ie<te.length;ie++){var se=te[ie];se!==null&&(se.lane&=-536870913)}i&=~le}l!==0&&Vo(e,l,0),h!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=h&~(v&~n))}function Vo(e,n,i){e.pendingLanes|=n,e.suspendedLanes&=~n;var l=31-Tt(n);e.entangledLanes|=n,e.entanglements[l]=e.entanglements[l]|1073741824|i&261930}function Yo(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var l=31-Tt(i),f=1<<l;f&n|e[l]&n&&(e[l]|=n),i&=~f}}function Po(e,n){var i=n&-n;return i=(i&42)!==0?1:ci(i),(i&(e.suspendedLanes|n))!==0?0:i}function ci(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ui(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Io(){var e=R.p;return e!==0?e:(e=window.event,e===void 0?32:ix(e.type))}function Xo(e,n){var i=R.p;try{return R.p=e,n()}finally{R.p=i}}var Mn=Math.random().toString(36).slice(2),ht="__reactFiber$"+Mn,Nt="__reactProps$"+Mn,Qn="__reactContainer$"+Mn,Fs="__reactEvents$"+Mn,Go="__reactListeners$"+Mn,Du="__reactHandles$"+Mn,Qo="__reactResources$"+Mn,hs="__reactMarker$"+Mn;function di(e){delete e[ht],delete e[Nt],delete e[Fs],delete e[Go],delete e[Du]}function Sa(e){var n=e[ht];if(n)return n;for(var i=e.parentNode;i;){if(n=i[Qn]||i[ht]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=Pg(e);e!==null;){if(i=e[ht])return i;e=Pg(e)}return n}e=i,i=e.parentNode}return null}function _a(e){if(e=e[ht]||e[Qn]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Ea(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(o(33))}function Ca(e){var n=e[Qo];return n||(n=e[Qo]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function it(e){e[hs]=!0}var Fo=new Set,Zo={};function Fn(e,n){Ta(e,n),Ta(e+"Capture",n)}function Ta(e,n){for(Zo[e]=n,e=0;e<n.length;e++)Fo.add(n[e])}var zu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fi={},Wo={};function Ou(e){return yt.call(Wo,e)?!0:yt.call(fi,e)?!1:zu.test(e)?Wo[e]=!0:(fi[e]=!0,!1)}function Zs(e,n,i){if(Ou(n))if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var l=n.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+i)}}function Ws(e,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+i)}}function gn(e,n,i,l){if(l===null)e.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(n,i,""+l)}}function kt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ko(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Bu(e,n,i){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,h=l.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return f.call(this)},set:function(v){i=""+v,h.call(this,v)}}),Object.defineProperty(e,n,{enumerable:l.enumerable}),{getValue:function(){return i},setValue:function(v){i=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Ks(e){if(!e._valueTracker){var n=Ko(e)?"checked":"value";e._valueTracker=Bu(e,n,""+e[n])}}function Jo(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),l="";return e&&(l=Ko(e)?e.checked?"true":"false":e.value),e=l,e!==i?(n.setValue(e),!0):!1}function ms(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Lu=/[\n"\\]/g;function Rt(e){return e.replace(Lu,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function ps(e,n,i,l,f,h,v,k){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+kt(n)):e.value!==""+kt(n)&&(e.value=""+kt(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?hi(e,v,kt(n)):i!=null?hi(e,v,kt(i)):l!=null&&e.removeAttribute("value"),f==null&&h!=null&&(e.defaultChecked=!!h),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?e.name=""+kt(k):e.removeAttribute("name")}function el(e,n,i,l,f,h,v,k){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),n!=null||i!=null){if(!(h!=="submit"&&h!=="reset"||n!=null)){Ks(e);return}i=i!=null?""+kt(i):"",n=n!=null?""+kt(n):i,k||n===e.value||(e.value=n),e.defaultValue=n}l=l??f,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=k?e.checked:!!l,e.defaultChecked=!!l,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),Ks(e)}function hi(e,n,i){n==="number"&&ms(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function Zn(e,n,i,l){if(e=e.options,n){n={};for(var f=0;f<i.length;f++)n["$"+i[f]]=!0;for(i=0;i<e.length;i++)f=n.hasOwnProperty("$"+e[i].value),e[i].selected!==f&&(e[i].selected=f),f&&l&&(e[i].defaultSelected=!0)}else{for(i=""+kt(i),n=null,f=0;f<e.length;f++){if(e[f].value===i){e[f].selected=!0,l&&(e[f].defaultSelected=!0);return}n!==null||e[f].disabled||(n=e[f])}n!==null&&(n.selected=!0)}}function km(e,n,i){if(n!=null&&(n=""+kt(n),n!==e.value&&(e.value=n),i==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=i!=null?""+kt(i):""}function Rm(e,n,i,l){if(n==null){if(l!=null){if(i!=null)throw Error(o(92));if(I(l)){if(1<l.length)throw Error(o(93));l=l[0]}i=l}i==null&&(i=""),n=i}i=kt(n),e.defaultValue=i,l=e.textContent,l===i&&l!==""&&l!==null&&(e.value=l),Ks(e)}function Js(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var Zv=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Dm(e,n,i){var l=n.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?l?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":l?e.setProperty(n,i):typeof i!="number"||i===0||Zv.has(n)?n==="float"?e.cssFloat=i:e[n]=(""+i).trim():e[n]=i+"px"}function zm(e,n,i){if(n!=null&&typeof n!="object")throw Error(o(62));if(e=e.style,i!=null){for(var l in i)!i.hasOwnProperty(l)||n!=null&&n.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var f in n)l=n[f],n.hasOwnProperty(f)&&i[f]!==l&&Dm(e,f,l)}else for(var h in n)n.hasOwnProperty(h)&&Dm(e,h,n[h])}function Hu(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wv=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Kv=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function tl(e){return Kv.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Wn(){}var $u=null;function qu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var er=null,tr=null;function Om(e){var n=_a(e);if(n&&(e=n.stateNode)){var i=e[Nt]||null;e:switch(e=n.stateNode,n.type){case"input":if(ps(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+Rt(""+n)+'"][type="radio"]'),n=0;n<i.length;n++){var l=i[n];if(l!==e&&l.form===e.form){var f=l[Nt]||null;if(!f)throw Error(o(90));ps(l,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<i.length;n++)l=i[n],l.form===e.form&&Jo(l)}break e;case"textarea":km(e,i.value,i.defaultValue);break e;case"select":n=i.value,n!=null&&Zn(e,!!i.multiple,n,!1)}}}var Uu=!1;function Bm(e,n,i){if(Uu)return e(n,i);Uu=!0;try{var l=e(n);return l}finally{if(Uu=!1,(er!==null||tr!==null)&&(Vl(),er&&(n=er,e=tr,tr=er=null,Om(n),e)))for(n=0;n<e.length;n++)Om(e[n])}}function mi(e,n){var i=e.stateNode;if(i===null)return null;var l=i[Nt]||null;if(l===null)return null;i=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(o(231,n,typeof i));return i}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vu=!1;if(Kn)try{var pi={};Object.defineProperty(pi,"passive",{get:function(){Vu=!0}}),window.addEventListener("test",pi,pi),window.removeEventListener("test",pi,pi)}catch{Vu=!1}var Ma=null,Yu=null,nl=null;function Lm(){if(nl)return nl;var e,n=Yu,i=n.length,l,f="value"in Ma?Ma.value:Ma.textContent,h=f.length;for(e=0;e<i&&n[e]===f[e];e++);var v=i-e;for(l=1;l<=v&&n[i-l]===f[h-l];l++);return nl=f.slice(e,1<l?1-l:void 0)}function al(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function sl(){return!0}function Hm(){return!1}function Dt(e){function n(i,l,f,h,v){this._reactName=i,this._targetInst=f,this.type=l,this.nativeEvent=h,this.target=v,this.currentTarget=null;for(var k in e)e.hasOwnProperty(k)&&(i=e[k],this[k]=i?i(h):h[k]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?sl:Hm,this.isPropagationStopped=Hm,this}return x(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=sl)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=sl)},persist:function(){},isPersistent:sl}),n}var gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rl=Dt(gs),gi=x({},gs,{view:0,detail:0}),Jv=Dt(gi),Pu,Iu,xi,il=x({},gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==xi&&(xi&&e.type==="mousemove"?(Pu=e.screenX-xi.screenX,Iu=e.screenY-xi.screenY):Iu=Pu=0,xi=e),Pu)},movementY:function(e){return"movementY"in e?e.movementY:Iu}}),$m=Dt(il),e2=x({},il,{dataTransfer:0}),t2=Dt(e2),n2=x({},gi,{relatedTarget:0}),Xu=Dt(n2),a2=x({},gs,{animationName:0,elapsedTime:0,pseudoElement:0}),s2=Dt(a2),r2=x({},gs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),i2=Dt(r2),o2=x({},gs,{data:0}),qm=Dt(o2),l2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},c2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},u2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function d2(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=u2[e])?!!n[e]:!1}function Gu(){return d2}var f2=x({},gi,{key:function(e){if(e.key){var n=l2[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=al(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?c2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gu,charCode:function(e){return e.type==="keypress"?al(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?al(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),h2=Dt(f2),m2=x({},il,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Um=Dt(m2),p2=x({},gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gu}),g2=Dt(p2),x2=x({},gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),y2=Dt(x2),b2=x({},il,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),v2=Dt(b2),w2=x({},gs,{newState:0,oldState:0}),j2=Dt(w2),N2=[9,13,27,32],Qu=Kn&&"CompositionEvent"in window,yi=null;Kn&&"documentMode"in document&&(yi=document.documentMode);var S2=Kn&&"TextEvent"in window&&!yi,Vm=Kn&&(!Qu||yi&&8<yi&&11>=yi),Ym=" ",Pm=!1;function Im(e,n){switch(e){case"keyup":return N2.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var nr=!1;function _2(e,n){switch(e){case"compositionend":return Xm(n);case"keypress":return n.which!==32?null:(Pm=!0,Ym);case"textInput":return e=n.data,e===Ym&&Pm?null:e;default:return null}}function E2(e,n){if(nr)return e==="compositionend"||!Qu&&Im(e,n)?(e=Lm(),nl=Yu=Ma=null,nr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Vm&&n.locale!=="ko"?null:n.data;default:return null}}var C2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gm(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!C2[e.type]:n==="textarea"}function Qm(e,n,i,l){er?tr?tr.push(l):tr=[l]:er=l,n=Fl(n,"onChange"),0<n.length&&(i=new rl("onChange","change",null,i,l),e.push({event:i,listeners:n}))}var bi=null,vi=null;function T2(e){Ag(e,0)}function ol(e){var n=Ea(e);if(Jo(n))return e}function Fm(e,n){if(e==="change")return n}var Zm=!1;if(Kn){var Fu;if(Kn){var Zu="oninput"in document;if(!Zu){var Wm=document.createElement("div");Wm.setAttribute("oninput","return;"),Zu=typeof Wm.oninput=="function"}Fu=Zu}else Fu=!1;Zm=Fu&&(!document.documentMode||9<document.documentMode)}function Km(){bi&&(bi.detachEvent("onpropertychange",Jm),vi=bi=null)}function Jm(e){if(e.propertyName==="value"&&ol(vi)){var n=[];Qm(n,vi,e,qu(e)),Bm(T2,n)}}function M2(e,n,i){e==="focusin"?(Km(),bi=n,vi=i,bi.attachEvent("onpropertychange",Jm)):e==="focusout"&&Km()}function A2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ol(vi)}function k2(e,n){if(e==="click")return ol(n)}function R2(e,n){if(e==="input"||e==="change")return ol(n)}function D2(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Vt=typeof Object.is=="function"?Object.is:D2;function wi(e,n){if(Vt(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),l=Object.keys(n);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var f=i[l];if(!yt.call(n,f)||!Vt(e[f],n[f]))return!1}return!0}function ep(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tp(e,n){var i=ep(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=n&&l>=n)return{node:i,offset:n-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ep(i)}}function np(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?np(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function ap(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=ms(e.document);n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=ms(e.document)}return n}function Wu(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var z2=Kn&&"documentMode"in document&&11>=document.documentMode,ar=null,Ku=null,ji=null,Ju=!1;function sp(e,n,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Ju||ar==null||ar!==ms(l)||(l=ar,"selectionStart"in l&&Wu(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),ji&&wi(ji,l)||(ji=l,l=Fl(Ku,"onSelect"),0<l.length&&(n=new rl("onSelect","select",null,n,i),e.push({event:n,listeners:l}),n.target=ar)))}function xs(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var sr={animationend:xs("Animation","AnimationEnd"),animationiteration:xs("Animation","AnimationIteration"),animationstart:xs("Animation","AnimationStart"),transitionrun:xs("Transition","TransitionRun"),transitionstart:xs("Transition","TransitionStart"),transitioncancel:xs("Transition","TransitionCancel"),transitionend:xs("Transition","TransitionEnd")},ed={},rp={};Kn&&(rp=document.createElement("div").style,"AnimationEvent"in window||(delete sr.animationend.animation,delete sr.animationiteration.animation,delete sr.animationstart.animation),"TransitionEvent"in window||delete sr.transitionend.transition);function ys(e){if(ed[e])return ed[e];if(!sr[e])return e;var n=sr[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in rp)return ed[e]=n[i];return e}var ip=ys("animationend"),op=ys("animationiteration"),lp=ys("animationstart"),O2=ys("transitionrun"),B2=ys("transitionstart"),L2=ys("transitioncancel"),cp=ys("transitionend"),up=new Map,td="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");td.push("scrollEnd");function xn(e,n){up.set(e,n),Fn(n,[e])}var ll=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},tn=[],rr=0,nd=0;function cl(){for(var e=rr,n=nd=rr=0;n<e;){var i=tn[n];tn[n++]=null;var l=tn[n];tn[n++]=null;var f=tn[n];tn[n++]=null;var h=tn[n];if(tn[n++]=null,l!==null&&f!==null){var v=l.pending;v===null?f.next=f:(f.next=v.next,v.next=f),l.pending=f}h!==0&&dp(i,f,h)}}function ul(e,n,i,l){tn[rr++]=e,tn[rr++]=n,tn[rr++]=i,tn[rr++]=l,nd|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function ad(e,n,i,l){return ul(e,n,i,l),dl(e)}function bs(e,n){return ul(e,null,null,n),dl(e)}function dp(e,n,i){e.lanes|=i;var l=e.alternate;l!==null&&(l.lanes|=i);for(var f=!1,h=e.return;h!==null;)h.childLanes|=i,l=h.alternate,l!==null&&(l.childLanes|=i),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(f=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,f&&n!==null&&(f=31-Tt(i),e=h.hiddenUpdates,l=e[f],l===null?e[f]=[n]:l.push(n),n.lane=i|536870912),h):null}function dl(e){if(50<Pi)throw Pi=0,hf=null,Error(o(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var ir={};function H2(e,n,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yt(e,n,i,l){return new H2(e,n,i,l)}function sd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Jn(e,n){var i=e.alternate;return i===null?(i=Yt(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function fp(e,n){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,n=i.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function fl(e,n,i,l,f,h){var v=0;if(l=e,typeof e=="function")sd(e)&&(v=1);else if(typeof e=="string")v=Yw(e,i,G.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case H:return e=Yt(31,i,n,f),e.elementType=H,e.lanes=h,e;case C:return vs(i.children,f,h,n);case _:v=8,f|=24;break;case E:return e=Yt(12,i,n,f|2),e.elementType=E,e.lanes=h,e;case w:return e=Yt(13,i,n,f),e.elementType=w,e.lanes=h,e;case O:return e=Yt(19,i,n,f),e.elementType=O,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case T:v=10;break e;case D:v=9;break e;case A:v=11;break e;case M:v=14;break e;case q:v=16,l=null;break e}v=29,i=Error(o(130,e===null?"null":typeof e,"")),l=null}return n=Yt(v,i,n,f),n.elementType=e,n.type=l,n.lanes=h,n}function vs(e,n,i,l){return e=Yt(7,e,l,n),e.lanes=i,e}function rd(e,n,i){return e=Yt(6,e,null,n),e.lanes=i,e}function hp(e){var n=Yt(18,null,null,0);return n.stateNode=e,n}function id(e,n,i){return n=Yt(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var mp=new WeakMap;function nn(e,n){if(typeof e=="object"&&e!==null){var i=mp.get(e);return i!==void 0?i:(n={value:e,source:n,stack:De(n)},mp.set(e,n),n)}return{value:e,source:n,stack:De(n)}}var or=[],lr=0,hl=null,Ni=0,an=[],sn=0,Aa=null,An=1,kn="";function ea(e,n){or[lr++]=Ni,or[lr++]=hl,hl=e,Ni=n}function pp(e,n,i){an[sn++]=An,an[sn++]=kn,an[sn++]=Aa,Aa=e;var l=An;e=kn;var f=32-Tt(l)-1;l&=~(1<<f),i+=1;var h=32-Tt(n)+f;if(30<h){var v=f-f%5;h=(l&(1<<v)-1).toString(32),l>>=v,f-=v,An=1<<32-Tt(n)+f|i<<f|l,kn=h+e}else An=1<<h|i<<f|l,kn=e}function od(e){e.return!==null&&(ea(e,1),pp(e,1,0))}function ld(e){for(;e===hl;)hl=or[--lr],or[lr]=null,Ni=or[--lr],or[lr]=null;for(;e===Aa;)Aa=an[--sn],an[sn]=null,kn=an[--sn],an[sn]=null,An=an[--sn],an[sn]=null}function gp(e,n){an[sn++]=An,an[sn++]=kn,an[sn++]=Aa,An=n.id,kn=n.overflow,Aa=e}var bt=null,Ge=null,ze=!1,ka=null,rn=!1,cd=Error(o(519));function Ra(e){var n=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Si(nn(n,e)),cd}function xp(e){var n=e.stateNode,i=e.type,l=e.memoizedProps;switch(n[ht]=e,n[Nt]=l,i){case"dialog":Me("cancel",n),Me("close",n);break;case"iframe":case"object":case"embed":Me("load",n);break;case"video":case"audio":for(i=0;i<Xi.length;i++)Me(Xi[i],n);break;case"source":Me("error",n);break;case"img":case"image":case"link":Me("error",n),Me("load",n);break;case"details":Me("toggle",n);break;case"input":Me("invalid",n),el(n,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Me("invalid",n);break;case"textarea":Me("invalid",n),Rm(n,l.value,l.defaultValue,l.children)}i=l.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||n.textContent===""+i||l.suppressHydrationWarning===!0||zg(n.textContent,i)?(l.popover!=null&&(Me("beforetoggle",n),Me("toggle",n)),l.onScroll!=null&&Me("scroll",n),l.onScrollEnd!=null&&Me("scrollend",n),l.onClick!=null&&(n.onclick=Wn),n=!0):n=!1,n||Ra(e,!0)}function yp(e){for(bt=e.return;bt;)switch(bt.tag){case 5:case 31:case 13:rn=!1;return;case 27:case 3:rn=!0;return;default:bt=bt.return}}function cr(e){if(e!==bt)return!1;if(!ze)return yp(e),ze=!0,!1;var n=e.tag,i;if((i=n!==3&&n!==27)&&((i=n===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||Tf(e.type,e.memoizedProps)),i=!i),i&&Ge&&Ra(e),yp(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Ge=Yg(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Ge=Yg(e)}else n===27?(n=Ge,Xa(e.type)?(e=Df,Df=null,Ge=e):Ge=n):Ge=bt?ln(e.stateNode.nextSibling):null;return!0}function ws(){Ge=bt=null,ze=!1}function ud(){var e=ka;return e!==null&&(Lt===null?Lt=e:Lt.push.apply(Lt,e),ka=null),e}function Si(e){ka===null?ka=[e]:ka.push(e)}var dd=B(null),js=null,ta=null;function Da(e,n,i){ae(dd,n._currentValue),n._currentValue=i}function na(e){e._currentValue=dd.current,P(dd)}function fd(e,n,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===i)break;e=e.return}}function hd(e,n,i,l){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var h=f.dependencies;if(h!==null){var v=f.child;h=h.firstContext;e:for(;h!==null;){var k=h;h=f;for(var Y=0;Y<n.length;Y++)if(k.context===n[Y]){h.lanes|=i,k=h.alternate,k!==null&&(k.lanes|=i),fd(h.return,i,e),l||(v=null);break e}h=k.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(o(341));v.lanes|=i,h=v.alternate,h!==null&&(h.lanes|=i),fd(v,i,e),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===e){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function ur(e,n,i,l){e=null;for(var f=n,h=!1;f!==null;){if(!h){if((f.flags&524288)!==0)h=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(o(387));if(v=v.memoizedProps,v!==null){var k=f.type;Vt(f.pendingProps.value,v.value)||(e!==null?e.push(k):e=[k])}}else if(f===ue.current){if(v=f.alternate,v===null)throw Error(o(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(Wi):e=[Wi])}f=f.return}e!==null&&hd(n,e,i,l),n.flags|=262144}function ml(e){for(e=e.firstContext;e!==null;){if(!Vt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ns(e){js=e,ta=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function vt(e){return bp(js,e)}function pl(e,n){return js===null&&Ns(e),bp(e,n)}function bp(e,n){var i=n._currentValue;if(n={context:n,memoizedValue:i,next:null},ta===null){if(e===null)throw Error(o(308));ta=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else ta=ta.next=n;return i}var $2=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(i,l){e.push(l)}};this.abort=function(){n.aborted=!0,e.forEach(function(i){return i()})}},q2=t.unstable_scheduleCallback,U2=t.unstable_NormalPriority,ot={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function md(){return{controller:new $2,data:new Map,refCount:0}}function _i(e){e.refCount--,e.refCount===0&&q2(U2,function(){e.controller.abort()})}var Ei=null,pd=0,dr=0,fr=null;function V2(e,n){if(Ei===null){var i=Ei=[];pd=0,dr=bf(),fr={status:"pending",value:void 0,then:function(l){i.push(l)}}}return pd++,n.then(vp,vp),n}function vp(){if(--pd===0&&Ei!==null){fr!==null&&(fr.status="fulfilled");var e=Ei;Ei=null,dr=0,fr=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function Y2(e,n){var i=[],l={status:"pending",value:null,reason:null,then:function(f){i.push(f)}};return e.then(function(){l.status="fulfilled",l.value=n;for(var f=0;f<i.length;f++)(0,i[f])(n)},function(f){for(l.status="rejected",l.reason=f,f=0;f<i.length;f++)(0,i[f])(void 0)}),l}var wp=z.S;z.S=function(e,n){sg=rt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&V2(e,n),wp!==null&&wp(e,n)};var Ss=B(null);function gd(){var e=Ss.current;return e!==null?e:Xe.pooledCache}function gl(e,n){n===null?ae(Ss,Ss.current):ae(Ss,n.pool)}function jp(){var e=gd();return e===null?null:{parent:ot._currentValue,pool:e}}var hr=Error(o(460)),xd=Error(o(474)),xl=Error(o(542)),yl={then:function(){}};function Np(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Sp(e,n,i){switch(i=e[i],i===void 0?e.push(n):i!==n&&(n.then(Wn,Wn),n=i),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Ep(e),e;default:if(typeof n.status=="string")n.then(Wn,Wn);else{if(e=Xe,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=n,e.status="pending",e.then(function(l){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=l}},function(l){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=l}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Ep(e),e}throw Es=n,hr}}function _s(e){try{var n=e._init;return n(e._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Es=i,hr):i}}var Es=null;function _p(){if(Es===null)throw Error(o(459));var e=Es;return Es=null,e}function Ep(e){if(e===hr||e===xl)throw Error(o(483))}var mr=null,Ci=0;function bl(e){var n=Ci;return Ci+=1,mr===null&&(mr=[]),Sp(mr,e,n)}function Ti(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function vl(e,n){throw n.$$typeof===b?Error(o(525)):(e=Object.prototype.toString.call(n),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Cp(e){function n(W,X){if(e){var J=W.deletions;J===null?(W.deletions=[X],W.flags|=16):J.push(X)}}function i(W,X){if(!e)return null;for(;X!==null;)n(W,X),X=X.sibling;return null}function l(W){for(var X=new Map;W!==null;)W.key!==null?X.set(W.key,W):X.set(W.index,W),W=W.sibling;return X}function f(W,X){return W=Jn(W,X),W.index=0,W.sibling=null,W}function h(W,X,J){return W.index=J,e?(J=W.alternate,J!==null?(J=J.index,J<X?(W.flags|=67108866,X):J):(W.flags|=67108866,X)):(W.flags|=1048576,X)}function v(W){return e&&W.alternate===null&&(W.flags|=67108866),W}function k(W,X,J,oe){return X===null||X.tag!==6?(X=rd(J,W.mode,oe),X.return=W,X):(X=f(X,J),X.return=W,X)}function Y(W,X,J,oe){var ye=J.type;return ye===C?ie(W,X,J.props.children,oe,J.key):X!==null&&(X.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===q&&_s(ye)===X.type)?(X=f(X,J.props),Ti(X,J),X.return=W,X):(X=fl(J.type,J.key,J.props,null,W.mode,oe),Ti(X,J),X.return=W,X)}function ee(W,X,J,oe){return X===null||X.tag!==4||X.stateNode.containerInfo!==J.containerInfo||X.stateNode.implementation!==J.implementation?(X=id(J,W.mode,oe),X.return=W,X):(X=f(X,J.children||[]),X.return=W,X)}function ie(W,X,J,oe,ye){return X===null||X.tag!==7?(X=vs(J,W.mode,oe,ye),X.return=W,X):(X=f(X,J),X.return=W,X)}function le(W,X,J){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return X=rd(""+X,W.mode,J),X.return=W,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case N:return J=fl(X.type,X.key,X.props,null,W.mode,J),Ti(J,X),J.return=W,J;case S:return X=id(X,W.mode,J),X.return=W,X;case q:return X=_s(X),le(W,X,J)}if(I(X)||Z(X))return X=vs(X,W.mode,J,null),X.return=W,X;if(typeof X.then=="function")return le(W,bl(X),J);if(X.$$typeof===T)return le(W,pl(W,X),J);vl(W,X)}return null}function te(W,X,J,oe){var ye=X!==null?X.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return ye!==null?null:k(W,X,""+J,oe);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case N:return J.key===ye?Y(W,X,J,oe):null;case S:return J.key===ye?ee(W,X,J,oe):null;case q:return J=_s(J),te(W,X,J,oe)}if(I(J)||Z(J))return ye!==null?null:ie(W,X,J,oe,null);if(typeof J.then=="function")return te(W,X,bl(J),oe);if(J.$$typeof===T)return te(W,X,pl(W,J),oe);vl(W,J)}return null}function se(W,X,J,oe,ye){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return W=W.get(J)||null,k(X,W,""+oe,ye);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case N:return W=W.get(oe.key===null?J:oe.key)||null,Y(X,W,oe,ye);case S:return W=W.get(oe.key===null?J:oe.key)||null,ee(X,W,oe,ye);case q:return oe=_s(oe),se(W,X,J,oe,ye)}if(I(oe)||Z(oe))return W=W.get(J)||null,ie(X,W,oe,ye,null);if(typeof oe.then=="function")return se(W,X,J,bl(oe),ye);if(oe.$$typeof===T)return se(W,X,J,pl(X,oe),ye);vl(X,oe)}return null}function fe(W,X,J,oe){for(var ye=null,Be=null,me=X,_e=X=0,Re=null;me!==null&&_e<J.length;_e++){me.index>_e?(Re=me,me=null):Re=me.sibling;var Le=te(W,me,J[_e],oe);if(Le===null){me===null&&(me=Re);break}e&&me&&Le.alternate===null&&n(W,me),X=h(Le,X,_e),Be===null?ye=Le:Be.sibling=Le,Be=Le,me=Re}if(_e===J.length)return i(W,me),ze&&ea(W,_e),ye;if(me===null){for(;_e<J.length;_e++)me=le(W,J[_e],oe),me!==null&&(X=h(me,X,_e),Be===null?ye=me:Be.sibling=me,Be=me);return ze&&ea(W,_e),ye}for(me=l(me);_e<J.length;_e++)Re=se(me,W,_e,J[_e],oe),Re!==null&&(e&&Re.alternate!==null&&me.delete(Re.key===null?_e:Re.key),X=h(Re,X,_e),Be===null?ye=Re:Be.sibling=Re,Be=Re);return e&&me.forEach(function(Wa){return n(W,Wa)}),ze&&ea(W,_e),ye}function we(W,X,J,oe){if(J==null)throw Error(o(151));for(var ye=null,Be=null,me=X,_e=X=0,Re=null,Le=J.next();me!==null&&!Le.done;_e++,Le=J.next()){me.index>_e?(Re=me,me=null):Re=me.sibling;var Wa=te(W,me,Le.value,oe);if(Wa===null){me===null&&(me=Re);break}e&&me&&Wa.alternate===null&&n(W,me),X=h(Wa,X,_e),Be===null?ye=Wa:Be.sibling=Wa,Be=Wa,me=Re}if(Le.done)return i(W,me),ze&&ea(W,_e),ye;if(me===null){for(;!Le.done;_e++,Le=J.next())Le=le(W,Le.value,oe),Le!==null&&(X=h(Le,X,_e),Be===null?ye=Le:Be.sibling=Le,Be=Le);return ze&&ea(W,_e),ye}for(me=l(me);!Le.done;_e++,Le=J.next())Le=se(me,W,_e,Le.value,oe),Le!==null&&(e&&Le.alternate!==null&&me.delete(Le.key===null?_e:Le.key),X=h(Le,X,_e),Be===null?ye=Le:Be.sibling=Le,Be=Le);return e&&me.forEach(function(ej){return n(W,ej)}),ze&&ea(W,_e),ye}function Ie(W,X,J,oe){if(typeof J=="object"&&J!==null&&J.type===C&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case N:e:{for(var ye=J.key;X!==null;){if(X.key===ye){if(ye=J.type,ye===C){if(X.tag===7){i(W,X.sibling),oe=f(X,J.props.children),oe.return=W,W=oe;break e}}else if(X.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===q&&_s(ye)===X.type){i(W,X.sibling),oe=f(X,J.props),Ti(oe,J),oe.return=W,W=oe;break e}i(W,X);break}else n(W,X);X=X.sibling}J.type===C?(oe=vs(J.props.children,W.mode,oe,J.key),oe.return=W,W=oe):(oe=fl(J.type,J.key,J.props,null,W.mode,oe),Ti(oe,J),oe.return=W,W=oe)}return v(W);case S:e:{for(ye=J.key;X!==null;){if(X.key===ye)if(X.tag===4&&X.stateNode.containerInfo===J.containerInfo&&X.stateNode.implementation===J.implementation){i(W,X.sibling),oe=f(X,J.children||[]),oe.return=W,W=oe;break e}else{i(W,X);break}else n(W,X);X=X.sibling}oe=id(J,W.mode,oe),oe.return=W,W=oe}return v(W);case q:return J=_s(J),Ie(W,X,J,oe)}if(I(J))return fe(W,X,J,oe);if(Z(J)){if(ye=Z(J),typeof ye!="function")throw Error(o(150));return J=ye.call(J),we(W,X,J,oe)}if(typeof J.then=="function")return Ie(W,X,bl(J),oe);if(J.$$typeof===T)return Ie(W,X,pl(W,J),oe);vl(W,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,X!==null&&X.tag===6?(i(W,X.sibling),oe=f(X,J),oe.return=W,W=oe):(i(W,X),oe=rd(J,W.mode,oe),oe.return=W,W=oe),v(W)):i(W,X)}return function(W,X,J,oe){try{Ci=0;var ye=Ie(W,X,J,oe);return mr=null,ye}catch(me){if(me===hr||me===xl)throw me;var Be=Yt(29,me,null,W.mode);return Be.lanes=oe,Be.return=W,Be}}}var Cs=Cp(!0),Tp=Cp(!1),za=!1;function yd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bd(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Oa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ba(e,n,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(He&2)!==0){var f=l.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),l.pending=n,n=dl(e),dp(e,null,i),n}return ul(e,l,n,i),dl(e)}function Mi(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194048)!==0)){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Yo(e,i)}}function vd(e,n){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var f=null,h=null;if(i=i.firstBaseUpdate,i!==null){do{var v={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};h===null?f=h=v:h=h.next=v,i=i.next}while(i!==null);h===null?f=h=n:h=h.next=n}else f=h=n;i={baseState:l.baseState,firstBaseUpdate:f,lastBaseUpdate:h,shared:l.shared,callbacks:l.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}var wd=!1;function Ai(){if(wd){var e=fr;if(e!==null)throw e}}function ki(e,n,i,l){wd=!1;var f=e.updateQueue;za=!1;var h=f.firstBaseUpdate,v=f.lastBaseUpdate,k=f.shared.pending;if(k!==null){f.shared.pending=null;var Y=k,ee=Y.next;Y.next=null,v===null?h=ee:v.next=ee,v=Y;var ie=e.alternate;ie!==null&&(ie=ie.updateQueue,k=ie.lastBaseUpdate,k!==v&&(k===null?ie.firstBaseUpdate=ee:k.next=ee,ie.lastBaseUpdate=Y))}if(h!==null){var le=f.baseState;v=0,ie=ee=Y=null,k=h;do{var te=k.lane&-536870913,se=te!==k.lane;if(se?(ke&te)===te:(l&te)===te){te!==0&&te===dr&&(wd=!0),ie!==null&&(ie=ie.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var fe=e,we=k;te=n;var Ie=i;switch(we.tag){case 1:if(fe=we.payload,typeof fe=="function"){le=fe.call(Ie,le,te);break e}le=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=we.payload,te=typeof fe=="function"?fe.call(Ie,le,te):fe,te==null)break e;le=x({},le,te);break e;case 2:za=!0}}te=k.callback,te!==null&&(e.flags|=64,se&&(e.flags|=8192),se=f.callbacks,se===null?f.callbacks=[te]:se.push(te))}else se={lane:te,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ie===null?(ee=ie=se,Y=le):ie=ie.next=se,v|=te;if(k=k.next,k===null){if(k=f.shared.pending,k===null)break;se=k,k=se.next,se.next=null,f.lastBaseUpdate=se,f.shared.pending=null}}while(!0);ie===null&&(Y=le),f.baseState=Y,f.firstBaseUpdate=ee,f.lastBaseUpdate=ie,h===null&&(f.shared.lanes=0),Ua|=v,e.lanes=v,e.memoizedState=le}}function Mp(e,n){if(typeof e!="function")throw Error(o(191,e));e.call(n)}function Ap(e,n){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)Mp(i[e],n)}var pr=B(null),wl=B(0);function kp(e,n){e=da,ae(wl,e),ae(pr,n),da=e|n.baseLanes}function jd(){ae(wl,da),ae(pr,pr.current)}function Nd(){da=wl.current,P(pr),P(wl)}var Pt=B(null),on=null;function La(e){var n=e.alternate;ae(tt,tt.current&1),ae(Pt,e),on===null&&(n===null||pr.current!==null||n.memoizedState!==null)&&(on=e)}function Sd(e){ae(tt,tt.current),ae(Pt,e),on===null&&(on=e)}function Rp(e){e.tag===22?(ae(tt,tt.current),ae(Pt,e),on===null&&(on=e)):Ha()}function Ha(){ae(tt,tt.current),ae(Pt,Pt.current)}function It(e){P(Pt),on===e&&(on=null),P(tt)}var tt=B(0);function jl(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||kf(i)||Rf(i)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var aa=0,Ne=null,Ye=null,lt=null,Nl=!1,gr=!1,Ts=!1,Sl=0,Ri=0,xr=null,P2=0;function Je(){throw Error(o(321))}function _d(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!Vt(e[i],n[i]))return!1;return!0}function Ed(e,n,i,l,f,h){return aa=h,Ne=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,z.H=e===null||e.memoizedState===null?p0:Ud,Ts=!1,h=i(l,f),Ts=!1,gr&&(h=zp(n,i,l,f)),Dp(e),h}function Dp(e){z.H=Oi;var n=Ye!==null&&Ye.next!==null;if(aa=0,lt=Ye=Ne=null,Nl=!1,Ri=0,xr=null,n)throw Error(o(300));e===null||ct||(e=e.dependencies,e!==null&&ml(e)&&(ct=!0))}function zp(e,n,i,l){Ne=e;var f=0;do{if(gr&&(xr=null),Ri=0,gr=!1,25<=f)throw Error(o(301));if(f+=1,lt=Ye=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}z.H=g0,h=n(i,l)}while(gr);return h}function I2(){var e=z.H,n=e.useState()[0];return n=typeof n.then=="function"?Di(n):n,e=e.useState()[0],(Ye!==null?Ye.memoizedState:null)!==e&&(Ne.flags|=1024),n}function Cd(){var e=Sl!==0;return Sl=0,e}function Td(e,n,i){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~i}function Md(e){if(Nl){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Nl=!1}aa=0,lt=Ye=Ne=null,gr=!1,Ri=Sl=0,xr=null}function Mt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?Ne.memoizedState=lt=e:lt=lt.next=e,lt}function nt(){if(Ye===null){var e=Ne.alternate;e=e!==null?e.memoizedState:null}else e=Ye.next;var n=lt===null?Ne.memoizedState:lt.next;if(n!==null)lt=n,Ye=e;else{if(e===null)throw Ne.alternate===null?Error(o(467)):Error(o(310));Ye=e,e={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},lt===null?Ne.memoizedState=lt=e:lt=lt.next=e}return lt}function _l(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Di(e){var n=Ri;return Ri+=1,xr===null&&(xr=[]),e=Sp(xr,e,n),n=Ne,(lt===null?n.memoizedState:lt.next)===null&&(n=n.alternate,z.H=n===null||n.memoizedState===null?p0:Ud),e}function El(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Di(e);if(e.$$typeof===T)return vt(e)}throw Error(o(438,String(e)))}function Ad(e){var n=null,i=Ne.updateQueue;if(i!==null&&(n=i.memoCache),n==null){var l=Ne.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(n={data:l.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),i===null&&(i=_l(),Ne.updateQueue=i),i.memoCache=n,i=n.data[n.index],i===void 0)for(i=n.data[n.index]=Array(e),l=0;l<e;l++)i[l]=F;return n.index++,i}function sa(e,n){return typeof n=="function"?n(e):n}function Cl(e){var n=nt();return kd(n,Ye,e)}function kd(e,n,i){var l=e.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=i;var f=e.baseQueue,h=l.pending;if(h!==null){if(f!==null){var v=f.next;f.next=h.next,h.next=v}n.baseQueue=f=h,l.pending=null}if(h=e.baseState,f===null)e.memoizedState=h;else{n=f.next;var k=v=null,Y=null,ee=n,ie=!1;do{var le=ee.lane&-536870913;if(le!==ee.lane?(ke&le)===le:(aa&le)===le){var te=ee.revertLane;if(te===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,gesture:null,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),le===dr&&(ie=!0);else if((aa&te)===te){ee=ee.next,te===dr&&(ie=!0);continue}else le={lane:0,revertLane:ee.revertLane,gesture:null,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},Y===null?(k=Y=le,v=h):Y=Y.next=le,Ne.lanes|=te,Ua|=te;le=ee.action,Ts&&i(h,le),h=ee.hasEagerState?ee.eagerState:i(h,le)}else te={lane:le,revertLane:ee.revertLane,gesture:ee.gesture,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},Y===null?(k=Y=te,v=h):Y=Y.next=te,Ne.lanes|=le,Ua|=le;ee=ee.next}while(ee!==null&&ee!==n);if(Y===null?v=h:Y.next=k,!Vt(h,e.memoizedState)&&(ct=!0,ie&&(i=fr,i!==null)))throw i;e.memoizedState=h,e.baseState=v,e.baseQueue=Y,l.lastRenderedState=h}return f===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function Rd(e){var n=nt(),i=n.queue;if(i===null)throw Error(o(311));i.lastRenderedReducer=e;var l=i.dispatch,f=i.pending,h=n.memoizedState;if(f!==null){i.pending=null;var v=f=f.next;do h=e(h,v.action),v=v.next;while(v!==f);Vt(h,n.memoizedState)||(ct=!0),n.memoizedState=h,n.baseQueue===null&&(n.baseState=h),i.lastRenderedState=h}return[h,l]}function Op(e,n,i){var l=Ne,f=nt(),h=ze;if(h){if(i===void 0)throw Error(o(407));i=i()}else i=n();var v=!Vt((Ye||f).memoizedState,i);if(v&&(f.memoizedState=i,ct=!0),f=f.queue,Od(Hp.bind(null,l,f,e),[e]),f.getSnapshot!==n||v||lt!==null&&lt.memoizedState.tag&1){if(l.flags|=2048,yr(9,{destroy:void 0},Lp.bind(null,l,f,i,n),null),Xe===null)throw Error(o(349));h||(aa&127)!==0||Bp(l,n,i)}return i}function Bp(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=Ne.updateQueue,n===null?(n=_l(),Ne.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function Lp(e,n,i,l){n.value=i,n.getSnapshot=l,$p(n)&&qp(e)}function Hp(e,n,i){return i(function(){$p(n)&&qp(e)})}function $p(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!Vt(e,i)}catch{return!0}}function qp(e){var n=bs(e,2);n!==null&&Ht(n,e,2)}function Dd(e){var n=Mt();if(typeof e=="function"){var i=e;if(e=i(),Ts){Tn(!0);try{i()}finally{Tn(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:e},n}function Up(e,n,i,l){return e.baseState=i,kd(e,Ye,typeof l=="function"?l:sa)}function X2(e,n,i,l,f){if(Al(e))throw Error(o(485));if(e=n.action,e!==null){var h={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){h.listeners.push(v)}};z.T!==null?i(!0):h.isTransition=!1,l(h),i=n.pending,i===null?(h.next=n.pending=h,Vp(n,h)):(h.next=i.next,n.pending=i.next=h)}}function Vp(e,n){var i=n.action,l=n.payload,f=e.state;if(n.isTransition){var h=z.T,v={};z.T=v;try{var k=i(f,l),Y=z.S;Y!==null&&Y(v,k),Yp(e,n,k)}catch(ee){zd(e,n,ee)}finally{h!==null&&v.types!==null&&(h.types=v.types),z.T=h}}else try{h=i(f,l),Yp(e,n,h)}catch(ee){zd(e,n,ee)}}function Yp(e,n,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(l){Pp(e,n,l)},function(l){return zd(e,n,l)}):Pp(e,n,i)}function Pp(e,n,i){n.status="fulfilled",n.value=i,Ip(n),e.state=i,n=e.pending,n!==null&&(i=n.next,i===n?e.pending=null:(i=i.next,n.next=i,Vp(e,i)))}function zd(e,n,i){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do n.status="rejected",n.reason=i,Ip(n),n=n.next;while(n!==l)}e.action=null}function Ip(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Xp(e,n){return n}function Gp(e,n){if(ze){var i=Xe.formState;if(i!==null){e:{var l=Ne;if(ze){if(Ge){t:{for(var f=Ge,h=rn;f.nodeType!==8;){if(!h){f=null;break t}if(f=ln(f.nextSibling),f===null){f=null;break t}}h=f.data,f=h==="F!"||h==="F"?f:null}if(f){Ge=ln(f.nextSibling),l=f.data==="F!";break e}}Ra(l)}l=!1}l&&(n=i[0])}}return i=Mt(),i.memoizedState=i.baseState=n,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xp,lastRenderedState:n},i.queue=l,i=f0.bind(null,Ne,l),l.dispatch=i,l=Dd(!1),h=qd.bind(null,Ne,!1,l.queue),l=Mt(),f={state:n,dispatch:null,action:e,pending:null},l.queue=f,i=X2.bind(null,Ne,f,h,i),f.dispatch=i,l.memoizedState=e,[n,i,!1]}function Qp(e){var n=nt();return Fp(n,Ye,e)}function Fp(e,n,i){if(n=kd(e,n,Xp)[0],e=Cl(sa)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var l=Di(n)}catch(v){throw v===hr?xl:v}else l=n;n=nt();var f=n.queue,h=f.dispatch;return i!==n.memoizedState&&(Ne.flags|=2048,yr(9,{destroy:void 0},G2.bind(null,f,i),null)),[l,h,e]}function G2(e,n){e.action=n}function Zp(e){var n=nt(),i=Ye;if(i!==null)return Fp(n,i,e);nt(),n=n.memoizedState,i=nt();var l=i.queue.dispatch;return i.memoizedState=e,[n,l,!1]}function yr(e,n,i,l){return e={tag:e,create:i,deps:l,inst:n,next:null},n=Ne.updateQueue,n===null&&(n=_l(),Ne.updateQueue=n),i=n.lastEffect,i===null?n.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,n.lastEffect=e),e}function Wp(){return nt().memoizedState}function Tl(e,n,i,l){var f=Mt();Ne.flags|=e,f.memoizedState=yr(1|n,{destroy:void 0},i,l===void 0?null:l)}function Ml(e,n,i,l){var f=nt();l=l===void 0?null:l;var h=f.memoizedState.inst;Ye!==null&&l!==null&&_d(l,Ye.memoizedState.deps)?f.memoizedState=yr(n,h,i,l):(Ne.flags|=e,f.memoizedState=yr(1|n,h,i,l))}function Kp(e,n){Tl(8390656,8,e,n)}function Od(e,n){Ml(2048,8,e,n)}function Q2(e){Ne.flags|=4;var n=Ne.updateQueue;if(n===null)n=_l(),Ne.updateQueue=n,n.events=[e];else{var i=n.events;i===null?n.events=[e]:i.push(e)}}function Jp(e){var n=nt().memoizedState;return Q2({ref:n,nextImpl:e}),function(){if((He&2)!==0)throw Error(o(440));return n.impl.apply(void 0,arguments)}}function e0(e,n){return Ml(4,2,e,n)}function t0(e,n){return Ml(4,4,e,n)}function n0(e,n){if(typeof n=="function"){e=e();var i=n(e);return function(){typeof i=="function"?i():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function a0(e,n,i){i=i!=null?i.concat([e]):null,Ml(4,4,n0.bind(null,n,e),i)}function Bd(){}function s0(e,n){var i=nt();n=n===void 0?null:n;var l=i.memoizedState;return n!==null&&_d(n,l[1])?l[0]:(i.memoizedState=[e,n],e)}function r0(e,n){var i=nt();n=n===void 0?null:n;var l=i.memoizedState;if(n!==null&&_d(n,l[1]))return l[0];if(l=e(),Ts){Tn(!0);try{e()}finally{Tn(!1)}}return i.memoizedState=[l,n],l}function Ld(e,n,i){return i===void 0||(aa&1073741824)!==0&&(ke&261930)===0?e.memoizedState=n:(e.memoizedState=i,e=ig(),Ne.lanes|=e,Ua|=e,i)}function i0(e,n,i,l){return Vt(i,n)?i:pr.current!==null?(e=Ld(e,i,l),Vt(e,n)||(ct=!0),e):(aa&42)===0||(aa&1073741824)!==0&&(ke&261930)===0?(ct=!0,e.memoizedState=i):(e=ig(),Ne.lanes|=e,Ua|=e,n)}function o0(e,n,i,l,f){var h=R.p;R.p=h!==0&&8>h?h:8;var v=z.T,k={};z.T=k,qd(e,!1,n,i);try{var Y=f(),ee=z.S;if(ee!==null&&ee(k,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ie=Y2(Y,l);zi(e,n,ie,Qt(e))}else zi(e,n,l,Qt(e))}catch(le){zi(e,n,{then:function(){},status:"rejected",reason:le},Qt())}finally{R.p=h,v!==null&&k.types!==null&&(v.types=k.types),z.T=v}}function F2(){}function Hd(e,n,i,l){if(e.tag!==5)throw Error(o(476));var f=l0(e).queue;o0(e,f,n,U,i===null?F2:function(){return c0(e),i(l)})}function l0(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:U},next:null};var i={};return n.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:i},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function c0(e){var n=l0(e);n.next===null&&(n=e.alternate.memoizedState),zi(e,n.next.queue,{},Qt())}function $d(){return vt(Wi)}function u0(){return nt().memoizedState}function d0(){return nt().memoizedState}function Z2(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var i=Qt();e=Oa(i);var l=Ba(n,e,i);l!==null&&(Ht(l,n,i),Mi(l,n,i)),n={cache:md()},e.payload=n;return}n=n.return}}function W2(e,n,i){var l=Qt();i={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Al(e)?h0(n,i):(i=ad(e,n,i,l),i!==null&&(Ht(i,e,l),m0(i,n,l)))}function f0(e,n,i){var l=Qt();zi(e,n,i,l)}function zi(e,n,i,l){var f={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(Al(e))h0(n,f);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=n.lastRenderedReducer,h!==null))try{var v=n.lastRenderedState,k=h(v,i);if(f.hasEagerState=!0,f.eagerState=k,Vt(k,v))return ul(e,n,f,0),Xe===null&&cl(),!1}catch{}if(i=ad(e,n,f,l),i!==null)return Ht(i,e,l),m0(i,n,l),!0}return!1}function qd(e,n,i,l){if(l={lane:2,revertLane:bf(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Al(e)){if(n)throw Error(o(479))}else n=ad(e,i,l,2),n!==null&&Ht(n,e,2)}function Al(e){var n=e.alternate;return e===Ne||n!==null&&n===Ne}function h0(e,n){gr=Nl=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function m0(e,n,i){if((i&4194048)!==0){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Yo(e,i)}}var Oi={readContext:vt,use:El,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je};Oi.useEffectEvent=Je;var p0={readContext:vt,use:El,useCallback:function(e,n){return Mt().memoizedState=[e,n===void 0?null:n],e},useContext:vt,useEffect:Kp,useImperativeHandle:function(e,n,i){i=i!=null?i.concat([e]):null,Tl(4194308,4,n0.bind(null,n,e),i)},useLayoutEffect:function(e,n){return Tl(4194308,4,e,n)},useInsertionEffect:function(e,n){Tl(4,2,e,n)},useMemo:function(e,n){var i=Mt();n=n===void 0?null:n;var l=e();if(Ts){Tn(!0);try{e()}finally{Tn(!1)}}return i.memoizedState=[l,n],l},useReducer:function(e,n,i){var l=Mt();if(i!==void 0){var f=i(n);if(Ts){Tn(!0);try{i(n)}finally{Tn(!1)}}}else f=n;return l.memoizedState=l.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},l.queue=e,e=e.dispatch=W2.bind(null,Ne,e),[l.memoizedState,e]},useRef:function(e){var n=Mt();return e={current:e},n.memoizedState=e},useState:function(e){e=Dd(e);var n=e.queue,i=f0.bind(null,Ne,n);return n.dispatch=i,[e.memoizedState,i]},useDebugValue:Bd,useDeferredValue:function(e,n){var i=Mt();return Ld(i,e,n)},useTransition:function(){var e=Dd(!1);return e=o0.bind(null,Ne,e.queue,!0,!1),Mt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,i){var l=Ne,f=Mt();if(ze){if(i===void 0)throw Error(o(407));i=i()}else{if(i=n(),Xe===null)throw Error(o(349));(ke&127)!==0||Bp(l,n,i)}f.memoizedState=i;var h={value:i,getSnapshot:n};return f.queue=h,Kp(Hp.bind(null,l,h,e),[e]),l.flags|=2048,yr(9,{destroy:void 0},Lp.bind(null,l,h,i,n),null),i},useId:function(){var e=Mt(),n=Xe.identifierPrefix;if(ze){var i=kn,l=An;i=(l&~(1<<32-Tt(l)-1)).toString(32)+i,n="_"+n+"R_"+i,i=Sl++,0<i&&(n+="H"+i.toString(32)),n+="_"}else i=P2++,n="_"+n+"r_"+i.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:$d,useFormState:Gp,useActionState:Gp,useOptimistic:function(e){var n=Mt();n.memoizedState=n.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=i,n=qd.bind(null,Ne,!0,i),i.dispatch=n,[e,n]},useMemoCache:Ad,useCacheRefresh:function(){return Mt().memoizedState=Z2.bind(null,Ne)},useEffectEvent:function(e){var n=Mt(),i={impl:e};return n.memoizedState=i,function(){if((He&2)!==0)throw Error(o(440));return i.impl.apply(void 0,arguments)}}},Ud={readContext:vt,use:El,useCallback:s0,useContext:vt,useEffect:Od,useImperativeHandle:a0,useInsertionEffect:e0,useLayoutEffect:t0,useMemo:r0,useReducer:Cl,useRef:Wp,useState:function(){return Cl(sa)},useDebugValue:Bd,useDeferredValue:function(e,n){var i=nt();return i0(i,Ye.memoizedState,e,n)},useTransition:function(){var e=Cl(sa)[0],n=nt().memoizedState;return[typeof e=="boolean"?e:Di(e),n]},useSyncExternalStore:Op,useId:u0,useHostTransitionStatus:$d,useFormState:Qp,useActionState:Qp,useOptimistic:function(e,n){var i=nt();return Up(i,Ye,e,n)},useMemoCache:Ad,useCacheRefresh:d0};Ud.useEffectEvent=Jp;var g0={readContext:vt,use:El,useCallback:s0,useContext:vt,useEffect:Od,useImperativeHandle:a0,useInsertionEffect:e0,useLayoutEffect:t0,useMemo:r0,useReducer:Rd,useRef:Wp,useState:function(){return Rd(sa)},useDebugValue:Bd,useDeferredValue:function(e,n){var i=nt();return Ye===null?Ld(i,e,n):i0(i,Ye.memoizedState,e,n)},useTransition:function(){var e=Rd(sa)[0],n=nt().memoizedState;return[typeof e=="boolean"?e:Di(e),n]},useSyncExternalStore:Op,useId:u0,useHostTransitionStatus:$d,useFormState:Zp,useActionState:Zp,useOptimistic:function(e,n){var i=nt();return Ye!==null?Up(i,Ye,e,n):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:Ad,useCacheRefresh:d0};g0.useEffectEvent=Jp;function Vd(e,n,i,l){n=e.memoizedState,i=i(l,n),i=i==null?n:x({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Yd={enqueueSetState:function(e,n,i){e=e._reactInternals;var l=Qt(),f=Oa(l);f.payload=n,i!=null&&(f.callback=i),n=Ba(e,f,l),n!==null&&(Ht(n,e,l),Mi(n,e,l))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var l=Qt(),f=Oa(l);f.tag=1,f.payload=n,i!=null&&(f.callback=i),n=Ba(e,f,l),n!==null&&(Ht(n,e,l),Mi(n,e,l))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=Qt(),l=Oa(i);l.tag=2,n!=null&&(l.callback=n),n=Ba(e,l,i),n!==null&&(Ht(n,e,i),Mi(n,e,i))}};function x0(e,n,i,l,f,h,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,h,v):n.prototype&&n.prototype.isPureReactComponent?!wi(i,l)||!wi(f,h):!0}function y0(e,n,i,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,l),n.state!==e&&Yd.enqueueReplaceState(n,n.state,null)}function Ms(e,n){var i=n;if("ref"in n){i={};for(var l in n)l!=="ref"&&(i[l]=n[l])}if(e=e.defaultProps){i===n&&(i=x({},i));for(var f in e)i[f]===void 0&&(i[f]=e[f])}return i}function b0(e){ll(e)}function v0(e){console.error(e)}function w0(e){ll(e)}function kl(e,n){try{var i=e.onUncaughtError;i(n.value,{componentStack:n.stack})}catch(l){setTimeout(function(){throw l})}}function j0(e,n,i){try{var l=e.onCaughtError;l(i.value,{componentStack:i.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Pd(e,n,i){return i=Oa(i),i.tag=3,i.payload={element:null},i.callback=function(){kl(e,n)},i}function N0(e){return e=Oa(e),e.tag=3,e}function S0(e,n,i,l){var f=i.type.getDerivedStateFromError;if(typeof f=="function"){var h=l.value;e.payload=function(){return f(h)},e.callback=function(){j0(n,i,l)}}var v=i.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){j0(n,i,l),typeof f!="function"&&(Va===null?Va=new Set([this]):Va.add(this));var k=l.stack;this.componentDidCatch(l.value,{componentStack:k!==null?k:""})})}function K2(e,n,i,l,f){if(i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(n=i.alternate,n!==null&&ur(n,i,f,!0),i=Pt.current,i!==null){switch(i.tag){case 31:case 13:return on===null?Yl():i.alternate===null&&et===0&&(et=3),i.flags&=-257,i.flags|=65536,i.lanes=f,l===yl?i.flags|=16384:(n=i.updateQueue,n===null?i.updateQueue=new Set([l]):n.add(l),gf(e,l,f)),!1;case 22:return i.flags|=65536,l===yl?i.flags|=16384:(n=i.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([l])},i.updateQueue=n):(i=n.retryQueue,i===null?n.retryQueue=new Set([l]):i.add(l)),gf(e,l,f)),!1}throw Error(o(435,i.tag))}return gf(e,l,f),Yl(),!1}if(ze)return n=Pt.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,l!==cd&&(e=Error(o(422),{cause:l}),Si(nn(e,i)))):(l!==cd&&(n=Error(o(423),{cause:l}),Si(nn(n,i))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,l=nn(l,i),f=Pd(e.stateNode,l,f),vd(e,f),et!==4&&(et=2)),!1;var h=Error(o(520),{cause:l});if(h=nn(h,i),Yi===null?Yi=[h]:Yi.push(h),et!==4&&(et=2),n===null)return!0;l=nn(l,i),i=n;do{switch(i.tag){case 3:return i.flags|=65536,e=f&-f,i.lanes|=e,e=Pd(i.stateNode,l,e),vd(i,e),!1;case 1:if(n=i.type,h=i.stateNode,(i.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(Va===null||!Va.has(h))))return i.flags|=65536,f&=-f,i.lanes|=f,f=N0(f),S0(f,e,i,l),vd(i,f),!1}i=i.return}while(i!==null);return!1}var Id=Error(o(461)),ct=!1;function wt(e,n,i,l){n.child=e===null?Tp(n,null,i,l):Cs(n,e.child,i,l)}function _0(e,n,i,l,f){i=i.render;var h=n.ref;if("ref"in l){var v={};for(var k in l)k!=="ref"&&(v[k]=l[k])}else v=l;return Ns(n),l=Ed(e,n,i,v,h,f),k=Cd(),e!==null&&!ct?(Td(e,n,f),ra(e,n,f)):(ze&&k&&od(n),n.flags|=1,wt(e,n,l,f),n.child)}function E0(e,n,i,l,f){if(e===null){var h=i.type;return typeof h=="function"&&!sd(h)&&h.defaultProps===void 0&&i.compare===null?(n.tag=15,n.type=h,C0(e,n,h,l,f)):(e=fl(i.type,null,l,n,n.mode,f),e.ref=n.ref,e.return=n,n.child=e)}if(h=e.child,!Jd(e,f)){var v=h.memoizedProps;if(i=i.compare,i=i!==null?i:wi,i(v,l)&&e.ref===n.ref)return ra(e,n,f)}return n.flags|=1,e=Jn(h,l),e.ref=n.ref,e.return=n,n.child=e}function C0(e,n,i,l,f){if(e!==null){var h=e.memoizedProps;if(wi(h,l)&&e.ref===n.ref)if(ct=!1,n.pendingProps=l=h,Jd(e,f))(e.flags&131072)!==0&&(ct=!0);else return n.lanes=e.lanes,ra(e,n,f)}return Xd(e,n,i,l,f)}function T0(e,n,i,l){var f=l.children,h=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((n.flags&128)!==0){if(h=h!==null?h.baseLanes|i:i,e!==null){for(l=n.child=e.child,f=0;l!==null;)f=f|l.lanes|l.childLanes,l=l.sibling;l=f&~h}else l=0,n.child=null;return M0(e,n,h,i,l)}if((i&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&gl(n,h!==null?h.cachePool:null),h!==null?kp(n,h):jd(),Rp(n);else return l=n.lanes=536870912,M0(e,n,h!==null?h.baseLanes|i:i,i,l)}else h!==null?(gl(n,h.cachePool),kp(n,h),Ha(),n.memoizedState=null):(e!==null&&gl(n,null),jd(),Ha());return wt(e,n,f,i),n.child}function Bi(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function M0(e,n,i,l,f){var h=gd();return h=h===null?null:{parent:ot._currentValue,pool:h},n.memoizedState={baseLanes:i,cachePool:h},e!==null&&gl(n,null),jd(),Rp(n),e!==null&&ur(e,n,l,!0),n.childLanes=f,null}function Rl(e,n){return n=zl({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function A0(e,n,i){return Cs(n,e.child,null,i),e=Rl(n,n.pendingProps),e.flags|=2,It(n),n.memoizedState=null,e}function J2(e,n,i){var l=n.pendingProps,f=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(ze){if(l.mode==="hidden")return e=Rl(n,l),n.lanes=536870912,Bi(null,e);if(Sd(n),(e=Ge)?(e=Vg(e,rn),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Aa!==null?{id:An,overflow:kn}:null,retryLane:536870912,hydrationErrors:null},i=hp(e),i.return=n,n.child=i,bt=n,Ge=null)):e=null,e===null)throw Ra(n);return n.lanes=536870912,null}return Rl(n,l)}var h=e.memoizedState;if(h!==null){var v=h.dehydrated;if(Sd(n),f)if(n.flags&256)n.flags&=-257,n=A0(e,n,i);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(o(558));else if(ct||ur(e,n,i,!1),f=(i&e.childLanes)!==0,ct||f){if(l=Xe,l!==null&&(v=Po(l,i),v!==0&&v!==h.retryLane))throw h.retryLane=v,bs(e,v),Ht(l,e,v),Id;Yl(),n=A0(e,n,i)}else e=h.treeContext,Ge=ln(v.nextSibling),bt=n,ze=!0,ka=null,rn=!1,e!==null&&gp(n,e),n=Rl(n,l),n.flags|=4096;return n}return e=Jn(e.child,{mode:l.mode,children:l.children}),e.ref=n.ref,n.child=e,e.return=n,e}function Dl(e,n){var i=n.ref;if(i===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(o(284));(e===null||e.ref!==i)&&(n.flags|=4194816)}}function Xd(e,n,i,l,f){return Ns(n),i=Ed(e,n,i,l,void 0,f),l=Cd(),e!==null&&!ct?(Td(e,n,f),ra(e,n,f)):(ze&&l&&od(n),n.flags|=1,wt(e,n,i,f),n.child)}function k0(e,n,i,l,f,h){return Ns(n),n.updateQueue=null,i=zp(n,l,i,f),Dp(e),l=Cd(),e!==null&&!ct?(Td(e,n,h),ra(e,n,h)):(ze&&l&&od(n),n.flags|=1,wt(e,n,i,h),n.child)}function R0(e,n,i,l,f){if(Ns(n),n.stateNode===null){var h=ir,v=i.contextType;typeof v=="object"&&v!==null&&(h=vt(v)),h=new i(l,h),n.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Yd,n.stateNode=h,h._reactInternals=n,h=n.stateNode,h.props=l,h.state=n.memoizedState,h.refs={},yd(n),v=i.contextType,h.context=typeof v=="object"&&v!==null?vt(v):ir,h.state=n.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(Vd(n,i,v,l),h.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(v=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),v!==h.state&&Yd.enqueueReplaceState(h,h.state,null),ki(n,l,h,f),Ai(),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308),l=!0}else if(e===null){h=n.stateNode;var k=n.memoizedProps,Y=Ms(i,k);h.props=Y;var ee=h.context,ie=i.contextType;v=ir,typeof ie=="object"&&ie!==null&&(v=vt(ie));var le=i.getDerivedStateFromProps;ie=typeof le=="function"||typeof h.getSnapshotBeforeUpdate=="function",k=n.pendingProps!==k,ie||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(k||ee!==v)&&y0(n,h,l,v),za=!1;var te=n.memoizedState;h.state=te,ki(n,l,h,f),Ai(),ee=n.memoizedState,k||te!==ee||za?(typeof le=="function"&&(Vd(n,i,le,l),ee=n.memoizedState),(Y=za||x0(n,i,Y,l,te,ee,v))?(ie||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(n.flags|=4194308)):(typeof h.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=ee),h.props=l,h.state=ee,h.context=v,l=Y):(typeof h.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{h=n.stateNode,bd(e,n),v=n.memoizedProps,ie=Ms(i,v),h.props=ie,le=n.pendingProps,te=h.context,ee=i.contextType,Y=ir,typeof ee=="object"&&ee!==null&&(Y=vt(ee)),k=i.getDerivedStateFromProps,(ee=typeof k=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(v!==le||te!==Y)&&y0(n,h,l,Y),za=!1,te=n.memoizedState,h.state=te,ki(n,l,h,f),Ai();var se=n.memoizedState;v!==le||te!==se||za||e!==null&&e.dependencies!==null&&ml(e.dependencies)?(typeof k=="function"&&(Vd(n,i,k,l),se=n.memoizedState),(ie=za||x0(n,i,ie,l,te,se,Y)||e!==null&&e.dependencies!==null&&ml(e.dependencies))?(ee||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(l,se,Y),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(l,se,Y)),typeof h.componentDidUpdate=="function"&&(n.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof h.componentDidUpdate!="function"||v===e.memoizedProps&&te===e.memoizedState||(n.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&te===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=se),h.props=l,h.state=se,h.context=Y,l=ie):(typeof h.componentDidUpdate!="function"||v===e.memoizedProps&&te===e.memoizedState||(n.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&te===e.memoizedState||(n.flags|=1024),l=!1)}return h=l,Dl(e,n),l=(n.flags&128)!==0,h||l?(h=n.stateNode,i=l&&typeof i.getDerivedStateFromError!="function"?null:h.render(),n.flags|=1,e!==null&&l?(n.child=Cs(n,e.child,null,f),n.child=Cs(n,null,i,f)):wt(e,n,i,f),n.memoizedState=h.state,e=n.child):e=ra(e,n,f),e}function D0(e,n,i,l){return ws(),n.flags|=256,wt(e,n,i,l),n.child}var Gd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qd(e){return{baseLanes:e,cachePool:jp()}}function Fd(e,n,i){return e=e!==null?e.childLanes&~i:0,n&&(e|=Gt),e}function z0(e,n,i){var l=n.pendingProps,f=!1,h=(n.flags&128)!==0,v;if((v=h)||(v=e!==null&&e.memoizedState===null?!1:(tt.current&2)!==0),v&&(f=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(ze){if(f?La(n):Ha(),(e=Ge)?(e=Vg(e,rn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Aa!==null?{id:An,overflow:kn}:null,retryLane:536870912,hydrationErrors:null},i=hp(e),i.return=n,n.child=i,bt=n,Ge=null)):e=null,e===null)throw Ra(n);return Rf(e)?n.lanes=32:n.lanes=536870912,null}var k=l.children;return l=l.fallback,f?(Ha(),f=n.mode,k=zl({mode:"hidden",children:k},f),l=vs(l,f,i,null),k.return=n,l.return=n,k.sibling=l,n.child=k,l=n.child,l.memoizedState=Qd(i),l.childLanes=Fd(e,v,i),n.memoizedState=Gd,Bi(null,l)):(La(n),Zd(n,k))}var Y=e.memoizedState;if(Y!==null&&(k=Y.dehydrated,k!==null)){if(h)n.flags&256?(La(n),n.flags&=-257,n=Wd(e,n,i)):n.memoizedState!==null?(Ha(),n.child=e.child,n.flags|=128,n=null):(Ha(),k=l.fallback,f=n.mode,l=zl({mode:"visible",children:l.children},f),k=vs(k,f,i,null),k.flags|=2,l.return=n,k.return=n,l.sibling=k,n.child=l,Cs(n,e.child,null,i),l=n.child,l.memoizedState=Qd(i),l.childLanes=Fd(e,v,i),n.memoizedState=Gd,n=Bi(null,l));else if(La(n),Rf(k)){if(v=k.nextSibling&&k.nextSibling.dataset,v)var ee=v.dgst;v=ee,l=Error(o(419)),l.stack="",l.digest=v,Si({value:l,source:null,stack:null}),n=Wd(e,n,i)}else if(ct||ur(e,n,i,!1),v=(i&e.childLanes)!==0,ct||v){if(v=Xe,v!==null&&(l=Po(v,i),l!==0&&l!==Y.retryLane))throw Y.retryLane=l,bs(e,l),Ht(v,e,l),Id;kf(k)||Yl(),n=Wd(e,n,i)}else kf(k)?(n.flags|=192,n.child=e.child,n=null):(e=Y.treeContext,Ge=ln(k.nextSibling),bt=n,ze=!0,ka=null,rn=!1,e!==null&&gp(n,e),n=Zd(n,l.children),n.flags|=4096);return n}return f?(Ha(),k=l.fallback,f=n.mode,Y=e.child,ee=Y.sibling,l=Jn(Y,{mode:"hidden",children:l.children}),l.subtreeFlags=Y.subtreeFlags&65011712,ee!==null?k=Jn(ee,k):(k=vs(k,f,i,null),k.flags|=2),k.return=n,l.return=n,l.sibling=k,n.child=l,Bi(null,l),l=n.child,k=e.child.memoizedState,k===null?k=Qd(i):(f=k.cachePool,f!==null?(Y=ot._currentValue,f=f.parent!==Y?{parent:Y,pool:Y}:f):f=jp(),k={baseLanes:k.baseLanes|i,cachePool:f}),l.memoizedState=k,l.childLanes=Fd(e,v,i),n.memoizedState=Gd,Bi(e.child,l)):(La(n),i=e.child,e=i.sibling,i=Jn(i,{mode:"visible",children:l.children}),i.return=n,i.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=i,n.memoizedState=null,i)}function Zd(e,n){return n=zl({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function zl(e,n){return e=Yt(22,e,null,n),e.lanes=0,e}function Wd(e,n,i){return Cs(n,e.child,null,i),e=Zd(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function O0(e,n,i){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),fd(e.return,n,i)}function Kd(e,n,i,l,f,h){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:f,treeForkCount:h}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=l,v.tail=i,v.tailMode=f,v.treeForkCount=h)}function B0(e,n,i){var l=n.pendingProps,f=l.revealOrder,h=l.tail;l=l.children;var v=tt.current,k=(v&2)!==0;if(k?(v=v&1|2,n.flags|=128):v&=1,ae(tt,v),wt(e,n,l,i),l=ze?Ni:0,!k&&e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&O0(e,i,n);else if(e.tag===19)O0(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(i=n.child,f=null;i!==null;)e=i.alternate,e!==null&&jl(e)===null&&(f=i),i=i.sibling;i=f,i===null?(f=n.child,n.child=null):(f=i.sibling,i.sibling=null),Kd(n,!1,f,i,h,l);break;case"backwards":case"unstable_legacy-backwards":for(i=null,f=n.child,n.child=null;f!==null;){if(e=f.alternate,e!==null&&jl(e)===null){n.child=f;break}e=f.sibling,f.sibling=i,i=f,f=e}Kd(n,!0,i,null,h,l);break;case"together":Kd(n,!1,null,null,void 0,l);break;default:n.memoizedState=null}return n.child}function ra(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),Ua|=n.lanes,(i&n.childLanes)===0)if(e!==null){if(ur(e,n,i,!1),(i&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(o(153));if(n.child!==null){for(e=n.child,i=Jn(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=Jn(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function Jd(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&ml(e)))}function ew(e,n,i){switch(n.tag){case 3:V(n,n.stateNode.containerInfo),Da(n,ot,e.memoizedState.cache),ws();break;case 27:case 5:he(n);break;case 4:V(n,n.stateNode.containerInfo);break;case 10:Da(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Sd(n),null;break;case 13:var l=n.memoizedState;if(l!==null)return l.dehydrated!==null?(La(n),n.flags|=128,null):(i&n.child.childLanes)!==0?z0(e,n,i):(La(n),e=ra(e,n,i),e!==null?e.sibling:null);La(n);break;case 19:var f=(e.flags&128)!==0;if(l=(i&n.childLanes)!==0,l||(ur(e,n,i,!1),l=(i&n.childLanes)!==0),f){if(l)return B0(e,n,i);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ae(tt,tt.current),l)break;return null;case 22:return n.lanes=0,T0(e,n,i,n.pendingProps);case 24:Da(n,ot,e.memoizedState.cache)}return ra(e,n,i)}function L0(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps)ct=!0;else{if(!Jd(e,i)&&(n.flags&128)===0)return ct=!1,ew(e,n,i);ct=(e.flags&131072)!==0}else ct=!1,ze&&(n.flags&1048576)!==0&&pp(n,Ni,n.index);switch(n.lanes=0,n.tag){case 16:e:{var l=n.pendingProps;if(e=_s(n.elementType),n.type=e,typeof e=="function")sd(e)?(l=Ms(e,l),n.tag=1,n=R0(null,n,e,l,i)):(n.tag=0,n=Xd(null,n,e,l,i));else{if(e!=null){var f=e.$$typeof;if(f===A){n.tag=11,n=_0(null,n,e,l,i);break e}else if(f===M){n.tag=14,n=E0(null,n,e,l,i);break e}}throw n=$(e)||e,Error(o(306,n,""))}}return n;case 0:return Xd(e,n,n.type,n.pendingProps,i);case 1:return l=n.type,f=Ms(l,n.pendingProps),R0(e,n,l,f,i);case 3:e:{if(V(n,n.stateNode.containerInfo),e===null)throw Error(o(387));l=n.pendingProps;var h=n.memoizedState;f=h.element,bd(e,n),ki(n,l,null,i);var v=n.memoizedState;if(l=v.cache,Da(n,ot,l),l!==h.cache&&hd(n,[ot],i,!0),Ai(),l=v.element,h.isDehydrated)if(h={element:l,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=h,n.memoizedState=h,n.flags&256){n=D0(e,n,l,i);break e}else if(l!==f){f=nn(Error(o(424)),n),Si(f),n=D0(e,n,l,i);break e}else for(e=n.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Ge=ln(e.firstChild),bt=n,ze=!0,ka=null,rn=!0,i=Tp(n,null,l,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(ws(),l===f){n=ra(e,n,i);break e}wt(e,n,l,i)}n=n.child}return n;case 26:return Dl(e,n),e===null?(i=Qg(n.type,null,n.pendingProps,null))?n.memoizedState=i:ze||(i=n.type,e=n.pendingProps,l=Zl(de.current).createElement(i),l[ht]=n,l[Nt]=e,jt(l,i,e),it(l),n.stateNode=l):n.memoizedState=Qg(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return he(n),e===null&&ze&&(l=n.stateNode=Ig(n.type,n.pendingProps,de.current),bt=n,rn=!0,f=Ge,Xa(n.type)?(Df=f,Ge=ln(l.firstChild)):Ge=f),wt(e,n,n.pendingProps.children,i),Dl(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&ze&&((f=l=Ge)&&(l=Aw(l,n.type,n.pendingProps,rn),l!==null?(n.stateNode=l,bt=n,Ge=ln(l.firstChild),rn=!1,f=!0):f=!1),f||Ra(n)),he(n),f=n.type,h=n.pendingProps,v=e!==null?e.memoizedProps:null,l=h.children,Tf(f,h)?l=null:v!==null&&Tf(f,v)&&(n.flags|=32),n.memoizedState!==null&&(f=Ed(e,n,I2,null,null,i),Wi._currentValue=f),Dl(e,n),wt(e,n,l,i),n.child;case 6:return e===null&&ze&&((e=i=Ge)&&(i=kw(i,n.pendingProps,rn),i!==null?(n.stateNode=i,bt=n,Ge=null,e=!0):e=!1),e||Ra(n)),null;case 13:return z0(e,n,i);case 4:return V(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Cs(n,null,l,i):wt(e,n,l,i),n.child;case 11:return _0(e,n,n.type,n.pendingProps,i);case 7:return wt(e,n,n.pendingProps,i),n.child;case 8:return wt(e,n,n.pendingProps.children,i),n.child;case 12:return wt(e,n,n.pendingProps.children,i),n.child;case 10:return l=n.pendingProps,Da(n,n.type,l.value),wt(e,n,l.children,i),n.child;case 9:return f=n.type._context,l=n.pendingProps.children,Ns(n),f=vt(f),l=l(f),n.flags|=1,wt(e,n,l,i),n.child;case 14:return E0(e,n,n.type,n.pendingProps,i);case 15:return C0(e,n,n.type,n.pendingProps,i);case 19:return B0(e,n,i);case 31:return J2(e,n,i);case 22:return T0(e,n,i,n.pendingProps);case 24:return Ns(n),l=vt(ot),e===null?(f=gd(),f===null&&(f=Xe,h=md(),f.pooledCache=h,h.refCount++,h!==null&&(f.pooledCacheLanes|=i),f=h),n.memoizedState={parent:l,cache:f},yd(n),Da(n,ot,f)):((e.lanes&i)!==0&&(bd(e,n),ki(n,null,null,i),Ai()),f=e.memoizedState,h=n.memoizedState,f.parent!==l?(f={parent:l,cache:l},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),Da(n,ot,l)):(l=h.cache,Da(n,ot,l),l!==f.cache&&hd(n,[ot],i,!0))),wt(e,n,n.pendingProps.children,i),n.child;case 29:throw n.pendingProps}throw Error(o(156,n.tag))}function ia(e){e.flags|=4}function ef(e,n,i,l,f){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(ug())e.flags|=8192;else throw Es=yl,xd}else e.flags&=-16777217}function H0(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Jg(n))if(ug())e.flags|=8192;else throw Es=yl,xd}function Ol(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Uo():536870912,e.lanes|=n,jr|=n)}function Li(e,n){if(!ze)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Qe(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(n)for(var f=e.child;f!==null;)i|=f.lanes|f.childLanes,l|=f.subtreeFlags&65011712,l|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)i|=f.lanes|f.childLanes,l|=f.subtreeFlags,l|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=l,e.childLanes=i,n}function tw(e,n,i){var l=n.pendingProps;switch(ld(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qe(n),null;case 1:return Qe(n),null;case 3:return i=n.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),na(ot),ce(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(cr(n)?ia(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,ud())),Qe(n),null;case 26:var f=n.type,h=n.memoizedState;return e===null?(ia(n),h!==null?(Qe(n),H0(n,h)):(Qe(n),ef(n,f,null,l,i))):h?h!==e.memoizedState?(ia(n),Qe(n),H0(n,h)):(Qe(n),n.flags&=-16777217):(e=e.memoizedProps,e!==l&&ia(n),Qe(n),ef(n,f,e,l,i)),null;case 27:if(ve(n),i=de.current,f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&ia(n);else{if(!l){if(n.stateNode===null)throw Error(o(166));return Qe(n),null}e=G.current,cr(n)?xp(n):(e=Ig(f,l,i),n.stateNode=e,ia(n))}return Qe(n),null;case 5:if(ve(n),f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&ia(n);else{if(!l){if(n.stateNode===null)throw Error(o(166));return Qe(n),null}if(h=G.current,cr(n))xp(n);else{var v=Zl(de.current);switch(h){case 1:h=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:h=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":h=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":h=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":h=v.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof l.is=="string"?v.createElement("select",{is:l.is}):v.createElement("select"),l.multiple?h.multiple=!0:l.size&&(h.size=l.size);break;default:h=typeof l.is=="string"?v.createElement(f,{is:l.is}):v.createElement(f)}}h[ht]=n,h[Nt]=l;e:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)h.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break e;for(;v.sibling===null;){if(v.return===null||v.return===n)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=h;e:switch(jt(h,f,l),f){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&ia(n)}}return Qe(n),ef(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,i),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==l&&ia(n);else{if(typeof l!="string"&&n.stateNode===null)throw Error(o(166));if(e=de.current,cr(n)){if(e=n.stateNode,i=n.memoizedProps,l=null,f=bt,f!==null)switch(f.tag){case 27:case 5:l=f.memoizedProps}e[ht]=n,e=!!(e.nodeValue===i||l!==null&&l.suppressHydrationWarning===!0||zg(e.nodeValue,i)),e||Ra(n,!0)}else e=Zl(e).createTextNode(l),e[ht]=n,n.stateNode=e}return Qe(n),null;case 31:if(i=n.memoizedState,e===null||e.memoizedState!==null){if(l=cr(n),i!==null){if(e===null){if(!l)throw Error(o(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[ht]=n}else ws(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Qe(n),e=!1}else i=ud(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),e=!0;if(!e)return n.flags&256?(It(n),n):(It(n),null);if((n.flags&128)!==0)throw Error(o(558))}return Qe(n),null;case 13:if(l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=cr(n),l!==null&&l.dehydrated!==null){if(e===null){if(!f)throw Error(o(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));f[ht]=n}else ws(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Qe(n),f=!1}else f=ud(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return n.flags&256?(It(n),n):(It(n),null)}return It(n),(n.flags&128)!==0?(n.lanes=i,n):(i=l!==null,e=e!==null&&e.memoizedState!==null,i&&(l=n.child,f=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(f=l.alternate.memoizedState.cachePool.pool),h=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(h=l.memoizedState.cachePool.pool),h!==f&&(l.flags|=2048)),i!==e&&i&&(n.child.flags|=8192),Ol(n,n.updateQueue),Qe(n),null);case 4:return ce(),e===null&&Nf(n.stateNode.containerInfo),Qe(n),null;case 10:return na(n.type),Qe(n),null;case 19:if(P(tt),l=n.memoizedState,l===null)return Qe(n),null;if(f=(n.flags&128)!==0,h=l.rendering,h===null)if(f)Li(l,!1);else{if(et!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(h=jl(e),h!==null){for(n.flags|=128,Li(l,!1),e=h.updateQueue,n.updateQueue=e,Ol(n,e),n.subtreeFlags=0,e=i,i=n.child;i!==null;)fp(i,e),i=i.sibling;return ae(tt,tt.current&1|2),ze&&ea(n,l.treeForkCount),n.child}e=e.sibling}l.tail!==null&&rt()>ql&&(n.flags|=128,f=!0,Li(l,!1),n.lanes=4194304)}else{if(!f)if(e=jl(h),e!==null){if(n.flags|=128,f=!0,e=e.updateQueue,n.updateQueue=e,Ol(n,e),Li(l,!0),l.tail===null&&l.tailMode==="hidden"&&!h.alternate&&!ze)return Qe(n),null}else 2*rt()-l.renderingStartTime>ql&&i!==536870912&&(n.flags|=128,f=!0,Li(l,!1),n.lanes=4194304);l.isBackwards?(h.sibling=n.child,n.child=h):(e=l.last,e!==null?e.sibling=h:n.child=h,l.last=h)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=rt(),e.sibling=null,i=tt.current,ae(tt,f?i&1|2:i&1),ze&&ea(n,l.treeForkCount),e):(Qe(n),null);case 22:case 23:return It(n),Nd(),l=n.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(n.flags|=8192):l&&(n.flags|=8192),l?(i&536870912)!==0&&(n.flags&128)===0&&(Qe(n),n.subtreeFlags&6&&(n.flags|=8192)):Qe(n),i=n.updateQueue,i!==null&&Ol(n,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),l=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),l!==i&&(n.flags|=2048),e!==null&&P(Ss),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),n.memoizedState.cache!==i&&(n.flags|=2048),na(ot),Qe(n),null;case 25:return null;case 30:return null}throw Error(o(156,n.tag))}function nw(e,n){switch(ld(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return na(ot),ce(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return ve(n),null;case 31:if(n.memoizedState!==null){if(It(n),n.alternate===null)throw Error(o(340));ws()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(It(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(o(340));ws()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return P(tt),null;case 4:return ce(),null;case 10:return na(n.type),null;case 22:case 23:return It(n),Nd(),e!==null&&P(Ss),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return na(ot),null;case 25:return null;default:return null}}function $0(e,n){switch(ld(n),n.tag){case 3:na(ot),ce();break;case 26:case 27:case 5:ve(n);break;case 4:ce();break;case 31:n.memoizedState!==null&&It(n);break;case 13:It(n);break;case 19:P(tt);break;case 10:na(n.type);break;case 22:case 23:It(n),Nd(),e!==null&&P(Ss);break;case 24:na(ot)}}function Hi(e,n){try{var i=n.updateQueue,l=i!==null?i.lastEffect:null;if(l!==null){var f=l.next;i=f;do{if((i.tag&e)===e){l=void 0;var h=i.create,v=i.inst;l=h(),v.destroy=l}i=i.next}while(i!==f)}}catch(k){Ue(n,n.return,k)}}function $a(e,n,i){try{var l=n.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var h=f.next;l=h;do{if((l.tag&e)===e){var v=l.inst,k=v.destroy;if(k!==void 0){v.destroy=void 0,f=n;var Y=i,ee=k;try{ee()}catch(ie){Ue(f,Y,ie)}}}l=l.next}while(l!==h)}}catch(ie){Ue(n,n.return,ie)}}function q0(e){var n=e.updateQueue;if(n!==null){var i=e.stateNode;try{Ap(n,i)}catch(l){Ue(e,e.return,l)}}}function U0(e,n,i){i.props=Ms(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(l){Ue(e,n,l)}}function $i(e,n){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof i=="function"?e.refCleanup=i(l):i.current=l}}catch(f){Ue(e,n,f)}}function Rn(e,n){var i=e.ref,l=e.refCleanup;if(i!==null)if(typeof l=="function")try{l()}catch(f){Ue(e,n,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(f){Ue(e,n,f)}else i.current=null}function V0(e){var n=e.type,i=e.memoizedProps,l=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":i.autoFocus&&l.focus();break e;case"img":i.src?l.src=i.src:i.srcSet&&(l.srcset=i.srcSet)}}catch(f){Ue(e,e.return,f)}}function tf(e,n,i){try{var l=e.stateNode;Sw(l,e.type,i,n),l[Nt]=n}catch(f){Ue(e,e.return,f)}}function Y0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Xa(e.type)||e.tag===4}function nf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Y0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Xa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function af(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,n):(n=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,n.appendChild(e),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=Wn));else if(l!==4&&(l===27&&Xa(e.type)&&(i=e.stateNode,n=null),e=e.child,e!==null))for(af(e,n,i),e=e.sibling;e!==null;)af(e,n,i),e=e.sibling}function Bl(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(l!==4&&(l===27&&Xa(e.type)&&(i=e.stateNode),e=e.child,e!==null))for(Bl(e,n,i),e=e.sibling;e!==null;)Bl(e,n,i),e=e.sibling}function P0(e){var n=e.stateNode,i=e.memoizedProps;try{for(var l=e.type,f=n.attributes;f.length;)n.removeAttributeNode(f[0]);jt(n,l,i),n[ht]=e,n[Nt]=i}catch(h){Ue(e,e.return,h)}}var oa=!1,ut=!1,sf=!1,I0=typeof WeakSet=="function"?WeakSet:Set,gt=null;function aw(e,n){if(e=e.containerInfo,Ef=ac,e=ap(e),Wu(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var f=l.anchorOffset,h=l.focusNode;l=l.focusOffset;try{i.nodeType,h.nodeType}catch{i=null;break e}var v=0,k=-1,Y=-1,ee=0,ie=0,le=e,te=null;t:for(;;){for(var se;le!==i||f!==0&&le.nodeType!==3||(k=v+f),le!==h||l!==0&&le.nodeType!==3||(Y=v+l),le.nodeType===3&&(v+=le.nodeValue.length),(se=le.firstChild)!==null;)te=le,le=se;for(;;){if(le===e)break t;if(te===i&&++ee===f&&(k=v),te===h&&++ie===l&&(Y=v),(se=le.nextSibling)!==null)break;le=te,te=le.parentNode}le=se}i=k===-1||Y===-1?null:{start:k,end:Y}}else i=null}i=i||{start:0,end:0}}else i=null;for(Cf={focusedElem:e,selectionRange:i},ac=!1,gt=n;gt!==null;)if(n=gt,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,gt=e;else for(;gt!==null;){switch(n=gt,h=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(i=0;i<e.length;i++)f=e[i],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,i=n,f=h.memoizedProps,h=h.memoizedState,l=i.stateNode;try{var fe=Ms(i.type,f);e=l.getSnapshotBeforeUpdate(fe,h),l.__reactInternalSnapshotBeforeUpdate=e}catch(we){Ue(i,i.return,we)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,i=e.nodeType,i===9)Af(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Af(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=n.sibling,e!==null){e.return=n.return,gt=e;break}gt=n.return}}function X0(e,n,i){var l=i.flags;switch(i.tag){case 0:case 11:case 15:ca(e,i),l&4&&Hi(5,i);break;case 1:if(ca(e,i),l&4)if(e=i.stateNode,n===null)try{e.componentDidMount()}catch(v){Ue(i,i.return,v)}else{var f=Ms(i.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(f,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Ue(i,i.return,v)}}l&64&&q0(i),l&512&&$i(i,i.return);break;case 3:if(ca(e,i),l&64&&(e=i.updateQueue,e!==null)){if(n=null,i.child!==null)switch(i.child.tag){case 27:case 5:n=i.child.stateNode;break;case 1:n=i.child.stateNode}try{Ap(e,n)}catch(v){Ue(i,i.return,v)}}break;case 27:n===null&&l&4&&P0(i);case 26:case 5:ca(e,i),n===null&&l&4&&V0(i),l&512&&$i(i,i.return);break;case 12:ca(e,i);break;case 31:ca(e,i),l&4&&F0(e,i);break;case 13:ca(e,i),l&4&&Z0(e,i),l&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=fw.bind(null,i),Rw(e,i))));break;case 22:if(l=i.memoizedState!==null||oa,!l){n=n!==null&&n.memoizedState!==null||ut,f=oa;var h=ut;oa=l,(ut=n)&&!h?ua(e,i,(i.subtreeFlags&8772)!==0):ca(e,i),oa=f,ut=h}break;case 30:break;default:ca(e,i)}}function G0(e){var n=e.alternate;n!==null&&(e.alternate=null,G0(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&di(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Fe=null,zt=!1;function la(e,n,i){for(i=i.child;i!==null;)Q0(e,n,i),i=i.sibling}function Q0(e,n,i){if(Ct&&typeof Ct.onCommitFiberUnmount=="function")try{Ct.onCommitFiberUnmount(us,i)}catch{}switch(i.tag){case 26:ut||Rn(i,n),la(e,n,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:ut||Rn(i,n);var l=Fe,f=zt;Xa(i.type)&&(Fe=i.stateNode,zt=!1),la(e,n,i),Qi(i.stateNode),Fe=l,zt=f;break;case 5:ut||Rn(i,n);case 6:if(l=Fe,f=zt,Fe=null,la(e,n,i),Fe=l,zt=f,Fe!==null)if(zt)try{(Fe.nodeType===9?Fe.body:Fe.nodeName==="HTML"?Fe.ownerDocument.body:Fe).removeChild(i.stateNode)}catch(h){Ue(i,n,h)}else try{Fe.removeChild(i.stateNode)}catch(h){Ue(i,n,h)}break;case 18:Fe!==null&&(zt?(e=Fe,qg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),Ar(e)):qg(Fe,i.stateNode));break;case 4:l=Fe,f=zt,Fe=i.stateNode.containerInfo,zt=!0,la(e,n,i),Fe=l,zt=f;break;case 0:case 11:case 14:case 15:$a(2,i,n),ut||$a(4,i,n),la(e,n,i);break;case 1:ut||(Rn(i,n),l=i.stateNode,typeof l.componentWillUnmount=="function"&&U0(i,n,l)),la(e,n,i);break;case 21:la(e,n,i);break;case 22:ut=(l=ut)||i.memoizedState!==null,la(e,n,i),ut=l;break;default:la(e,n,i)}}function F0(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Ar(e)}catch(i){Ue(n,n.return,i)}}}function Z0(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ar(e)}catch(i){Ue(n,n.return,i)}}function sw(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new I0),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new I0),n;default:throw Error(o(435,e.tag))}}function Ll(e,n){var i=sw(e);n.forEach(function(l){if(!i.has(l)){i.add(l);var f=hw.bind(null,e,l);l.then(f,f)}})}function Ot(e,n){var i=n.deletions;if(i!==null)for(var l=0;l<i.length;l++){var f=i[l],h=e,v=n,k=v;e:for(;k!==null;){switch(k.tag){case 27:if(Xa(k.type)){Fe=k.stateNode,zt=!1;break e}break;case 5:Fe=k.stateNode,zt=!1;break e;case 3:case 4:Fe=k.stateNode.containerInfo,zt=!0;break e}k=k.return}if(Fe===null)throw Error(o(160));Q0(h,v,f),Fe=null,zt=!1,h=f.alternate,h!==null&&(h.return=null),f.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)W0(n,e),n=n.sibling}var yn=null;function W0(e,n){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ot(n,e),Bt(e),l&4&&($a(3,e,e.return),Hi(3,e),$a(5,e,e.return));break;case 1:Ot(n,e),Bt(e),l&512&&(ut||i===null||Rn(i,i.return)),l&64&&oa&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?l:i.concat(l))));break;case 26:var f=yn;if(Ot(n,e),Bt(e),l&512&&(ut||i===null||Rn(i,i.return)),l&4){var h=i!==null?i.memoizedState:null;if(l=e.memoizedState,i===null)if(l===null)if(e.stateNode===null){e:{l=e.type,i=e.memoizedProps,f=f.ownerDocument||f;t:switch(l){case"title":h=f.getElementsByTagName("title")[0],(!h||h[hs]||h[ht]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=f.createElement(l),f.head.insertBefore(h,f.querySelector("head > title"))),jt(h,l,i),h[ht]=e,it(h),l=h;break e;case"link":var v=Wg("link","href",f).get(l+(i.href||""));if(v){for(var k=0;k<v.length;k++)if(h=v[k],h.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&h.getAttribute("rel")===(i.rel==null?null:i.rel)&&h.getAttribute("title")===(i.title==null?null:i.title)&&h.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){v.splice(k,1);break t}}h=f.createElement(l),jt(h,l,i),f.head.appendChild(h);break;case"meta":if(v=Wg("meta","content",f).get(l+(i.content||""))){for(k=0;k<v.length;k++)if(h=v[k],h.getAttribute("content")===(i.content==null?null:""+i.content)&&h.getAttribute("name")===(i.name==null?null:i.name)&&h.getAttribute("property")===(i.property==null?null:i.property)&&h.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&h.getAttribute("charset")===(i.charSet==null?null:i.charSet)){v.splice(k,1);break t}}h=f.createElement(l),jt(h,l,i),f.head.appendChild(h);break;default:throw Error(o(468,l))}h[ht]=e,it(h),l=h}e.stateNode=l}else Kg(f,e.type,e.stateNode);else e.stateNode=Zg(f,l,e.memoizedProps);else h!==l?(h===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):h.count--,l===null?Kg(f,e.type,e.stateNode):Zg(f,l,e.memoizedProps)):l===null&&e.stateNode!==null&&tf(e,e.memoizedProps,i.memoizedProps)}break;case 27:Ot(n,e),Bt(e),l&512&&(ut||i===null||Rn(i,i.return)),i!==null&&l&4&&tf(e,e.memoizedProps,i.memoizedProps);break;case 5:if(Ot(n,e),Bt(e),l&512&&(ut||i===null||Rn(i,i.return)),e.flags&32){f=e.stateNode;try{Js(f,"")}catch(fe){Ue(e,e.return,fe)}}l&4&&e.stateNode!=null&&(f=e.memoizedProps,tf(e,f,i!==null?i.memoizedProps:f)),l&1024&&(sf=!0);break;case 6:if(Ot(n,e),Bt(e),l&4){if(e.stateNode===null)throw Error(o(162));l=e.memoizedProps,i=e.stateNode;try{i.nodeValue=l}catch(fe){Ue(e,e.return,fe)}}break;case 3:if(Jl=null,f=yn,yn=Wl(n.containerInfo),Ot(n,e),yn=f,Bt(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{Ar(n.containerInfo)}catch(fe){Ue(e,e.return,fe)}sf&&(sf=!1,K0(e));break;case 4:l=yn,yn=Wl(e.stateNode.containerInfo),Ot(n,e),Bt(e),yn=l;break;case 12:Ot(n,e),Bt(e);break;case 31:Ot(n,e),Bt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ll(e,l)));break;case 13:Ot(n,e),Bt(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&($l=rt()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ll(e,l)));break;case 22:f=e.memoizedState!==null;var Y=i!==null&&i.memoizedState!==null,ee=oa,ie=ut;if(oa=ee||f,ut=ie||Y,Ot(n,e),ut=ie,oa=ee,Bt(e),l&8192)e:for(n=e.stateNode,n._visibility=f?n._visibility&-2:n._visibility|1,f&&(i===null||Y||oa||ut||As(e)),i=null,n=e;;){if(n.tag===5||n.tag===26){if(i===null){Y=i=n;try{if(h=Y.stateNode,f)v=h.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{k=Y.stateNode;var le=Y.memoizedProps.style,te=le!=null&&le.hasOwnProperty("display")?le.display:null;k.style.display=te==null||typeof te=="boolean"?"":(""+te).trim()}}catch(fe){Ue(Y,Y.return,fe)}}}else if(n.tag===6){if(i===null){Y=n;try{Y.stateNode.nodeValue=f?"":Y.memoizedProps}catch(fe){Ue(Y,Y.return,fe)}}}else if(n.tag===18){if(i===null){Y=n;try{var se=Y.stateNode;f?Ug(se,!0):Ug(Y.stateNode,!1)}catch(fe){Ue(Y,Y.return,fe)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;i===n&&(i=null),n=n.return}i===n&&(i=null),n.sibling.return=n.return,n=n.sibling}l&4&&(l=e.updateQueue,l!==null&&(i=l.retryQueue,i!==null&&(l.retryQueue=null,Ll(e,i))));break;case 19:Ot(n,e),Bt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ll(e,l)));break;case 30:break;case 21:break;default:Ot(n,e),Bt(e)}}function Bt(e){var n=e.flags;if(n&2){try{for(var i,l=e.return;l!==null;){if(Y0(l)){i=l;break}l=l.return}if(i==null)throw Error(o(160));switch(i.tag){case 27:var f=i.stateNode,h=nf(e);Bl(e,h,f);break;case 5:var v=i.stateNode;i.flags&32&&(Js(v,""),i.flags&=-33);var k=nf(e);Bl(e,k,v);break;case 3:case 4:var Y=i.stateNode.containerInfo,ee=nf(e);af(e,ee,Y);break;default:throw Error(o(161))}}catch(ie){Ue(e,e.return,ie)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function K0(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;K0(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function ca(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)X0(e,n.alternate,n),n=n.sibling}function As(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:$a(4,n,n.return),As(n);break;case 1:Rn(n,n.return);var i=n.stateNode;typeof i.componentWillUnmount=="function"&&U0(n,n.return,i),As(n);break;case 27:Qi(n.stateNode);case 26:case 5:Rn(n,n.return),As(n);break;case 22:n.memoizedState===null&&As(n);break;case 30:As(n);break;default:As(n)}e=e.sibling}}function ua(e,n,i){for(i=i&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var l=n.alternate,f=e,h=n,v=h.flags;switch(h.tag){case 0:case 11:case 15:ua(f,h,i),Hi(4,h);break;case 1:if(ua(f,h,i),l=h,f=l.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ee){Ue(l,l.return,ee)}if(l=h,f=l.updateQueue,f!==null){var k=l.stateNode;try{var Y=f.shared.hiddenCallbacks;if(Y!==null)for(f.shared.hiddenCallbacks=null,f=0;f<Y.length;f++)Mp(Y[f],k)}catch(ee){Ue(l,l.return,ee)}}i&&v&64&&q0(h),$i(h,h.return);break;case 27:P0(h);case 26:case 5:ua(f,h,i),i&&l===null&&v&4&&V0(h),$i(h,h.return);break;case 12:ua(f,h,i);break;case 31:ua(f,h,i),i&&v&4&&F0(f,h);break;case 13:ua(f,h,i),i&&v&4&&Z0(f,h);break;case 22:h.memoizedState===null&&ua(f,h,i),$i(h,h.return);break;case 30:break;default:ua(f,h,i)}n=n.sibling}}function rf(e,n){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&_i(i))}function of(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&_i(e))}function bn(e,n,i,l){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)J0(e,n,i,l),n=n.sibling}function J0(e,n,i,l){var f=n.flags;switch(n.tag){case 0:case 11:case 15:bn(e,n,i,l),f&2048&&Hi(9,n);break;case 1:bn(e,n,i,l);break;case 3:bn(e,n,i,l),f&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&_i(e)));break;case 12:if(f&2048){bn(e,n,i,l),e=n.stateNode;try{var h=n.memoizedProps,v=h.id,k=h.onPostCommit;typeof k=="function"&&k(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(Y){Ue(n,n.return,Y)}}else bn(e,n,i,l);break;case 31:bn(e,n,i,l);break;case 13:bn(e,n,i,l);break;case 23:break;case 22:h=n.stateNode,v=n.alternate,n.memoizedState!==null?h._visibility&2?bn(e,n,i,l):qi(e,n):h._visibility&2?bn(e,n,i,l):(h._visibility|=2,br(e,n,i,l,(n.subtreeFlags&10256)!==0||!1)),f&2048&&rf(v,n);break;case 24:bn(e,n,i,l),f&2048&&of(n.alternate,n);break;default:bn(e,n,i,l)}}function br(e,n,i,l,f){for(f=f&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var h=e,v=n,k=i,Y=l,ee=v.flags;switch(v.tag){case 0:case 11:case 15:br(h,v,k,Y,f),Hi(8,v);break;case 23:break;case 22:var ie=v.stateNode;v.memoizedState!==null?ie._visibility&2?br(h,v,k,Y,f):qi(h,v):(ie._visibility|=2,br(h,v,k,Y,f)),f&&ee&2048&&rf(v.alternate,v);break;case 24:br(h,v,k,Y,f),f&&ee&2048&&of(v.alternate,v);break;default:br(h,v,k,Y,f)}n=n.sibling}}function qi(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var i=e,l=n,f=l.flags;switch(l.tag){case 22:qi(i,l),f&2048&&rf(l.alternate,l);break;case 24:qi(i,l),f&2048&&of(l.alternate,l);break;default:qi(i,l)}n=n.sibling}}var Ui=8192;function vr(e,n,i){if(e.subtreeFlags&Ui)for(e=e.child;e!==null;)eg(e,n,i),e=e.sibling}function eg(e,n,i){switch(e.tag){case 26:vr(e,n,i),e.flags&Ui&&e.memoizedState!==null&&Pw(i,yn,e.memoizedState,e.memoizedProps);break;case 5:vr(e,n,i);break;case 3:case 4:var l=yn;yn=Wl(e.stateNode.containerInfo),vr(e,n,i),yn=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=Ui,Ui=16777216,vr(e,n,i),Ui=l):vr(e,n,i));break;default:vr(e,n,i)}}function tg(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Vi(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];gt=l,ag(l,e)}tg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ng(e),e=e.sibling}function ng(e){switch(e.tag){case 0:case 11:case 15:Vi(e),e.flags&2048&&$a(9,e,e.return);break;case 3:Vi(e);break;case 12:Vi(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,Hl(e)):Vi(e);break;default:Vi(e)}}function Hl(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];gt=l,ag(l,e)}tg(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:$a(8,n,n.return),Hl(n);break;case 22:i=n.stateNode,i._visibility&2&&(i._visibility&=-3,Hl(n));break;default:Hl(n)}e=e.sibling}}function ag(e,n){for(;gt!==null;){var i=gt;switch(i.tag){case 0:case 11:case 15:$a(8,i,n);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var l=i.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:_i(i.memoizedState.cache)}if(l=i.child,l!==null)l.return=i,gt=l;else e:for(i=e;gt!==null;){l=gt;var f=l.sibling,h=l.return;if(G0(l),l===i){gt=null;break e}if(f!==null){f.return=h,gt=f;break e}gt=h}}}var rw={getCacheForType:function(e){var n=vt(ot),i=n.data.get(e);return i===void 0&&(i=e(),n.data.set(e,i)),i},cacheSignal:function(){return vt(ot).controller.signal}},iw=typeof WeakMap=="function"?WeakMap:Map,He=0,Xe=null,Te=null,ke=0,qe=0,Xt=null,qa=!1,wr=!1,lf=!1,da=0,et=0,Ua=0,ks=0,cf=0,Gt=0,jr=0,Yi=null,Lt=null,uf=!1,$l=0,sg=0,ql=1/0,Ul=null,Va=null,mt=0,Ya=null,Nr=null,fa=0,df=0,ff=null,rg=null,Pi=0,hf=null;function Qt(){return(He&2)!==0&&ke!==0?ke&-ke:z.T!==null?bf():Io()}function ig(){if(Gt===0)if((ke&536870912)===0||ze){var e=Xs;Xs<<=1,(Xs&3932160)===0&&(Xs=262144),Gt=e}else Gt=536870912;return e=Pt.current,e!==null&&(e.flags|=32),Gt}function Ht(e,n,i){(e===Xe&&(qe===2||qe===9)||e.cancelPendingCommit!==null)&&(Sr(e,0),Pa(e,ke,Gt,!1)),fs(e,i),((He&2)===0||e!==Xe)&&(e===Xe&&((He&2)===0&&(ks|=i),et===4&&Pa(e,ke,Gt,!1)),Dn(e))}function og(e,n,i){if((He&6)!==0)throw Error(o(327));var l=!i&&(n&127)===0&&(n&e.expiredLanes)===0||ds(e,n),f=l?cw(e,n):pf(e,n,!0),h=l;do{if(f===0){wr&&!l&&Pa(e,n,0,!1);break}else{if(i=e.current.alternate,h&&!ow(i)){f=pf(e,n,!1),h=!1;continue}if(f===2){if(h=n,e.errorRecoveryDisabledLanes&h)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;e:{var k=e;f=Yi;var Y=k.current.memoizedState.isDehydrated;if(Y&&(Sr(k,v).flags|=256),v=pf(k,v,!1),v!==2){if(lf&&!Y){k.errorRecoveryDisabledLanes|=h,ks|=h,f=4;break e}h=Lt,Lt=f,h!==null&&(Lt===null?Lt=h:Lt.push.apply(Lt,h))}f=v}if(h=!1,f!==2)continue}}if(f===1){Sr(e,0),Pa(e,n,0,!0);break}e:{switch(l=e,h=f,h){case 0:case 1:throw Error(o(345));case 4:if((n&4194048)!==n)break;case 6:Pa(l,n,Gt,!qa);break e;case 2:Lt=null;break;case 3:case 5:break;default:throw Error(o(329))}if((n&62914560)===n&&(f=$l+300-rt(),10<f)){if(Pa(l,n,Gt,!qa),Qs(l,0,!0)!==0)break e;fa=n,l.timeoutHandle=Hg(lg.bind(null,l,i,Lt,Ul,uf,n,Gt,ks,jr,qa,h,"Throttled",-0,0),f);break e}lg(l,i,Lt,Ul,uf,n,Gt,ks,jr,qa,h,null,-0,0)}}break}while(!0);Dn(e)}function lg(e,n,i,l,f,h,v,k,Y,ee,ie,le,te,se){if(e.timeoutHandle=-1,le=n.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Wn},eg(n,h,le);var fe=(h&62914560)===h?$l-rt():(h&4194048)===h?sg-rt():0;if(fe=Iw(le,fe),fe!==null){fa=h,e.cancelPendingCommit=fe(gg.bind(null,e,n,h,i,l,f,v,k,Y,ie,le,null,te,se)),Pa(e,h,v,!ee);return}}gg(e,n,h,i,l,f,v,k,Y)}function ow(e){for(var n=e;;){var i=n.tag;if((i===0||i===11||i===15)&&n.flags&16384&&(i=n.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var l=0;l<i.length;l++){var f=i[l],h=f.getSnapshot;f=f.value;try{if(!Vt(h(),f))return!1}catch{return!1}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Pa(e,n,i,l){n&=~cf,n&=~ks,e.suspendedLanes|=n,e.pingedLanes&=~n,l&&(e.warmLanes|=n),l=e.expirationTimes;for(var f=n;0<f;){var h=31-Tt(f),v=1<<h;l[h]=-1,f&=~v}i!==0&&Vo(e,i,n)}function Vl(){return(He&6)===0?(Ii(0),!1):!0}function mf(){if(Te!==null){if(qe===0)var e=Te.return;else e=Te,ta=js=null,Md(e),mr=null,Ci=0,e=Te;for(;e!==null;)$0(e.alternate,e),e=e.return;Te=null}}function Sr(e,n){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,Cw(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),fa=0,mf(),Xe=e,Te=i=Jn(e.current,null),ke=n,qe=0,Xt=null,qa=!1,wr=ds(e,n),lf=!1,jr=Gt=cf=ks=Ua=et=0,Lt=Yi=null,uf=!1,(n&8)!==0&&(n|=n&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=n;0<l;){var f=31-Tt(l),h=1<<f;n|=e[f],l&=~h}return da=n,cl(),i}function cg(e,n){Ne=null,z.H=Oi,n===hr||n===xl?(n=_p(),qe=3):n===xd?(n=_p(),qe=4):qe=n===Id?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Xt=n,Te===null&&(et=1,kl(e,nn(n,e.current)))}function ug(){var e=Pt.current;return e===null?!0:(ke&4194048)===ke?on===null:(ke&62914560)===ke||(ke&536870912)!==0?e===on:!1}function dg(){var e=z.H;return z.H=Oi,e===null?Oi:e}function fg(){var e=z.A;return z.A=rw,e}function Yl(){et=4,qa||(ke&4194048)!==ke&&Pt.current!==null||(wr=!0),(Ua&134217727)===0&&(ks&134217727)===0||Xe===null||Pa(Xe,ke,Gt,!1)}function pf(e,n,i){var l=He;He|=2;var f=dg(),h=fg();(Xe!==e||ke!==n)&&(Ul=null,Sr(e,n)),n=!1;var v=et;e:do try{if(qe!==0&&Te!==null){var k=Te,Y=Xt;switch(qe){case 8:mf(),v=6;break e;case 3:case 2:case 9:case 6:Pt.current===null&&(n=!0);var ee=qe;if(qe=0,Xt=null,_r(e,k,Y,ee),i&&wr){v=0;break e}break;default:ee=qe,qe=0,Xt=null,_r(e,k,Y,ee)}}lw(),v=et;break}catch(ie){cg(e,ie)}while(!0);return n&&e.shellSuspendCounter++,ta=js=null,He=l,z.H=f,z.A=h,Te===null&&(Xe=null,ke=0,cl()),v}function lw(){for(;Te!==null;)hg(Te)}function cw(e,n){var i=He;He|=2;var l=dg(),f=fg();Xe!==e||ke!==n?(Ul=null,ql=rt()+500,Sr(e,n)):wr=ds(e,n);e:do try{if(qe!==0&&Te!==null){n=Te;var h=Xt;t:switch(qe){case 1:qe=0,Xt=null,_r(e,n,h,1);break;case 2:case 9:if(Np(h)){qe=0,Xt=null,mg(n);break}n=function(){qe!==2&&qe!==9||Xe!==e||(qe=7),Dn(e)},h.then(n,n);break e;case 3:qe=7;break e;case 4:qe=5;break e;case 7:Np(h)?(qe=0,Xt=null,mg(n)):(qe=0,Xt=null,_r(e,n,h,7));break;case 5:var v=null;switch(Te.tag){case 26:v=Te.memoizedState;case 5:case 27:var k=Te;if(v?Jg(v):k.stateNode.complete){qe=0,Xt=null;var Y=k.sibling;if(Y!==null)Te=Y;else{var ee=k.return;ee!==null?(Te=ee,Pl(ee)):Te=null}break t}}qe=0,Xt=null,_r(e,n,h,5);break;case 6:qe=0,Xt=null,_r(e,n,h,6);break;case 8:mf(),et=6;break e;default:throw Error(o(462))}}uw();break}catch(ie){cg(e,ie)}while(!0);return ta=js=null,z.H=l,z.A=f,He=i,Te!==null?0:(Xe=null,ke=0,cl(),et)}function uw(){for(;Te!==null&&!En();)hg(Te)}function hg(e){var n=L0(e.alternate,e,da);e.memoizedProps=e.pendingProps,n===null?Pl(e):Te=n}function mg(e){var n=e,i=n.alternate;switch(n.tag){case 15:case 0:n=k0(i,n,n.pendingProps,n.type,void 0,ke);break;case 11:n=k0(i,n,n.pendingProps,n.type.render,n.ref,ke);break;case 5:Md(n);default:$0(i,n),n=Te=fp(n,da),n=L0(i,n,da)}e.memoizedProps=e.pendingProps,n===null?Pl(e):Te=n}function _r(e,n,i,l){ta=js=null,Md(n),mr=null,Ci=0;var f=n.return;try{if(K2(e,f,n,i,ke)){et=1,kl(e,nn(i,e.current)),Te=null;return}}catch(h){if(f!==null)throw Te=f,h;et=1,kl(e,nn(i,e.current)),Te=null;return}n.flags&32768?(ze||l===1?e=!0:wr||(ke&536870912)!==0?e=!1:(qa=e=!0,(l===2||l===9||l===3||l===6)&&(l=Pt.current,l!==null&&l.tag===13&&(l.flags|=16384))),pg(n,e)):Pl(n)}function Pl(e){var n=e;do{if((n.flags&32768)!==0){pg(n,qa);return}e=n.return;var i=tw(n.alternate,n,da);if(i!==null){Te=i;return}if(n=n.sibling,n!==null){Te=n;return}Te=n=e}while(n!==null);et===0&&(et=5)}function pg(e,n){do{var i=nw(e.alternate,e);if(i!==null){i.flags&=32767,Te=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!n&&(e=e.sibling,e!==null)){Te=e;return}Te=e=i}while(e!==null);et=6,Te=null}function gg(e,n,i,l,f,h,v,k,Y){e.cancelPendingCommit=null;do Il();while(mt!==0);if((He&6)!==0)throw Error(o(327));if(n!==null){if(n===e.current)throw Error(o(177));if(h=n.lanes|n.childLanes,h|=nd,Ru(e,i,h,v,k,Y),e===Xe&&(Te=Xe=null,ke=0),Nr=n,Ya=e,fa=i,df=h,ff=f,rg=l,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,mw(In,function(){return wg(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||l){l=z.T,z.T=null,f=R.p,R.p=2,v=He,He|=4;try{aw(e,n,i)}finally{He=v,R.p=f,z.T=l}}mt=1,xg(),yg(),bg()}}function xg(){if(mt===1){mt=0;var e=Ya,n=Nr,i=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||i){i=z.T,z.T=null;var l=R.p;R.p=2;var f=He;He|=4;try{W0(n,e);var h=Cf,v=ap(e.containerInfo),k=h.focusedElem,Y=h.selectionRange;if(v!==k&&k&&k.ownerDocument&&np(k.ownerDocument.documentElement,k)){if(Y!==null&&Wu(k)){var ee=Y.start,ie=Y.end;if(ie===void 0&&(ie=ee),"selectionStart"in k)k.selectionStart=ee,k.selectionEnd=Math.min(ie,k.value.length);else{var le=k.ownerDocument||document,te=le&&le.defaultView||window;if(te.getSelection){var se=te.getSelection(),fe=k.textContent.length,we=Math.min(Y.start,fe),Ie=Y.end===void 0?we:Math.min(Y.end,fe);!se.extend&&we>Ie&&(v=Ie,Ie=we,we=v);var W=tp(k,we),X=tp(k,Ie);if(W&&X&&(se.rangeCount!==1||se.anchorNode!==W.node||se.anchorOffset!==W.offset||se.focusNode!==X.node||se.focusOffset!==X.offset)){var J=le.createRange();J.setStart(W.node,W.offset),se.removeAllRanges(),we>Ie?(se.addRange(J),se.extend(X.node,X.offset)):(J.setEnd(X.node,X.offset),se.addRange(J))}}}}for(le=[],se=k;se=se.parentNode;)se.nodeType===1&&le.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<le.length;k++){var oe=le[k];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}ac=!!Ef,Cf=Ef=null}finally{He=f,R.p=l,z.T=i}}e.current=n,mt=2}}function yg(){if(mt===2){mt=0;var e=Ya,n=Nr,i=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||i){i=z.T,z.T=null;var l=R.p;R.p=2;var f=He;He|=4;try{X0(e,n.alternate,n)}finally{He=f,R.p=l,z.T=i}}mt=3}}function bg(){if(mt===4||mt===3){mt=0,Cn();var e=Ya,n=Nr,i=fa,l=rg;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?mt=5:(mt=0,Nr=Ya=null,vg(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(Va=null),ui(i),n=n.stateNode,Ct&&typeof Ct.onCommitFiberRoot=="function")try{Ct.onCommitFiberRoot(us,n,void 0,(n.current.flags&128)===128)}catch{}if(l!==null){n=z.T,f=R.p,R.p=2,z.T=null;try{for(var h=e.onRecoverableError,v=0;v<l.length;v++){var k=l[v];h(k.value,{componentStack:k.stack})}}finally{z.T=n,R.p=f}}(fa&3)!==0&&Il(),Dn(e),f=e.pendingLanes,(i&261930)!==0&&(f&42)!==0?e===hf?Pi++:(Pi=0,hf=e):Pi=0,Ii(0)}}function vg(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,_i(n)))}function Il(){return xg(),yg(),bg(),wg()}function wg(){if(mt!==5)return!1;var e=Ya,n=df;df=0;var i=ui(fa),l=z.T,f=R.p;try{R.p=32>i?32:i,z.T=null,i=ff,ff=null;var h=Ya,v=fa;if(mt=0,Nr=Ya=null,fa=0,(He&6)!==0)throw Error(o(331));var k=He;if(He|=4,ng(h.current),J0(h,h.current,v,i),He=k,Ii(0,!1),Ct&&typeof Ct.onPostCommitFiberRoot=="function")try{Ct.onPostCommitFiberRoot(us,h)}catch{}return!0}finally{R.p=f,z.T=l,vg(e,n)}}function jg(e,n,i){n=nn(i,n),n=Pd(e.stateNode,n,2),e=Ba(e,n,2),e!==null&&(fs(e,2),Dn(e))}function Ue(e,n,i){if(e.tag===3)jg(e,e,i);else for(;n!==null;){if(n.tag===3){jg(n,e,i);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Va===null||!Va.has(l))){e=nn(i,e),i=N0(2),l=Ba(n,i,2),l!==null&&(S0(i,l,n,e),fs(l,2),Dn(l));break}}n=n.return}}function gf(e,n,i){var l=e.pingCache;if(l===null){l=e.pingCache=new iw;var f=new Set;l.set(n,f)}else f=l.get(n),f===void 0&&(f=new Set,l.set(n,f));f.has(i)||(lf=!0,f.add(i),e=dw.bind(null,e,n,i),n.then(e,e))}function dw(e,n,i){var l=e.pingCache;l!==null&&l.delete(n),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,Xe===e&&(ke&i)===i&&(et===4||et===3&&(ke&62914560)===ke&&300>rt()-$l?(He&2)===0&&Sr(e,0):cf|=i,jr===ke&&(jr=0)),Dn(e)}function Ng(e,n){n===0&&(n=Uo()),e=bs(e,n),e!==null&&(fs(e,n),Dn(e))}function fw(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),Ng(e,i)}function hw(e,n){var i=0;switch(e.tag){case 31:case 13:var l=e.stateNode,f=e.memoizedState;f!==null&&(i=f.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(o(314))}l!==null&&l.delete(n),Ng(e,i)}function mw(e,n){return pt(e,n)}var Xl=null,Er=null,xf=!1,Gl=!1,yf=!1,Ia=0;function Dn(e){e!==Er&&e.next===null&&(Er===null?Xl=Er=e:Er=Er.next=e),Gl=!0,xf||(xf=!0,gw())}function Ii(e,n){if(!yf&&Gl){yf=!0;do for(var i=!1,l=Xl;l!==null;){if(e!==0){var f=l.pendingLanes;if(f===0)var h=0;else{var v=l.suspendedLanes,k=l.pingedLanes;h=(1<<31-Tt(42|e)+1)-1,h&=f&~(v&~k),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(i=!0,Cg(l,h))}else h=ke,h=Qs(l,l===Xe?h:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(h&3)===0||ds(l,h)||(i=!0,Cg(l,h));l=l.next}while(i);yf=!1}}function pw(){Sg()}function Sg(){Gl=xf=!1;var e=0;Ia!==0&&Ew()&&(e=Ia);for(var n=rt(),i=null,l=Xl;l!==null;){var f=l.next,h=_g(l,n);h===0?(l.next=null,i===null?Xl=f:i.next=f,f===null&&(Er=i)):(i=l,(e!==0||(h&3)!==0)&&(Gl=!0)),l=f}mt!==0&&mt!==5||Ii(e),Ia!==0&&(Ia=0)}function _g(e,n){for(var i=e.suspendedLanes,l=e.pingedLanes,f=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var v=31-Tt(h),k=1<<v,Y=f[v];Y===-1?((k&i)===0||(k&l)!==0)&&(f[v]=ku(k,n)):Y<=n&&(e.expiredLanes|=k),h&=~k}if(n=Xe,i=ke,i=Qs(e,e===n?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,i===0||e===n&&(qe===2||qe===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&hn(l),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||ds(e,i)){if(n=i&-i,n===e.callbackPriority)return n;switch(l!==null&&hn(l),ui(i)){case 2:case 8:i=en;break;case 32:i=In;break;case 268435456:i=Xn;break;default:i=In}return l=Eg.bind(null,e),i=pt(i,l),e.callbackPriority=n,e.callbackNode=i,n}return l!==null&&l!==null&&hn(l),e.callbackPriority=2,e.callbackNode=null,2}function Eg(e,n){if(mt!==0&&mt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(Il()&&e.callbackNode!==i)return null;var l=ke;return l=Qs(e,e===Xe?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(og(e,l,n),_g(e,rt()),e.callbackNode!=null&&e.callbackNode===i?Eg.bind(null,e):null)}function Cg(e,n){if(Il())return null;og(e,n,!0)}function gw(){Tw(function(){(He&6)!==0?pt(mn,pw):Sg()})}function bf(){if(Ia===0){var e=dr;e===0&&(e=Is,Is<<=1,(Is&261888)===0&&(Is=256)),Ia=e}return Ia}function Tg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:tl(""+e)}function Mg(e,n){var i=n.ownerDocument.createElement("input");return i.name=n.name,i.value=n.value,e.id&&i.setAttribute("form",e.id),n.parentNode.insertBefore(i,n),e=new FormData(e),i.parentNode.removeChild(i),e}function xw(e,n,i,l,f){if(n==="submit"&&i&&i.stateNode===f){var h=Tg((f[Nt]||null).action),v=l.submitter;v&&(n=(n=v[Nt]||null)?Tg(n.formAction):v.getAttribute("formAction"),n!==null&&(h=n,v=null));var k=new rl("action","action",null,l,f);e.push({event:k,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Ia!==0){var Y=v?Mg(f,v):new FormData(f);Hd(i,{pending:!0,data:Y,method:f.method,action:h},null,Y)}}else typeof h=="function"&&(k.preventDefault(),Y=v?Mg(f,v):new FormData(f),Hd(i,{pending:!0,data:Y,method:f.method,action:h},h,Y))},currentTarget:f}]})}}for(var vf=0;vf<td.length;vf++){var wf=td[vf],yw=wf.toLowerCase(),bw=wf[0].toUpperCase()+wf.slice(1);xn(yw,"on"+bw)}xn(ip,"onAnimationEnd"),xn(op,"onAnimationIteration"),xn(lp,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(O2,"onTransitionRun"),xn(B2,"onTransitionStart"),xn(L2,"onTransitionCancel"),xn(cp,"onTransitionEnd"),Ta("onMouseEnter",["mouseout","mouseover"]),Ta("onMouseLeave",["mouseout","mouseover"]),Ta("onPointerEnter",["pointerout","pointerover"]),Ta("onPointerLeave",["pointerout","pointerover"]),Fn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xi));function Ag(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],f=l.event;l=l.listeners;e:{var h=void 0;if(n)for(var v=l.length-1;0<=v;v--){var k=l[v],Y=k.instance,ee=k.currentTarget;if(k=k.listener,Y!==h&&f.isPropagationStopped())break e;h=k,f.currentTarget=ee;try{h(f)}catch(ie){ll(ie)}f.currentTarget=null,h=Y}else for(v=0;v<l.length;v++){if(k=l[v],Y=k.instance,ee=k.currentTarget,k=k.listener,Y!==h&&f.isPropagationStopped())break e;h=k,f.currentTarget=ee;try{h(f)}catch(ie){ll(ie)}f.currentTarget=null,h=Y}}}}function Me(e,n){var i=n[Fs];i===void 0&&(i=n[Fs]=new Set);var l=e+"__bubble";i.has(l)||(kg(n,e,2,!1),i.add(l))}function jf(e,n,i){var l=0;n&&(l|=4),kg(i,e,l,n)}var Ql="_reactListening"+Math.random().toString(36).slice(2);function Nf(e){if(!e[Ql]){e[Ql]=!0,Fo.forEach(function(i){i!=="selectionchange"&&(vw.has(i)||jf(i,!1,e),jf(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Ql]||(n[Ql]=!0,jf("selectionchange",!1,n))}}function kg(e,n,i,l){switch(ix(n)){case 2:var f=Qw;break;case 8:f=Fw;break;default:f=Hf}i=f.bind(null,n,i,e),f=void 0,!Vu||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),l?f!==void 0?e.addEventListener(n,i,{capture:!0,passive:f}):e.addEventListener(n,i,!0):f!==void 0?e.addEventListener(n,i,{passive:f}):e.addEventListener(n,i,!1)}function Sf(e,n,i,l,f){var h=l;if((n&1)===0&&(n&2)===0&&l!==null)e:for(;;){if(l===null)return;var v=l.tag;if(v===3||v===4){var k=l.stateNode.containerInfo;if(k===f)break;if(v===4)for(v=l.return;v!==null;){var Y=v.tag;if((Y===3||Y===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;k!==null;){if(v=Sa(k),v===null)return;if(Y=v.tag,Y===5||Y===6||Y===26||Y===27){l=h=v;continue e}k=k.parentNode}}l=l.return}Bm(function(){var ee=h,ie=qu(i),le=[];e:{var te=up.get(e);if(te!==void 0){var se=rl,fe=e;switch(e){case"keypress":if(al(i)===0)break e;case"keydown":case"keyup":se=h2;break;case"focusin":fe="focus",se=Xu;break;case"focusout":fe="blur",se=Xu;break;case"beforeblur":case"afterblur":se=Xu;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=$m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=t2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=g2;break;case ip:case op:case lp:se=s2;break;case cp:se=y2;break;case"scroll":case"scrollend":se=Jv;break;case"wheel":se=v2;break;case"copy":case"cut":case"paste":se=i2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=Um;break;case"toggle":case"beforetoggle":se=j2}var we=(n&4)!==0,Ie=!we&&(e==="scroll"||e==="scrollend"),W=we?te!==null?te+"Capture":null:te;we=[];for(var X=ee,J;X!==null;){var oe=X;if(J=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||J===null||W===null||(oe=mi(X,W),oe!=null&&we.push(Gi(X,oe,J))),Ie)break;X=X.return}0<we.length&&(te=new se(te,fe,null,i,ie),le.push({event:te,listeners:we}))}}if((n&7)===0){e:{if(te=e==="mouseover"||e==="pointerover",se=e==="mouseout"||e==="pointerout",te&&i!==$u&&(fe=i.relatedTarget||i.fromElement)&&(Sa(fe)||fe[Qn]))break e;if((se||te)&&(te=ie.window===ie?ie:(te=ie.ownerDocument)?te.defaultView||te.parentWindow:window,se?(fe=i.relatedTarget||i.toElement,se=ee,fe=fe?Sa(fe):null,fe!==null&&(Ie=u(fe),we=fe.tag,fe!==Ie||we!==5&&we!==27&&we!==6)&&(fe=null)):(se=null,fe=ee),se!==fe)){if(we=$m,oe="onMouseLeave",W="onMouseEnter",X="mouse",(e==="pointerout"||e==="pointerover")&&(we=Um,oe="onPointerLeave",W="onPointerEnter",X="pointer"),Ie=se==null?te:Ea(se),J=fe==null?te:Ea(fe),te=new we(oe,X+"leave",se,i,ie),te.target=Ie,te.relatedTarget=J,oe=null,Sa(ie)===ee&&(we=new we(W,X+"enter",fe,i,ie),we.target=J,we.relatedTarget=Ie,oe=we),Ie=oe,se&&fe)t:{for(we=ww,W=se,X=fe,J=0,oe=W;oe;oe=we(oe))J++;oe=0;for(var ye=X;ye;ye=we(ye))oe++;for(;0<J-oe;)W=we(W),J--;for(;0<oe-J;)X=we(X),oe--;for(;J--;){if(W===X||X!==null&&W===X.alternate){we=W;break t}W=we(W),X=we(X)}we=null}else we=null;se!==null&&Rg(le,te,se,we,!1),fe!==null&&Ie!==null&&Rg(le,Ie,fe,we,!0)}}e:{if(te=ee?Ea(ee):window,se=te.nodeName&&te.nodeName.toLowerCase(),se==="select"||se==="input"&&te.type==="file")var Be=Fm;else if(Gm(te))if(Zm)Be=R2;else{Be=A2;var me=M2}else se=te.nodeName,!se||se.toLowerCase()!=="input"||te.type!=="checkbox"&&te.type!=="radio"?ee&&Hu(ee.elementType)&&(Be=Fm):Be=k2;if(Be&&(Be=Be(e,ee))){Qm(le,Be,i,ie);break e}me&&me(e,te,ee),e==="focusout"&&ee&&te.type==="number"&&ee.memoizedProps.value!=null&&hi(te,"number",te.value)}switch(me=ee?Ea(ee):window,e){case"focusin":(Gm(me)||me.contentEditable==="true")&&(ar=me,Ku=ee,ji=null);break;case"focusout":ji=Ku=ar=null;break;case"mousedown":Ju=!0;break;case"contextmenu":case"mouseup":case"dragend":Ju=!1,sp(le,i,ie);break;case"selectionchange":if(z2)break;case"keydown":case"keyup":sp(le,i,ie)}var _e;if(Qu)e:{switch(e){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else nr?Im(e,i)&&(Re="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Re="onCompositionStart");Re&&(Vm&&i.locale!=="ko"&&(nr||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&nr&&(_e=Lm()):(Ma=ie,Yu="value"in Ma?Ma.value:Ma.textContent,nr=!0)),me=Fl(ee,Re),0<me.length&&(Re=new qm(Re,e,null,i,ie),le.push({event:Re,listeners:me}),_e?Re.data=_e:(_e=Xm(i),_e!==null&&(Re.data=_e)))),(_e=S2?_2(e,i):E2(e,i))&&(Re=Fl(ee,"onBeforeInput"),0<Re.length&&(me=new qm("onBeforeInput","beforeinput",null,i,ie),le.push({event:me,listeners:Re}),me.data=_e)),xw(le,e,ee,i,ie)}Ag(le,n)})}function Gi(e,n,i){return{instance:e,listener:n,currentTarget:i}}function Fl(e,n){for(var i=n+"Capture",l=[];e!==null;){var f=e,h=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||h===null||(f=mi(e,i),f!=null&&l.unshift(Gi(e,f,h)),f=mi(e,n),f!=null&&l.push(Gi(e,f,h))),e.tag===3)return l;e=e.return}return[]}function ww(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Rg(e,n,i,l,f){for(var h=n._reactName,v=[];i!==null&&i!==l;){var k=i,Y=k.alternate,ee=k.stateNode;if(k=k.tag,Y!==null&&Y===l)break;k!==5&&k!==26&&k!==27||ee===null||(Y=ee,f?(ee=mi(i,h),ee!=null&&v.unshift(Gi(i,ee,Y))):f||(ee=mi(i,h),ee!=null&&v.push(Gi(i,ee,Y)))),i=i.return}v.length!==0&&e.push({event:n,listeners:v})}var jw=/\r\n?/g,Nw=/\u0000|\uFFFD/g;function Dg(e){return(typeof e=="string"?e:""+e).replace(jw,`
`).replace(Nw,"")}function zg(e,n){return n=Dg(n),Dg(e)===n}function Pe(e,n,i,l,f,h){switch(i){case"children":typeof l=="string"?n==="body"||n==="textarea"&&l===""||Js(e,l):(typeof l=="number"||typeof l=="bigint")&&n!=="body"&&Js(e,""+l);break;case"className":Ws(e,"class",l);break;case"tabIndex":Ws(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Ws(e,i,l);break;case"style":zm(e,l,h);break;case"data":if(n!=="object"){Ws(e,"data",l);break}case"src":case"href":if(l===""&&(n!=="a"||i!=="href")){e.removeAttribute(i);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=tl(""+l),e.setAttribute(i,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(i==="formAction"?(n!=="input"&&Pe(e,n,"name",f.name,f,null),Pe(e,n,"formEncType",f.formEncType,f,null),Pe(e,n,"formMethod",f.formMethod,f,null),Pe(e,n,"formTarget",f.formTarget,f,null)):(Pe(e,n,"encType",f.encType,f,null),Pe(e,n,"method",f.method,f,null),Pe(e,n,"target",f.target,f,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=tl(""+l),e.setAttribute(i,l);break;case"onClick":l!=null&&(e.onclick=Wn);break;case"onScroll":l!=null&&Me("scroll",e);break;case"onScrollEnd":l!=null&&Me("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(i=l.__html,i!=null){if(f.children!=null)throw Error(o(60));e.innerHTML=i}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}i=tl(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""+l):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":l===!0?e.setAttribute(i,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,l):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(i,l):e.removeAttribute(i);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(i):e.setAttribute(i,l);break;case"popover":Me("beforetoggle",e),Me("toggle",e),Zs(e,"popover",l);break;case"xlinkActuate":gn(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":gn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":gn(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":gn(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":gn(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":gn(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":gn(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":gn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":gn(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Zs(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=Wv.get(i)||i,Zs(e,i,l))}}function _f(e,n,i,l,f,h){switch(i){case"style":zm(e,l,h);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(i=l.__html,i!=null){if(f.children!=null)throw Error(o(60));e.innerHTML=i}}break;case"children":typeof l=="string"?Js(e,l):(typeof l=="number"||typeof l=="bigint")&&Js(e,""+l);break;case"onScroll":l!=null&&Me("scroll",e);break;case"onScrollEnd":l!=null&&Me("scrollend",e);break;case"onClick":l!=null&&(e.onclick=Wn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zo.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(f=i.endsWith("Capture"),n=i.slice(2,f?i.length-7:void 0),h=e[Nt]||null,h=h!=null?h[i]:null,typeof h=="function"&&e.removeEventListener(n,h,f),typeof l=="function")){typeof h!="function"&&h!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(n,l,f);break e}i in e?e[i]=l:l===!0?e.setAttribute(i,""):Zs(e,i,l)}}}function jt(e,n,i){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Me("error",e),Me("load",e);var l=!1,f=!1,h;for(h in i)if(i.hasOwnProperty(h)){var v=i[h];if(v!=null)switch(h){case"src":l=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,n));default:Pe(e,n,h,v,i,null)}}f&&Pe(e,n,"srcSet",i.srcSet,i,null),l&&Pe(e,n,"src",i.src,i,null);return;case"input":Me("invalid",e);var k=h=v=f=null,Y=null,ee=null;for(l in i)if(i.hasOwnProperty(l)){var ie=i[l];if(ie!=null)switch(l){case"name":f=ie;break;case"type":v=ie;break;case"checked":Y=ie;break;case"defaultChecked":ee=ie;break;case"value":h=ie;break;case"defaultValue":k=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(o(137,n));break;default:Pe(e,n,l,ie,i,null)}}el(e,h,k,Y,ee,v,f,!1);return;case"select":Me("invalid",e),l=v=h=null;for(f in i)if(i.hasOwnProperty(f)&&(k=i[f],k!=null))switch(f){case"value":h=k;break;case"defaultValue":v=k;break;case"multiple":l=k;default:Pe(e,n,f,k,i,null)}n=h,i=v,e.multiple=!!l,n!=null?Zn(e,!!l,n,!1):i!=null&&Zn(e,!!l,i,!0);return;case"textarea":Me("invalid",e),h=f=l=null;for(v in i)if(i.hasOwnProperty(v)&&(k=i[v],k!=null))switch(v){case"value":l=k;break;case"defaultValue":f=k;break;case"children":h=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(o(91));break;default:Pe(e,n,v,k,i,null)}Rm(e,l,f,h);return;case"option":for(Y in i)i.hasOwnProperty(Y)&&(l=i[Y],l!=null)&&(Y==="selected"?e.selected=l&&typeof l!="function"&&typeof l!="symbol":Pe(e,n,Y,l,i,null));return;case"dialog":Me("beforetoggle",e),Me("toggle",e),Me("cancel",e),Me("close",e);break;case"iframe":case"object":Me("load",e);break;case"video":case"audio":for(l=0;l<Xi.length;l++)Me(Xi[l],e);break;case"image":Me("error",e),Me("load",e);break;case"details":Me("toggle",e);break;case"embed":case"source":case"link":Me("error",e),Me("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ee in i)if(i.hasOwnProperty(ee)&&(l=i[ee],l!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,n));default:Pe(e,n,ee,l,i,null)}return;default:if(Hu(n)){for(ie in i)i.hasOwnProperty(ie)&&(l=i[ie],l!==void 0&&_f(e,n,ie,l,i,void 0));return}}for(k in i)i.hasOwnProperty(k)&&(l=i[k],l!=null&&Pe(e,n,k,l,i,null))}function Sw(e,n,i,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,h=null,v=null,k=null,Y=null,ee=null,ie=null;for(se in i){var le=i[se];if(i.hasOwnProperty(se)&&le!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":Y=le;default:l.hasOwnProperty(se)||Pe(e,n,se,null,l,le)}}for(var te in l){var se=l[te];if(le=i[te],l.hasOwnProperty(te)&&(se!=null||le!=null))switch(te){case"type":h=se;break;case"name":f=se;break;case"checked":ee=se;break;case"defaultChecked":ie=se;break;case"value":v=se;break;case"defaultValue":k=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(o(137,n));break;default:se!==le&&Pe(e,n,te,se,l,le)}}ps(e,v,k,Y,ee,ie,h,f);return;case"select":se=v=k=te=null;for(h in i)if(Y=i[h],i.hasOwnProperty(h)&&Y!=null)switch(h){case"value":break;case"multiple":se=Y;default:l.hasOwnProperty(h)||Pe(e,n,h,null,l,Y)}for(f in l)if(h=l[f],Y=i[f],l.hasOwnProperty(f)&&(h!=null||Y!=null))switch(f){case"value":te=h;break;case"defaultValue":k=h;break;case"multiple":v=h;default:h!==Y&&Pe(e,n,f,h,l,Y)}n=k,i=v,l=se,te!=null?Zn(e,!!i,te,!1):!!l!=!!i&&(n!=null?Zn(e,!!i,n,!0):Zn(e,!!i,i?[]:"",!1));return;case"textarea":se=te=null;for(k in i)if(f=i[k],i.hasOwnProperty(k)&&f!=null&&!l.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Pe(e,n,k,null,l,f)}for(v in l)if(f=l[v],h=i[v],l.hasOwnProperty(v)&&(f!=null||h!=null))switch(v){case"value":te=f;break;case"defaultValue":se=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(o(91));break;default:f!==h&&Pe(e,n,v,f,l,h)}km(e,te,se);return;case"option":for(var fe in i)te=i[fe],i.hasOwnProperty(fe)&&te!=null&&!l.hasOwnProperty(fe)&&(fe==="selected"?e.selected=!1:Pe(e,n,fe,null,l,te));for(Y in l)te=l[Y],se=i[Y],l.hasOwnProperty(Y)&&te!==se&&(te!=null||se!=null)&&(Y==="selected"?e.selected=te&&typeof te!="function"&&typeof te!="symbol":Pe(e,n,Y,te,l,se));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var we in i)te=i[we],i.hasOwnProperty(we)&&te!=null&&!l.hasOwnProperty(we)&&Pe(e,n,we,null,l,te);for(ee in l)if(te=l[ee],se=i[ee],l.hasOwnProperty(ee)&&te!==se&&(te!=null||se!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(o(137,n));break;default:Pe(e,n,ee,te,l,se)}return;default:if(Hu(n)){for(var Ie in i)te=i[Ie],i.hasOwnProperty(Ie)&&te!==void 0&&!l.hasOwnProperty(Ie)&&_f(e,n,Ie,void 0,l,te);for(ie in l)te=l[ie],se=i[ie],!l.hasOwnProperty(ie)||te===se||te===void 0&&se===void 0||_f(e,n,ie,te,l,se);return}}for(var W in i)te=i[W],i.hasOwnProperty(W)&&te!=null&&!l.hasOwnProperty(W)&&Pe(e,n,W,null,l,te);for(le in l)te=l[le],se=i[le],!l.hasOwnProperty(le)||te===se||te==null&&se==null||Pe(e,n,le,te,l,se)}function Og(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function _w(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,i=performance.getEntriesByType("resource"),l=0;l<i.length;l++){var f=i[l],h=f.transferSize,v=f.initiatorType,k=f.duration;if(h&&k&&Og(v)){for(v=0,k=f.responseEnd,l+=1;l<i.length;l++){var Y=i[l],ee=Y.startTime;if(ee>k)break;var ie=Y.transferSize,le=Y.initiatorType;ie&&Og(le)&&(Y=Y.responseEnd,v+=ie*(Y<k?1:(k-ee)/(Y-ee)))}if(--l,n+=8*(h+v)/(f.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Ef=null,Cf=null;function Zl(e){return e.nodeType===9?e:e.ownerDocument}function Bg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Lg(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Tf(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Mf=null;function Ew(){var e=window.event;return e&&e.type==="popstate"?e===Mf?!1:(Mf=e,!0):(Mf=null,!1)}var Hg=typeof setTimeout=="function"?setTimeout:void 0,Cw=typeof clearTimeout=="function"?clearTimeout:void 0,$g=typeof Promise=="function"?Promise:void 0,Tw=typeof queueMicrotask=="function"?queueMicrotask:typeof $g<"u"?function(e){return $g.resolve(null).then(e).catch(Mw)}:Hg;function Mw(e){setTimeout(function(){throw e})}function Xa(e){return e==="head"}function qg(e,n){var i=n,l=0;do{var f=i.nextSibling;if(e.removeChild(i),f&&f.nodeType===8)if(i=f.data,i==="/$"||i==="/&"){if(l===0){e.removeChild(f),Ar(n);return}l--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")l++;else if(i==="html")Qi(e.ownerDocument.documentElement);else if(i==="head"){i=e.ownerDocument.head,Qi(i);for(var h=i.firstChild;h;){var v=h.nextSibling,k=h.nodeName;h[hs]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&h.rel.toLowerCase()==="stylesheet"||i.removeChild(h),h=v}}else i==="body"&&Qi(e.ownerDocument.body);i=f}while(i);Ar(n)}function Ug(e,n){var i=e;e=0;do{var l=i.nextSibling;if(i.nodeType===1?n?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(n?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),l&&l.nodeType===8)if(i=l.data,i==="/$"){if(e===0)break;e--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||e++;i=l}while(i)}function Af(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var i=n;switch(n=n.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Af(i),di(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function Aw(e,n,i,l){for(;e.nodeType===1;){var f=i;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[hs])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var h=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=ln(e.nextSibling),e===null)break}return null}function kw(e,n,i){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=ln(e.nextSibling),e===null))return null;return e}function Vg(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=ln(e.nextSibling),e===null))return null;return e}function kf(e){return e.data==="$?"||e.data==="$~"}function Rf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Rw(e,n){var i=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||i.readyState!=="loading")n();else{var l=function(){n(),i.removeEventListener("DOMContentLoaded",l)};i.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function ln(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Df=null;function Yg(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"||i==="/&"){if(n===0)return ln(e.nextSibling);n--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||n++}e=e.nextSibling}return null}function Pg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(n===0)return e;n--}else i!=="/$"&&i!=="/&"||n++}e=e.previousSibling}return null}function Ig(e,n,i){switch(n=Zl(i),e){case"html":if(e=n.documentElement,!e)throw Error(o(452));return e;case"head":if(e=n.head,!e)throw Error(o(453));return e;case"body":if(e=n.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function Qi(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);di(e)}var cn=new Map,Xg=new Set;function Wl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ha=R.d;R.d={f:Dw,r:zw,D:Ow,C:Bw,L:Lw,m:Hw,X:qw,S:$w,M:Uw};function Dw(){var e=ha.f(),n=Vl();return e||n}function zw(e){var n=_a(e);n!==null&&n.tag===5&&n.type==="form"?c0(n):ha.r(e)}var Cr=typeof document>"u"?null:document;function Gg(e,n,i){var l=Cr;if(l&&typeof n=="string"&&n){var f=Rt(n);f='link[rel="'+e+'"][href="'+f+'"]',typeof i=="string"&&(f+='[crossorigin="'+i+'"]'),Xg.has(f)||(Xg.add(f),e={rel:e,crossOrigin:i,href:n},l.querySelector(f)===null&&(n=l.createElement("link"),jt(n,"link",e),it(n),l.head.appendChild(n)))}}function Ow(e){ha.D(e),Gg("dns-prefetch",e,null)}function Bw(e,n){ha.C(e,n),Gg("preconnect",e,n)}function Lw(e,n,i){ha.L(e,n,i);var l=Cr;if(l&&e&&n){var f='link[rel="preload"][as="'+Rt(n)+'"]';n==="image"&&i&&i.imageSrcSet?(f+='[imagesrcset="'+Rt(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(f+='[imagesizes="'+Rt(i.imageSizes)+'"]')):f+='[href="'+Rt(e)+'"]';var h=f;switch(n){case"style":h=Tr(e);break;case"script":h=Mr(e)}cn.has(h)||(e=x({rel:"preload",href:n==="image"&&i&&i.imageSrcSet?void 0:e,as:n},i),cn.set(h,e),l.querySelector(f)!==null||n==="style"&&l.querySelector(Fi(h))||n==="script"&&l.querySelector(Zi(h))||(n=l.createElement("link"),jt(n,"link",e),it(n),l.head.appendChild(n)))}}function Hw(e,n){ha.m(e,n);var i=Cr;if(i&&e){var l=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+Rt(l)+'"][href="'+Rt(e)+'"]',h=f;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Mr(e)}if(!cn.has(h)&&(e=x({rel:"modulepreload",href:e},n),cn.set(h,e),i.querySelector(f)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Zi(h)))return}l=i.createElement("link"),jt(l,"link",e),it(l),i.head.appendChild(l)}}}function $w(e,n,i){ha.S(e,n,i);var l=Cr;if(l&&e){var f=Ca(l).hoistableStyles,h=Tr(e);n=n||"default";var v=f.get(h);if(!v){var k={loading:0,preload:null};if(v=l.querySelector(Fi(h)))k.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":n},i),(i=cn.get(h))&&zf(e,i);var Y=v=l.createElement("link");it(Y),jt(Y,"link",e),Y._p=new Promise(function(ee,ie){Y.onload=ee,Y.onerror=ie}),Y.addEventListener("load",function(){k.loading|=1}),Y.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Kl(v,n,l)}v={type:"stylesheet",instance:v,count:1,state:k},f.set(h,v)}}}function qw(e,n){ha.X(e,n);var i=Cr;if(i&&e){var l=Ca(i).hoistableScripts,f=Mr(e),h=l.get(f);h||(h=i.querySelector(Zi(f)),h||(e=x({src:e,async:!0},n),(n=cn.get(f))&&Of(e,n),h=i.createElement("script"),it(h),jt(h,"link",e),i.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},l.set(f,h))}}function Uw(e,n){ha.M(e,n);var i=Cr;if(i&&e){var l=Ca(i).hoistableScripts,f=Mr(e),h=l.get(f);h||(h=i.querySelector(Zi(f)),h||(e=x({src:e,async:!0,type:"module"},n),(n=cn.get(f))&&Of(e,n),h=i.createElement("script"),it(h),jt(h,"link",e),i.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},l.set(f,h))}}function Qg(e,n,i,l){var f=(f=de.current)?Wl(f):null;if(!f)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(n=Tr(i.href),i=Ca(f).hoistableStyles,l=i.get(n),l||(l={type:"style",instance:null,count:0,state:null},i.set(n,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=Tr(i.href);var h=Ca(f).hoistableStyles,v=h.get(e);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,v),(h=f.querySelector(Fi(e)))&&!h._p&&(v.instance=h,v.state.loading=5),cn.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},cn.set(e,i),h||Vw(f,e,i,v.state))),n&&l===null)throw Error(o(528,""));return v}if(n&&l!==null)throw Error(o(529,""));return null;case"script":return n=i.async,i=i.src,typeof i=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Mr(i),i=Ca(f).hoistableScripts,l=i.get(n),l||(l={type:"script",instance:null,count:0,state:null},i.set(n,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Tr(e){return'href="'+Rt(e)+'"'}function Fi(e){return'link[rel="stylesheet"]['+e+"]"}function Fg(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function Vw(e,n,i,l){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?l.loading=1:(n=e.createElement("link"),l.preload=n,n.addEventListener("load",function(){return l.loading|=1}),n.addEventListener("error",function(){return l.loading|=2}),jt(n,"link",i),it(n),e.head.appendChild(n))}function Mr(e){return'[src="'+Rt(e)+'"]'}function Zi(e){return"script[async]"+e}function Zg(e,n,i){if(n.count++,n.instance===null)switch(n.type){case"style":var l=e.querySelector('style[data-href~="'+Rt(i.href)+'"]');if(l)return n.instance=l,it(l),l;var f=x({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),it(l),jt(l,"style",f),Kl(l,i.precedence,e),n.instance=l;case"stylesheet":f=Tr(i.href);var h=e.querySelector(Fi(f));if(h)return n.state.loading|=4,n.instance=h,it(h),h;l=Fg(i),(f=cn.get(f))&&zf(l,f),h=(e.ownerDocument||e).createElement("link"),it(h);var v=h;return v._p=new Promise(function(k,Y){v.onload=k,v.onerror=Y}),jt(h,"link",l),n.state.loading|=4,Kl(h,i.precedence,e),n.instance=h;case"script":return h=Mr(i.src),(f=e.querySelector(Zi(h)))?(n.instance=f,it(f),f):(l=i,(f=cn.get(h))&&(l=x({},i),Of(l,f)),e=e.ownerDocument||e,f=e.createElement("script"),it(f),jt(f,"link",l),e.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(o(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(l=n.instance,n.state.loading|=4,Kl(l,i.precedence,e));return n.instance}function Kl(e,n,i){for(var l=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=l.length?l[l.length-1]:null,h=f,v=0;v<l.length;v++){var k=l[v];if(k.dataset.precedence===n)h=k;else if(h!==f)break}h?h.parentNode.insertBefore(e,h.nextSibling):(n=i.nodeType===9?i.head:i,n.insertBefore(e,n.firstChild))}function zf(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Of(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Jl=null;function Wg(e,n,i){if(Jl===null){var l=new Map,f=Jl=new Map;f.set(i,l)}else f=Jl,l=f.get(i),l||(l=new Map,f.set(i,l));if(l.has(e))return l;for(l.set(e,null),i=i.getElementsByTagName(e),f=0;f<i.length;f++){var h=i[f];if(!(h[hs]||h[ht]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var v=h.getAttribute(n)||"";v=e+v;var k=l.get(v);k?k.push(h):l.set(v,[h])}}return l}function Kg(e,n,i){e=e.ownerDocument||e,e.head.insertBefore(i,n==="title"?e.querySelector("head > title"):null)}function Yw(e,n,i){if(i===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(e=n.disabled,typeof n.precedence=="string"&&e==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Jg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Pw(e,n,i,l){if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var f=Tr(l.href),h=n.querySelector(Fi(f));if(h){n=h._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=ec.bind(e),n.then(e,e)),i.state.loading|=4,i.instance=h,it(h);return}h=n.ownerDocument||n,l=Fg(l),(f=cn.get(f))&&zf(l,f),h=h.createElement("link"),it(h);var v=h;v._p=new Promise(function(k,Y){v.onload=k,v.onerror=Y}),jt(h,"link",l),i.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(i,n),(n=i.state.preload)&&(i.state.loading&3)===0&&(e.count++,i=ec.bind(e),n.addEventListener("load",i),n.addEventListener("error",i))}}var Bf=0;function Iw(e,n){return e.stylesheets&&e.count===0&&nc(e,e.stylesheets),0<e.count||0<e.imgCount?function(i){var l=setTimeout(function(){if(e.stylesheets&&nc(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+n);0<e.imgBytes&&Bf===0&&(Bf=62500*_w());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&nc(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>Bf?50:800)+n);return e.unsuspend=i,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(f)}}:null}function ec(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)nc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var tc=null;function nc(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,tc=new Map,n.forEach(Xw,e),tc=null,ec.call(e))}function Xw(e,n){if(!(n.state.loading&4)){var i=tc.get(e);if(i)var l=i.get(null);else{i=new Map,tc.set(e,i);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<f.length;h++){var v=f[h];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(i.set(v.dataset.precedence,v),l=v)}l&&i.set(null,l)}f=n.instance,v=f.getAttribute("data-precedence"),h=i.get(v)||l,h===l&&i.set(null,f),i.set(v,f),this.count++,l=ec.bind(this),f.addEventListener("load",l),f.addEventListener("error",l),h?h.parentNode.insertBefore(f,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),n.state.loading|=4}}var Wi={$$typeof:T,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function Gw(e,n,i,l,f,h,v,k,Y){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=li(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=li(0),this.hiddenUpdates=li(null),this.identifierPrefix=l,this.onUncaughtError=f,this.onCaughtError=h,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function ex(e,n,i,l,f,h,v,k,Y,ee,ie,le){return e=new Gw(e,n,i,v,Y,ee,ie,le,k),n=1,h===!0&&(n|=24),h=Yt(3,null,null,n),e.current=h,h.stateNode=e,n=md(),n.refCount++,e.pooledCache=n,n.refCount++,h.memoizedState={element:l,isDehydrated:i,cache:n},yd(h),e}function tx(e){return e?(e=ir,e):ir}function nx(e,n,i,l,f,h){f=tx(f),l.context===null?l.context=f:l.pendingContext=f,l=Oa(n),l.payload={element:i},h=h===void 0?null:h,h!==null&&(l.callback=h),i=Ba(e,l,n),i!==null&&(Ht(i,e,n),Mi(i,e,n))}function ax(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function Lf(e,n){ax(e,n),(e=e.alternate)&&ax(e,n)}function sx(e){if(e.tag===13||e.tag===31){var n=bs(e,67108864);n!==null&&Ht(n,e,67108864),Lf(e,67108864)}}function rx(e){if(e.tag===13||e.tag===31){var n=Qt();n=ci(n);var i=bs(e,n);i!==null&&Ht(i,e,n),Lf(e,n)}}var ac=!0;function Qw(e,n,i,l){var f=z.T;z.T=null;var h=R.p;try{R.p=2,Hf(e,n,i,l)}finally{R.p=h,z.T=f}}function Fw(e,n,i,l){var f=z.T;z.T=null;var h=R.p;try{R.p=8,Hf(e,n,i,l)}finally{R.p=h,z.T=f}}function Hf(e,n,i,l){if(ac){var f=$f(l);if(f===null)Sf(e,n,l,sc,i),ox(e,l);else if(Ww(f,e,n,i,l))l.stopPropagation();else if(ox(e,l),n&4&&-1<Zw.indexOf(e)){for(;f!==null;){var h=_a(f);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var v=Gn(h.pendingLanes);if(v!==0){var k=h;for(k.pendingLanes|=2,k.entangledLanes|=2;v;){var Y=1<<31-Tt(v);k.entanglements[1]|=Y,v&=~Y}Dn(h),(He&6)===0&&(ql=rt()+500,Ii(0))}}break;case 31:case 13:k=bs(h,2),k!==null&&Ht(k,h,2),Vl(),Lf(h,2)}if(h=$f(l),h===null&&Sf(e,n,l,sc,i),h===f)break;f=h}f!==null&&l.stopPropagation()}else Sf(e,n,l,null,i)}}function $f(e){return e=qu(e),qf(e)}var sc=null;function qf(e){if(sc=null,e=Sa(e),e!==null){var n=u(e);if(n===null)e=null;else{var i=n.tag;if(i===13){if(e=d(n),e!==null)return e;e=null}else if(i===31){if(e=m(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return sc=e,null}function ix(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pn()){case mn:return 2;case en:return 8;case In:case pn:return 32;case Xn:return 268435456;default:return 32}default:return 32}}var Uf=!1,Ga=null,Qa=null,Fa=null,Ki=new Map,Ji=new Map,Za=[],Zw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ox(e,n){switch(e){case"focusin":case"focusout":Ga=null;break;case"dragenter":case"dragleave":Qa=null;break;case"mouseover":case"mouseout":Fa=null;break;case"pointerover":case"pointerout":Ki.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ji.delete(n.pointerId)}}function eo(e,n,i,l,f,h){return e===null||e.nativeEvent!==h?(e={blockedOn:n,domEventName:i,eventSystemFlags:l,nativeEvent:h,targetContainers:[f]},n!==null&&(n=_a(n),n!==null&&sx(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),e)}function Ww(e,n,i,l,f){switch(n){case"focusin":return Ga=eo(Ga,e,n,i,l,f),!0;case"dragenter":return Qa=eo(Qa,e,n,i,l,f),!0;case"mouseover":return Fa=eo(Fa,e,n,i,l,f),!0;case"pointerover":var h=f.pointerId;return Ki.set(h,eo(Ki.get(h)||null,e,n,i,l,f)),!0;case"gotpointercapture":return h=f.pointerId,Ji.set(h,eo(Ji.get(h)||null,e,n,i,l,f)),!0}return!1}function lx(e){var n=Sa(e.target);if(n!==null){var i=u(n);if(i!==null){if(n=i.tag,n===13){if(n=d(i),n!==null){e.blockedOn=n,Xo(e.priority,function(){rx(i)});return}}else if(n===31){if(n=m(i),n!==null){e.blockedOn=n,Xo(e.priority,function(){rx(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function rc(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=$f(e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);$u=l,i.target.dispatchEvent(l),$u=null}else return n=_a(i),n!==null&&sx(n),e.blockedOn=i,!1;n.shift()}return!0}function cx(e,n,i){rc(e)&&i.delete(n)}function Kw(){Uf=!1,Ga!==null&&rc(Ga)&&(Ga=null),Qa!==null&&rc(Qa)&&(Qa=null),Fa!==null&&rc(Fa)&&(Fa=null),Ki.forEach(cx),Ji.forEach(cx)}function ic(e,n){e.blockedOn===n&&(e.blockedOn=null,Uf||(Uf=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Kw)))}var oc=null;function ux(e){oc!==e&&(oc=e,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){oc===e&&(oc=null);for(var n=0;n<e.length;n+=3){var i=e[n],l=e[n+1],f=e[n+2];if(typeof l!="function"){if(qf(l||i)===null)continue;break}var h=_a(i);h!==null&&(e.splice(n,3),n-=3,Hd(h,{pending:!0,data:f,method:i.method,action:l},l,f))}}))}function Ar(e){function n(Y){return ic(Y,e)}Ga!==null&&ic(Ga,e),Qa!==null&&ic(Qa,e),Fa!==null&&ic(Fa,e),Ki.forEach(n),Ji.forEach(n);for(var i=0;i<Za.length;i++){var l=Za[i];l.blockedOn===e&&(l.blockedOn=null)}for(;0<Za.length&&(i=Za[0],i.blockedOn===null);)lx(i),i.blockedOn===null&&Za.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(l=0;l<i.length;l+=3){var f=i[l],h=i[l+1],v=f[Nt]||null;if(typeof h=="function")v||ux(i);else if(v){var k=null;if(h&&h.hasAttribute("formAction")){if(f=h,v=h[Nt]||null)k=v.formAction;else if(qf(f)!==null)continue}else k=v.action;typeof k=="function"?i[l+1]=k:(i.splice(l,3),l-=3),ux(i)}}}function dx(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function n(){f!==null&&(f(),f=null),l||setTimeout(i,20)}function i(){if(!l&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(i,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),f!==null&&(f(),f=null)}}}function Vf(e){this._internalRoot=e}lc.prototype.render=Vf.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(o(409));var i=n.current,l=Qt();nx(i,l,e,n,null,null)},lc.prototype.unmount=Vf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;nx(e.current,2,null,e,null,null),Vl(),n[Qn]=null}};function lc(e){this._internalRoot=e}lc.prototype.unstable_scheduleHydration=function(e){if(e){var n=Io();e={blockedOn:null,target:e,priority:n};for(var i=0;i<Za.length&&n!==0&&n<Za[i].priority;i++);Za.splice(i,0,e),i===0&&lx(e)}};var fx=a.version;if(fx!=="19.2.3")throw Error(o(527,fx,"19.2.3"));R.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=g(n),e=e!==null?y(e):null,e=e===null?null:e.stateNode,e};var Jw={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cc.isDisabled&&cc.supportsFiber)try{us=cc.inject(Jw),Ct=cc}catch{}}return no.createRoot=function(e,n){if(!c(e))throw Error(o(299));var i=!1,l="",f=b0,h=v0,v=w0;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(h=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=ex(e,1,!1,null,null,i,l,null,f,h,v,dx),e[Qn]=n.current,Nf(e),new Vf(n)},no.hydrateRoot=function(e,n,i){if(!c(e))throw Error(o(299));var l=!1,f="",h=b0,v=v0,k=w0,Y=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(h=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError),i.formState!==void 0&&(Y=i.formState)),n=ex(e,1,!0,n,i??null,l,f,Y,h,v,k,dx),n.context=tx(null),i=n.current,l=Qt(),l=ci(l),f=Oa(l),f.callback=null,Ba(i,f,l),i=l,n.current.lanes=i,fs(n,i),Dn(n),e[Qn]=n.current,Nf(e),new lc(n)},no.version="19.2.3",no}var jx;function lj(){if(jx)return If.exports;jx=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(a){console.error(a)}}return t(),If.exports=oj(),If.exports}var cj=lj();const uj=Yh(cj);var Nx="popstate";function dj(t={}){function a(o,c){let{pathname:u,search:d,hash:m}=o.location;return yh("",{pathname:u,search:d,hash:m},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function s(o,c){return typeof c=="string"?c:po(c)}return hj(a,s,null,t)}function Ze(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function Zt(t,a){if(!t){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function fj(){return Math.random().toString(36).substring(2,10)}function Sx(t,a){return{usr:t.state,key:t.key,idx:a}}function yh(t,a,s=null,o){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof a=="string"?Jr(a):a,state:s,key:a&&a.key||o||fj()}}function po({pathname:t="/",search:a="",hash:s=""}){return a&&a!=="?"&&(t+=a.charAt(0)==="?"?a:"?"+a),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Jr(t){let a={};if(t){let s=t.indexOf("#");s>=0&&(a.hash=t.substring(s),t=t.substring(0,s));let o=t.indexOf("?");o>=0&&(a.search=t.substring(o),t=t.substring(0,o)),t&&(a.pathname=t)}return a}function hj(t,a,s,o={}){let{window:c=document.defaultView,v5Compat:u=!1}=o,d=c.history,m="POP",p=null,g=y();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function y(){return(d.state||{idx:null}).idx}function x(){m="POP";let _=y(),E=_==null?null:_-g;g=_,p&&p({action:m,location:C.location,delta:E})}function b(_,E){m="PUSH";let D=yh(C.location,_,E);g=y()+1;let T=Sx(D,g),A=C.createHref(D);try{d.pushState(T,"",A)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;c.location.assign(A)}u&&p&&p({action:m,location:C.location,delta:1})}function N(_,E){m="REPLACE";let D=yh(C.location,_,E);g=y();let T=Sx(D,g),A=C.createHref(D);d.replaceState(T,"",A),u&&p&&p({action:m,location:C.location,delta:0})}function S(_){return mj(_)}let C={get action(){return m},get location(){return t(c,d)},listen(_){if(p)throw new Error("A history only accepts one active listener");return c.addEventListener(Nx,x),p=_,()=>{c.removeEventListener(Nx,x),p=null}},createHref(_){return a(c,_)},createURL:S,encodeLocation(_){let E=S(_);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:b,replace:N,go(_){return d.go(_)}};return C}function mj(t,a=!1){let s="http://localhost";typeof window<"u"&&(s=window.location.origin!=="null"?window.location.origin:window.location.href),Ze(s,"No window.location.(origin|href) available to create URL");let o=typeof t=="string"?t:po(t);return o=o.replace(/ $/,"%20"),!a&&o.startsWith("//")&&(o=s+o),new URL(o,s)}function ub(t,a,s="/"){return pj(t,a,s,!1)}function pj(t,a,s,o){let c=typeof a=="string"?Jr(a):a,u=ya(c.pathname||"/",s);if(u==null)return null;let d=db(t);gj(d);let m=null;for(let p=0;m==null&&p<d.length;++p){let g=Cj(u);m=_j(d[p],g,o)}return m}function db(t,a=[],s=[],o="",c=!1){let u=(d,m,p=c,g)=>{let y={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:m,route:d};if(y.relativePath.startsWith("/")){if(!y.relativePath.startsWith(o)&&p)return;Ze(y.relativePath.startsWith(o),`Absolute route path "${y.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),y.relativePath=y.relativePath.slice(o.length)}let x=xa([o,y.relativePath]),b=s.concat(y);d.children&&d.children.length>0&&(Ze(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),db(d.children,a,b,x,p)),!(d.path==null&&!d.index)&&a.push({path:x,score:Nj(x,d.index),routesMeta:b})};return t.forEach((d,m)=>{if(d.path===""||!d.path?.includes("?"))u(d,m);else for(let p of fb(d.path))u(d,m,!0,p)}),a}function fb(t){let a=t.split("/");if(a.length===0)return[];let[s,...o]=a,c=s.endsWith("?"),u=s.replace(/\?$/,"");if(o.length===0)return c?[u,""]:[u];let d=fb(o.join("/")),m=[];return m.push(...d.map(p=>p===""?u:[u,p].join("/"))),c&&m.push(...d),m.map(p=>t.startsWith("/")&&p===""?"/":p)}function gj(t){t.sort((a,s)=>a.score!==s.score?s.score-a.score:Sj(a.routesMeta.map(o=>o.childrenIndex),s.routesMeta.map(o=>o.childrenIndex)))}var xj=/^:[\w-]+$/,yj=3,bj=2,vj=1,wj=10,jj=-2,_x=t=>t==="*";function Nj(t,a){let s=t.split("/"),o=s.length;return s.some(_x)&&(o+=jj),a&&(o+=bj),s.filter(c=>!_x(c)).reduce((c,u)=>c+(xj.test(u)?yj:u===""?vj:wj),o)}function Sj(t,a){return t.length===a.length&&t.slice(0,-1).every((o,c)=>o===a[c])?t[t.length-1]-a[a.length-1]:0}function _j(t,a,s=!1){let{routesMeta:o}=t,c={},u="/",d=[];for(let m=0;m<o.length;++m){let p=o[m],g=m===o.length-1,y=u==="/"?a:a.slice(u.length)||"/",x=Hc({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},y),b=p.route;if(!x&&g&&s&&!o[o.length-1].route.index&&(x=Hc({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},y)),!x)return null;Object.assign(c,x.params),d.push({params:c,pathname:xa([u,x.pathname]),pathnameBase:kj(xa([u,x.pathnameBase])),route:b}),x.pathnameBase!=="/"&&(u=xa([u,x.pathnameBase]))}return d}function Hc(t,a){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,o]=Ej(t.path,t.caseSensitive,t.end),c=a.match(s);if(!c)return null;let u=c[0],d=u.replace(/(.)\/+$/,"$1"),m=c.slice(1);return{params:o.reduce((g,{paramName:y,isOptional:x},b)=>{if(y==="*"){let S=m[b]||"";d=u.slice(0,u.length-S.length).replace(/(.)\/+$/,"$1")}const N=m[b];return x&&!N?g[y]=void 0:g[y]=(N||"").replace(/%2F/g,"/"),g},{}),pathname:u,pathnameBase:d,pattern:t}}function Ej(t,a=!1,s=!0){Zt(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let o=[],c="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,m,p)=>(o.push({paramName:m,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(o.push({paramName:"*"}),c+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?c+="\\/*$":t!==""&&t!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,a?void 0:"i"),o]}function Cj(t){try{return t.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return Zt(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${a}).`),t}}function ya(t,a){if(a==="/")return t;if(!t.toLowerCase().startsWith(a.toLowerCase()))return null;let s=a.endsWith("/")?a.length-1:a.length,o=t.charAt(s);return o&&o!=="/"?null:t.slice(s)||"/"}var hb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tj=t=>hb.test(t);function Mj(t,a="/"){let{pathname:s,search:o="",hash:c=""}=typeof t=="string"?Jr(t):t,u;if(s)if(Tj(s))u=s;else{if(s.includes("//")){let d=s;s=s.replace(/\/\/+/g,"/"),Zt(!1,`Pathnames cannot have embedded double slashes - normalizing ${d} -> ${s}`)}s.startsWith("/")?u=Ex(s.substring(1),"/"):u=Ex(s,a)}else u=a;return{pathname:u,search:Rj(o),hash:Dj(c)}}function Ex(t,a){let s=a.replace(/\/+$/,"").split("/");return t.split("/").forEach(c=>{c===".."?s.length>1&&s.pop():c!=="."&&s.push(c)}),s.length>1?s.join("/"):"/"}function Ff(t,a,s,o){return`Cannot include a '${t}' character in a manually specified \`to.${a}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Aj(t){return t.filter((a,s)=>s===0||a.route.path&&a.route.path.length>0)}function Ph(t){let a=Aj(t);return a.map((s,o)=>o===a.length-1?s.pathname:s.pathnameBase)}function Ih(t,a,s,o=!1){let c;typeof t=="string"?c=Jr(t):(c={...t},Ze(!c.pathname||!c.pathname.includes("?"),Ff("?","pathname","search",c)),Ze(!c.pathname||!c.pathname.includes("#"),Ff("#","pathname","hash",c)),Ze(!c.search||!c.search.includes("#"),Ff("#","search","hash",c)));let u=t===""||c.pathname==="",d=u?"/":c.pathname,m;if(d==null)m=s;else{let x=a.length-1;if(!o&&d.startsWith("..")){let b=d.split("/");for(;b[0]==="..";)b.shift(),x-=1;c.pathname=b.join("/")}m=x>=0?a[x]:"/"}let p=Mj(c,m),g=d&&d!=="/"&&d.endsWith("/"),y=(u||d===".")&&s.endsWith("/");return!p.pathname.endsWith("/")&&(g||y)&&(p.pathname+="/"),p}var xa=t=>t.join("/").replace(/\/\/+/g,"/"),kj=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Rj=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Dj=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,zj=class{constructor(t,a,s,o=!1){this.status=t,this.statusText=a||"",this.internal=o,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}};function Oj(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function Bj(t){return t.map(a=>a.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var mb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function pb(t,a){let s=t;if(typeof s!="string"||!hb.test(s))return{absoluteURL:void 0,isExternal:!1,to:s};let o=s,c=!1;if(mb)try{let u=new URL(window.location.href),d=s.startsWith("//")?new URL(u.protocol+s):new URL(s),m=ya(d.pathname,a);d.origin===u.origin&&m!=null?s=m+d.search+d.hash:c=!0}catch{Zt(!1,`<Link to="${s}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:o,isExternal:c,to:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var gb=["POST","PUT","PATCH","DELETE"];new Set(gb);var Lj=["GET",...gb];new Set(Lj);var ei=j.createContext(null);ei.displayName="DataRouter";var au=j.createContext(null);au.displayName="DataRouterState";var Hj=j.createContext(!1),xb=j.createContext({isTransitioning:!1});xb.displayName="ViewTransition";var $j=j.createContext(new Map);$j.displayName="Fetchers";var qj=j.createContext(null);qj.displayName="Await";var Kt=j.createContext(null);Kt.displayName="Navigation";var Co=j.createContext(null);Co.displayName="Location";var fn=j.createContext({outlet:null,matches:[],isDataRoute:!1});fn.displayName="Route";var Xh=j.createContext(null);Xh.displayName="RouteError";var yb="REACT_ROUTER_ERROR",Uj="REDIRECT",Vj="ROUTE_ERROR_RESPONSE";function Yj(t){if(t.startsWith(`${yb}:${Uj}:{`))try{let a=JSON.parse(t.slice(28));if(typeof a=="object"&&a&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.location=="string"&&typeof a.reloadDocument=="boolean"&&typeof a.replace=="boolean")return a}catch{}}function Pj(t){if(t.startsWith(`${yb}:${Vj}:{`))try{let a=JSON.parse(t.slice(40));if(typeof a=="object"&&a&&typeof a.status=="number"&&typeof a.statusText=="string")return new zj(a.status,a.statusText,a.data)}catch{}}function Ij(t,{relative:a}={}){Ze(ti(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:o}=j.useContext(Kt),{hash:c,pathname:u,search:d}=To(t,{relative:a}),m=u;return s!=="/"&&(m=u==="/"?s:xa([s,u])),o.createHref({pathname:m,search:d,hash:c})}function ti(){return j.useContext(Co)!=null}function wa(){return Ze(ti(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(Co).location}var bb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function vb(t){j.useContext(Kt).static||j.useLayoutEffect(t)}function Ps(){let{isDataRoute:t}=j.useContext(fn);return t?oN():Xj()}function Xj(){Ze(ti(),"useNavigate() may be used only in the context of a <Router> component.");let t=j.useContext(ei),{basename:a,navigator:s}=j.useContext(Kt),{matches:o}=j.useContext(fn),{pathname:c}=wa(),u=JSON.stringify(Ph(o)),d=j.useRef(!1);return vb(()=>{d.current=!0}),j.useCallback((p,g={})=>{if(Zt(d.current,bb),!d.current)return;if(typeof p=="number"){s.go(p);return}let y=Ih(p,JSON.parse(u),c,g.relative==="path");t==null&&a!=="/"&&(y.pathname=y.pathname==="/"?a:xa([a,y.pathname])),(g.replace?s.replace:s.push)(y,g.state,g)},[a,s,u,c,t])}var Gj=j.createContext(null);function Qj(t){let a=j.useContext(fn).outlet;return j.useMemo(()=>a&&j.createElement(Gj.Provider,{value:t},a),[a,t])}function Fj(){let{matches:t}=j.useContext(fn),a=t[t.length-1];return a?a.params:{}}function To(t,{relative:a}={}){let{matches:s}=j.useContext(fn),{pathname:o}=wa(),c=JSON.stringify(Ph(s));return j.useMemo(()=>Ih(t,JSON.parse(c),o,a==="path"),[t,c,o,a])}function Zj(t,a){return wb(t,a)}function wb(t,a,s,o,c){Ze(ti(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=j.useContext(Kt),{matches:d}=j.useContext(fn),m=d[d.length-1],p=m?m.params:{},g=m?m.pathname:"/",y=m?m.pathnameBase:"/",x=m&&m.route;{let D=x&&x.path||"";Nb(g,!x||D.endsWith("*")||D.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${D}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${D}"> to <Route path="${D==="/"?"*":`${D}/*`}">.`)}let b=wa(),N;if(a){let D=typeof a=="string"?Jr(a):a;Ze(y==="/"||D.pathname?.startsWith(y),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${y}" but pathname "${D.pathname}" was given in the \`location\` prop.`),N=D}else N=b;let S=N.pathname||"/",C=S;if(y!=="/"){let D=y.replace(/^\//,"").split("/");C="/"+S.replace(/^\//,"").split("/").slice(D.length).join("/")}let _=ub(t,{pathname:C});Zt(x||_!=null,`No routes matched location "${N.pathname}${N.search}${N.hash}" `),Zt(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${N.pathname}${N.search}${N.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=tN(_&&_.map(D=>Object.assign({},D,{params:Object.assign({},p,D.params),pathname:xa([y,u.encodeLocation?u.encodeLocation(D.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?y:xa([y,u.encodeLocation?u.encodeLocation(D.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:D.pathnameBase])})),d,s,o,c);return a&&E?j.createElement(Co.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...N},navigationType:"POP"}},E):E}function Wj(){let t=iN(),a=Oj(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,o="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:o},u={padding:"2px 4px",backgroundColor:o},d=null;return console.error("Error handled by React Router default ErrorBoundary:",t),d=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:u},"ErrorBoundary")," or"," ",j.createElement("code",{style:u},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},a),s?j.createElement("pre",{style:c},s):null,d)}var Kj=j.createElement(Wj,null),jb=class extends j.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,a){return a.location!==t.location||a.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:a.error,location:a.location,revalidation:t.revalidation||a.revalidation}}componentDidCatch(t,a){this.props.onError?this.props.onError(t,a):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const s=Pj(t.digest);s&&(t=s)}let a=t!==void 0?j.createElement(fn.Provider,{value:this.props.routeContext},j.createElement(Xh.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?j.createElement(Jj,{error:t},a):a}};jb.contextType=Hj;var Zf=new WeakMap;function Jj({children:t,error:a}){let{basename:s}=j.useContext(Kt);if(typeof a=="object"&&a&&"digest"in a&&typeof a.digest=="string"){let o=Yj(a.digest);if(o){let c=Zf.get(a);if(c)throw c;let u=pb(o.location,s);if(mb&&!Zf.get(a))if(u.isExternal||o.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:o.replace}));throw Zf.set(a,d),d}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return t}function eN({routeContext:t,match:a,children:s}){let o=j.useContext(ei);return o&&o.static&&o.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=a.route.id),j.createElement(fn.Provider,{value:t},s)}function tN(t,a=[],s=null,o=null,c=null){if(t==null){if(!s)return null;if(s.errors)t=s.matches;else if(a.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let u=t,d=s?.errors;if(d!=null){let y=u.findIndex(x=>x.route.id&&d?.[x.route.id]!==void 0);Ze(y>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,y+1))}let m=!1,p=-1;if(s)for(let y=0;y<u.length;y++){let x=u[y];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=y),x.route.id){let{loaderData:b,errors:N}=s,S=x.route.loader&&!b.hasOwnProperty(x.route.id)&&(!N||N[x.route.id]===void 0);if(x.route.lazy||S){m=!0,p>=0?u=u.slice(0,p+1):u=[u[0]];break}}}let g=s&&o?(y,x)=>{o(y,{location:s.location,params:s.matches?.[0]?.params??{},unstable_pattern:Bj(s.matches),errorInfo:x})}:void 0;return u.reduceRight((y,x,b)=>{let N,S=!1,C=null,_=null;s&&(N=d&&x.route.id?d[x.route.id]:void 0,C=x.route.errorElement||Kj,m&&(p<0&&b===0?(Nb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,_=null):p===b&&(S=!0,_=x.route.hydrateFallbackElement||null)));let E=a.concat(u.slice(0,b+1)),D=()=>{let T;return N?T=C:S?T=_:x.route.Component?T=j.createElement(x.route.Component,null):x.route.element?T=x.route.element:T=y,j.createElement(eN,{match:x,routeContext:{outlet:y,matches:E,isDataRoute:s!=null},children:T})};return s&&(x.route.ErrorBoundary||x.route.errorElement||b===0)?j.createElement(jb,{location:s.location,revalidation:s.revalidation,component:C,error:N,children:D(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:g}):D()},null)}function Gh(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function nN(t){let a=j.useContext(ei);return Ze(a,Gh(t)),a}function aN(t){let a=j.useContext(au);return Ze(a,Gh(t)),a}function sN(t){let a=j.useContext(fn);return Ze(a,Gh(t)),a}function Qh(t){let a=sN(t),s=a.matches[a.matches.length-1];return Ze(s.route.id,`${t} can only be used on routes that contain a unique "id"`),s.route.id}function rN(){return Qh("useRouteId")}function iN(){let t=j.useContext(Xh),a=aN("useRouteError"),s=Qh("useRouteError");return t!==void 0?t:a.errors?.[s]}function oN(){let{router:t}=nN("useNavigate"),a=Qh("useNavigate"),s=j.useRef(!1);return vb(()=>{s.current=!0}),j.useCallback(async(c,u={})=>{Zt(s.current,bb),s.current&&(typeof c=="number"?await t.navigate(c):await t.navigate(c,{fromRouteId:a,...u}))},[t,a])}var Cx={};function Nb(t,a,s){!a&&!Cx[t]&&(Cx[t]=!0,Zt(!1,s))}j.memo(lN);function lN({routes:t,future:a,state:s,onError:o}){return wb(t,void 0,s,o,a)}function $c({to:t,replace:a,state:s,relative:o}){Ze(ti(),"<Navigate> may be used only in the context of a <Router> component.");let{static:c}=j.useContext(Kt);Zt(!c,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=j.useContext(fn),{pathname:d}=wa(),m=Ps(),p=Ih(t,Ph(u),d,o==="path"),g=JSON.stringify(p);return j.useEffect(()=>{m(JSON.parse(g),{replace:a,state:s,relative:o})},[m,g,o,a,s]),null}function cN(t){return Qj(t.context)}function _t(t){Ze(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function uN({basename:t="/",children:a=null,location:s,navigationType:o="POP",navigator:c,static:u=!1,unstable_useTransitions:d}){Ze(!ti(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=t.replace(/^\/*/,"/"),p=j.useMemo(()=>({basename:m,navigator:c,static:u,unstable_useTransitions:d,future:{}}),[m,c,u,d]);typeof s=="string"&&(s=Jr(s));let{pathname:g="/",search:y="",hash:x="",state:b=null,key:N="default"}=s,S=j.useMemo(()=>{let C=ya(g,m);return C==null?null:{location:{pathname:C,search:y,hash:x,state:b,key:N},navigationType:o}},[m,g,y,x,b,N,o]);return Zt(S!=null,`<Router basename="${m}"> is not able to match the URL "${g}${y}${x}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:j.createElement(Kt.Provider,{value:p},j.createElement(Co.Provider,{children:a,value:S}))}function dN({children:t,location:a}){return Zj(bh(t),a)}function bh(t,a=[]){let s=[];return j.Children.forEach(t,(o,c)=>{if(!j.isValidElement(o))return;let u=[...a,c];if(o.type===j.Fragment){s.push.apply(s,bh(o.props.children,u));return}Ze(o.type===_t,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ze(!o.props.index||!o.props.children,"An index route cannot have child routes.");let d={id:o.props.id||u.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,middleware:o.props.middleware,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=bh(o.props.children,u)),s.push(d)}),s}var Ec="get",Cc="application/x-www-form-urlencoded";function su(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function fN(t){return su(t)&&t.tagName.toLowerCase()==="button"}function hN(t){return su(t)&&t.tagName.toLowerCase()==="form"}function mN(t){return su(t)&&t.tagName.toLowerCase()==="input"}function pN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function gN(t,a){return t.button===0&&(!a||a==="_self")&&!pN(t)}function vh(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((a,s)=>{let o=t[s];return a.concat(Array.isArray(o)?o.map(c=>[s,c]):[[s,o]])},[]))}function xN(t,a){let s=vh(t);return a&&a.forEach((o,c)=>{s.has(c)||a.getAll(c).forEach(u=>{s.append(c,u)})}),s}var uc=null;function yN(){if(uc===null)try{new FormData(document.createElement("form"),0),uc=!1}catch{uc=!0}return uc}var bN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Wf(t){return t!=null&&!bN.has(t)?(Zt(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cc}"`),null):t}function vN(t,a){let s,o,c,u,d;if(hN(t)){let m=t.getAttribute("action");o=m?ya(m,a):null,s=t.getAttribute("method")||Ec,c=Wf(t.getAttribute("enctype"))||Cc,u=new FormData(t)}else if(fN(t)||mN(t)&&(t.type==="submit"||t.type==="image")){let m=t.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||m.getAttribute("action");if(o=p?ya(p,a):null,s=t.getAttribute("formmethod")||m.getAttribute("method")||Ec,c=Wf(t.getAttribute("formenctype"))||Wf(m.getAttribute("enctype"))||Cc,u=new FormData(m,t),!yN()){let{name:g,type:y,value:x}=t;if(y==="image"){let b=g?`${g}.`:"";u.append(`${b}x`,"0"),u.append(`${b}y`,"0")}else g&&u.append(g,x)}}else{if(su(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=Ec,o=null,c=Cc,d=t}return u&&c==="text/plain"&&(d=u,u=void 0),{action:o,method:s.toLowerCase(),encType:c,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Fh(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function wN(t,a,s,o){let c=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s?c.pathname.endsWith("/")?c.pathname=`${c.pathname}_.${o}`:c.pathname=`${c.pathname}.${o}`:c.pathname==="/"?c.pathname=`_root.${o}`:a&&ya(c.pathname,a)==="/"?c.pathname=`${a.replace(/\/$/,"")}/_root.${o}`:c.pathname=`${c.pathname.replace(/\/$/,"")}.${o}`,c}async function jN(t,a){if(t.id in a)return a[t.id];try{let s=await import(t.module);return a[t.id]=s,s}catch(s){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function NN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function SN(t,a,s){let o=await Promise.all(t.map(async c=>{let u=a.routes[c.route.id];if(u){let d=await jN(u,s);return d.links?d.links():[]}return[]}));return TN(o.flat(1).filter(NN).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function Tx(t,a,s,o,c,u){let d=(p,g)=>s[g]?p.route.id!==s[g].route.id:!0,m=(p,g)=>s[g].pathname!==p.pathname||s[g].route.path?.endsWith("*")&&s[g].params["*"]!==p.params["*"];return u==="assets"?a.filter((p,g)=>d(p,g)||m(p,g)):u==="data"?a.filter((p,g)=>{let y=o.routes[p.route.id];if(!y||!y.hasLoader)return!1;if(d(p,g)||m(p,g))return!0;if(p.route.shouldRevalidate){let x=p.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:s[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function _N(t,a,{includeHydrateFallback:s}={}){return EN(t.map(o=>{let c=a.routes[o.route.id];if(!c)return[];let u=[c.module];return c.clientActionModule&&(u=u.concat(c.clientActionModule)),c.clientLoaderModule&&(u=u.concat(c.clientLoaderModule)),s&&c.hydrateFallbackModule&&(u=u.concat(c.hydrateFallbackModule)),c.imports&&(u=u.concat(c.imports)),u}).flat(1))}function EN(t){return[...new Set(t)]}function CN(t){let a={},s=Object.keys(t).sort();for(let o of s)a[o]=t[o];return a}function TN(t,a){let s=new Set;return new Set(a),t.reduce((o,c)=>{let u=JSON.stringify(CN(c));return s.has(u)||(s.add(u),o.push({key:u,link:c})),o},[])}function Sb(){let t=j.useContext(ei);return Fh(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function MN(){let t=j.useContext(au);return Fh(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Zh=j.createContext(void 0);Zh.displayName="FrameworkContext";function _b(){let t=j.useContext(Zh);return Fh(t,"You must render this element inside a <HydratedRouter> element"),t}function AN(t,a){let s=j.useContext(Zh),[o,c]=j.useState(!1),[u,d]=j.useState(!1),{onFocus:m,onBlur:p,onMouseEnter:g,onMouseLeave:y,onTouchStart:x}=a,b=j.useRef(null);j.useEffect(()=>{if(t==="render"&&d(!0),t==="viewport"){let C=E=>{E.forEach(D=>{d(D.isIntersecting)})},_=new IntersectionObserver(C,{threshold:.5});return b.current&&_.observe(b.current),()=>{_.disconnect()}}},[t]),j.useEffect(()=>{if(o){let C=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(C)}}},[o]);let N=()=>{c(!0)},S=()=>{c(!1),d(!1)};return s?t!=="intent"?[u,b,{}]:[u,b,{onFocus:ao(m,N),onBlur:ao(p,S),onMouseEnter:ao(g,N),onMouseLeave:ao(y,S),onTouchStart:ao(x,N)}]:[!1,b,{}]}function ao(t,a){return s=>{t&&t(s),s.defaultPrevented||a(s)}}function kN({page:t,...a}){let{router:s}=Sb(),o=j.useMemo(()=>ub(s.routes,t,s.basename),[s.routes,t,s.basename]);return o?j.createElement(DN,{page:t,matches:o,...a}):null}function RN(t){let{manifest:a,routeModules:s}=_b(),[o,c]=j.useState([]);return j.useEffect(()=>{let u=!1;return SN(t,a,s).then(d=>{u||c(d)}),()=>{u=!0}},[t,a,s]),o}function DN({page:t,matches:a,...s}){let o=wa(),{future:c,manifest:u,routeModules:d}=_b(),{basename:m}=Sb(),{loaderData:p,matches:g}=MN(),y=j.useMemo(()=>Tx(t,a,g,u,o,"data"),[t,a,g,u,o]),x=j.useMemo(()=>Tx(t,a,g,u,o,"assets"),[t,a,g,u,o]),b=j.useMemo(()=>{if(t===o.pathname+o.search+o.hash)return[];let C=new Set,_=!1;if(a.forEach(D=>{let T=u.routes[D.route.id];!T||!T.hasLoader||(!y.some(A=>A.route.id===D.route.id)&&D.route.id in p&&d[D.route.id]?.shouldRevalidate||T.hasClientLoader?_=!0:C.add(D.route.id))}),C.size===0)return[];let E=wN(t,m,c.unstable_trailingSlashAwareDataRequests,"data");return _&&C.size>0&&E.searchParams.set("_routes",a.filter(D=>C.has(D.route.id)).map(D=>D.route.id).join(",")),[E.pathname+E.search]},[m,c.unstable_trailingSlashAwareDataRequests,p,o,u,y,a,t,d]),N=j.useMemo(()=>_N(x,u),[x,u]),S=RN(x);return j.createElement(j.Fragment,null,b.map(C=>j.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...s})),N.map(C=>j.createElement("link",{key:C,rel:"modulepreload",href:C,...s})),S.map(({key:C,link:_})=>j.createElement("link",{key:C,nonce:s.nonce,..._})))}function zN(...t){return a=>{t.forEach(s=>{typeof s=="function"?s(a):s!=null&&(s.current=a)})}}var ON=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ON&&(window.__reactRouterVersion="7.12.0")}catch{}function BN({basename:t,children:a,unstable_useTransitions:s,window:o}){let c=j.useRef();c.current==null&&(c.current=dj({window:o,v5Compat:!0}));let u=c.current,[d,m]=j.useState({action:u.action,location:u.location}),p=j.useCallback(g=>{s===!1?m(g):j.startTransition(()=>m(g))},[s]);return j.useLayoutEffect(()=>u.listen(p),[u,p]),j.createElement(uN,{basename:t,children:a,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:s})}var Eb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Os=j.forwardRef(function({onClick:a,discover:s="render",prefetch:o="none",relative:c,reloadDocument:u,replace:d,state:m,target:p,to:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:b,...N},S){let{basename:C,unstable_useTransitions:_}=j.useContext(Kt),E=typeof g=="string"&&Eb.test(g),D=pb(g,C);g=D.to;let T=Ij(g,{relative:c}),[A,w,O]=AN(o,N),M=$N(g,{replace:d,state:m,target:p,preventScrollReset:y,relative:c,viewTransition:x,unstable_defaultShouldRevalidate:b,unstable_useTransitions:_});function q(F){a&&a(F),F.defaultPrevented||M(F)}let H=j.createElement("a",{...N,...O,href:D.absoluteURL||T,onClick:D.isExternal||u?a:q,ref:zN(S,w),target:p,"data-discover":!E&&s==="render"?"true":void 0});return A&&!E?j.createElement(j.Fragment,null,H,j.createElement(kN,{page:T})):H});Os.displayName="Link";var Cb=j.forwardRef(function({"aria-current":a="page",caseSensitive:s=!1,className:o="",end:c=!1,style:u,to:d,viewTransition:m,children:p,...g},y){let x=To(d,{relative:g.relative}),b=wa(),N=j.useContext(au),{navigator:S,basename:C}=j.useContext(Kt),_=N!=null&&IN(x)&&m===!0,E=S.encodeLocation?S.encodeLocation(x).pathname:x.pathname,D=b.pathname,T=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;s||(D=D.toLowerCase(),T=T?T.toLowerCase():null,E=E.toLowerCase()),T&&C&&(T=ya(T,C)||T);const A=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let w=D===E||!c&&D.startsWith(E)&&D.charAt(A)==="/",O=T!=null&&(T===E||!c&&T.startsWith(E)&&T.charAt(E.length)==="/"),M={isActive:w,isPending:O,isTransitioning:_},q=w?a:void 0,H;typeof o=="function"?H=o(M):H=[o,w?"active":null,O?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let F=typeof u=="function"?u(M):u;return j.createElement(Os,{...g,"aria-current":q,className:H,ref:y,style:F,to:d,viewTransition:m},typeof p=="function"?p(M):p)});Cb.displayName="NavLink";var LN=j.forwardRef(({discover:t="render",fetcherKey:a,navigate:s,reloadDocument:o,replace:c,state:u,method:d=Ec,action:m,onSubmit:p,relative:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:b,...N},S)=>{let{unstable_useTransitions:C}=j.useContext(Kt),_=YN(),E=PN(m,{relative:g}),D=d.toLowerCase()==="get"?"get":"post",T=typeof m=="string"&&Eb.test(m),A=w=>{if(p&&p(w),w.defaultPrevented)return;w.preventDefault();let O=w.nativeEvent.submitter,M=O?.getAttribute("formmethod")||d,q=()=>_(O||w.currentTarget,{fetcherKey:a,method:M,navigate:s,replace:c,state:u,relative:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:b});C&&s!==!1?j.startTransition(()=>q()):q()};return j.createElement("form",{ref:S,method:D,action:E,onSubmit:o?p:A,...N,"data-discover":!T&&t==="render"?"true":void 0})});LN.displayName="Form";function HN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Tb(t){let a=j.useContext(ei);return Ze(a,HN(t)),a}function $N(t,{target:a,replace:s,state:o,preventScrollReset:c,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:m,unstable_useTransitions:p}={}){let g=Ps(),y=wa(),x=To(t,{relative:u});return j.useCallback(b=>{if(gN(b,a)){b.preventDefault();let N=s!==void 0?s:po(y)===po(x),S=()=>g(t,{replace:N,state:o,preventScrollReset:c,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:m});p?j.startTransition(()=>S()):S()}},[y,g,x,s,o,a,t,c,u,d,m,p])}function qN(t){Zt(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let a=j.useRef(vh(t)),s=j.useRef(!1),o=wa(),c=j.useMemo(()=>xN(o.search,s.current?null:a.current),[o.search]),u=Ps(),d=j.useCallback((m,p)=>{const g=vh(typeof m=="function"?m(new URLSearchParams(c)):m);s.current=!0,u("?"+g,p)},[u,c]);return[c,d]}var UN=0,VN=()=>`__${String(++UN)}__`;function YN(){let{router:t}=Tb("useSubmit"),{basename:a}=j.useContext(Kt),s=rN(),o=t.fetch,c=t.navigate;return j.useCallback(async(u,d={})=>{let{action:m,method:p,encType:g,formData:y,body:x}=vN(u,a);if(d.navigate===!1){let b=d.fetcherKey||VN();await o(b,s,d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:y,body:x,formMethod:d.method||p,formEncType:d.encType||g,flushSync:d.flushSync})}else await c(d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:y,body:x,formMethod:d.method||p,formEncType:d.encType||g,replace:d.replace,state:d.state,fromRouteId:s,flushSync:d.flushSync,viewTransition:d.viewTransition})},[o,c,a,s])}function PN(t,{relative:a}={}){let{basename:s}=j.useContext(Kt),o=j.useContext(fn);Ze(o,"useFormAction must be used inside a RouteContext");let[c]=o.matches.slice(-1),u={...To(t||".",{relative:a})},d=wa();if(t==null){u.search=d.search;let m=new URLSearchParams(u.search),p=m.getAll("index");if(p.some(y=>y==="")){m.delete("index"),p.filter(x=>x).forEach(x=>m.append("index",x));let y=m.toString();u.search=y?`?${y}`:""}}return(!t||t===".")&&c.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),s!=="/"&&(u.pathname=u.pathname==="/"?s:xa([s,u.pathname])),po(u)}function IN(t,{relative:a}={}){let s=j.useContext(xb);Ze(s!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=Tb("useViewTransitionState"),c=To(t,{relative:a});if(!s.isTransitioning)return!1;let u=ya(s.currentLocation.pathname,o)||s.currentLocation.pathname,d=ya(s.nextLocation.pathname,o)||s.nextLocation.pathname;return Hc(c.pathname,d)!=null||Hc(c.pathname,u)!=null}cb();const Mx=t=>{let a;const s=new Set,o=(g,y)=>{const x=typeof g=="function"?g(a):g;if(!Object.is(x,a)){const b=a;a=y??(typeof x!="object"||x===null)?x:Object.assign({},a,x),s.forEach(N=>N(a,b))}},c=()=>a,m={setState:o,getState:c,getInitialState:()=>p,subscribe:g=>(s.add(g),()=>s.delete(g))},p=a=t(o,c,m);return m},XN=(t=>t?Mx(t):Mx),GN=t=>t;function QN(t,a=GN){const s=zr.useSyncExternalStore(t.subscribe,zr.useCallback(()=>a(t.getState()),[t,a]),zr.useCallback(()=>a(t.getInitialState()),[t,a]));return zr.useDebugValue(s),s}const Ax=t=>{const a=XN(t),s=o=>QN(a,o);return Object.assign(s,a),s},Mb=(t=>t?Ax(t):Ax);function FN(t,a){let s;try{s=t()}catch{return}return{getItem:c=>{var u;const d=p=>p===null?null:JSON.parse(p,void 0),m=(u=s.getItem(c))!=null?u:null;return m instanceof Promise?m.then(d):d(m)},setItem:(c,u)=>s.setItem(c,JSON.stringify(u,void 0)),removeItem:c=>s.removeItem(c)}}const wh=t=>a=>{try{const s=t(a);return s instanceof Promise?s:{then(o){return wh(o)(s)},catch(o){return this}}}catch(s){return{then(o){return this},catch(o){return wh(o)(s)}}}},ZN=(t,a)=>(s,o,c)=>{let u={storage:FN(()=>localStorage),partialize:_=>_,version:0,merge:(_,E)=>({...E,..._}),...a},d=!1,m=0;const p=new Set,g=new Set;let y=u.storage;if(!y)return t((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${u.name}', the given storage is currently unavailable.`),s(..._)},o,c);const x=()=>{const _=u.partialize({...o()});return y.setItem(u.name,{state:_,version:u.version})},b=c.setState;c.setState=(_,E)=>(b(_,E),x());const N=t((..._)=>(s(..._),x()),o,c);c.getInitialState=()=>N;let S;const C=()=>{var _,E;if(!y)return;const D=++m;d=!1,p.forEach(A=>{var w;return A((w=o())!=null?w:N)});const T=((E=u.onRehydrateStorage)==null?void 0:E.call(u,(_=o())!=null?_:N))||void 0;return wh(y.getItem.bind(y))(u.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==u.version){if(u.migrate){const w=u.migrate(A.state,A.version);return w instanceof Promise?w.then(O=>[!0,O]):[!0,w]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var w;if(D!==m)return;const[O,M]=A;if(S=u.merge(M,(w=o())!=null?w:N),s(S,!0),O)return x()}).then(()=>{D===m&&(T?.(S,void 0),S=o(),d=!0,g.forEach(A=>A(S)))}).catch(A=>{D===m&&T?.(void 0,A)})};return c.persist={setOptions:_=>{u={...u,..._},_.storage&&(y=_.storage)},clearStorage:()=>{y?.removeItem(u.name)},getOptions:()=>u,rehydrate:()=>C(),hasHydrated:()=>d,onHydrate:_=>(p.add(_),()=>{p.delete(_)}),onFinishHydration:_=>(g.add(_),()=>{g.delete(_)})},u.skipHydration||C(),S||N},WN=ZN,At=Mb(WN(t=>({user:null,agent:null,token:null,basicToken:null,isAuthenticated:!1,login:(a,s,o)=>{t({user:a,agent:a,token:s,basicToken:o,isAuthenticated:!0})},logout:()=>{t({user:null,agent:null,token:null,basicToken:null,isAuthenticated:!1})}}),{name:"auth-storage"}));const KN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),JN=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,s,o)=>o?o.toUpperCase():s.toLowerCase()),kx=t=>{const a=JN(t);return a.charAt(0).toUpperCase()+a.slice(1)},Ab=(...t)=>t.filter((a,s,o)=>!!a&&a.trim()!==""&&o.indexOf(a)===s).join(" ").trim(),eS=t=>{for(const a in t)if(a.startsWith("aria-")||a==="role"||a==="title")return!0};var tS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const nS=j.forwardRef(({color:t="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:c="",children:u,iconNode:d,...m},p)=>j.createElement("svg",{ref:p,...tS,width:a,height:a,stroke:t,strokeWidth:o?Number(s)*24/Number(a):s,className:Ab("lucide",c),...!u&&!eS(m)&&{"aria-hidden":"true"},...m},[...d.map(([g,y])=>j.createElement(g,y)),...Array.isArray(u)?u:[u]]));const pe=(t,a)=>{const s=j.forwardRef(({className:o,...c},u)=>j.createElement(nS,{ref:u,iconNode:a,className:Ab(`lucide-${KN(kx(t))}`,`lucide-${t}`,o),...c}));return s.displayName=kx(t),s};const aS=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],ns=pe("activity",aS);const sS=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],rS=pe("arrow-left",sS);const iS=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Wh=pe("arrow-right-left",iS);const oS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],lS=pe("arrow-right",oS);const cS=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],rs=pe("book-open",cS);const uS=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Kh=pe("bot",uS);const dS=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Ln=pe("brain",dS);const fS=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],qr=pe("building-2",fS);const hS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Jh=pe("chart-column",hS);const mS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Et=pe("check",mS);const pS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],gS=pe("chevron-down",pS);const xS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],yS=pe("chevron-left",xS);const bS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Mo=pe("chevron-right",bS);const vS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],wS=pe("circle-alert",vS);const jS=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qc=pe("circle-check-big",jS);const NS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],em=pe("circle-x",NS);const SS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ur=pe("clock",SS);const _S=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Uc=pe("code",_S);const ES=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Vr=pe("dollar-sign",ES);const CS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],TS=pe("download",CS);const MS=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],AS=pe("eye-off",MS);const kS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],tm=pe("eye",kS);const RS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ni=pe("file-text",RS);const DS=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],nm=pe("funnel",DS);const zS=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],am=pe("git-branch",zS);const OS=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],BS=pe("heart",OS);const LS=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],HS=pe("image",LS);const $S=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],kb=pe("inbox",$S);const qS=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],US=pe("key",qS);const VS=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],YS=pe("layout-dashboard",VS);const PS=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],IS=pe("loader-circle",PS);const XS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],GS=pe("log-out",XS);const QS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],FS=pe("map-pin",QS);const ZS=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],qt=pe("message-square",ZS);const WS=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],KS=pe("mic",WS);const JS=[["path",{d:"M5 12h14",key:"1ays0h"}]],Rb=pe("minus",JS);const e5=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Db=pe("pen-line",e5);const t5=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ru=pe("phone",t5);const n5=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],zb=pe("play",n5);const a5=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],iu=pe("plus",a5);const s5=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],r5=pe("radio",s5);const i5=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ls=pe("refresh-cw",i5);const o5=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ob=pe("rotate-ccw",o5);const l5=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],c5=pe("save",l5);const u5=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],sm=pe("search",u5);const d5=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],rm=pe("send",d5);const f5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],is=pe("shield",f5);const h5=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Yr=pe("sparkles",h5);const m5=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ou=pe("square-pen",m5);const p5=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],g5=pe("tag",p5);const x5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],lu=pe("target",x5);const y5=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ai=pe("trash-2",y5);const b5=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Vc=pe("trending-up",b5);const v5=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],lo=pe("triangle-alert",v5);const w5=[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],j5=pe("user-cog",w5);const N5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Pr=pe("user-plus",N5);const S5=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ls=pe("user",S5);const _5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],cu=pe("users",_5);const E5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],qn=pe("x",E5);const C5=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Ao=pe("zap",C5);function T5(){const t=Ps(),{agent:a,logout:s}=At(),o=a?.role==="supervisor",c=[{to:"/dashboard",icon:YS,label:"Dashboard"},{to:"/conversations",icon:qt,label:"Conversaciones"},...o?[{to:"/agents",icon:j5,label:"Agentes"},{to:"/departments",icon:qr,label:"Departamentos"},{to:"/flows",icon:am,label:"Flujos"},{to:"/logs",icon:ns,label:"Logs"},{to:"/leads",icon:cu,label:"Leads"},{to:"/analytics",icon:Jh,label:"Analytics"},{to:"/monitor",icon:r5,label:"Monitor"},{to:"/learning",icon:Ln,label:"Cerebro IA"}]:[]],u=()=>{s(),t("/login")},d=o?"Supervisor":"Agente";return r.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[r.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[r.jsxs("div",{className:"h-16 flex items-center gap-3 px-6 border-b border-gray-200",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-xl flex items-center justify-center",children:r.jsx(Kh,{className:"w-6 h-6 text-white"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"font-bold text-gray-800",children:"Chat Platform"}),r.jsx("p",{className:"text-xs text-gray-400",children:"Respaldos Chile"})]})]}),r.jsx("nav",{className:"flex-1 p-4 space-y-1",children:c.map(({to:m,icon:p,label:g})=>r.jsxs(Cb,{to:m,className:({isActive:y})=>`flex items-center gap-3 px-4 py-3 rounded-lg transition ${y?"bg-indigo-50 text-indigo-600 font-medium":"text-gray-600 hover:bg-gray-100"}`,children:[r.jsx(p,{className:"w-5 h-5"}),r.jsx("span",{children:g})]},m))}),r.jsx("div",{className:"p-4 border-t border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:a?.avatarColor||"#6366f1"},children:r.jsx("span",{className:"text-white font-medium text-sm",children:a?.name?.[0]?.toUpperCase()||a?.username?.[0]?.toUpperCase()||"A"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-800 text-sm",children:a?.name||a?.username||"Admin"}),r.jsx("p",{className:"text-xs text-gray-400",children:d})]})]}),r.jsx("button",{onClick:u,className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition",title:"Cerrar sesion",children:r.jsx(GS,{className:"w-5 h-5"})})]})})]}),r.jsx("main",{className:"flex-1 overflow-auto",children:r.jsx(cN,{})})]})}async function M5(t,a){const s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})});if(!s.ok){const c=await s.json().catch(()=>({}));throw new Error(c.error||"Credenciales invlidas")}const o=await s.json();return{agent:o.agent,token:o.token,basicToken:o.basicToken}}function A5(){const[t,a]=j.useState(""),[s,o]=j.useState(""),[c,u]=j.useState(""),[d,m]=j.useState(!1),p=Ps(),g=At(x=>x.login),y=async x=>{x.preventDefault(),u(""),m(!0);try{const{agent:b,token:N,basicToken:S}=await M5(t,s);g(b,N,S),p("/dashboard")}catch(b){u(b.message||"Error al iniciar sesin")}finally{m(!1)}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-10",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"w-18 h-18 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-5 p-4",children:r.jsx("svg",{className:"w-11 h-11 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Chat Platform"}),r.jsx("p",{className:"text-gray-500 text-sm",children:"Ingresa tus credenciales para continuar"})]}),r.jsxs("form",{onSubmit:y,children:[c&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-3 rounded-xl text-sm mb-5 border border-red-200",children:c}),r.jsxs("div",{className:"mb-5",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Usuario"}),r.jsx("input",{type:"text",value:t,onChange:x=>a(x.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl text-base outline-none transition-colors focus:border-indigo-500",placeholder:"admin",required:!0})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),r.jsx("input",{type:"password",value:s,onChange:x=>o(x.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl text-base outline-none transition-colors focus:border-indigo-500",placeholder:"",required:!0})]}),r.jsx("button",{type:"submit",disabled:d,className:"w-full bg-gradient-to-r from-indigo-500 to-blue-600 hover:from-indigo-600 hover:to-blue-700 text-white font-semibold py-3.5 px-5 rounded-xl text-base transition-all shadow-lg shadow-indigo-500/30 disabled:opacity-60 disabled:cursor-not-allowed",children:d?"Ingresando...":"Ingresar"})]}),r.jsx("p",{className:"text-center text-gray-400 text-xs mt-8",children:"Respaldos Chile  2025"})]})})}const ko=()=>{const t=At.getState().token;return{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}}};async function Bb(t,a){const s=new URLSearchParams;t&&s.set("filter",t);const o=s.toString(),c=await fetch(`/api/chat/conversations${o?"?"+o:""}`,{headers:ko()});if(!c.ok)throw new Error("Error loading conversations");return c.json()}async function k5(t){const a=await fetch(`/api/chat/conversations/${encodeURIComponent(t)}`,{headers:ko()});if(!a.ok)throw new Error("Error loading conversation");return a.json()}async function R5(t,a){const s=await fetch("/api/chat/send",{method:"POST",headers:ko(),body:JSON.stringify({to:t,message:a})});if(!s.ok)throw new Error("Error sending message");return s.json()}async function Rx(t){const a=await fetch("/api/chat/mark-read",{method:"POST",headers:ko(),body:JSON.stringify({phone:t})});if(!a.ok)throw new Error("Error marking as read");return a.json()}async function D5(){const t=await fetch("/api/chatbot/stats",{headers:ko()});if(!t.ok)throw new Error("Error loading stats");return t.json()}function dn({title:t,value:a,icon:s,color:o="green",subtitle:c}){const u={green:"bg-green-50 text-green-600",blue:"bg-blue-50 text-blue-600",yellow:"bg-yellow-50 text-yellow-600",purple:"bg-purple-50 text-purple-600",red:"bg-red-50 text-red-600"};return r.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500 font-medium",children:t}),r.jsx("p",{className:"text-3xl font-bold text-gray-800 mt-2",children:a}),c&&r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:c})]}),s&&r.jsx("div",{className:`p-3 rounded-xl ${u[o]}`,children:r.jsx(s,{className:"w-6 h-6"})})]})})}const Lb=6048e5,z5=864e5,dc=43200,Dx=1440,zx=Symbol.for("constructDateFrom");function ba(t,a){return typeof t=="function"?t(a):t&&typeof t=="object"&&zx in t?t[zx](a):t instanceof Date?new t.constructor(a):new Date(a)}function xt(t,a){return ba(a||t,t)}let O5={};function Ro(){return O5}function go(t,a){const s=Ro(),o=a?.weekStartsOn??a?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,c=xt(t,a?.in),u=c.getDay(),d=(u<o?7:0)+u-o;return c.setDate(c.getDate()-d),c.setHours(0,0,0,0),c}function Yc(t,a){return go(t,{...a,weekStartsOn:1})}function Hb(t,a){const s=xt(t,a?.in),o=s.getFullYear(),c=ba(s,0);c.setFullYear(o+1,0,4),c.setHours(0,0,0,0);const u=Yc(c),d=ba(s,0);d.setFullYear(o,0,4),d.setHours(0,0,0,0);const m=Yc(d);return s.getTime()>=u.getTime()?o+1:s.getTime()>=m.getTime()?o:o-1}function Pc(t){const a=xt(t),s=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()));return s.setUTCFullYear(a.getFullYear()),+t-+s}function uu(t,...a){const s=ba.bind(null,t||a.find(o=>typeof o=="object"));return a.map(s)}function Ox(t,a){const s=xt(t,a?.in);return s.setHours(0,0,0,0),s}function B5(t,a,s){const[o,c]=uu(s?.in,t,a),u=Ox(o),d=Ox(c),m=+u-Pc(u),p=+d-Pc(d);return Math.round((m-p)/z5)}function L5(t,a){const s=Hb(t,a),o=ba(t,0);return o.setFullYear(s,0,4),o.setHours(0,0,0,0),Yc(o)}function Tc(t,a){const s=+xt(t)-+xt(a);return s<0?-1:s>0?1:s}function H5(t){return ba(t,Date.now())}function $5(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function q5(t){return!(!$5(t)&&typeof t!="number"||isNaN(+xt(t)))}function U5(t,a,s){const[o,c]=uu(s?.in,t,a),u=o.getFullYear()-c.getFullYear(),d=o.getMonth()-c.getMonth();return u*12+d}function V5(t){return a=>{const o=(t?Math[t]:Math.trunc)(a);return o===0?0:o}}function Y5(t,a){return+xt(t)-+xt(a)}function P5(t,a){const s=xt(t,a?.in);return s.setHours(23,59,59,999),s}function I5(t,a){const s=xt(t,a?.in),o=s.getMonth();return s.setFullYear(s.getFullYear(),o+1,0),s.setHours(23,59,59,999),s}function X5(t,a){const s=xt(t,a?.in);return+P5(s,a)==+I5(s,a)}function G5(t,a,s){const[o,c,u]=uu(s?.in,t,t,a),d=Tc(c,u),m=Math.abs(U5(c,u));if(m<1)return 0;c.getMonth()===1&&c.getDate()>27&&c.setDate(30),c.setMonth(c.getMonth()-d*m);let p=Tc(c,u)===-d;X5(o)&&m===1&&Tc(o,u)===1&&(p=!1);const g=d*(m-+p);return g===0?0:g}function Q5(t,a,s){const o=Y5(t,a)/1e3;return V5(s?.roundingMethod)(o)}function F5(t,a){const s=xt(t,a?.in);return s.setFullYear(s.getFullYear(),0,1),s.setHours(0,0,0,0),s}const Z5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},W5=(t,a,s)=>{let o;const c=Z5[t];return typeof c=="string"?o=c:a===1?o=c.one:o=c.other.replace("{{count}}",a.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+o:o+" ago":o};function Lr(t){return(a={})=>{const s=a.width?String(a.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const K5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},J5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},e4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},t4={date:Lr({formats:K5,defaultWidth:"full"}),time:Lr({formats:J5,defaultWidth:"full"}),dateTime:Lr({formats:e4,defaultWidth:"full"})},n4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},a4=(t,a,s,o)=>n4[t];function On(t){return(a,s)=>{const o=s?.context?String(s.context):"standalone";let c;if(o==="formatting"&&t.formattingValues){const d=t.defaultFormattingWidth||t.defaultWidth,m=s?.width?String(s.width):d;c=t.formattingValues[m]||t.formattingValues[d]}else{const d=t.defaultWidth,m=s?.width?String(s.width):t.defaultWidth;c=t.values[m]||t.values[d]}const u=t.argumentCallback?t.argumentCallback(a):a;return c[u]}}const s4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},r4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},i4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},o4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},l4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},c4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},u4=(t,a)=>{const s=Number(t),o=s%100;if(o>20||o<10)switch(o%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},d4={ordinalNumber:u4,era:On({values:s4,defaultWidth:"wide"}),quarter:On({values:r4,defaultWidth:"wide",argumentCallback:t=>t-1}),month:On({values:i4,defaultWidth:"wide"}),day:On({values:o4,defaultWidth:"wide"}),dayPeriod:On({values:l4,defaultWidth:"wide",formattingValues:c4,defaultFormattingWidth:"wide"})};function Bn(t){return(a,s={})=>{const o=s.width,c=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],u=a.match(c);if(!u)return null;const d=u[0],m=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth],p=Array.isArray(m)?h4(m,x=>x.test(d)):f4(m,x=>x.test(d));let g;g=t.valueCallback?t.valueCallback(p):p,g=s.valueCallback?s.valueCallback(g):g;const y=a.slice(d.length);return{value:g,rest:y}}}function f4(t,a){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&a(t[s]))return s}function h4(t,a){for(let s=0;s<t.length;s++)if(a(t[s]))return s}function $b(t){return(a,s={})=>{const o=a.match(t.matchPattern);if(!o)return null;const c=o[0],u=a.match(t.parsePattern);if(!u)return null;let d=t.valueCallback?t.valueCallback(u[0]):u[0];d=s.valueCallback?s.valueCallback(d):d;const m=a.slice(c.length);return{value:d,rest:m}}}const m4=/^(\d+)(th|st|nd|rd)?/i,p4=/\d+/i,g4={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},x4={any:[/^b/i,/^(a|c)/i]},y4={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},b4={any:[/1/i,/2/i,/3/i,/4/i]},v4={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},w4={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},j4={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},N4={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},S4={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_4={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},E4={ordinalNumber:$b({matchPattern:m4,parsePattern:p4,valueCallback:t=>parseInt(t,10)}),era:Bn({matchPatterns:g4,defaultMatchWidth:"wide",parsePatterns:x4,defaultParseWidth:"any"}),quarter:Bn({matchPatterns:y4,defaultMatchWidth:"wide",parsePatterns:b4,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Bn({matchPatterns:v4,defaultMatchWidth:"wide",parsePatterns:w4,defaultParseWidth:"any"}),day:Bn({matchPatterns:j4,defaultMatchWidth:"wide",parsePatterns:N4,defaultParseWidth:"any"}),dayPeriod:Bn({matchPatterns:S4,defaultMatchWidth:"any",parsePatterns:_4,defaultParseWidth:"any"})},qb={code:"en-US",formatDistance:W5,formatLong:t4,formatRelative:a4,localize:d4,match:E4,options:{weekStartsOn:0,firstWeekContainsDate:1}};function C4(t,a){const s=xt(t,a?.in);return B5(s,F5(s))+1}function T4(t,a){const s=xt(t,a?.in),o=+Yc(s)-+L5(s);return Math.round(o/Lb)+1}function Ub(t,a){const s=xt(t,a?.in),o=s.getFullYear(),c=Ro(),u=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??c.firstWeekContainsDate??c.locale?.options?.firstWeekContainsDate??1,d=ba(a?.in||t,0);d.setFullYear(o+1,0,u),d.setHours(0,0,0,0);const m=go(d,a),p=ba(a?.in||t,0);p.setFullYear(o,0,u),p.setHours(0,0,0,0);const g=go(p,a);return+s>=+m?o+1:+s>=+g?o:o-1}function M4(t,a){const s=Ro(),o=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,c=Ub(t,a),u=ba(a?.in||t,0);return u.setFullYear(c,0,o),u.setHours(0,0,0,0),go(u,a)}function A4(t,a){const s=xt(t,a?.in),o=+go(s,a)-+M4(s,a);return Math.round(o/Lb)+1}function Ve(t,a){const s=t<0?"-":"",o=Math.abs(t).toString().padStart(a,"0");return s+o}const Ka={y(t,a){const s=t.getFullYear(),o=s>0?s:1-s;return Ve(a==="yy"?o%100:o,a.length)},M(t,a){const s=t.getMonth();return a==="M"?String(s+1):Ve(s+1,2)},d(t,a){return Ve(t.getDate(),a.length)},a(t,a){const s=t.getHours()/12>=1?"pm":"am";switch(a){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];default:return s==="am"?"a.m.":"p.m."}},h(t,a){return Ve(t.getHours()%12||12,a.length)},H(t,a){return Ve(t.getHours(),a.length)},m(t,a){return Ve(t.getMinutes(),a.length)},s(t,a){return Ve(t.getSeconds(),a.length)},S(t,a){const s=a.length,o=t.getMilliseconds(),c=Math.trunc(o*Math.pow(10,s-3));return Ve(c,a.length)}},kr={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Bx={G:function(t,a,s){const o=t.getFullYear()>0?1:0;switch(a){case"G":case"GG":case"GGG":return s.era(o,{width:"abbreviated"});case"GGGGG":return s.era(o,{width:"narrow"});default:return s.era(o,{width:"wide"})}},y:function(t,a,s){if(a==="yo"){const o=t.getFullYear(),c=o>0?o:1-o;return s.ordinalNumber(c,{unit:"year"})}return Ka.y(t,a)},Y:function(t,a,s,o){const c=Ub(t,o),u=c>0?c:1-c;if(a==="YY"){const d=u%100;return Ve(d,2)}return a==="Yo"?s.ordinalNumber(u,{unit:"year"}):Ve(u,a.length)},R:function(t,a){const s=Hb(t);return Ve(s,a.length)},u:function(t,a){const s=t.getFullYear();return Ve(s,a.length)},Q:function(t,a,s){const o=Math.ceil((t.getMonth()+1)/3);switch(a){case"Q":return String(o);case"QQ":return Ve(o,2);case"Qo":return s.ordinalNumber(o,{unit:"quarter"});case"QQQ":return s.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(o,{width:"narrow",context:"formatting"});default:return s.quarter(o,{width:"wide",context:"formatting"})}},q:function(t,a,s){const o=Math.ceil((t.getMonth()+1)/3);switch(a){case"q":return String(o);case"qq":return Ve(o,2);case"qo":return s.ordinalNumber(o,{unit:"quarter"});case"qqq":return s.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(o,{width:"narrow",context:"standalone"});default:return s.quarter(o,{width:"wide",context:"standalone"})}},M:function(t,a,s){const o=t.getMonth();switch(a){case"M":case"MM":return Ka.M(t,a);case"Mo":return s.ordinalNumber(o+1,{unit:"month"});case"MMM":return s.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(o,{width:"narrow",context:"formatting"});default:return s.month(o,{width:"wide",context:"formatting"})}},L:function(t,a,s){const o=t.getMonth();switch(a){case"L":return String(o+1);case"LL":return Ve(o+1,2);case"Lo":return s.ordinalNumber(o+1,{unit:"month"});case"LLL":return s.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(o,{width:"narrow",context:"standalone"});default:return s.month(o,{width:"wide",context:"standalone"})}},w:function(t,a,s,o){const c=A4(t,o);return a==="wo"?s.ordinalNumber(c,{unit:"week"}):Ve(c,a.length)},I:function(t,a,s){const o=T4(t);return a==="Io"?s.ordinalNumber(o,{unit:"week"}):Ve(o,a.length)},d:function(t,a,s){return a==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):Ka.d(t,a)},D:function(t,a,s){const o=C4(t);return a==="Do"?s.ordinalNumber(o,{unit:"dayOfYear"}):Ve(o,a.length)},E:function(t,a,s){const o=t.getDay();switch(a){case"E":case"EE":case"EEE":return s.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(o,{width:"short",context:"formatting"});default:return s.day(o,{width:"wide",context:"formatting"})}},e:function(t,a,s,o){const c=t.getDay(),u=(c-o.weekStartsOn+8)%7||7;switch(a){case"e":return String(u);case"ee":return Ve(u,2);case"eo":return s.ordinalNumber(u,{unit:"day"});case"eee":return s.day(c,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(c,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(c,{width:"short",context:"formatting"});default:return s.day(c,{width:"wide",context:"formatting"})}},c:function(t,a,s,o){const c=t.getDay(),u=(c-o.weekStartsOn+8)%7||7;switch(a){case"c":return String(u);case"cc":return Ve(u,a.length);case"co":return s.ordinalNumber(u,{unit:"day"});case"ccc":return s.day(c,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(c,{width:"narrow",context:"standalone"});case"cccccc":return s.day(c,{width:"short",context:"standalone"});default:return s.day(c,{width:"wide",context:"standalone"})}},i:function(t,a,s){const o=t.getDay(),c=o===0?7:o;switch(a){case"i":return String(c);case"ii":return Ve(c,a.length);case"io":return s.ordinalNumber(c,{unit:"day"});case"iii":return s.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(o,{width:"short",context:"formatting"});default:return s.day(o,{width:"wide",context:"formatting"})}},a:function(t,a,s){const c=t.getHours()/12>=1?"pm":"am";switch(a){case"a":case"aa":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(c,{width:"narrow",context:"formatting"});default:return s.dayPeriod(c,{width:"wide",context:"formatting"})}},b:function(t,a,s){const o=t.getHours();let c;switch(o===12?c=kr.noon:o===0?c=kr.midnight:c=o/12>=1?"pm":"am",a){case"b":case"bb":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(c,{width:"narrow",context:"formatting"});default:return s.dayPeriod(c,{width:"wide",context:"formatting"})}},B:function(t,a,s){const o=t.getHours();let c;switch(o>=17?c=kr.evening:o>=12?c=kr.afternoon:o>=4?c=kr.morning:c=kr.night,a){case"B":case"BB":case"BBB":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(c,{width:"narrow",context:"formatting"});default:return s.dayPeriod(c,{width:"wide",context:"formatting"})}},h:function(t,a,s){if(a==="ho"){let o=t.getHours()%12;return o===0&&(o=12),s.ordinalNumber(o,{unit:"hour"})}return Ka.h(t,a)},H:function(t,a,s){return a==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):Ka.H(t,a)},K:function(t,a,s){const o=t.getHours()%12;return a==="Ko"?s.ordinalNumber(o,{unit:"hour"}):Ve(o,a.length)},k:function(t,a,s){let o=t.getHours();return o===0&&(o=24),a==="ko"?s.ordinalNumber(o,{unit:"hour"}):Ve(o,a.length)},m:function(t,a,s){return a==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ka.m(t,a)},s:function(t,a,s){return a==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):Ka.s(t,a)},S:function(t,a){return Ka.S(t,a)},X:function(t,a,s){const o=t.getTimezoneOffset();if(o===0)return"Z";switch(a){case"X":return Hx(o);case"XXXX":case"XX":return Ds(o);default:return Ds(o,":")}},x:function(t,a,s){const o=t.getTimezoneOffset();switch(a){case"x":return Hx(o);case"xxxx":case"xx":return Ds(o);default:return Ds(o,":")}},O:function(t,a,s){const o=t.getTimezoneOffset();switch(a){case"O":case"OO":case"OOO":return"GMT"+Lx(o,":");default:return"GMT"+Ds(o,":")}},z:function(t,a,s){const o=t.getTimezoneOffset();switch(a){case"z":case"zz":case"zzz":return"GMT"+Lx(o,":");default:return"GMT"+Ds(o,":")}},t:function(t,a,s){const o=Math.trunc(+t/1e3);return Ve(o,a.length)},T:function(t,a,s){return Ve(+t,a.length)}};function Lx(t,a=""){const s=t>0?"-":"+",o=Math.abs(t),c=Math.trunc(o/60),u=o%60;return u===0?s+String(c):s+String(c)+a+Ve(u,2)}function Hx(t,a){return t%60===0?(t>0?"-":"+")+Ve(Math.abs(t)/60,2):Ds(t,a)}function Ds(t,a=""){const s=t>0?"-":"+",o=Math.abs(t),c=Ve(Math.trunc(o/60),2),u=Ve(o%60,2);return s+c+a+u}const $x=(t,a)=>{switch(t){case"P":return a.date({width:"short"});case"PP":return a.date({width:"medium"});case"PPP":return a.date({width:"long"});default:return a.date({width:"full"})}},Vb=(t,a)=>{switch(t){case"p":return a.time({width:"short"});case"pp":return a.time({width:"medium"});case"ppp":return a.time({width:"long"});default:return a.time({width:"full"})}},k4=(t,a)=>{const s=t.match(/(P+)(p+)?/)||[],o=s[1],c=s[2];if(!c)return $x(t,a);let u;switch(o){case"P":u=a.dateTime({width:"short"});break;case"PP":u=a.dateTime({width:"medium"});break;case"PPP":u=a.dateTime({width:"long"});break;default:u=a.dateTime({width:"full"});break}return u.replace("{{date}}",$x(o,a)).replace("{{time}}",Vb(c,a))},R4={p:Vb,P:k4},D4=/^D+$/,z4=/^Y+$/,O4=["D","DD","YY","YYYY"];function B4(t){return D4.test(t)}function L4(t){return z4.test(t)}function H4(t,a,s){const o=$4(t,a,s);if(console.warn(o),O4.includes(t))throw new RangeError(o)}function $4(t,a,s){const o=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${a}\`) for formatting ${o} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const q4=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,U4=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,V4=/^'([^]*?)'?$/,Y4=/''/g,P4=/[a-zA-Z]/;function du(t,a,s){const o=Ro(),c=s?.locale??o.locale??qb,u=s?.firstWeekContainsDate??s?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,d=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0,m=xt(t,s?.in);if(!q5(m))throw new RangeError("Invalid time value");let p=a.match(U4).map(y=>{const x=y[0];if(x==="p"||x==="P"){const b=R4[x];return b(y,c.formatLong)}return y}).join("").match(q4).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const x=y[0];if(x==="'")return{isToken:!1,value:I4(y)};if(Bx[x])return{isToken:!0,value:y};if(x.match(P4))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:y}});c.localize.preprocessor&&(p=c.localize.preprocessor(m,p));const g={firstWeekContainsDate:u,weekStartsOn:d,locale:c};return p.map(y=>{if(!y.isToken)return y.value;const x=y.value;(!s?.useAdditionalWeekYearTokens&&L4(x)||!s?.useAdditionalDayOfYearTokens&&B4(x))&&H4(x,a,String(t));const b=Bx[x[0]];return b(m,x,c.localize,g)}).join("")}function I4(t){const a=t.match(V4);return a?a[1].replace(Y4,"'"):t}function X4(t,a,s){const o=Ro(),c=s?.locale??o.locale??qb,u=2520,d=Tc(t,a);if(isNaN(d))throw new RangeError("Invalid time value");const m=Object.assign({},s,{addSuffix:s?.addSuffix,comparison:d}),[p,g]=uu(s?.in,...d>0?[a,t]:[t,a]),y=Q5(g,p),x=(Pc(g)-Pc(p))/1e3,b=Math.round((y-x)/60);let N;if(b<2)return s?.includeSeconds?y<5?c.formatDistance("lessThanXSeconds",5,m):y<10?c.formatDistance("lessThanXSeconds",10,m):y<20?c.formatDistance("lessThanXSeconds",20,m):y<40?c.formatDistance("halfAMinute",0,m):y<60?c.formatDistance("lessThanXMinutes",1,m):c.formatDistance("xMinutes",1,m):b===0?c.formatDistance("lessThanXMinutes",1,m):c.formatDistance("xMinutes",b,m);if(b<45)return c.formatDistance("xMinutes",b,m);if(b<90)return c.formatDistance("aboutXHours",1,m);if(b<Dx){const S=Math.round(b/60);return c.formatDistance("aboutXHours",S,m)}else{if(b<u)return c.formatDistance("xDays",1,m);if(b<dc){const S=Math.round(b/Dx);return c.formatDistance("xDays",S,m)}else if(b<dc*2)return N=Math.round(b/dc),c.formatDistance("aboutXMonths",N,m)}if(N=G5(g,p),N<12){const S=Math.round(b/dc);return c.formatDistance("xMonths",S,m)}else{const S=N%12,C=Math.trunc(N/12);return S<3?c.formatDistance("aboutXYears",C,m):S<9?c.formatDistance("overXYears",C,m):c.formatDistance("almostXYears",C+1,m)}}function si(t,a){return X4(t,H5(t),a)}const G4={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},Q4=(t,a,s)=>{let o;const c=G4[t];return typeof c=="string"?o=c:a===1?o=c.one:o=c.other.replace("{{count}}",a.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"en "+o:"hace "+o:o},F4={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},Z4={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},W4={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},K4={date:Lr({formats:F4,defaultWidth:"full"}),time:Lr({formats:Z4,defaultWidth:"full"}),dateTime:Lr({formats:W4,defaultWidth:"full"})},J4={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},e3={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},t3=(t,a,s,o)=>a.getHours()!==1?e3[t]:J4[t],n3={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},a3={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},s3={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},r3={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},i3={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},o3={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},l3=(t,a)=>Number(t)+"",c3={ordinalNumber:l3,era:On({values:n3,defaultWidth:"wide"}),quarter:On({values:a3,defaultWidth:"wide",argumentCallback:t=>Number(t)-1}),month:On({values:s3,defaultWidth:"wide"}),day:On({values:r3,defaultWidth:"wide"}),dayPeriod:On({values:i3,defaultWidth:"wide",formattingValues:o3,defaultFormattingWidth:"wide"})},u3=/^(\d+)()?/i,d3=/\d+/i,f3={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},h3={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},m3={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},p3={any:[/1/i,/2/i,/3/i,/4/i]},g3={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},x3={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},y3={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},b3={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},v3={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},w3={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},j3={ordinalNumber:$b({matchPattern:u3,parsePattern:d3,valueCallback:function(t){return parseInt(t,10)}}),era:Bn({matchPatterns:f3,defaultMatchWidth:"wide",parsePatterns:h3,defaultParseWidth:"any"}),quarter:Bn({matchPatterns:m3,defaultMatchWidth:"wide",parsePatterns:p3,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Bn({matchPatterns:g3,defaultMatchWidth:"wide",parsePatterns:x3,defaultParseWidth:"any"}),day:Bn({matchPatterns:y3,defaultMatchWidth:"wide",parsePatterns:b3,defaultParseWidth:"any"}),dayPeriod:Bn({matchPatterns:v3,defaultMatchWidth:"any",parsePatterns:w3,defaultParseWidth:"any"})},os={code:"es",formatDistance:Q4,formatLong:K4,formatRelative:t3,localize:c3,match:j3,options:{weekStartsOn:1,firstWeekContainsDate:1}};function N3(){const[t,a]=j.useState(null),[s,o]=j.useState([]),[c,u]=j.useState(!0);j.useEffect(()=>{d()},[]);const d=async()=>{try{const[p,g]=await Promise.all([D5(),Bb()]);a(p),o(g.conversations||[])}catch(p){console.error("Error loading dashboard:",p)}finally{u(!1)}};if(c)return r.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})});const m=s.slice(0,5);return r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Resumen de tu chatbot de WhatsApp"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[r.jsx(dn,{title:"Conversaciones",value:s.length,icon:qt,color:"green",subtitle:"Total activas"}),r.jsx(dn,{title:"Usuarios nicos",value:t?.unique_users||0,icon:cu,color:"blue",subtitle:"ltimos 30 das"}),r.jsx(dn,{title:"Interacciones",value:t?.interactions||0,icon:Kh,color:"purple",subtitle:"Procesadas por el bot"}),r.jsx(dn,{title:"Confianza",value:`${Math.round((t?.avg_confidence||0)*100)}%`,icon:Ur,color:"yellow",subtitle:"Promedio clasificacin"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[r.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Conversaciones Recientes"}),r.jsxs(Os,{to:"/conversations",className:"text-green-600 hover:text-green-700 text-sm font-medium flex items-center gap-1",children:["Ver todas ",r.jsx(lS,{className:"w-4 h-4"})]})]}),m.length===0?r.jsxs("div",{className:"p-12 text-center text-gray-400",children:[r.jsx(qt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"No hay conversaciones todava"})]}):r.jsx("div",{className:"divide-y divide-gray-100",children:m.map(p=>r.jsxs(Os,{to:`/conversations?phone=${encodeURIComponent(p.phone)}`,className:"flex items-center gap-4 p-4 hover:bg-gray-50 transition",children:[r.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx("span",{className:"text-green-600 font-medium",children:p.contact_name?.[0]?.toUpperCase()||p.phone.slice(-2)})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium text-gray-800 truncate",children:p.contact_name||p.phone}),r.jsx("span",{className:"text-xs text-gray-400",children:p.last_message_time?si(new Date(p.last_message_time),{addSuffix:!0,locale:os}):""})]}),r.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:p.last_message||"Sin mensajes"})]}),p.unread_count>0&&r.jsx("span",{className:"bg-green-500 text-white text-xs font-medium px-2 py-1 rounded-full",children:p.unread_count})]},p.phone))})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-8",children:[r.jsxs(Os,{to:"/flows",className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white hover:from-green-600 hover:to-green-700 transition",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Editor de Flujos"}),r.jsx("p",{className:"text-green-100 text-sm",children:"Crea y edita flujos conversacionales de forma visual"})]}),r.jsxs(Os,{to:"/conversations",className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white hover:from-blue-600 hover:to-blue-700 transition",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Ver Conversaciones"}),r.jsx("p",{className:"text-blue-100 text-sm",children:"Responde a tus clientes en tiempo real"})]})]})]})}const Un=Object.create(null);Un.open="0";Un.close="1";Un.ping="2";Un.pong="3";Un.message="4";Un.upgrade="5";Un.noop="6";const Mc=Object.create(null);Object.keys(Un).forEach(t=>{Mc[Un[t]]=t});const jh={type:"error",data:"parser error"},Yb=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Pb=typeof ArrayBuffer=="function",Ib=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,im=({type:t,data:a},s,o)=>Yb&&a instanceof Blob?s?o(a):qx(a,o):Pb&&(a instanceof ArrayBuffer||Ib(a))?s?o(a):qx(new Blob([a]),o):o(Un[t]+(a||"")),qx=(t,a)=>{const s=new FileReader;return s.onload=function(){const o=s.result.split(",")[1];a("b"+(o||""))},s.readAsDataURL(t)};function Ux(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Kf;function S3(t,a){if(Yb&&t.data instanceof Blob)return t.data.arrayBuffer().then(Ux).then(a);if(Pb&&(t.data instanceof ArrayBuffer||Ib(t.data)))return a(Ux(t.data));im(t,!1,s=>{Kf||(Kf=new TextEncoder),a(Kf.encode(s))})}const Vx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",co=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<Vx.length;t++)co[Vx.charCodeAt(t)]=t;const _3=t=>{let a=t.length*.75,s=t.length,o,c=0,u,d,m,p;t[t.length-1]==="="&&(a--,t[t.length-2]==="="&&a--);const g=new ArrayBuffer(a),y=new Uint8Array(g);for(o=0;o<s;o+=4)u=co[t.charCodeAt(o)],d=co[t.charCodeAt(o+1)],m=co[t.charCodeAt(o+2)],p=co[t.charCodeAt(o+3)],y[c++]=u<<2|d>>4,y[c++]=(d&15)<<4|m>>2,y[c++]=(m&3)<<6|p&63;return g},E3=typeof ArrayBuffer=="function",om=(t,a)=>{if(typeof t!="string")return{type:"message",data:Xb(t,a)};const s=t.charAt(0);return s==="b"?{type:"message",data:C3(t.substring(1),a)}:Mc[s]?t.length>1?{type:Mc[s],data:t.substring(1)}:{type:Mc[s]}:jh},C3=(t,a)=>{if(E3){const s=_3(t);return Xb(s,a)}else return{base64:!0,data:t}},Xb=(t,a)=>a==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,Gb="",T3=(t,a)=>{const s=t.length,o=new Array(s);let c=0;t.forEach((u,d)=>{im(u,!1,m=>{o[d]=m,++c===s&&a(o.join(Gb))})})},M3=(t,a)=>{const s=t.split(Gb),o=[];for(let c=0;c<s.length;c++){const u=om(s[c],a);if(o.push(u),u.type==="error")break}return o};function A3(){return new TransformStream({transform(t,a){S3(t,s=>{const o=s.length;let c;if(o<126)c=new Uint8Array(1),new DataView(c.buffer).setUint8(0,o);else if(o<65536){c=new Uint8Array(3);const u=new DataView(c.buffer);u.setUint8(0,126),u.setUint16(1,o)}else{c=new Uint8Array(9);const u=new DataView(c.buffer);u.setUint8(0,127),u.setBigUint64(1,BigInt(o))}t.data&&typeof t.data!="string"&&(c[0]|=128),a.enqueue(c),a.enqueue(s)})}})}let Jf;function fc(t){return t.reduce((a,s)=>a+s.length,0)}function hc(t,a){if(t[0].length===a)return t.shift();const s=new Uint8Array(a);let o=0;for(let c=0;c<a;c++)s[c]=t[0][o++],o===t[0].length&&(t.shift(),o=0);return t.length&&o<t[0].length&&(t[0]=t[0].slice(o)),s}function k3(t,a){Jf||(Jf=new TextDecoder);const s=[];let o=0,c=-1,u=!1;return new TransformStream({transform(d,m){for(s.push(d);;){if(o===0){if(fc(s)<1)break;const p=hc(s,1);u=(p[0]&128)===128,c=p[0]&127,c<126?o=3:c===126?o=1:o=2}else if(o===1){if(fc(s)<2)break;const p=hc(s,2);c=new DataView(p.buffer,p.byteOffset,p.length).getUint16(0),o=3}else if(o===2){if(fc(s)<8)break;const p=hc(s,8),g=new DataView(p.buffer,p.byteOffset,p.length),y=g.getUint32(0);if(y>Math.pow(2,21)-1){m.enqueue(jh);break}c=y*Math.pow(2,32)+g.getUint32(4),o=3}else{if(fc(s)<c)break;const p=hc(s,c);m.enqueue(om(u?p:Jf.decode(p),a)),o=0}if(c===0||c>t){m.enqueue(jh);break}}}})}const Qb=4;function dt(t){if(t)return R3(t)}function R3(t){for(var a in dt.prototype)t[a]=dt.prototype[a];return t}dt.prototype.on=dt.prototype.addEventListener=function(t,a){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(a),this};dt.prototype.once=function(t,a){function s(){this.off(t,s),a.apply(this,arguments)}return s.fn=a,this.on(t,s),this};dt.prototype.off=dt.prototype.removeListener=dt.prototype.removeAllListeners=dt.prototype.removeEventListener=function(t,a){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+t];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var o,c=0;c<s.length;c++)if(o=s[c],o===a||o.fn===a){s.splice(c,1);break}return s.length===0&&delete this._callbacks["$"+t],this};dt.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var a=new Array(arguments.length-1),s=this._callbacks["$"+t],o=1;o<arguments.length;o++)a[o-1]=arguments[o];if(s){s=s.slice(0);for(var o=0,c=s.length;o<c;++o)s[o].apply(this,a)}return this};dt.prototype.emitReserved=dt.prototype.emit;dt.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};dt.prototype.hasListeners=function(t){return!!this.listeners(t).length};const fu=typeof Promise=="function"&&typeof Promise.resolve=="function"?a=>Promise.resolve().then(a):(a,s)=>s(a,0),un=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),D3="arraybuffer";function Fb(t,...a){return a.reduce((s,o)=>(t.hasOwnProperty(o)&&(s[o]=t[o]),s),{})}const z3=un.setTimeout,O3=un.clearTimeout;function hu(t,a){a.useNativeTimers?(t.setTimeoutFn=z3.bind(un),t.clearTimeoutFn=O3.bind(un)):(t.setTimeoutFn=un.setTimeout.bind(un),t.clearTimeoutFn=un.clearTimeout.bind(un))}const B3=1.33;function L3(t){return typeof t=="string"?H3(t):Math.ceil((t.byteLength||t.size)*B3)}function H3(t){let a=0,s=0;for(let o=0,c=t.length;o<c;o++)a=t.charCodeAt(o),a<128?s+=1:a<2048?s+=2:a<55296||a>=57344?s+=3:(o++,s+=4);return s}function Zb(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function $3(t){let a="";for(let s in t)t.hasOwnProperty(s)&&(a.length&&(a+="&"),a+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return a}function q3(t){let a={},s=t.split("&");for(let o=0,c=s.length;o<c;o++){let u=s[o].split("=");a[decodeURIComponent(u[0])]=decodeURIComponent(u[1])}return a}class U3 extends Error{constructor(a,s,o){super(a),this.description=s,this.context=o,this.type="TransportError"}}class lm extends dt{constructor(a){super(),this.writable=!1,hu(this,a),this.opts=a,this.query=a.query,this.socket=a.socket,this.supportsBinary=!a.forceBase64}onError(a,s,o){return super.emitReserved("error",new U3(a,s,o)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(a){this.readyState==="open"&&this.write(a)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(a){const s=om(a,this.socket.binaryType);this.onPacket(s)}onPacket(a){super.emitReserved("packet",a)}onClose(a){this.readyState="closed",super.emitReserved("close",a)}pause(a){}createUri(a,s={}){return a+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const a=this.opts.hostname;return a.indexOf(":")===-1?a:"["+a+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(a){const s=$3(a);return s.length?"?"+s:""}}class V3 extends lm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(a){this.readyState="pausing";const s=()=>{this.readyState="paused",a()};if(this._polling||!this.writable){let o=0;this._polling&&(o++,this.once("pollComplete",function(){--o||s()})),this.writable||(o++,this.once("drain",function(){--o||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(a){const s=o=>{if(this.readyState==="opening"&&o.type==="open"&&this.onOpen(),o.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(o)};M3(a,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const a=()=>{this.write([{type:"close"}])};this.readyState==="open"?a():this.once("open",a)}write(a){this.writable=!1,T3(a,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const a=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=Zb()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(a,s)}}let Wb=!1;try{Wb=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Y3=Wb;function P3(){}class I3 extends V3{constructor(a){if(super(a),typeof location<"u"){const s=location.protocol==="https:";let o=location.port;o||(o=s?"443":"80"),this.xd=typeof location<"u"&&a.hostname!==location.hostname||o!==a.port}}doWrite(a,s){const o=this.request({method:"POST",data:a});o.on("success",s),o.on("error",(c,u)=>{this.onError("xhr post error",c,u)})}doPoll(){const a=this.request();a.on("data",this.onData.bind(this)),a.on("error",(s,o)=>{this.onError("xhr poll error",s,o)}),this.pollXhr=a}}class Hn extends dt{constructor(a,s,o){super(),this.createRequest=a,hu(this,o),this._opts=o,this._method=o.method||"GET",this._uri=s,this._data=o.data!==void 0?o.data:null,this._create()}_create(){var a;const s=Fb(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const o=this._xhr=this.createRequest(s);try{o.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){o.setDisableHeaderCheck&&o.setDisableHeaderCheck(!0);for(let c in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(c)&&o.setRequestHeader(c,this._opts.extraHeaders[c])}}catch{}if(this._method==="POST")try{o.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{o.setRequestHeader("Accept","*/*")}catch{}(a=this._opts.cookieJar)===null||a===void 0||a.addCookies(o),"withCredentials"in o&&(o.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(o.timeout=this._opts.requestTimeout),o.onreadystatechange=()=>{var c;o.readyState===3&&((c=this._opts.cookieJar)===null||c===void 0||c.parseCookies(o.getResponseHeader("set-cookie"))),o.readyState===4&&(o.status===200||o.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof o.status=="number"?o.status:0)},0))},o.send(this._data)}catch(c){this.setTimeoutFn(()=>{this._onError(c)},0);return}typeof document<"u"&&(this._index=Hn.requestsCount++,Hn.requests[this._index]=this)}_onError(a){this.emitReserved("error",a,this._xhr),this._cleanup(!0)}_cleanup(a){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=P3,a)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Hn.requests[this._index],this._xhr=null}}_onLoad(){const a=this._xhr.responseText;a!==null&&(this.emitReserved("data",a),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Hn.requestsCount=0;Hn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Yx);else if(typeof addEventListener=="function"){const t="onpagehide"in un?"pagehide":"unload";addEventListener(t,Yx,!1)}}function Yx(){for(let t in Hn.requests)Hn.requests.hasOwnProperty(t)&&Hn.requests[t].abort()}const X3=(function(){const t=Kb({xdomain:!1});return t&&t.responseType!==null})();class G3 extends I3{constructor(a){super(a);const s=a&&a.forceBase64;this.supportsBinary=X3&&!s}request(a={}){return Object.assign(a,{xd:this.xd},this.opts),new Hn(Kb,this.uri(),a)}}function Kb(t){const a=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!a||Y3))return new XMLHttpRequest}catch{}if(!a)try{return new un[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Jb=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Q3 extends lm{get name(){return"websocket"}doOpen(){const a=this.uri(),s=this.opts.protocols,o=Jb?{}:Fb(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(o.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(a,s,o)}catch(c){return this.emitReserved("error",c)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=a=>this.onClose({description:"websocket connection closed",context:a}),this.ws.onmessage=a=>this.onData(a.data),this.ws.onerror=a=>this.onError("websocket error",a)}write(a){this.writable=!1;for(let s=0;s<a.length;s++){const o=a[s],c=s===a.length-1;im(o,this.supportsBinary,u=>{try{this.doWrite(o,u)}catch{}c&&fu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const a=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=Zb()),this.supportsBinary||(s.b64=1),this.createUri(a,s)}}const eh=un.WebSocket||un.MozWebSocket;class F3 extends Q3{createSocket(a,s,o){return Jb?new eh(a,s,o):s?new eh(a,s):new eh(a)}doWrite(a,s){this.ws.send(s)}}class Z3 extends lm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(a){return this.emitReserved("error",a)}this._transport.closed.then(()=>{this.onClose()}).catch(a=>{this.onError("webtransport error",a)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(a=>{const s=k3(Number.MAX_SAFE_INTEGER,this.socket.binaryType),o=a.readable.pipeThrough(s).getReader(),c=A3();c.readable.pipeTo(a.writable),this._writer=c.writable.getWriter();const u=()=>{o.read().then(({done:m,value:p})=>{m||(this.onPacket(p),u())}).catch(m=>{})};u();const d={type:"open"};this.query.sid&&(d.data=`{"sid":"${this.query.sid}"}`),this._writer.write(d).then(()=>this.onOpen())})})}write(a){this.writable=!1;for(let s=0;s<a.length;s++){const o=a[s],c=s===a.length-1;this._writer.write(o).then(()=>{c&&fu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var a;(a=this._transport)===null||a===void 0||a.close()}}const W3={websocket:F3,webtransport:Z3,polling:G3},K3=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,J3=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Nh(t){if(t.length>8e3)throw"URI too long";const a=t,s=t.indexOf("["),o=t.indexOf("]");s!=-1&&o!=-1&&(t=t.substring(0,s)+t.substring(s,o).replace(/:/g,";")+t.substring(o,t.length));let c=K3.exec(t||""),u={},d=14;for(;d--;)u[J3[d]]=c[d]||"";return s!=-1&&o!=-1&&(u.source=a,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=e_(u,u.path),u.queryKey=t_(u,u.query),u}function e_(t,a){const s=/\/{2,9}/g,o=a.replace(s,"/").split("/");return(a.slice(0,1)=="/"||a.length===0)&&o.splice(0,1),a.slice(-1)=="/"&&o.splice(o.length-1,1),o}function t_(t,a){const s={};return a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(o,c,u){c&&(s[c]=u)}),s}const Sh=typeof addEventListener=="function"&&typeof removeEventListener=="function",Ac=[];Sh&&addEventListener("offline",()=>{Ac.forEach(t=>t())},!1);class as extends dt{constructor(a,s){if(super(),this.binaryType=D3,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,a&&typeof a=="object"&&(s=a,a=null),a){const o=Nh(a);s.hostname=o.host,s.secure=o.protocol==="https"||o.protocol==="wss",s.port=o.port,o.query&&(s.query=o.query)}else s.host&&(s.hostname=Nh(s.host).host);hu(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(o=>{const c=o.prototype.name;this.transports.push(c),this._transportsByName[c]=o}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=q3(this.opts.query)),Sh&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Ac.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(a){const s=Object.assign({},this.opts.query);s.EIO=Qb,s.transport=a,this.id&&(s.sid=this.id);const o=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[a]);return new this._transportsByName[a](o)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const a=this.opts.rememberUpgrade&&as.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(a);s.open(),this.setTransport(s)}setTransport(a){this.transport&&this.transport.removeAllListeners(),this.transport=a,a.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",as.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(a){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case"open":this.onHandshake(JSON.parse(a.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=a.data,this._onError(s);break;case"message":this.emitReserved("data",a.data),this.emitReserved("message",a.data);break}}onHandshake(a){this.emitReserved("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this._pingInterval=a.pingInterval,this._pingTimeout=a.pingTimeout,this._maxPayload=a.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const a=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+a,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},a),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const a=this._getWritablePackets();this.transport.send(a),this._prevBufferLen=a.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let o=0;o<this.writeBuffer.length;o++){const c=this.writeBuffer[o].data;if(c&&(s+=L3(c)),o>0&&s>this._maxPayload)return this.writeBuffer.slice(0,o);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const a=Date.now()>this._pingTimeoutTime;return a&&(this._pingTimeoutTime=0,fu(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),a}write(a,s,o){return this._sendPacket("message",a,s,o),this}send(a,s,o){return this._sendPacket("message",a,s,o),this}_sendPacket(a,s,o,c){if(typeof s=="function"&&(c=s,s=void 0),typeof o=="function"&&(c=o,o=null),this.readyState==="closing"||this.readyState==="closed")return;o=o||{},o.compress=o.compress!==!1;const u={type:a,data:s,options:o};this.emitReserved("packetCreate",u),this.writeBuffer.push(u),c&&this.once("flush",c),this.flush()}close(){const a=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),a()},o=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?o():a()}):this.upgrading?o():a()),this}_onError(a){if(as.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",a),this._onClose("transport error",a)}_onClose(a,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Sh&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const o=Ac.indexOf(this._offlineEventListener);o!==-1&&Ac.splice(o,1)}this.readyState="closed",this.id=null,this.emitReserved("close",a,s),this.writeBuffer=[],this._prevBufferLen=0}}}as.protocol=Qb;class n_ extends as{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let a=0;a<this._upgrades.length;a++)this._probe(this._upgrades[a])}_probe(a){let s=this.createTransport(a),o=!1;as.priorWebsocketSuccess=!1;const c=()=>{o||(s.send([{type:"ping",data:"probe"}]),s.once("packet",x=>{if(!o)if(x.type==="pong"&&x.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;as.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{o||this.readyState!=="closed"&&(y(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const b=new Error("probe error");b.transport=s.name,this.emitReserved("upgradeError",b)}}))};function u(){o||(o=!0,y(),s.close(),s=null)}const d=x=>{const b=new Error("probe error: "+x);b.transport=s.name,u(),this.emitReserved("upgradeError",b)};function m(){d("transport closed")}function p(){d("socket closed")}function g(x){s&&x.name!==s.name&&u()}const y=()=>{s.removeListener("open",c),s.removeListener("error",d),s.removeListener("close",m),this.off("close",p),this.off("upgrading",g)};s.once("open",c),s.once("error",d),s.once("close",m),this.once("close",p),this.once("upgrading",g),this._upgrades.indexOf("webtransport")!==-1&&a!=="webtransport"?this.setTimeoutFn(()=>{o||s.open()},200):s.open()}onHandshake(a){this._upgrades=this._filterUpgrades(a.upgrades),super.onHandshake(a)}_filterUpgrades(a){const s=[];for(let o=0;o<a.length;o++)~this.transports.indexOf(a[o])&&s.push(a[o]);return s}}let a_=class extends n_{constructor(a,s={}){const o=typeof a=="object"?a:s;(!o.transports||o.transports&&typeof o.transports[0]=="string")&&(o.transports=(o.transports||["polling","websocket","webtransport"]).map(c=>W3[c]).filter(c=>!!c)),super(a,o)}};function s_(t,a="",s){let o=t;s=s||typeof location<"u"&&location,t==null&&(t=s.protocol+"//"+s.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=s.protocol+t:t=s.host+t),/^(https?|wss?):\/\//.test(t)||(typeof s<"u"?t=s.protocol+"//"+t:t="https://"+t),o=Nh(t)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";const u=o.host.indexOf(":")!==-1?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+u+":"+o.port+a,o.href=o.protocol+"://"+u+(s&&s.port===o.port?"":":"+o.port),o}const r_=typeof ArrayBuffer=="function",i_=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,e1=Object.prototype.toString,o_=typeof Blob=="function"||typeof Blob<"u"&&e1.call(Blob)==="[object BlobConstructor]",l_=typeof File=="function"||typeof File<"u"&&e1.call(File)==="[object FileConstructor]";function cm(t){return r_&&(t instanceof ArrayBuffer||i_(t))||o_&&t instanceof Blob||l_&&t instanceof File}function kc(t,a){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let s=0,o=t.length;s<o;s++)if(kc(t[s]))return!0;return!1}if(cm(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return kc(t.toJSON(),!0);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&kc(t[s]))return!0;return!1}function c_(t){const a=[],s=t.data,o=t;return o.data=_h(s,a),o.attachments=a.length,{packet:o,buffers:a}}function _h(t,a){if(!t)return t;if(cm(t)){const s={_placeholder:!0,num:a.length};return a.push(t),s}else if(Array.isArray(t)){const s=new Array(t.length);for(let o=0;o<t.length;o++)s[o]=_h(t[o],a);return s}else if(typeof t=="object"&&!(t instanceof Date)){const s={};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=_h(t[o],a));return s}return t}function u_(t,a){return t.data=Eh(t.data,a),delete t.attachments,t}function Eh(t,a){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<a.length)return a[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=Eh(t[s],a);else if(typeof t=="object")for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=Eh(t[s],a));return t}const t1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],d_=5;var Ce;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Ce||(Ce={}));class f_{constructor(a){this.replacer=a}encode(a){return(a.type===Ce.EVENT||a.type===Ce.ACK)&&kc(a)?this.encodeAsBinary({type:a.type===Ce.EVENT?Ce.BINARY_EVENT:Ce.BINARY_ACK,nsp:a.nsp,data:a.data,id:a.id}):[this.encodeAsString(a)]}encodeAsString(a){let s=""+a.type;return(a.type===Ce.BINARY_EVENT||a.type===Ce.BINARY_ACK)&&(s+=a.attachments+"-"),a.nsp&&a.nsp!=="/"&&(s+=a.nsp+","),a.id!=null&&(s+=a.id),a.data!=null&&(s+=JSON.stringify(a.data,this.replacer)),s}encodeAsBinary(a){const s=c_(a),o=this.encodeAsString(s.packet),c=s.buffers;return c.unshift(o),c}}class um extends dt{constructor(a){super(),this.reviver=a}add(a){let s;if(typeof a=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(a);const o=s.type===Ce.BINARY_EVENT;o||s.type===Ce.BINARY_ACK?(s.type=o?Ce.EVENT:Ce.ACK,this.reconstructor=new h_(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(cm(a)||a.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(a),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+a)}decodeString(a){let s=0;const o={type:Number(a.charAt(0))};if(Ce[o.type]===void 0)throw new Error("unknown packet type "+o.type);if(o.type===Ce.BINARY_EVENT||o.type===Ce.BINARY_ACK){const u=s+1;for(;a.charAt(++s)!=="-"&&s!=a.length;);const d=a.substring(u,s);if(d!=Number(d)||a.charAt(s)!=="-")throw new Error("Illegal attachments");o.attachments=Number(d)}if(a.charAt(s+1)==="/"){const u=s+1;for(;++s&&!(a.charAt(s)===","||s===a.length););o.nsp=a.substring(u,s)}else o.nsp="/";const c=a.charAt(s+1);if(c!==""&&Number(c)==c){const u=s+1;for(;++s;){const d=a.charAt(s);if(d==null||Number(d)!=d){--s;break}if(s===a.length)break}o.id=Number(a.substring(u,s+1))}if(a.charAt(++s)){const u=this.tryParse(a.substr(s));if(um.isPayloadValid(o.type,u))o.data=u;else throw new Error("invalid payload")}return o}tryParse(a){try{return JSON.parse(a,this.reviver)}catch{return!1}}static isPayloadValid(a,s){switch(a){case Ce.CONNECT:return Ic(s);case Ce.DISCONNECT:return s===void 0;case Ce.CONNECT_ERROR:return typeof s=="string"||Ic(s);case Ce.EVENT:case Ce.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&t1.indexOf(s[0])===-1);case Ce.ACK:case Ce.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class h_{constructor(a){this.packet=a,this.buffers=[],this.reconPack=a}takeBinaryData(a){if(this.buffers.push(a),this.buffers.length===this.reconPack.attachments){const s=u_(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function m_(t){return typeof t=="string"}const p_=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function g_(t){return t===void 0||p_(t)}function Ic(t){return Object.prototype.toString.call(t)==="[object Object]"}function x_(t,a){switch(t){case Ce.CONNECT:return a===void 0||Ic(a);case Ce.DISCONNECT:return a===void 0;case Ce.EVENT:return Array.isArray(a)&&(typeof a[0]=="number"||typeof a[0]=="string"&&t1.indexOf(a[0])===-1);case Ce.ACK:return Array.isArray(a);case Ce.CONNECT_ERROR:return typeof a=="string"||Ic(a);default:return!1}}function y_(t){return m_(t.nsp)&&g_(t.id)&&x_(t.type,t.data)}const b_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:um,Encoder:f_,get PacketType(){return Ce},isPacketValid:y_,protocol:d_},Symbol.toStringTag,{value:"Module"}));function vn(t,a,s){return t.on(a,s),function(){t.off(a,s)}}const v_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class n1 extends dt{constructor(a,s,o){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=a,this.nsp=s,o&&o.auth&&(this.auth=o.auth),this._opts=Object.assign({},o),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const a=this.io;this.subs=[vn(a,"open",this.onopen.bind(this)),vn(a,"packet",this.onpacket.bind(this)),vn(a,"error",this.onerror.bind(this)),vn(a,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...a){return a.unshift("message"),this.emit.apply(this,a),this}emit(a,...s){var o,c,u;if(v_.hasOwnProperty(a))throw new Error('"'+a.toString()+'" is a reserved event name');if(s.unshift(a),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const d={type:Ce.EVENT,data:s};if(d.options={},d.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const y=this.ids++,x=s.pop();this._registerAckCallback(y,x),d.id=y}const m=(c=(o=this.io.engine)===null||o===void 0?void 0:o.transport)===null||c===void 0?void 0:c.writable,p=this.connected&&!(!((u=this.io.engine)===null||u===void 0)&&u._hasPingExpired());return this.flags.volatile&&!m||(p?(this.notifyOutgoingListeners(d),this.packet(d)):this.sendBuffer.push(d)),this.flags={},this}_registerAckCallback(a,s){var o;const c=(o=this.flags.timeout)!==null&&o!==void 0?o:this._opts.ackTimeout;if(c===void 0){this.acks[a]=s;return}const u=this.io.setTimeoutFn(()=>{delete this.acks[a];for(let m=0;m<this.sendBuffer.length;m++)this.sendBuffer[m].id===a&&this.sendBuffer.splice(m,1);s.call(this,new Error("operation has timed out"))},c),d=(...m)=>{this.io.clearTimeoutFn(u),s.apply(this,m)};d.withError=!0,this.acks[a]=d}emitWithAck(a,...s){return new Promise((o,c)=>{const u=(d,m)=>d?c(d):o(m);u.withError=!0,s.push(u),this.emit(a,...s)})}_addToQueue(a){let s;typeof a[a.length-1]=="function"&&(s=a.pop());const o={id:this._queueSeq++,tryCount:0,pending:!1,args:a,flags:Object.assign({fromQueue:!0},this.flags)};a.push((c,...u)=>(this._queue[0],c!==null?o.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(c)):(this._queue.shift(),s&&s(null,...u)),o.pending=!1,this._drainQueue())),this._queue.push(o),this._drainQueue()}_drainQueue(a=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!a||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(a){a.nsp=this.nsp,this.io._packet(a)}onopen(){typeof this.auth=="function"?this.auth(a=>{this._sendConnectPacket(a)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(a){this.packet({type:Ce.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},a):a})}onerror(a){this.connected||this.emitReserved("connect_error",a)}onclose(a,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",a,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(a=>{if(!this.sendBuffer.some(o=>String(o.id)===a)){const o=this.acks[a];delete this.acks[a],o.withError&&o.call(this,new Error("socket has been disconnected"))}})}onpacket(a){if(a.nsp===this.nsp)switch(a.type){case Ce.CONNECT:a.data&&a.data.sid?this.onconnect(a.data.sid,a.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ce.EVENT:case Ce.BINARY_EVENT:this.onevent(a);break;case Ce.ACK:case Ce.BINARY_ACK:this.onack(a);break;case Ce.DISCONNECT:this.ondisconnect();break;case Ce.CONNECT_ERROR:this.destroy();const o=new Error(a.data.message);o.data=a.data.data,this.emitReserved("connect_error",o);break}}onevent(a){const s=a.data||[];a.id!=null&&s.push(this.ack(a.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(a){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const o of s)o.apply(this,a)}super.emit.apply(this,a),this._pid&&a.length&&typeof a[a.length-1]=="string"&&(this._lastOffset=a[a.length-1])}ack(a){const s=this;let o=!1;return function(...c){o||(o=!0,s.packet({type:Ce.ACK,id:a,data:c}))}}onack(a){const s=this.acks[a.id];typeof s=="function"&&(delete this.acks[a.id],s.withError&&a.data.unshift(null),s.apply(this,a.data))}onconnect(a,s){this.id=a,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(a=>this.emitEvent(a)),this.receiveBuffer=[],this.sendBuffer.forEach(a=>{this.notifyOutgoingListeners(a),this.packet(a)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(a=>a()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ce.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(a){return this.flags.compress=a,this}get volatile(){return this.flags.volatile=!0,this}timeout(a){return this.flags.timeout=a,this}onAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this}prependAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(a),this}offAny(a){if(!this._anyListeners)return this;if(a){const s=this._anyListeners;for(let o=0;o<s.length;o++)if(a===s[o])return s.splice(o,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(a),this}prependAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(a),this}offAnyOutgoing(a){if(!this._anyOutgoingListeners)return this;if(a){const s=this._anyOutgoingListeners;for(let o=0;o<s.length;o++)if(a===s[o])return s.splice(o,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(a){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const o of s)o.apply(this,a.data)}}}function ri(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ri.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var a=Math.random(),s=Math.floor(a*this.jitter*t);t=(Math.floor(a*10)&1)==0?t-s:t+s}return Math.min(t,this.max)|0};ri.prototype.reset=function(){this.attempts=0};ri.prototype.setMin=function(t){this.ms=t};ri.prototype.setMax=function(t){this.max=t};ri.prototype.setJitter=function(t){this.jitter=t};class Ch extends dt{constructor(a,s){var o;super(),this.nsps={},this.subs=[],a&&typeof a=="object"&&(s=a,a=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,hu(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((o=s.randomizationFactor)!==null&&o!==void 0?o:.5),this.backoff=new ri({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=a;const c=s.parser||b_;this.encoder=new c.Encoder,this.decoder=new c.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(a){return arguments.length?(this._reconnection=!!a,a||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(a){return a===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)}reconnectionDelay(a){var s;return a===void 0?this._reconnectionDelay:(this._reconnectionDelay=a,(s=this.backoff)===null||s===void 0||s.setMin(a),this)}randomizationFactor(a){var s;return a===void 0?this._randomizationFactor:(this._randomizationFactor=a,(s=this.backoff)===null||s===void 0||s.setJitter(a),this)}reconnectionDelayMax(a){var s;return a===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,(s=this.backoff)===null||s===void 0||s.setMax(a),this)}timeout(a){return arguments.length?(this._timeout=a,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(a){if(~this._readyState.indexOf("open"))return this;this.engine=new a_(this.uri,this.opts);const s=this.engine,o=this;this._readyState="opening",this.skipReconnect=!1;const c=vn(s,"open",function(){o.onopen(),a&&a()}),u=m=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",m),a?a(m):this.maybeReconnectOnOpen()},d=vn(s,"error",u);if(this._timeout!==!1){const m=this._timeout,p=this.setTimeoutFn(()=>{c(),u(new Error("timeout")),s.close()},m);this.opts.autoUnref&&p.unref(),this.subs.push(()=>{this.clearTimeoutFn(p)})}return this.subs.push(c),this.subs.push(d),this}connect(a){return this.open(a)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const a=this.engine;this.subs.push(vn(a,"ping",this.onping.bind(this)),vn(a,"data",this.ondata.bind(this)),vn(a,"error",this.onerror.bind(this)),vn(a,"close",this.onclose.bind(this)),vn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(a){try{this.decoder.add(a)}catch(s){this.onclose("parse error",s)}}ondecoded(a){fu(()=>{this.emitReserved("packet",a)},this.setTimeoutFn)}onerror(a){this.emitReserved("error",a)}socket(a,s){let o=this.nsps[a];return o?this._autoConnect&&!o.active&&o.connect():(o=new n1(this,a,s),this.nsps[a]=o),o}_destroy(a){const s=Object.keys(this.nsps);for(const o of s)if(this.nsps[o].active)return;this._close()}_packet(a){const s=this.encoder.encode(a);for(let o=0;o<s.length;o++)this.engine.write(s[o],a.options)}cleanup(){this.subs.forEach(a=>a()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(a,s){var o;this.cleanup(),(o=this.engine)===null||o===void 0||o.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",a,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const a=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const o=this.setTimeoutFn(()=>{a.skipReconnect||(this.emitReserved("reconnect_attempt",a.backoff.attempts),!a.skipReconnect&&a.open(c=>{c?(a._reconnecting=!1,a.reconnect(),this.emitReserved("reconnect_error",c)):a.onreconnect()}))},s);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}}onreconnect(){const a=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",a)}}const so={};function Rc(t,a){typeof t=="object"&&(a=t,t=void 0),a=a||{};const s=s_(t,a.path||"/socket.io"),o=s.source,c=s.id,u=s.path,d=so[c]&&u in so[c].nsps,m=a.forceNew||a["force new connection"]||a.multiplex===!1||d;let p;return m?p=new Ch(o,a):(so[c]||(so[c]=new Ch(o,a)),p=so[c]),s.query&&!a.query&&(a.query=s.queryKey),p.socket(s.path,a)}Object.assign(Rc,{Manager:Ch,Socket:n1,io:Rc,connect:Rc});function w_(t){const[a,s]=j.useState(!1),o=j.useRef(null),c=At(u=>u.token);return j.useEffect(()=>{if(!c)return;const u=Rc(t,{path:"/socket.io/",auth:{dashboardToken:c},transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:2e3,reconnectionDelayMax:1e4,timeout:2e4});return u.on("connect",()=>{console.log(`Dashboard socket conectado a ${t}`),s(!0)}),u.on("disconnect",d=>{console.log(`Dashboard socket desconectado: ${d}`),s(!1)}),u.on("connect_error",d=>{console.error("Error de conexin Socket.IO:",d.message)}),o.current=u,()=>{u.disconnect(),o.current=null,s(!1)}},[t,c]),{socket:o.current,connected:a}}function j_({sessionId:t,currentAgentId:a,currentDepartmentId:s,onClose:o,onAssigned:c}){const[u,d]=j.useState([]),[m,p]=j.useState([]),[g,y]=j.useState(a||""),[x,b]=j.useState(s||""),[N,S]=j.useState(!1),[C,_]=j.useState(""),E=At(w=>w.token),D={"Content-Type":"application/json",...E?{Authorization:`Bearer ${E}`}:{}};j.useEffect(()=>{Promise.all([fetch("/api/agents",{headers:D}).then(w=>w.json()),fetch("/api/departments",{headers:D}).then(w=>w.json())]).then(([w,O])=>{d(w.agents||[]),p(O.departments||[])}).catch(()=>{})},[]);const T=async()=>{S(!0),_("");try{const w={sessionId:Number(t)};g&&(w.agentId=Number(g)),x&&(w.departmentId=Number(x));const M=await(await fetch("/api/chat/assign",{method:"POST",headers:D,body:JSON.stringify(w)})).json();if(!M.ok)throw new Error(M.error||"Error al asignar");c&&c(M),o()}catch(w){_(w.message)}finally{S(!1)}},A={};return u.filter(w=>w.status==="active").forEach(w=>{const O=w.department_name||"Sin departamento";A[O]||(A[O]=[]),A[O].push(w)}),r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o,children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6",onClick:w=>w.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between mb-5",children:[r.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[r.jsx(Pr,{className:"w-5 h-5 text-green-600"}),"Asignar Conversacin"]}),r.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:r.jsx(qn,{className:"w-5 h-5"})})]}),C&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4 border border-red-200",children:C}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(qr,{className:"w-4 h-4 inline mr-1"}),"Departamento"]}),r.jsxs("select",{value:x,onChange:w=>b(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none",children:[r.jsx("option",{value:"",children:"Sin asignar departamento"}),m.filter(w=>w.active).map(w=>r.jsx("option",{value:w.id,children:w.display_name||w.name},w.id))]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Pr,{className:"w-4 h-4 inline mr-1"}),"Agente"]}),r.jsxs("select",{value:g,onChange:w=>y(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none",children:[r.jsx("option",{value:"",children:"Sin asignar agente"}),Object.entries(A).map(([w,O])=>r.jsx("optgroup",{label:w,children:O.map(M=>r.jsxs("option",{value:M.id,children:[M.name," (",M.username,") - ",M.role]},M.id))},w))]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:o,className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition",children:"Cancelar"}),r.jsx("button",{onClick:T,disabled:N||!g&&!x,className:"flex-1 px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Asignando...":"Asignar"})]})]})})}function N_({sessionId:t,currentAgentId:a,currentDepartmentId:s,onClose:o,onTransferred:c}){const[u,d]=j.useState([]),[m,p]=j.useState([]),[g,y]=j.useState(""),[x,b]=j.useState(""),[N,S]=j.useState(""),[C,_]=j.useState(!1),[E,D]=j.useState(""),T=At(M=>M.token),A={"Content-Type":"application/json",...T?{Authorization:`Bearer ${T}`}:{}};j.useEffect(()=>{Promise.all([fetch("/api/agents",{headers:A}).then(M=>M.json()),fetch("/api/departments",{headers:A}).then(M=>M.json())]).then(([M,q])=>{d(M.agents||[]),p(q.departments||[])}).catch(()=>{})},[]);const w=async()=>{_(!0),D("");try{const M={sessionId:Number(t)};g&&(M.targetAgentId=Number(g)),x&&(M.targetDepartmentId=Number(x)),N&&(M.reason=N);const H=await(await fetch("/api/chat/transfer",{method:"POST",headers:A,body:JSON.stringify(M)})).json();if(!H.ok)throw new Error(H.error||"Error al transferir");c&&c(H),o()}catch(M){D(M.message)}finally{_(!1)}},O={};return u.filter(M=>M.status==="active"&&M.id!==a).forEach(M=>{const q=M.department_name||"Sin departamento";O[q]||(O[q]=[]),O[q].push(M)}),r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o,children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6",onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between mb-5",children:[r.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[r.jsx(Wh,{className:"w-5 h-5 text-blue-600"}),"Transferir Conversacin"]}),r.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:r.jsx(qn,{className:"w-5 h-5"})})]}),E&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4 border border-red-200",children:E}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(qr,{className:"w-4 h-4 inline mr-1"}),"Departamento destino"]}),r.jsxs("select",{value:x,onChange:M=>b(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[r.jsx("option",{value:"",children:"Mantener departamento actual"}),m.filter(M=>M.active).map(M=>r.jsx("option",{value:M.id,children:M.display_name||M.name},M.id))]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Pr,{className:"w-4 h-4 inline mr-1"}),"Agente destino"]}),r.jsxs("select",{value:g,onChange:M=>y(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[r.jsx("option",{value:"",children:"Sin asignar agente"}),Object.entries(O).map(([M,q])=>r.jsx("optgroup",{label:M,children:q.map(H=>r.jsxs("option",{value:H.id,children:[H.name," (",H.username,") - ",H.role]},H.id))},M))]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Razn (opcional)"}),r.jsx("input",{type:"text",value:N,onChange:M=>S(M.target.value),placeholder:"Ej: Cliente necesita soporte tcnico",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:o,className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition",children:"Cancelar"}),r.jsx("button",{onClick:w,disabled:C||!g&&!x,className:"flex-1 px-4 py-2.5 bg-blue-500 hover:bg-blue-600 text-white rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed",children:C?"Transfiriendo...":"Transferir"})]})]})})}function a1({className:t}){return r.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})}function s1({className:t}){return r.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"})})}function S_({className:t}){return r.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 0C5.373 0 0 4.974 0 11.111c0 3.498 1.744 6.614 4.469 8.654V24l4.088-2.242c1.092.3 2.246.464 3.443.464 6.627 0 12-4.974 12-11.111S18.627 0 12 0zm1.191 14.963l-3.055-3.26-5.963 3.26L10.732 8.2l3.131 3.26 5.887-3.26-6.559 6.763z"})})}function Px({channel:t}){return!t||t==="whatsapp"?r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-green-50 text-green-600 font-medium",title:"WhatsApp",children:[r.jsx(a1,{className:"w-2.5 h-2.5"}),"WA"]}):t==="instagram"?r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-pink-50 text-pink-600 font-medium",title:"Instagram",children:[r.jsx(s1,{className:"w-2.5 h-2.5"}),"IG"]}):t==="messenger"?r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-blue-50 text-blue-600 font-medium",title:"Messenger",children:[r.jsx(S_,{className:"w-2.5 h-2.5"}),"FB"]}):null}const Ix=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500","bg-orange-500","bg-red-400","bg-cyan-500","bg-emerald-500"];function Xx(t){let a=0;for(let s=0;s<t.length;s++)a=t.charCodeAt(s)+((a<<5)-a);return Ix[Math.abs(a)%Ix.length]}function Gx(t,a){if(t){const s=t.trim().split(/\s+/);return s.length>=2?(s[0][0]+s[s.length-1][0]).toUpperCase():t[0].toUpperCase()}return a.slice(-2)}const Qx=[{key:"mine",label:"Mis Chats",icon:Ls},{key:"department",label:"Departamento",icon:qr},{key:"unassigned",label:"Sin Asignar",icon:kb},{key:"all",label:"Todos",icon:nm}];function __(){const[t,a]=qN(),[s,o]=j.useState([]),[c,u]=j.useState(t.get("phone")||null),[d,m]=j.useState([]),[p,g]=j.useState(""),[y,x]=j.useState(!0),[b,N]=j.useState(!1),[S,C]=j.useState(""),[_,E]=j.useState("all"),[D,T]=j.useState(!1),[A,w]=j.useState(!1),O=j.useRef(null),M=j.useRef(!0),q=At(V=>V.agent),H=q?.role==="supervisor",[F,Q]=j.useState(H?"all":"mine"),Z=j.useRef(F);Z.current=F;const ne=s.find(V=>V.phone===c),$=j.useRef(c);$.current=c;const{socket:I,connected:z}=w_("/chat");j.useEffect(()=>{R();const V=setInterval(()=>{R()},3e4);return()=>{clearInterval(V)}},[F]),j.useEffect(()=>{c&&(M.current=!0,U(c),a({phone:c}))},[c]),j.useEffect(()=>{if(I)return I.on("new_message",V=>{if(console.log("Nuevo mensaje via WebSocket:",V),V.phone&&V.phone===$.current){m(ce=>ce.find(ve=>ve.waMsgId===V.msgId||ve.id===V.dbId)?ce:[...ce,{id:V.dbId||Date.now(),direction:V.direction==="in"?"incoming":"outgoing",body:V.text,content:V.text,created_at:new Date(V.timestamp).toISOString(),status:V.status,waMsgId:V.msgId,is_bot:V.isAI||!1,mediaType:V.media?.type||null,mediaId:V.media?.id||V.mediaId||null,mediaMime:V.media?.mime||null,mediaCaption:V.media?.caption||null,mediaExtra:V.media?.extra||null,media:V.media}]),Rx(V.phone).then(()=>R());return}R()}),I.on("escalation",V=>{console.log("Escalamiento detectado:",V),R()}),I.on("message_status_update",V=>{console.log("Status actualizado:",V),m(ce=>ce.map(he=>he.waMsgId===V.msgId?{...he,status:V.status}:he))}),I.on("chat_assigned",V=>{console.log("Chat asignado:",V),R()}),I.on("chat_transferred",V=>{console.log("Chat transferido:",V),R()}),I.on("chat_unassigned",V=>{console.log("Chat liberado:",V),R()}),I.on("agent_status_change",V=>{console.log("Agent status change:",V)}),()=>{I.off("new_message"),I.off("escalation"),I.off("message_status_update"),I.off("chat_assigned"),I.off("chat_transferred"),I.off("chat_unassigned"),I.off("agent_status_change")}},[I]),j.useEffect(()=>{M.current?(O.current?.scrollIntoView({behavior:"instant"}),M.current=!1):O.current?.scrollIntoView({behavior:"smooth"})},[d]);const R=async V=>{try{const ce=V||Z.current,he=await Bb(ce);o(he.conversations||[])}catch(ce){console.error("Error loading conversations:",ce)}finally{x(!1)}},U=async V=>{try{const ce=await k5(V);m(ce.messages||[]),await Rx(V)}catch(ce){console.error("Error loading messages:",ce)}},L=V=>{g(V.target.value)},K=async()=>{if(!(!p.trim()||!c||b)){N(!0);try{await R5(c,p),g("")}catch(V){console.error("Error sending message:",V),alert("Error al enviar mensaje")}finally{N(!1)}}},B=V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),K())},P=async()=>{if(!re)return;const V=re.session_id||re.sessionId||re.id;if(!confirm(`Eliminar conversacin con ${re.contact_name||re.phone}? Se borrarn todos los mensajes.`))return;const ce=At.getState().token;try{const ve=await(await fetch(`/api/chat/conversations/${V}`,{method:"DELETE",headers:{"Content-Type":"application/json",...ce?{Authorization:`Bearer ${ce}`}:{}}})).json();ve.ok?(u(null),m([]),R()):alert(ve.error||"Error al eliminar")}catch(he){console.error("Error deleting conversation:",he),alert("Error al eliminar conversacin")}},ae=async()=>{if(!ne)return;const V=At.getState().token;try{(await(await fetch("/api/chat/self-assign",{method:"POST",headers:{"Content-Type":"application/json",...V?{Authorization:`Bearer ${V}`}:{}},body:JSON.stringify({sessionId:ne.session_id||ne.sessionId||ne.id})})).json()).ok&&R()}catch(ce){console.error("Error self-assigning:",ce)}},G=s.filter(V=>{const ce=(V.contact_name?.toLowerCase()||"").includes(S.toLowerCase())||V.phone.includes(S),he=V.channel||"whatsapp";return ce&&(_==="all"||he===_)}),re=s.find(V=>V.phone===c),de=H?Qx:Qx.filter(V=>V.key!=="all"),ue=V=>{const{mediaType:ce,mediaId:he,mediaExtra:ve,mediaMime:ge,media:be}=V,Se=ce||be?.type,Ae=he||be?.id,Ee=ge||be?.mime,$e=ve||be?.extra;if(!Se)return null;const De=V.direction==="outgoing",pt=Ae&&(Ae.startsWith("http://")||Ae.startsWith("https://"))?Ae:`/api/chat/media/${Ae}`;switch(Se){case"image":return r.jsxs("div",{className:"mt-2 rounded-lg overflow-hidden max-w-xs",children:[r.jsx("img",{src:pt,alt:"Imagen",className:"w-full h-auto cursor-pointer hover:opacity-90",onClick:()=>window.open(pt,"_blank"),onError:pn=>{pn.target.style.display="none",pn.target.nextSibling.style.display="flex"}}),r.jsxs("div",{className:"hidden items-center gap-2 p-3 bg-gray-100 rounded-lg",children:[r.jsx(HS,{className:"w-5 h-5 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Imagen no disponible"})]})]});case"video":return r.jsx("div",{className:"mt-2 rounded-lg overflow-hidden max-w-xs",children:r.jsx("video",{src:pt,controls:!0,className:"w-full h-auto rounded-lg",preload:"metadata",children:"Tu navegador no soporta video"})});case"audio":return r.jsxs("div",{className:`mt-2 flex items-center gap-2 p-2 rounded-lg ${De?"bg-green-600":"bg-gray-100"}`,children:[r.jsx(KS,{className:`w-5 h-5 ${De?"text-white":"text-green-600"}`}),r.jsx("audio",{src:pt,controls:!0,className:"h-8 flex-1",preload:"metadata"})]});case"document":const hn=$e?.filename||"Documento";return r.jsxs("a",{href:pt,target:"_blank",rel:"noopener noreferrer",className:`mt-2 flex items-center gap-3 p-3 rounded-lg ${De?"bg-green-600 hover:bg-green-700":"bg-gray-100 hover:bg-gray-200"} transition`,children:[r.jsx(ni,{className:`w-8 h-8 ${De?"text-white":"text-blue-600"}`}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:`text-sm font-medium truncate ${De?"text-white":"text-gray-800"}`,children:hn}),r.jsx("p",{className:`text-xs ${De?"text-green-100":"text-gray-500"}`,children:Ee||"Documento"})]}),r.jsx(TS,{className:`w-5 h-5 ${De?"text-white":"text-gray-500"}`})]});case"sticker":return r.jsx("div",{className:"mt-2",children:r.jsx("img",{src:pt,alt:"Sticker",className:"w-32 h-32 object-contain",onError:pn=>{pn.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24" fill="none" stroke="gray" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>'}})});case"location":const En=$e?.latitude,Cn=$e?.longitude,rt=$e?.name,Pn=$e?.address,mn=`https://www.google.com/maps?q=${En},${Cn}`;return r.jsx("a",{href:mn,target:"_blank",rel:"noopener noreferrer",className:`mt-2 block p-3 rounded-lg ${De?"bg-green-600 hover:bg-green-700":"bg-gray-100 hover:bg-gray-200"} transition`,children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:`p-2 rounded-full ${De?"bg-green-500":"bg-red-100"}`,children:r.jsx(FS,{className:`w-5 h-5 ${De?"text-white":"text-red-600"}`})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[rt&&r.jsx("p",{className:`font-medium ${De?"text-white":"text-gray-800"}`,children:rt}),Pn&&r.jsx("p",{className:`text-sm ${De?"text-green-100":"text-gray-600"}`,children:Pn}),r.jsxs("p",{className:`text-xs mt-1 ${De?"text-green-200":"text-gray-500"}`,children:[En?.toFixed(6),", ",Cn?.toFixed(6)]})]})]})});case"contacts":const en=$e?.contacts||[];return r.jsxs("div",{className:`mt-2 p-3 rounded-lg ${De?"bg-green-600":"bg-gray-100"}`,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(cu,{className:`w-5 h-5 ${De?"text-white":"text-blue-600"}`}),r.jsx("span",{className:`font-medium ${De?"text-white":"text-gray-800"}`,children:en.length===1?"Contacto compartido":`${en.length} contactos`})]}),en.map((pn,Xn)=>r.jsxs("div",{className:`p-2 rounded ${De?"bg-green-500":"bg-white"} ${Xn>0?"mt-2":""}`,children:[r.jsx("p",{className:`font-medium ${De?"text-white":"text-gray-800"}`,children:pn.name}),pn.phones?.map((cs,oi)=>r.jsxs("p",{className:`text-sm ${De?"text-green-100":"text-gray-600"}`,children:[cs.phone," ",cs.type&&`(${cs.type})`]},oi))]},Xn))]});case"reaction":const In=$e?.emoji||V.body;return r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(BS,{className:`w-4 h-4 ${De?"text-white":"text-pink-500"}`}),r.jsx("span",{className:"text-2xl",children:In})]});default:return null}};return y?r.jsx("div",{className:"h-full flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):r.jsxs("div",{className:"h-screen flex",children:[r.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:"Conversaciones"}),r.jsx("div",{className:`grid ${H?"grid-cols-4":"grid-cols-3"} gap-1 mb-3 bg-gray-100 p-1 rounded-xl`,children:de.map(V=>{const ce=V.icon;return r.jsxs("button",{onClick:()=>{Q(V.key),Z.current=V.key,R(V.key)},className:`flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-semibold transition-all ${F===V.key?"bg-white text-green-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[r.jsx(ce,{className:"w-3.5 h-3.5"}),V.label]},V.key)})}),r.jsx("div",{className:"flex gap-1 mb-3",children:[{key:"all",label:"Todos",icon:null,color:"gray"},{key:"whatsapp",label:"WhatsApp",icon:a1,color:"green"},{key:"instagram",label:"Instagram",icon:s1,color:"pink"}].map(V=>{const ce=V.icon,he=_===V.key;return r.jsxs("button",{onClick:()=>E(V.key),className:`flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-xs font-medium transition-all border ${he?V.key==="whatsapp"?"bg-green-50 text-green-700 border-green-200":V.key==="instagram"?"bg-pink-50 text-pink-700 border-pink-200":"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:[ce&&r.jsx(ce,{className:"w-3 h-3"}),V.label]},V.key)})}),r.jsxs("div",{className:"relative",children:[r.jsx(sm,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),r.jsx("input",{type:"text",value:S,onChange:V=>C(V.target.value),placeholder:"Buscar conversacin...",className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:G.length===0?r.jsxs("div",{className:"p-8 text-center text-gray-400",children:[r.jsx(qt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"No hay conversaciones"})]}):G.map(V=>r.jsxs("button",{onClick:()=>u(V.phone),className:`w-full flex items-center gap-3 p-4 border-b border-gray-100 hover:bg-gray-50 transition text-left ${c===V.phone?"bg-green-50":""}`,children:[r.jsx("div",{className:`w-12 h-12 ${Xx(V.contact_name||V.phone)} rounded-full flex items-center justify-center flex-shrink-0`,children:r.jsx("span",{className:"text-white font-semibold text-sm",children:Gx(V.contact_name,V.phone)})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium text-gray-800 truncate",children:V.contact_name||V.phone}),V.unread_count>0&&r.jsx("span",{className:"bg-green-500 text-white text-xs font-medium px-2 py-0.5 rounded-full",children:V.unread_count})]}),r.jsx("p",{className:"text-sm text-gray-500 truncate",children:V.last_message||"Sin mensajes"}),r.jsxs("div",{className:"flex items-center gap-1.5 mt-1 flex-wrap",children:[r.jsx(Px,{channel:V.channel}),V.department_name&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full font-medium",style:{backgroundColor:(V.department_color||"#6b7280")+"20",color:V.department_color||"#6b7280"},children:[r.jsx(qr,{className:"w-2.5 h-2.5"}),V.department_name]}),V.agent_name&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-blue-50 text-blue-600 font-medium",children:[r.jsx(Ls,{className:"w-2.5 h-2.5"}),V.agent_name]}),!V.agent_name&&!V.department_name&&V.escalation_status==="ESCALATED"&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-yellow-50 text-yellow-600 font-medium",children:[r.jsx(kb,{className:"w-2.5 h-2.5"}),"Sin asignar"]}),r.jsx("span",{className:"text-xs text-gray-400",children:V.last_message_time?si(new Date(V.last_message_time),{addSuffix:!0,locale:os}):""})]})]})]},V.phone))})]}),r.jsx("div",{className:"flex-1 flex flex-col bg-gray-50",children:c?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-white border-b border-gray-200 p-4 flex items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`w-10 h-10 ${Xx(re?.contact_name||c)} rounded-full flex items-center justify-center`,children:r.jsx("span",{className:"text-white font-semibold text-sm",children:Gx(re?.contact_name,c)})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-800",children:re?.contact_name||c}),r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[r.jsx(Px,{channel:re?.channel}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(ru,{className:"w-3 h-3"}),c]}),re?.department_name&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full font-medium",style:{backgroundColor:(re.department_color||"#6b7280")+"20",color:re.department_color||"#6b7280"},children:[r.jsx(qr,{className:"w-2.5 h-2.5"}),re.department_name]}),re?.agent_name&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-blue-50 text-blue-600 font-medium",children:[r.jsx(Ls,{className:"w-2.5 h-2.5"}),re.agent_name]})]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[re&&q?.id>0&&(!re.assigned_agent_id||re.assigned_agent_id!==q.id)&&r.jsxs("button",{onClick:ae,className:"flex items-center gap-1.5 px-3 py-2 text-xs font-medium bg-green-50 text-green-700 hover:bg-green-100 rounded-lg border border-green-200 transition",title:"Tomar este chat",children:[r.jsx(Pr,{className:"w-4 h-4"}),"Tomar"]}),re&&r.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-1.5 px-3 py-2 text-xs font-medium bg-gray-50 text-gray-700 hover:bg-gray-100 rounded-lg border border-gray-200 transition",title:"Asignar chat",children:[r.jsx(Pr,{className:"w-4 h-4"}),"Asignar"]}),re&&r.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-1.5 px-3 py-2 text-xs font-medium bg-blue-50 text-blue-700 hover:bg-blue-100 rounded-lg border border-blue-200 transition",title:"Transferir chat",children:[r.jsx(Wh,{className:"w-4 h-4"}),"Transferir"]}),re&&H&&r.jsxs("button",{onClick:P,className:"flex items-center gap-1.5 px-3 py-2 text-xs font-medium bg-red-50 text-red-700 hover:bg-red-100 rounded-lg border border-red-200 transition",title:"Eliminar conversacin",children:[r.jsx(ai,{className:"w-4 h-4"}),"Eliminar"]}),r.jsx("div",{className:"text-sm",children:z?r.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 bg-green-600 rounded-full"}),"Tiempo real"]}):r.jsxs("span",{className:"text-yellow-600 flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 bg-yellow-600 rounded-full"}),"Reconectando..."]})})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[d.map((V,ce)=>r.jsx("div",{className:`flex ${V.direction==="outgoing"?"justify-end":"justify-start"}`,children:r.jsxs("div",{className:`max-w-md px-4 py-2 rounded-2xl ${V.direction==="outgoing"?"bg-green-500 text-white rounded-br-md":"bg-white text-gray-800 rounded-bl-md shadow-sm"}`,children:[V.direction==="incoming"&&r.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400 mb-1",children:[r.jsx(Ls,{className:"w-3 h-3"}),"Cliente"]}),V.direction==="outgoing"&&V.is_bot&&r.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-100 mb-1",children:[r.jsx(Kh,{className:"w-3 h-3"}),"Bot"]}),ue(V),(V.body||V.content)&&(!V.mediaType||V.mediaType==="reaction")&&r.jsx("p",{className:"whitespace-pre-wrap",children:V.body||V.content}),V.mediaType&&V.mediaType!=="reaction"&&(V.mediaCaption||V.body)&&r.jsx("p",{className:"whitespace-pre-wrap mt-2 text-sm",children:V.mediaCaption||V.body}),r.jsxs("div",{className:`flex items-center gap-1 text-xs mt-1 ${V.direction==="outgoing"?"text-white opacity-90":"text-gray-400"}`,children:[r.jsx("span",{children:V.created_at?du(new Date(V.created_at),"HH:mm",{locale:os}):""}),V.direction==="outgoing"&&r.jsxs("span",{className:"ml-1",children:[V.status==="sent"&&"",V.status==="delivered"&&"",V.status==="read"&&r.jsx("span",{className:"text-blue-400",children:""})]})]})]})},ce)),r.jsx("div",{ref:O})]}),r.jsx("div",{className:"bg-white border-t border-gray-200 p-4",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("input",{type:"text",value:p,onChange:L,onKeyPress:B,placeholder:"Escribe un mensaje...",className:"flex-1 px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none"}),r.jsxs("button",{onClick:K,disabled:!p.trim()||b,className:"bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[r.jsx(rm,{className:"w-5 h-5"}),b?"Enviando...":"Enviar"]})]})})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:r.jsxs("div",{className:"text-center",children:[r.jsx(qt,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),r.jsx("p",{className:"text-lg",children:"Selecciona una conversacin"})]})})}),D&&re&&r.jsx(j_,{sessionId:re.session_id||re.sessionId||re.id,currentAgentId:re.assigned_agent_id,currentDepartmentId:re.assigned_department_id,onClose:()=>T(!1),onAssigned:()=>R()}),A&&re&&r.jsx(N_,{sessionId:re.session_id||re.sessionId||re.id,currentAgentId:re.assigned_agent_id,currentDepartmentId:re.assigned_department_id,onClose:()=>w(!1),onTransferred:()=>R()})]})}const ja="/api/visual-flows-live";async function Jt(t,a){if(!t.ok){let s=a;try{const o=await t.json();o.error&&(s=o.error)}catch{}throw new Error(s)}return t.json()}async function r1(){const t=await fetch(ja);return Jt(t,"Error al cargar flujos")}async function Th(t){const a=await fetch(`${ja}/${t}`);return Jt(a,"Flujo no encontrado")}async function E_(t){const a=await fetch(ja,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return Jt(a,"Error al crear flujo")}async function C_(t,a){const s=await fetch(`${ja}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return Jt(s,"Error al actualizar flujo")}async function T_(t){const a=await fetch(`${ja}/${t}`,{method:"DELETE"});return Jt(a,"Error al eliminar flujo")}async function i1(t,a=!0){const s=await fetch(`${ja}/${t}/activate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:a})});return Jt(s,"Error al activar flujo")}async function M_(t,a){const s=await fetch(`${ja}/${t}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({new_name:a})});return Jt(s,"Error al duplicar flujo")}async function A_(){const t=await fetch(`${ja}/templates/list`);return Jt(t,"Error al cargar plantillas")}async function o1(t,a){const s=await fetch(`${ja}/templates/${t}/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a})});return Jt(s,"Error al crear desde plantilla")}async function k_(t={}){const a=new URLSearchParams;t.status&&a.append("status",t.status),t.category&&a.append("category",t.category),t.lang&&a.append("lang",t.lang),a.append("with","components"),a.append("limit","200");const s=await fetch(`/api/chat/templates?${a}`);return Jt(s,"Error al cargar plantillas de Meta")}async function R_({templateName:t,languageCode:a,phone:s,parameters:o=[],headerParams:c=[],buttonParams:u=[]}){const d=await fetch("/api/templates/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({templateName:t,languageCode:a,phone:s,parameters:o,headerParams:c,buttonParams:u})});return Jt(d,"Error al enviar plantilla de prueba")}async function D_(){const t=await fetch("/api/settings/visual-flows");return Jt(t,"Error al obtener estado de Visual Flows")}async function z_(t){const a=await fetch("/api/settings/visual-flows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:t})});return Jt(a,"Error al cambiar estado de Visual Flows")}const Fx="whatsapp_test_phone";function O_({template:t,onClose:a}){const[s,o]=j.useState(""),[c,u]=j.useState(!0),[d,m]=j.useState([]),[p,g]=j.useState([]),[y,x]=j.useState([]),[b,N]=j.useState(!1),[S,C]=j.useState(null);j.useEffect(()=>{const A=localStorage.getItem(Fx);A&&o(A)},[]),j.useEffect(()=>{if(!t?.components)return;const A=t.components.find(M=>M.type==="BODY"),w=t.components.find(M=>M.type==="HEADER"),O=t.components.filter(M=>M.type==="BUTTONS");if(A?.text){const M=A.text.match(/\{\{(\d+)\}\}/g)||[];m(M.map(()=>""))}if(w?.text){const M=w.text.match(/\{\{(\d+)\}\}/g)||[];g(M.map(()=>""))}if(O.length>0){const M=[];O.forEach(q=>{q.buttons&&q.buttons.forEach(H=>{H.type==="URL"&&H.url?.includes("{{")&&M.push("")})}),x(M)}},[t]);const _=async()=>{if(!s.trim()){C({ok:!1,error:"Ingresa un nmero de telfono"});return}N(!0),C(null);try{c&&localStorage.setItem(Fx,s);const A=await R_({templateName:t.name,languageCode:t.language,phone:s.trim(),parameters:d.filter(w=>w!==""),headerParams:p.filter(w=>w!==""),buttonParams:y.filter(w=>w!=="")});C(A)}catch(A){C({ok:!1,error:A.message})}finally{N(!1)}},E=()=>{if(!t?.components)return"";const A=t.components.find(O=>O.type==="BODY");if(!A?.text)return"";let w=A.text;return d.forEach((O,M)=>{w=w.replace(`{{${M+1}}}`,O||`[param ${M+1}]`)}),w},D={APPROVED:{bg:"#dcfce7",text:"#166534"},PENDING:{bg:"#fef3c7",text:"#92400e"},REJECTED:{bg:"#fee2e2",text:"#991b1b"}},T={MARKETING:{bg:"#dbeafe",text:"#1e40af"},UTILITY:{bg:"#f3e8ff",text:"#6b21a8"},AUTHENTICATION:{bg:"#fce7f3",text:"#9d174d"}};return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:"0 0 8px 0",fontSize:"20px"},children:"Probar Plantilla"}),r.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[r.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",background:D[t.status]?.bg||"#f3f4f6",color:D[t.status]?.text||"#374151"},children:t.status}),r.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",background:T[t.category]?.bg||"#f3f4f6",color:T[t.category]?.text||"#374151"},children:t.category}),r.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"12px",background:"#f3f4f6",color:"#374151"},children:t.language})]})]}),r.jsx("button",{onClick:a,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280"},children:""})]}),r.jsxs("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Nombre de la plantilla"}),r.jsx("div",{style:{fontFamily:"monospace",fontWeight:"500"},children:t.name})]}),r.jsxs("div",{style:{background:"#dcf8c6",padding:"12px",borderRadius:"8px",marginBottom:"16px",whiteSpace:"pre-wrap"},children:[r.jsx("div",{style:{fontSize:"12px",color:"#075e54",marginBottom:"4px"},children:"Vista previa"}),r.jsx("div",{style:{color:"#000"},children:E()||"(Sin contenido)"})]}),d.length>0&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Parmetros del mensaje"}),d.map((A,w)=>r.jsx("input",{type:"text",placeholder:`Parmetro {{${w+1}}}`,value:A,onChange:O=>{const M=[...d];M[w]=O.target.value,m(M)},style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",marginBottom:"8px",fontSize:"14px"}},`body-${w}`))]}),p.length>0&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Parmetros del encabezado"}),p.map((A,w)=>r.jsx("input",{type:"text",placeholder:`Header {{${w+1}}}`,value:A,onChange:O=>{const M=[...p];M[w]=O.target.value,g(M)},style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",marginBottom:"8px",fontSize:"14px"}},`header-${w}`))]}),y.length>0&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Parmetros de botn URL"}),y.map((A,w)=>r.jsx("input",{type:"text",placeholder:`Texto dinmico del botn ${w+1}`,value:A,onChange:O=>{const M=[...y];M[w]=O.target.value,x(M)},style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",marginBottom:"8px",fontSize:"14px"}},`btn-${w}`))]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Nmero de telfono destino"}),r.jsx("input",{type:"tel",placeholder:"56912345678",value:s,onChange:A=>o(A.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"}}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"8px",fontSize:"13px",color:"#6b7280",cursor:"pointer"},children:[r.jsx("input",{type:"checkbox",checked:c,onChange:A=>u(A.target.checked)}),"Recordar este nmero"]})]}),S&&r.jsx("div",{style:{padding:"12px",borderRadius:"8px",marginBottom:"16px",background:S.ok?"#dcfce7":"#fee2e2",color:S.ok?"#166534":"#991b1b"},children:S.ok?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontWeight:"500"},children:"Enviado correctamente"}),r.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:["Mensaje enviado a ",S.sentTo]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontWeight:"500"},children:"Error al enviar"}),r.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:S.error})]})}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{onClick:a,style:{padding:"10px 20px",border:"1px solid #d1d5db",borderRadius:"8px",background:"white",cursor:"pointer",fontSize:"14px"},children:"Cerrar"}),r.jsx("button",{onClick:_,disabled:b||t.status!=="APPROVED",style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:t.status==="APPROVED"?"#25d366":"#9ca3af",color:"white",cursor:t.status==="APPROVED"?"pointer":"not-allowed",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px"},children:b?"Enviando...":"Enviar Prueba"})]}),t.status!=="APPROVED"&&r.jsx("div",{style:{marginTop:"12px",padding:"8px",background:"#fef3c7",borderRadius:"6px",fontSize:"13px",color:"#92400e",textAlign:"center"},children:"Solo se pueden probar plantillas con estado APPROVED"})]})})}function B_(){const t=Ps(),[a,s]=j.useState("flows"),[o,c]=j.useState([]),[u,d]=j.useState([]),[m,p]=j.useState([]),[g,y]=j.useState(!1),[x,b]=j.useState({status:"",category:""}),[N,S]=j.useState(null),[C,_]=j.useState(!0),[E,D]=j.useState(null),[T,A]=j.useState(null),[w,O]=j.useState(!0),[M,q]=j.useState(!1);j.useEffect(()=>{Q(),H()},[]),j.useEffect(()=>{a==="whatsapp"&&Z()},[a,x]);const H=async()=>{try{const L=await D_();O(L.enabled)}catch(L){console.error("Error loading visual flows status:",L)}},F=async()=>{try{q(!0);const K=await z_(!w);O(K.enabled),ne(K.enabled?"Modo automtico ACTIVADO":"Modo automtico DESACTIVADO",K.enabled?"success":"info")}catch(L){console.error("Error toggling visual flows:",L),ne(`Error: ${L.message}`,"error")}finally{q(!1)}},Q=async()=>{try{_(!0),D(null);const[L,K]=await Promise.all([r1(),A_()]);c(L.flows||[]),d(K.templates||[])}catch(L){console.error("Error loading flows:",L),D(L.message)}finally{_(!1)}},Z=async()=>{try{y(!0);const L={};x.status&&(L.status=x.status),x.category&&(L.category=x.category);const K=await k_(L);p(K.items||[])}catch(L){console.error("Error loading Meta templates:",L),ne(`Error al cargar plantillas: ${L.message}`,"error")}finally{y(!1)}},ne=(L,K="success")=>{A({message:L,type:K}),setTimeout(()=>A(null),4e3)},$=async(L,K)=>{try{const B=await o1(L,null);ne(`Flujo "${K}" creado correctamente`,"success"),await Q(),B.id&&t(`/flows/builder/${B.id}`)}catch(B){console.error("Error creating from template:",B),ne(`Error al crear flujo: ${B.message}`,"error")}},I=async L=>{try{const K=!L.is_active;await i1(L.id,K),ne(`Flujo "${L.name}" ${K?"activado":"desactivado"}`,"success"),await Q()}catch(K){console.error("Error toggling flow:",K),ne(`Error: ${K.message}`,"error")}},z=async L=>{try{await M_(L.id,`${L.name} (copia)`),ne("Flujo duplicado correctamente","success"),await Q()}catch(K){console.error("Error duplicating flow:",K),ne(`Error al duplicar: ${K.message}`,"error")}},R=async L=>{if(confirm(`Ests seguro de eliminar el flujo "${L.name}"?`))try{await T_(L.id),ne("Flujo eliminado correctamente","success"),await Q()}catch(K){console.error("Error deleting flow:",K),ne(`Error al eliminar: ${K.message}`,"error")}},U=L=>({sales:"bg-green-100 text-green-800",support:"bg-blue-100 text-blue-800",service:"bg-purple-100 text-purple-800",feedback:"bg-yellow-100 text-yellow-800",engagement:"bg-pink-100 text-pink-800"})[L]||"bg-gray-100 text-gray-800";return C?r.jsx("div",{className:"flex items-center justify-center h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Cargando flujos..."})]})}):E?r.jsx("div",{className:"p-8",children:r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-red-800 font-semibold mb-2",children:"Error al cargar flujos"}),r.jsx("p",{className:"text-red-600",children:E}),r.jsx("button",{onClick:Q,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reintentar"})]})}):r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-6 flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Gestin de Flujos"}),r.jsx("p",{className:"text-gray-600",children:"Administra tus flujos conversacionales y crea nuevos desde plantillas predefinidas"})]}),r.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-lg border ${w?"bg-green-50 border-green-200":"bg-gray-50 border-gray-300"}`,children:[r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:`text-sm font-medium ${w?"text-green-800":"text-gray-600"}`,children:"Modo Automtico"}),r.jsx("p",{className:`text-xs ${w?"text-green-600":"text-gray-500"}`,children:w?"Bot respondiendo":"Bot pausado"})]}),r.jsx("button",{onClick:F,disabled:M,className:`relative inline-flex h-7 w-14 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${w?"bg-green-500 focus:ring-green-500":"bg-gray-300 focus:ring-gray-500"} ${M?"opacity-50 cursor-wait":"cursor-pointer"}`,children:r.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow-md transition-transform ${w?"translate-x-8":"translate-x-1"}`})})]})]}),T&&r.jsx("div",{className:`mb-4 p-4 rounded-lg ${T.type==="success"?"bg-green-50 text-green-800 border border-green-200":T.type==="error"?"bg-red-50 text-red-800 border border-red-200":"bg-blue-50 text-blue-800 border border-blue-200"}`,children:T.message}),r.jsx("div",{className:"mb-6 border-b border-gray-200",children:r.jsxs("div",{className:"flex space-x-8",children:[r.jsxs("button",{onClick:()=>s("flows"),className:`pb-4 px-1 border-b-2 font-medium transition-colors ${a==="flows"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Mis Flujos (",o.length,")"]}),r.jsxs("button",{onClick:()=>s("templates"),className:`pb-4 px-1 border-b-2 font-medium transition-colors ${a==="templates"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Plantillas (",u.length,")"]}),r.jsxs("button",{onClick:()=>s("whatsapp"),className:`pb-4 px-1 border-b-2 font-medium transition-colors flex items-center gap-2 ${a==="whatsapp"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp Templates"]})]})}),a==="flows"&&r.jsx("div",{children:o.length===0?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[r.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tienes flujos creados"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Comienza creando un flujo desde una plantilla"}),r.jsx("div",{className:"mt-6",children:r.jsx("button",{onClick:()=>s("templates"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Ver Plantillas"})})]}):r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estadsticas"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ltima actualizacin"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(L=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[L.name,L.is_default&&r.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"Por defecto"})]}),L.description&&r.jsx("div",{className:"text-sm text-gray-500",children:L.description})]})})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("button",{onClick:()=>I(L),className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium cursor-pointer transition-colors ${L.is_active?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:L.is_active?"Activo":"Inactivo"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsxs("span",{children:["Ejecutado: ",L.times_triggered||0," veces"]}),r.jsxs("span",{children:["Completado: ",L.times_completed||0," veces"]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:L.updated_at?du(new Date(L.updated_at),"dd MMM yyyy, HH:mm",{locale:os}):"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[r.jsx("button",{onClick:()=>t(`/flows/builder/${L.id}`),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),r.jsx("button",{onClick:()=>z(L),className:"text-gray-600 hover:text-gray-900",title:"Duplicar",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),r.jsx("button",{onClick:()=>R(L),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},L.id))})]})})}),a==="templates"&&r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(L=>r.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden border border-gray-200",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:L.name}),r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${U(L.category)}`,children:L.category})]}),r.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:L.description}),r.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-4",children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),r.jsxs("span",{children:[L.nodes_count," nodos"]})]}),L.features&&L.features.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:L.features.map(K=>r.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-50 text-purple-700 border border-purple-200",children:K},K))}),r.jsx("button",{onClick:()=>$(L.id,L.name),className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:"Crear desde esta plantilla"})]})},L.id))}),a==="whatsapp"&&r.jsxs("div",{children:[r.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),r.jsxs("select",{value:x.status,onChange:L=>b({...x,status:L.target.value}),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-green-500 focus:border-green-500",children:[r.jsx("option",{value:"",children:"Todos"}),r.jsx("option",{value:"APPROVED",children:"Aprobadas"}),r.jsx("option",{value:"PENDING",children:"Pendientes"}),r.jsx("option",{value:"REJECTED",children:"Rechazadas"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categora"}),r.jsxs("select",{value:x.category,onChange:L=>b({...x,category:L.target.value}),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-green-500 focus:border-green-500",children:[r.jsx("option",{value:"",children:"Todas"}),r.jsx("option",{value:"MARKETING",children:"Marketing"}),r.jsx("option",{value:"UTILITY",children:"Utilidad"}),r.jsx("option",{value:"AUTHENTICATION",children:"Autenticacin"})]})]}),r.jsx("div",{className:"flex-1"}),r.jsxs("div",{className:"text-sm text-gray-500",children:[m.length," plantillas encontradas"]})]}),g?r.jsxs("div",{className:"flex items-center justify-center py-12",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"}),r.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando plantillas de Meta..."})]}):m.length===0?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[r.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No se encontraron plantillas"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Ajusta los filtros o crea plantillas en Meta Business Suite"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((L,K)=>{const P=L.components?.find(re=>re.type==="BODY")?.text||"",ae={APPROVED:"bg-green-100 text-green-800",PENDING:"bg-yellow-100 text-yellow-800",REJECTED:"bg-red-100 text-red-800"},G={MARKETING:"bg-blue-100 text-blue-800",UTILITY:"bg-purple-100 text-purple-800",AUTHENTICATION:"bg-pink-100 text-pink-800"};return r.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden border border-gray-200",children:r.jsxs("div",{className:"p-5",children:[r.jsx("div",{className:"flex items-start justify-between mb-3",children:r.jsx("h3",{className:"text-base font-semibold text-gray-900 font-mono",children:L.name})}),r.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${ae[L.status]||"bg-gray-100 text-gray-800"}`,children:L.status}),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${G[L.category]||"bg-gray-100 text-gray-800"}`,children:L.category}),r.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:L.language})]}),r.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 max-h-32 overflow-y-auto",children:r.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:P.length>200?P.substring(0,200)+"...":P||"(Sin contenido)"})}),r.jsx("button",{onClick:()=>S(L),disabled:L.status!=="APPROVED",className:`w-full px-4 py-2 rounded-lg font-medium transition-colors ${L.status==="APPROVED"?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:L.status==="APPROVED"?"Probar Plantilla":"No disponible"})]})},`${L.name}-${L.language}-${K}`)})})]}),N&&r.jsx(O_,{template:N,onClose:()=>S(null)})]})}function ft(t){if(typeof t=="string"||typeof t=="number")return""+t;let a="";if(Array.isArray(t))for(let s=0,o;s<t.length;s++)(o=ft(t[s]))!==""&&(a+=(a&&" ")+o);else for(let s in t)t[s]&&(a+=(a&&" ")+s);return a}var L_={value:()=>{}};function mu(){for(var t=0,a=arguments.length,s={},o;t<a;++t){if(!(o=arguments[t]+"")||o in s||/[\s.]/.test(o))throw new Error("illegal type: "+o);s[o]=[]}return new Dc(s)}function Dc(t){this._=t}function H_(t,a){return t.trim().split(/^|\s+/).map(function(s){var o="",c=s.indexOf(".");if(c>=0&&(o=s.slice(c+1),s=s.slice(0,c)),s&&!a.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:o}})}Dc.prototype=mu.prototype={constructor:Dc,on:function(t,a){var s=this._,o=H_(t+"",s),c,u=-1,d=o.length;if(arguments.length<2){for(;++u<d;)if((c=(t=o[u]).type)&&(c=$_(s[c],t.name)))return c;return}if(a!=null&&typeof a!="function")throw new Error("invalid callback: "+a);for(;++u<d;)if(c=(t=o[u]).type)s[c]=Zx(s[c],t.name,a);else if(a==null)for(c in s)s[c]=Zx(s[c],t.name,null);return this},copy:function(){var t={},a=this._;for(var s in a)t[s]=a[s].slice();return new Dc(t)},call:function(t,a){if((c=arguments.length-2)>0)for(var s=new Array(c),o=0,c,u;o<c;++o)s[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(u=this._[t],o=0,c=u.length;o<c;++o)u[o].value.apply(a,s)},apply:function(t,a,s){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var o=this._[t],c=0,u=o.length;c<u;++c)o[c].value.apply(a,s)}};function $_(t,a){for(var s=0,o=t.length,c;s<o;++s)if((c=t[s]).name===a)return c.value}function Zx(t,a,s){for(var o=0,c=t.length;o<c;++o)if(t[o].name===a){t[o]=L_,t=t.slice(0,o).concat(t.slice(o+1));break}return s!=null&&t.push({name:a,value:s}),t}var Mh="http://www.w3.org/1999/xhtml";const Wx={svg:"http://www.w3.org/2000/svg",xhtml:Mh,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function pu(t){var a=t+="",s=a.indexOf(":");return s>=0&&(a=t.slice(0,s))!=="xmlns"&&(t=t.slice(s+1)),Wx.hasOwnProperty(a)?{space:Wx[a],local:t}:t}function q_(t){return function(){var a=this.ownerDocument,s=this.namespaceURI;return s===Mh&&a.documentElement.namespaceURI===Mh?a.createElement(t):a.createElementNS(s,t)}}function U_(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function l1(t){var a=pu(t);return(a.local?U_:q_)(a)}function V_(){}function dm(t){return t==null?V_:function(){return this.querySelector(t)}}function Y_(t){typeof t!="function"&&(t=dm(t));for(var a=this._groups,s=a.length,o=new Array(s),c=0;c<s;++c)for(var u=a[c],d=u.length,m=o[c]=new Array(d),p,g,y=0;y<d;++y)(p=u[y])&&(g=t.call(p,p.__data__,y,u))&&("__data__"in p&&(g.__data__=p.__data__),m[y]=g);return new Wt(o,this._parents)}function P_(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function I_(){return[]}function c1(t){return t==null?I_:function(){return this.querySelectorAll(t)}}function X_(t){return function(){return P_(t.apply(this,arguments))}}function G_(t){typeof t=="function"?t=X_(t):t=c1(t);for(var a=this._groups,s=a.length,o=[],c=[],u=0;u<s;++u)for(var d=a[u],m=d.length,p,g=0;g<m;++g)(p=d[g])&&(o.push(t.call(p,p.__data__,g,d)),c.push(p));return new Wt(o,c)}function u1(t){return function(){return this.matches(t)}}function d1(t){return function(a){return a.matches(t)}}var Q_=Array.prototype.find;function F_(t){return function(){return Q_.call(this.children,t)}}function Z_(){return this.firstElementChild}function W_(t){return this.select(t==null?Z_:F_(typeof t=="function"?t:d1(t)))}var K_=Array.prototype.filter;function J_(){return Array.from(this.children)}function eE(t){return function(){return K_.call(this.children,t)}}function tE(t){return this.selectAll(t==null?J_:eE(typeof t=="function"?t:d1(t)))}function nE(t){typeof t!="function"&&(t=u1(t));for(var a=this._groups,s=a.length,o=new Array(s),c=0;c<s;++c)for(var u=a[c],d=u.length,m=o[c]=[],p,g=0;g<d;++g)(p=u[g])&&t.call(p,p.__data__,g,u)&&m.push(p);return new Wt(o,this._parents)}function f1(t){return new Array(t.length)}function aE(){return new Wt(this._enter||this._groups.map(f1),this._parents)}function Xc(t,a){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=a}Xc.prototype={constructor:Xc,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,a){return this._parent.insertBefore(t,a)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function sE(t){return function(){return t}}function rE(t,a,s,o,c,u){for(var d=0,m,p=a.length,g=u.length;d<g;++d)(m=a[d])?(m.__data__=u[d],o[d]=m):s[d]=new Xc(t,u[d]);for(;d<p;++d)(m=a[d])&&(c[d]=m)}function iE(t,a,s,o,c,u,d){var m,p,g=new Map,y=a.length,x=u.length,b=new Array(y),N;for(m=0;m<y;++m)(p=a[m])&&(b[m]=N=d.call(p,p.__data__,m,a)+"",g.has(N)?c[m]=p:g.set(N,p));for(m=0;m<x;++m)N=d.call(t,u[m],m,u)+"",(p=g.get(N))?(o[m]=p,p.__data__=u[m],g.delete(N)):s[m]=new Xc(t,u[m]);for(m=0;m<y;++m)(p=a[m])&&g.get(b[m])===p&&(c[m]=p)}function oE(t){return t.__data__}function lE(t,a){if(!arguments.length)return Array.from(this,oE);var s=a?iE:rE,o=this._parents,c=this._groups;typeof t!="function"&&(t=sE(t));for(var u=c.length,d=new Array(u),m=new Array(u),p=new Array(u),g=0;g<u;++g){var y=o[g],x=c[g],b=x.length,N=cE(t.call(y,y&&y.__data__,g,o)),S=N.length,C=m[g]=new Array(S),_=d[g]=new Array(S),E=p[g]=new Array(b);s(y,x,C,_,E,N,a);for(var D=0,T=0,A,w;D<S;++D)if(A=C[D]){for(D>=T&&(T=D+1);!(w=_[T])&&++T<S;);A._next=w||null}}return d=new Wt(d,o),d._enter=m,d._exit=p,d}function cE(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function uE(){return new Wt(this._exit||this._groups.map(f1),this._parents)}function dE(t,a,s){var o=this.enter(),c=this,u=this.exit();return typeof t=="function"?(o=t(o),o&&(o=o.selection())):o=o.append(t+""),a!=null&&(c=a(c),c&&(c=c.selection())),s==null?u.remove():s(u),o&&c?o.merge(c).order():c}function fE(t){for(var a=t.selection?t.selection():t,s=this._groups,o=a._groups,c=s.length,u=o.length,d=Math.min(c,u),m=new Array(c),p=0;p<d;++p)for(var g=s[p],y=o[p],x=g.length,b=m[p]=new Array(x),N,S=0;S<x;++S)(N=g[S]||y[S])&&(b[S]=N);for(;p<c;++p)m[p]=s[p];return new Wt(m,this._parents)}function hE(){for(var t=this._groups,a=-1,s=t.length;++a<s;)for(var o=t[a],c=o.length-1,u=o[c],d;--c>=0;)(d=o[c])&&(u&&d.compareDocumentPosition(u)^4&&u.parentNode.insertBefore(d,u),u=d);return this}function mE(t){t||(t=pE);function a(x,b){return x&&b?t(x.__data__,b.__data__):!x-!b}for(var s=this._groups,o=s.length,c=new Array(o),u=0;u<o;++u){for(var d=s[u],m=d.length,p=c[u]=new Array(m),g,y=0;y<m;++y)(g=d[y])&&(p[y]=g);p.sort(a)}return new Wt(c,this._parents).order()}function pE(t,a){return t<a?-1:t>a?1:t>=a?0:NaN}function gE(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function xE(){return Array.from(this)}function yE(){for(var t=this._groups,a=0,s=t.length;a<s;++a)for(var o=t[a],c=0,u=o.length;c<u;++c){var d=o[c];if(d)return d}return null}function bE(){let t=0;for(const a of this)++t;return t}function vE(){return!this.node()}function wE(t){for(var a=this._groups,s=0,o=a.length;s<o;++s)for(var c=a[s],u=0,d=c.length,m;u<d;++u)(m=c[u])&&t.call(m,m.__data__,u,c);return this}function jE(t){return function(){this.removeAttribute(t)}}function NE(t){return function(){this.removeAttributeNS(t.space,t.local)}}function SE(t,a){return function(){this.setAttribute(t,a)}}function _E(t,a){return function(){this.setAttributeNS(t.space,t.local,a)}}function EE(t,a){return function(){var s=a.apply(this,arguments);s==null?this.removeAttribute(t):this.setAttribute(t,s)}}function CE(t,a){return function(){var s=a.apply(this,arguments);s==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,s)}}function TE(t,a){var s=pu(t);if(arguments.length<2){var o=this.node();return s.local?o.getAttributeNS(s.space,s.local):o.getAttribute(s)}return this.each((a==null?s.local?NE:jE:typeof a=="function"?s.local?CE:EE:s.local?_E:SE)(s,a))}function h1(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ME(t){return function(){this.style.removeProperty(t)}}function AE(t,a,s){return function(){this.style.setProperty(t,a,s)}}function kE(t,a,s){return function(){var o=a.apply(this,arguments);o==null?this.style.removeProperty(t):this.style.setProperty(t,o,s)}}function RE(t,a,s){return arguments.length>1?this.each((a==null?ME:typeof a=="function"?kE:AE)(t,a,s??"")):Ir(this.node(),t)}function Ir(t,a){return t.style.getPropertyValue(a)||h1(t).getComputedStyle(t,null).getPropertyValue(a)}function DE(t){return function(){delete this[t]}}function zE(t,a){return function(){this[t]=a}}function OE(t,a){return function(){var s=a.apply(this,arguments);s==null?delete this[t]:this[t]=s}}function BE(t,a){return arguments.length>1?this.each((a==null?DE:typeof a=="function"?OE:zE)(t,a)):this.node()[t]}function m1(t){return t.trim().split(/^|\s+/)}function fm(t){return t.classList||new p1(t)}function p1(t){this._node=t,this._names=m1(t.getAttribute("class")||"")}p1.prototype={add:function(t){var a=this._names.indexOf(t);a<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var a=this._names.indexOf(t);a>=0&&(this._names.splice(a,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function g1(t,a){for(var s=fm(t),o=-1,c=a.length;++o<c;)s.add(a[o])}function x1(t,a){for(var s=fm(t),o=-1,c=a.length;++o<c;)s.remove(a[o])}function LE(t){return function(){g1(this,t)}}function HE(t){return function(){x1(this,t)}}function $E(t,a){return function(){(a.apply(this,arguments)?g1:x1)(this,t)}}function qE(t,a){var s=m1(t+"");if(arguments.length<2){for(var o=fm(this.node()),c=-1,u=s.length;++c<u;)if(!o.contains(s[c]))return!1;return!0}return this.each((typeof a=="function"?$E:a?LE:HE)(s,a))}function UE(){this.textContent=""}function VE(t){return function(){this.textContent=t}}function YE(t){return function(){var a=t.apply(this,arguments);this.textContent=a??""}}function PE(t){return arguments.length?this.each(t==null?UE:(typeof t=="function"?YE:VE)(t)):this.node().textContent}function IE(){this.innerHTML=""}function XE(t){return function(){this.innerHTML=t}}function GE(t){return function(){var a=t.apply(this,arguments);this.innerHTML=a??""}}function QE(t){return arguments.length?this.each(t==null?IE:(typeof t=="function"?GE:XE)(t)):this.node().innerHTML}function FE(){this.nextSibling&&this.parentNode.appendChild(this)}function ZE(){return this.each(FE)}function WE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function KE(){return this.each(WE)}function JE(t){var a=typeof t=="function"?t:l1(t);return this.select(function(){return this.appendChild(a.apply(this,arguments))})}function e6(){return null}function t6(t,a){var s=typeof t=="function"?t:l1(t),o=a==null?e6:typeof a=="function"?a:dm(a);return this.select(function(){return this.insertBefore(s.apply(this,arguments),o.apply(this,arguments)||null)})}function n6(){var t=this.parentNode;t&&t.removeChild(this)}function a6(){return this.each(n6)}function s6(){var t=this.cloneNode(!1),a=this.parentNode;return a?a.insertBefore(t,this.nextSibling):t}function r6(){var t=this.cloneNode(!0),a=this.parentNode;return a?a.insertBefore(t,this.nextSibling):t}function i6(t){return this.select(t?r6:s6)}function o6(t){return arguments.length?this.property("__data__",t):this.node().__data__}function l6(t){return function(a){t.call(this,a,this.__data__)}}function c6(t){return t.trim().split(/^|\s+/).map(function(a){var s="",o=a.indexOf(".");return o>=0&&(s=a.slice(o+1),a=a.slice(0,o)),{type:a,name:s}})}function u6(t){return function(){var a=this.__on;if(a){for(var s=0,o=-1,c=a.length,u;s<c;++s)u=a[s],(!t.type||u.type===t.type)&&u.name===t.name?this.removeEventListener(u.type,u.listener,u.options):a[++o]=u;++o?a.length=o:delete this.__on}}}function d6(t,a,s){return function(){var o=this.__on,c,u=l6(a);if(o){for(var d=0,m=o.length;d<m;++d)if((c=o[d]).type===t.type&&c.name===t.name){this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=u,c.options=s),c.value=a;return}}this.addEventListener(t.type,u,s),c={type:t.type,name:t.name,value:a,listener:u,options:s},o?o.push(c):this.__on=[c]}}function f6(t,a,s){var o=c6(t+""),c,u=o.length,d;if(arguments.length<2){var m=this.node().__on;if(m){for(var p=0,g=m.length,y;p<g;++p)for(c=0,y=m[p];c<u;++c)if((d=o[c]).type===y.type&&d.name===y.name)return y.value}return}for(m=a?d6:u6,c=0;c<u;++c)this.each(m(o[c],a,s));return this}function y1(t,a,s){var o=h1(t),c=o.CustomEvent;typeof c=="function"?c=new c(a,s):(c=o.document.createEvent("Event"),s?(c.initEvent(a,s.bubbles,s.cancelable),c.detail=s.detail):c.initEvent(a,!1,!1)),t.dispatchEvent(c)}function h6(t,a){return function(){return y1(this,t,a)}}function m6(t,a){return function(){return y1(this,t,a.apply(this,arguments))}}function p6(t,a){return this.each((typeof a=="function"?m6:h6)(t,a))}function*g6(){for(var t=this._groups,a=0,s=t.length;a<s;++a)for(var o=t[a],c=0,u=o.length,d;c<u;++c)(d=o[c])&&(yield d)}var b1=[null];function Wt(t,a){this._groups=t,this._parents=a}function Do(){return new Wt([[document.documentElement]],b1)}function x6(){return this}Wt.prototype=Do.prototype={constructor:Wt,select:Y_,selectAll:G_,selectChild:W_,selectChildren:tE,filter:nE,data:lE,enter:aE,exit:uE,join:dE,merge:fE,selection:x6,order:hE,sort:mE,call:gE,nodes:xE,node:yE,size:bE,empty:vE,each:wE,attr:TE,style:RE,property:BE,classed:qE,text:PE,html:QE,raise:ZE,lower:KE,append:JE,insert:t6,remove:a6,clone:i6,datum:o6,on:f6,dispatch:p6,[Symbol.iterator]:g6};function Ft(t){return typeof t=="string"?new Wt([[document.querySelector(t)]],[document.documentElement]):new Wt([[t]],b1)}function y6(t){let a;for(;a=t.sourceEvent;)t=a;return t}function wn(t,a){if(t=y6(t),a===void 0&&(a=t.currentTarget),a){var s=a.ownerSVGElement||a;if(s.createSVGPoint){var o=s.createSVGPoint();return o.x=t.clientX,o.y=t.clientY,o=o.matrixTransform(a.getScreenCTM().inverse()),[o.x,o.y]}if(a.getBoundingClientRect){var c=a.getBoundingClientRect();return[t.clientX-c.left-a.clientLeft,t.clientY-c.top-a.clientTop]}}return[t.pageX,t.pageY]}const b6={passive:!1},xo={capture:!0,passive:!1};function th(t){t.stopImmediatePropagation()}function Hr(t){t.preventDefault(),t.stopImmediatePropagation()}function v1(t){var a=t.document.documentElement,s=Ft(t).on("dragstart.drag",Hr,xo);"onselectstart"in a?s.on("selectstart.drag",Hr,xo):(a.__noselect=a.style.MozUserSelect,a.style.MozUserSelect="none")}function w1(t,a){var s=t.document.documentElement,o=Ft(t).on("dragstart.drag",null);a&&(o.on("click.drag",Hr,xo),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in s?o.on("selectstart.drag",null):(s.style.MozUserSelect=s.__noselect,delete s.__noselect)}const mc=t=>()=>t;function Ah(t,{sourceEvent:a,subject:s,target:o,identifier:c,active:u,x:d,y:m,dx:p,dy:g,dispatch:y}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:a,enumerable:!0,configurable:!0},subject:{value:s,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:c,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:d,enumerable:!0,configurable:!0},y:{value:m,enumerable:!0,configurable:!0},dx:{value:p,enumerable:!0,configurable:!0},dy:{value:g,enumerable:!0,configurable:!0},_:{value:y}})}Ah.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function v6(t){return!t.ctrlKey&&!t.button}function w6(){return this.parentNode}function j6(t,a){return a??{x:t.x,y:t.y}}function N6(){return navigator.maxTouchPoints||"ontouchstart"in this}function j1(){var t=v6,a=w6,s=j6,o=N6,c={},u=mu("start","drag","end"),d=0,m,p,g,y,x=0;function b(A){A.on("mousedown.drag",N).filter(o).on("touchstart.drag",_).on("touchmove.drag",E,b6).on("touchend.drag touchcancel.drag",D).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function N(A,w){if(!(y||!t.call(this,A,w))){var O=T(this,a.call(this,A,w),A,w,"mouse");O&&(Ft(A.view).on("mousemove.drag",S,xo).on("mouseup.drag",C,xo),v1(A.view),th(A),g=!1,m=A.clientX,p=A.clientY,O("start",A))}}function S(A){if(Hr(A),!g){var w=A.clientX-m,O=A.clientY-p;g=w*w+O*O>x}c.mouse("drag",A)}function C(A){Ft(A.view).on("mousemove.drag mouseup.drag",null),w1(A.view,g),Hr(A),c.mouse("end",A)}function _(A,w){if(t.call(this,A,w)){var O=A.changedTouches,M=a.call(this,A,w),q=O.length,H,F;for(H=0;H<q;++H)(F=T(this,M,A,w,O[H].identifier,O[H]))&&(th(A),F("start",A,O[H]))}}function E(A){var w=A.changedTouches,O=w.length,M,q;for(M=0;M<O;++M)(q=c[w[M].identifier])&&(Hr(A),q("drag",A,w[M]))}function D(A){var w=A.changedTouches,O=w.length,M,q;for(y&&clearTimeout(y),y=setTimeout(function(){y=null},500),M=0;M<O;++M)(q=c[w[M].identifier])&&(th(A),q("end",A,w[M]))}function T(A,w,O,M,q,H){var F=u.copy(),Q=wn(H||O,w),Z,ne,$;if(($=s.call(A,new Ah("beforestart",{sourceEvent:O,target:b,identifier:q,active:d,x:Q[0],y:Q[1],dx:0,dy:0,dispatch:F}),M))!=null)return Z=$.x-Q[0]||0,ne=$.y-Q[1]||0,function I(z,R,U){var L=Q,K;switch(z){case"start":c[q]=I,K=d++;break;case"end":delete c[q],--d;case"drag":Q=wn(U||R,w),K=d;break}F.call(z,A,new Ah(z,{sourceEvent:R,subject:$,target:b,identifier:q,active:K,x:Q[0]+Z,y:Q[1]+ne,dx:Q[0]-L[0],dy:Q[1]-L[1],dispatch:F}),M)}}return b.filter=function(A){return arguments.length?(t=typeof A=="function"?A:mc(!!A),b):t},b.container=function(A){return arguments.length?(a=typeof A=="function"?A:mc(A),b):a},b.subject=function(A){return arguments.length?(s=typeof A=="function"?A:mc(A),b):s},b.touchable=function(A){return arguments.length?(o=typeof A=="function"?A:mc(!!A),b):o},b.on=function(){var A=u.on.apply(u,arguments);return A===u?b:A},b.clickDistance=function(A){return arguments.length?(x=(A=+A)*A,b):Math.sqrt(x)},b}function hm(t,a,s){t.prototype=a.prototype=s,s.constructor=t}function N1(t,a){var s=Object.create(t.prototype);for(var o in a)s[o]=a[o];return s}function zo(){}var yo=.7,Gc=1/yo,$r="\\s*([+-]?\\d+)\\s*",bo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",S6=/^#([0-9a-f]{3,8})$/,_6=new RegExp(`^rgb\\(${$r},${$r},${$r}\\)$`),E6=new RegExp(`^rgb\\(${$n},${$n},${$n}\\)$`),C6=new RegExp(`^rgba\\(${$r},${$r},${$r},${bo}\\)$`),T6=new RegExp(`^rgba\\(${$n},${$n},${$n},${bo}\\)$`),M6=new RegExp(`^hsl\\(${bo},${$n},${$n}\\)$`),A6=new RegExp(`^hsla\\(${bo},${$n},${$n},${bo}\\)$`),Kx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};hm(zo,qs,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Jx,formatHex:Jx,formatHex8:k6,formatHsl:R6,formatRgb:ey,toString:ey});function Jx(){return this.rgb().formatHex()}function k6(){return this.rgb().formatHex8()}function R6(){return S1(this).formatHsl()}function ey(){return this.rgb().formatRgb()}function qs(t){var a,s;return t=(t+"").trim().toLowerCase(),(a=S6.exec(t))?(s=a[1].length,a=parseInt(a[1],16),s===6?ty(a):s===3?new $t(a>>8&15|a>>4&240,a>>4&15|a&240,(a&15)<<4|a&15,1):s===8?pc(a>>24&255,a>>16&255,a>>8&255,(a&255)/255):s===4?pc(a>>12&15|a>>8&240,a>>8&15|a>>4&240,a>>4&15|a&240,((a&15)<<4|a&15)/255):null):(a=_6.exec(t))?new $t(a[1],a[2],a[3],1):(a=E6.exec(t))?new $t(a[1]*255/100,a[2]*255/100,a[3]*255/100,1):(a=C6.exec(t))?pc(a[1],a[2],a[3],a[4]):(a=T6.exec(t))?pc(a[1]*255/100,a[2]*255/100,a[3]*255/100,a[4]):(a=M6.exec(t))?sy(a[1],a[2]/100,a[3]/100,1):(a=A6.exec(t))?sy(a[1],a[2]/100,a[3]/100,a[4]):Kx.hasOwnProperty(t)?ty(Kx[t]):t==="transparent"?new $t(NaN,NaN,NaN,0):null}function ty(t){return new $t(t>>16&255,t>>8&255,t&255,1)}function pc(t,a,s,o){return o<=0&&(t=a=s=NaN),new $t(t,a,s,o)}function D6(t){return t instanceof zo||(t=qs(t)),t?(t=t.rgb(),new $t(t.r,t.g,t.b,t.opacity)):new $t}function kh(t,a,s,o){return arguments.length===1?D6(t):new $t(t,a,s,o??1)}function $t(t,a,s,o){this.r=+t,this.g=+a,this.b=+s,this.opacity=+o}hm($t,kh,N1(zo,{brighter(t){return t=t==null?Gc:Math.pow(Gc,t),new $t(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?yo:Math.pow(yo,t),new $t(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new $t(Hs(this.r),Hs(this.g),Hs(this.b),Qc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ny,formatHex:ny,formatHex8:z6,formatRgb:ay,toString:ay}));function ny(){return`#${Bs(this.r)}${Bs(this.g)}${Bs(this.b)}`}function z6(){return`#${Bs(this.r)}${Bs(this.g)}${Bs(this.b)}${Bs((isNaN(this.opacity)?1:this.opacity)*255)}`}function ay(){const t=Qc(this.opacity);return`${t===1?"rgb(":"rgba("}${Hs(this.r)}, ${Hs(this.g)}, ${Hs(this.b)}${t===1?")":`, ${t})`}`}function Qc(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Hs(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Bs(t){return t=Hs(t),(t<16?"0":"")+t.toString(16)}function sy(t,a,s,o){return o<=0?t=a=s=NaN:s<=0||s>=1?t=a=NaN:a<=0&&(t=NaN),new jn(t,a,s,o)}function S1(t){if(t instanceof jn)return new jn(t.h,t.s,t.l,t.opacity);if(t instanceof zo||(t=qs(t)),!t)return new jn;if(t instanceof jn)return t;t=t.rgb();var a=t.r/255,s=t.g/255,o=t.b/255,c=Math.min(a,s,o),u=Math.max(a,s,o),d=NaN,m=u-c,p=(u+c)/2;return m?(a===u?d=(s-o)/m+(s<o)*6:s===u?d=(o-a)/m+2:d=(a-s)/m+4,m/=p<.5?u+c:2-u-c,d*=60):m=p>0&&p<1?0:d,new jn(d,m,p,t.opacity)}function O6(t,a,s,o){return arguments.length===1?S1(t):new jn(t,a,s,o??1)}function jn(t,a,s,o){this.h=+t,this.s=+a,this.l=+s,this.opacity=+o}hm(jn,O6,N1(zo,{brighter(t){return t=t==null?Gc:Math.pow(Gc,t),new jn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?yo:Math.pow(yo,t),new jn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,a=isNaN(t)||isNaN(this.s)?0:this.s,s=this.l,o=s+(s<.5?s:1-s)*a,c=2*s-o;return new $t(nh(t>=240?t-240:t+120,c,o),nh(t,c,o),nh(t<120?t+240:t-120,c,o),this.opacity)},clamp(){return new jn(ry(this.h),gc(this.s),gc(this.l),Qc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qc(this.opacity);return`${t===1?"hsl(":"hsla("}${ry(this.h)}, ${gc(this.s)*100}%, ${gc(this.l)*100}%${t===1?")":`, ${t})`}`}}));function ry(t){return t=(t||0)%360,t<0?t+360:t}function gc(t){return Math.max(0,Math.min(1,t||0))}function nh(t,a,s){return(t<60?a+(s-a)*t/60:t<180?s:t<240?a+(s-a)*(240-t)/60:a)*255}const mm=t=>()=>t;function B6(t,a){return function(s){return t+s*a}}function L6(t,a,s){return t=Math.pow(t,s),a=Math.pow(a,s)-t,s=1/s,function(o){return Math.pow(t+o*a,s)}}function H6(t){return(t=+t)==1?_1:function(a,s){return s-a?L6(a,s,t):mm(isNaN(a)?s:a)}}function _1(t,a){var s=a-t;return s?B6(t,s):mm(isNaN(t)?a:t)}const Fc=(function t(a){var s=H6(a);function o(c,u){var d=s((c=kh(c)).r,(u=kh(u)).r),m=s(c.g,u.g),p=s(c.b,u.b),g=_1(c.opacity,u.opacity);return function(y){return c.r=d(y),c.g=m(y),c.b=p(y),c.opacity=g(y),c+""}}return o.gamma=t,o})(1);function $6(t,a){a||(a=[]);var s=t?Math.min(a.length,t.length):0,o=a.slice(),c;return function(u){for(c=0;c<s;++c)o[c]=t[c]*(1-u)+a[c]*u;return o}}function q6(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function U6(t,a){var s=a?a.length:0,o=t?Math.min(s,t.length):0,c=new Array(o),u=new Array(s),d;for(d=0;d<o;++d)c[d]=ho(t[d],a[d]);for(;d<s;++d)u[d]=a[d];return function(m){for(d=0;d<o;++d)u[d]=c[d](m);return u}}function V6(t,a){var s=new Date;return t=+t,a=+a,function(o){return s.setTime(t*(1-o)+a*o),s}}function zn(t,a){return t=+t,a=+a,function(s){return t*(1-s)+a*s}}function Y6(t,a){var s={},o={},c;(t===null||typeof t!="object")&&(t={}),(a===null||typeof a!="object")&&(a={});for(c in a)c in t?s[c]=ho(t[c],a[c]):o[c]=a[c];return function(u){for(c in s)o[c]=s[c](u);return o}}var Rh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ah=new RegExp(Rh.source,"g");function P6(t){return function(){return t}}function I6(t){return function(a){return t(a)+""}}function E1(t,a){var s=Rh.lastIndex=ah.lastIndex=0,o,c,u,d=-1,m=[],p=[];for(t=t+"",a=a+"";(o=Rh.exec(t))&&(c=ah.exec(a));)(u=c.index)>s&&(u=a.slice(s,u),m[d]?m[d]+=u:m[++d]=u),(o=o[0])===(c=c[0])?m[d]?m[d]+=c:m[++d]=c:(m[++d]=null,p.push({i:d,x:zn(o,c)})),s=ah.lastIndex;return s<a.length&&(u=a.slice(s),m[d]?m[d]+=u:m[++d]=u),m.length<2?p[0]?I6(p[0].x):P6(a):(a=p.length,function(g){for(var y=0,x;y<a;++y)m[(x=p[y]).i]=x.x(g);return m.join("")})}function ho(t,a){var s=typeof a,o;return a==null||s==="boolean"?mm(a):(s==="number"?zn:s==="string"?(o=qs(a))?(a=o,Fc):E1:a instanceof qs?Fc:a instanceof Date?V6:q6(a)?$6:Array.isArray(a)?U6:typeof a.valueOf!="function"&&typeof a.toString!="function"||isNaN(a)?Y6:zn)(t,a)}var iy=180/Math.PI,Dh={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function C1(t,a,s,o,c,u){var d,m,p;return(d=Math.sqrt(t*t+a*a))&&(t/=d,a/=d),(p=t*s+a*o)&&(s-=t*p,o-=a*p),(m=Math.sqrt(s*s+o*o))&&(s/=m,o/=m,p/=m),t*o<a*s&&(t=-t,a=-a,p=-p,d=-d),{translateX:c,translateY:u,rotate:Math.atan2(a,t)*iy,skewX:Math.atan(p)*iy,scaleX:d,scaleY:m}}var xc;function X6(t){const a=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return a.isIdentity?Dh:C1(a.a,a.b,a.c,a.d,a.e,a.f)}function G6(t){return t==null||(xc||(xc=document.createElementNS("http://www.w3.org/2000/svg","g")),xc.setAttribute("transform",t),!(t=xc.transform.baseVal.consolidate()))?Dh:(t=t.matrix,C1(t.a,t.b,t.c,t.d,t.e,t.f))}function T1(t,a,s,o){function c(g){return g.length?g.pop()+" ":""}function u(g,y,x,b,N,S){if(g!==x||y!==b){var C=N.push("translate(",null,a,null,s);S.push({i:C-4,x:zn(g,x)},{i:C-2,x:zn(y,b)})}else(x||b)&&N.push("translate("+x+a+b+s)}function d(g,y,x,b){g!==y?(g-y>180?y+=360:y-g>180&&(g+=360),b.push({i:x.push(c(x)+"rotate(",null,o)-2,x:zn(g,y)})):y&&x.push(c(x)+"rotate("+y+o)}function m(g,y,x,b){g!==y?b.push({i:x.push(c(x)+"skewX(",null,o)-2,x:zn(g,y)}):y&&x.push(c(x)+"skewX("+y+o)}function p(g,y,x,b,N,S){if(g!==x||y!==b){var C=N.push(c(N)+"scale(",null,",",null,")");S.push({i:C-4,x:zn(g,x)},{i:C-2,x:zn(y,b)})}else(x!==1||b!==1)&&N.push(c(N)+"scale("+x+","+b+")")}return function(g,y){var x=[],b=[];return g=t(g),y=t(y),u(g.translateX,g.translateY,y.translateX,y.translateY,x,b),d(g.rotate,y.rotate,x,b),m(g.skewX,y.skewX,x,b),p(g.scaleX,g.scaleY,y.scaleX,y.scaleY,x,b),g=y=null,function(N){for(var S=-1,C=b.length,_;++S<C;)x[(_=b[S]).i]=_.x(N);return x.join("")}}}var Q6=T1(X6,"px, ","px)","deg)"),F6=T1(G6,", ",")",")"),Z6=1e-12;function oy(t){return((t=Math.exp(t))+1/t)/2}function W6(t){return((t=Math.exp(t))-1/t)/2}function K6(t){return((t=Math.exp(2*t))-1)/(t+1)}const zc=(function t(a,s,o){function c(u,d){var m=u[0],p=u[1],g=u[2],y=d[0],x=d[1],b=d[2],N=y-m,S=x-p,C=N*N+S*S,_,E;if(C<Z6)E=Math.log(b/g)/a,_=function(M){return[m+M*N,p+M*S,g*Math.exp(a*M*E)]};else{var D=Math.sqrt(C),T=(b*b-g*g+o*C)/(2*g*s*D),A=(b*b-g*g-o*C)/(2*b*s*D),w=Math.log(Math.sqrt(T*T+1)-T),O=Math.log(Math.sqrt(A*A+1)-A);E=(O-w)/a,_=function(M){var q=M*E,H=oy(w),F=g/(s*D)*(H*K6(a*q+w)-W6(w));return[m+F*N,p+F*S,g*H/oy(a*q+w)]}}return _.duration=E*1e3*a/Math.SQRT2,_}return c.rho=function(u){var d=Math.max(.001,+u),m=d*d,p=m*m;return t(d,m,p)},c})(Math.SQRT2,2,4);var Xr=0,uo=0,ro=0,M1=1e3,Zc,fo,Wc=0,Us=0,gu=0,vo=typeof performance=="object"&&performance.now?performance:Date,A1=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function pm(){return Us||(A1(J6),Us=vo.now()+gu)}function J6(){Us=0}function Kc(){this._call=this._time=this._next=null}Kc.prototype=k1.prototype={constructor:Kc,restart:function(t,a,s){if(typeof t!="function")throw new TypeError("callback is not a function");s=(s==null?pm():+s)+(a==null?0:+a),!this._next&&fo!==this&&(fo?fo._next=this:Zc=this,fo=this),this._call=t,this._time=s,zh()},stop:function(){this._call&&(this._call=null,this._time=1/0,zh())}};function k1(t,a,s){var o=new Kc;return o.restart(t,a,s),o}function eC(){pm(),++Xr;for(var t=Zc,a;t;)(a=Us-t._time)>=0&&t._call.call(void 0,a),t=t._next;--Xr}function ly(){Us=(Wc=vo.now())+gu,Xr=uo=0;try{eC()}finally{Xr=0,nC(),Us=0}}function tC(){var t=vo.now(),a=t-Wc;a>M1&&(gu-=a,Wc=t)}function nC(){for(var t,a=Zc,s,o=1/0;a;)a._call?(o>a._time&&(o=a._time),t=a,a=a._next):(s=a._next,a._next=null,a=t?t._next=s:Zc=s);fo=t,zh(o)}function zh(t){if(!Xr){uo&&(uo=clearTimeout(uo));var a=t-Us;a>24?(t<1/0&&(uo=setTimeout(ly,t-vo.now()-gu)),ro&&(ro=clearInterval(ro))):(ro||(Wc=vo.now(),ro=setInterval(tC,M1)),Xr=1,A1(ly))}}function cy(t,a,s){var o=new Kc;return a=a==null?0:+a,o.restart(c=>{o.stop(),t(c+a)},a,s),o}var aC=mu("start","end","cancel","interrupt"),sC=[],R1=0,uy=1,Oh=2,Oc=3,dy=4,Bh=5,Bc=6;function xu(t,a,s,o,c,u){var d=t.__transition;if(!d)t.__transition={};else if(s in d)return;rC(t,s,{name:a,index:o,group:c,on:aC,tween:sC,time:u.time,delay:u.delay,duration:u.duration,ease:u.ease,timer:null,state:R1})}function gm(t,a){var s=_n(t,a);if(s.state>R1)throw new Error("too late; already scheduled");return s}function Yn(t,a){var s=_n(t,a);if(s.state>Oc)throw new Error("too late; already running");return s}function _n(t,a){var s=t.__transition;if(!s||!(s=s[a]))throw new Error("transition not found");return s}function rC(t,a,s){var o=t.__transition,c;o[a]=s,s.timer=k1(u,0,s.time);function u(g){s.state=uy,s.timer.restart(d,s.delay,s.time),s.delay<=g&&d(g-s.delay)}function d(g){var y,x,b,N;if(s.state!==uy)return p();for(y in o)if(N=o[y],N.name===s.name){if(N.state===Oc)return cy(d);N.state===dy?(N.state=Bc,N.timer.stop(),N.on.call("interrupt",t,t.__data__,N.index,N.group),delete o[y]):+y<a&&(N.state=Bc,N.timer.stop(),N.on.call("cancel",t,t.__data__,N.index,N.group),delete o[y])}if(cy(function(){s.state===Oc&&(s.state=dy,s.timer.restart(m,s.delay,s.time),m(g))}),s.state=Oh,s.on.call("start",t,t.__data__,s.index,s.group),s.state===Oh){for(s.state=Oc,c=new Array(b=s.tween.length),y=0,x=-1;y<b;++y)(N=s.tween[y].value.call(t,t.__data__,s.index,s.group))&&(c[++x]=N);c.length=x+1}}function m(g){for(var y=g<s.duration?s.ease.call(null,g/s.duration):(s.timer.restart(p),s.state=Bh,1),x=-1,b=c.length;++x<b;)c[x].call(t,y);s.state===Bh&&(s.on.call("end",t,t.__data__,s.index,s.group),p())}function p(){s.state=Bc,s.timer.stop(),delete o[a];for(var g in o)return;delete t.__transition}}function Lc(t,a){var s=t.__transition,o,c,u=!0,d;if(s){a=a==null?null:a+"";for(d in s){if((o=s[d]).name!==a){u=!1;continue}c=o.state>Oh&&o.state<Bh,o.state=Bc,o.timer.stop(),o.on.call(c?"interrupt":"cancel",t,t.__data__,o.index,o.group),delete s[d]}u&&delete t.__transition}}function iC(t){return this.each(function(){Lc(this,t)})}function oC(t,a){var s,o;return function(){var c=Yn(this,t),u=c.tween;if(u!==s){o=s=u;for(var d=0,m=o.length;d<m;++d)if(o[d].name===a){o=o.slice(),o.splice(d,1);break}}c.tween=o}}function lC(t,a,s){var o,c;if(typeof s!="function")throw new Error;return function(){var u=Yn(this,t),d=u.tween;if(d!==o){c=(o=d).slice();for(var m={name:a,value:s},p=0,g=c.length;p<g;++p)if(c[p].name===a){c[p]=m;break}p===g&&c.push(m)}u.tween=c}}function cC(t,a){var s=this._id;if(t+="",arguments.length<2){for(var o=_n(this.node(),s).tween,c=0,u=o.length,d;c<u;++c)if((d=o[c]).name===t)return d.value;return null}return this.each((a==null?oC:lC)(s,t,a))}function xm(t,a,s){var o=t._id;return t.each(function(){var c=Yn(this,o);(c.value||(c.value={}))[a]=s.apply(this,arguments)}),function(c){return _n(c,o).value[a]}}function D1(t,a){var s;return(typeof a=="number"?zn:a instanceof qs?Fc:(s=qs(a))?(a=s,Fc):E1)(t,a)}function uC(t){return function(){this.removeAttribute(t)}}function dC(t){return function(){this.removeAttributeNS(t.space,t.local)}}function fC(t,a,s){var o,c=s+"",u;return function(){var d=this.getAttribute(t);return d===c?null:d===o?u:u=a(o=d,s)}}function hC(t,a,s){var o,c=s+"",u;return function(){var d=this.getAttributeNS(t.space,t.local);return d===c?null:d===o?u:u=a(o=d,s)}}function mC(t,a,s){var o,c,u;return function(){var d,m=s(this),p;return m==null?void this.removeAttribute(t):(d=this.getAttribute(t),p=m+"",d===p?null:d===o&&p===c?u:(c=p,u=a(o=d,m)))}}function pC(t,a,s){var o,c,u;return function(){var d,m=s(this),p;return m==null?void this.removeAttributeNS(t.space,t.local):(d=this.getAttributeNS(t.space,t.local),p=m+"",d===p?null:d===o&&p===c?u:(c=p,u=a(o=d,m)))}}function gC(t,a){var s=pu(t),o=s==="transform"?F6:D1;return this.attrTween(t,typeof a=="function"?(s.local?pC:mC)(s,o,xm(this,"attr."+t,a)):a==null?(s.local?dC:uC)(s):(s.local?hC:fC)(s,o,a))}function xC(t,a){return function(s){this.setAttribute(t,a.call(this,s))}}function yC(t,a){return function(s){this.setAttributeNS(t.space,t.local,a.call(this,s))}}function bC(t,a){var s,o;function c(){var u=a.apply(this,arguments);return u!==o&&(s=(o=u)&&yC(t,u)),s}return c._value=a,c}function vC(t,a){var s,o;function c(){var u=a.apply(this,arguments);return u!==o&&(s=(o=u)&&xC(t,u)),s}return c._value=a,c}function wC(t,a){var s="attr."+t;if(arguments.length<2)return(s=this.tween(s))&&s._value;if(a==null)return this.tween(s,null);if(typeof a!="function")throw new Error;var o=pu(t);return this.tween(s,(o.local?bC:vC)(o,a))}function jC(t,a){return function(){gm(this,t).delay=+a.apply(this,arguments)}}function NC(t,a){return a=+a,function(){gm(this,t).delay=a}}function SC(t){var a=this._id;return arguments.length?this.each((typeof t=="function"?jC:NC)(a,t)):_n(this.node(),a).delay}function _C(t,a){return function(){Yn(this,t).duration=+a.apply(this,arguments)}}function EC(t,a){return a=+a,function(){Yn(this,t).duration=a}}function CC(t){var a=this._id;return arguments.length?this.each((typeof t=="function"?_C:EC)(a,t)):_n(this.node(),a).duration}function TC(t,a){if(typeof a!="function")throw new Error;return function(){Yn(this,t).ease=a}}function MC(t){var a=this._id;return arguments.length?this.each(TC(a,t)):_n(this.node(),a).ease}function AC(t,a){return function(){var s=a.apply(this,arguments);if(typeof s!="function")throw new Error;Yn(this,t).ease=s}}function kC(t){if(typeof t!="function")throw new Error;return this.each(AC(this._id,t))}function RC(t){typeof t!="function"&&(t=u1(t));for(var a=this._groups,s=a.length,o=new Array(s),c=0;c<s;++c)for(var u=a[c],d=u.length,m=o[c]=[],p,g=0;g<d;++g)(p=u[g])&&t.call(p,p.__data__,g,u)&&m.push(p);return new va(o,this._parents,this._name,this._id)}function DC(t){if(t._id!==this._id)throw new Error;for(var a=this._groups,s=t._groups,o=a.length,c=s.length,u=Math.min(o,c),d=new Array(o),m=0;m<u;++m)for(var p=a[m],g=s[m],y=p.length,x=d[m]=new Array(y),b,N=0;N<y;++N)(b=p[N]||g[N])&&(x[N]=b);for(;m<o;++m)d[m]=a[m];return new va(d,this._parents,this._name,this._id)}function zC(t){return(t+"").trim().split(/^|\s+/).every(function(a){var s=a.indexOf(".");return s>=0&&(a=a.slice(0,s)),!a||a==="start"})}function OC(t,a,s){var o,c,u=zC(a)?gm:Yn;return function(){var d=u(this,t),m=d.on;m!==o&&(c=(o=m).copy()).on(a,s),d.on=c}}function BC(t,a){var s=this._id;return arguments.length<2?_n(this.node(),s).on.on(t):this.each(OC(s,t,a))}function LC(t){return function(){var a=this.parentNode;for(var s in this.__transition)if(+s!==t)return;a&&a.removeChild(this)}}function HC(){return this.on("end.remove",LC(this._id))}function $C(t){var a=this._name,s=this._id;typeof t!="function"&&(t=dm(t));for(var o=this._groups,c=o.length,u=new Array(c),d=0;d<c;++d)for(var m=o[d],p=m.length,g=u[d]=new Array(p),y,x,b=0;b<p;++b)(y=m[b])&&(x=t.call(y,y.__data__,b,m))&&("__data__"in y&&(x.__data__=y.__data__),g[b]=x,xu(g[b],a,s,b,g,_n(y,s)));return new va(u,this._parents,a,s)}function qC(t){var a=this._name,s=this._id;typeof t!="function"&&(t=c1(t));for(var o=this._groups,c=o.length,u=[],d=[],m=0;m<c;++m)for(var p=o[m],g=p.length,y,x=0;x<g;++x)if(y=p[x]){for(var b=t.call(y,y.__data__,x,p),N,S=_n(y,s),C=0,_=b.length;C<_;++C)(N=b[C])&&xu(N,a,s,C,b,S);u.push(b),d.push(y)}return new va(u,d,a,s)}var UC=Do.prototype.constructor;function VC(){return new UC(this._groups,this._parents)}function YC(t,a){var s,o,c;return function(){var u=Ir(this,t),d=(this.style.removeProperty(t),Ir(this,t));return u===d?null:u===s&&d===o?c:c=a(s=u,o=d)}}function z1(t){return function(){this.style.removeProperty(t)}}function PC(t,a,s){var o,c=s+"",u;return function(){var d=Ir(this,t);return d===c?null:d===o?u:u=a(o=d,s)}}function IC(t,a,s){var o,c,u;return function(){var d=Ir(this,t),m=s(this),p=m+"";return m==null&&(p=m=(this.style.removeProperty(t),Ir(this,t))),d===p?null:d===o&&p===c?u:(c=p,u=a(o=d,m))}}function XC(t,a){var s,o,c,u="style."+a,d="end."+u,m;return function(){var p=Yn(this,t),g=p.on,y=p.value[u]==null?m||(m=z1(a)):void 0;(g!==s||c!==y)&&(o=(s=g).copy()).on(d,c=y),p.on=o}}function GC(t,a,s){var o=(t+="")=="transform"?Q6:D1;return a==null?this.styleTween(t,YC(t,o)).on("end.style."+t,z1(t)):typeof a=="function"?this.styleTween(t,IC(t,o,xm(this,"style."+t,a))).each(XC(this._id,t)):this.styleTween(t,PC(t,o,a),s).on("end.style."+t,null)}function QC(t,a,s){return function(o){this.style.setProperty(t,a.call(this,o),s)}}function FC(t,a,s){var o,c;function u(){var d=a.apply(this,arguments);return d!==c&&(o=(c=d)&&QC(t,d,s)),o}return u._value=a,u}function ZC(t,a,s){var o="style."+(t+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(a==null)return this.tween(o,null);if(typeof a!="function")throw new Error;return this.tween(o,FC(t,a,s??""))}function WC(t){return function(){this.textContent=t}}function KC(t){return function(){var a=t(this);this.textContent=a??""}}function JC(t){return this.tween("text",typeof t=="function"?KC(xm(this,"text",t)):WC(t==null?"":t+""))}function e8(t){return function(a){this.textContent=t.call(this,a)}}function t8(t){var a,s;function o(){var c=t.apply(this,arguments);return c!==s&&(a=(s=c)&&e8(c)),a}return o._value=t,o}function n8(t){var a="text";if(arguments.length<1)return(a=this.tween(a))&&a._value;if(t==null)return this.tween(a,null);if(typeof t!="function")throw new Error;return this.tween(a,t8(t))}function a8(){for(var t=this._name,a=this._id,s=O1(),o=this._groups,c=o.length,u=0;u<c;++u)for(var d=o[u],m=d.length,p,g=0;g<m;++g)if(p=d[g]){var y=_n(p,a);xu(p,t,s,g,d,{time:y.time+y.delay+y.duration,delay:0,duration:y.duration,ease:y.ease})}return new va(o,this._parents,t,s)}function s8(){var t,a,s=this,o=s._id,c=s.size();return new Promise(function(u,d){var m={value:d},p={value:function(){--c===0&&u()}};s.each(function(){var g=Yn(this,o),y=g.on;y!==t&&(a=(t=y).copy(),a._.cancel.push(m),a._.interrupt.push(m),a._.end.push(p)),g.on=a}),c===0&&u()})}var r8=0;function va(t,a,s,o){this._groups=t,this._parents=a,this._name=s,this._id=o}function O1(){return++r8}var ma=Do.prototype;va.prototype={constructor:va,select:$C,selectAll:qC,selectChild:ma.selectChild,selectChildren:ma.selectChildren,filter:RC,merge:DC,selection:VC,transition:a8,call:ma.call,nodes:ma.nodes,node:ma.node,size:ma.size,empty:ma.empty,each:ma.each,on:BC,attr:gC,attrTween:wC,style:GC,styleTween:ZC,text:JC,textTween:n8,remove:HC,tween:cC,delay:SC,duration:CC,ease:MC,easeVarying:kC,end:s8,[Symbol.iterator]:ma[Symbol.iterator]};function i8(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var o8={time:null,delay:0,duration:250,ease:i8};function l8(t,a){for(var s;!(s=t.__transition)||!(s=s[a]);)if(!(t=t.parentNode))throw new Error(`transition ${a} not found`);return s}function c8(t){var a,s;t instanceof va?(a=t._id,t=t._name):(a=O1(),(s=o8).time=pm(),t=t==null?null:t+"");for(var o=this._groups,c=o.length,u=0;u<c;++u)for(var d=o[u],m=d.length,p,g=0;g<m;++g)(p=d[g])&&xu(p,t,a,g,d,s||l8(p,a));return new va(o,this._parents,t,a)}Do.prototype.interrupt=iC;Do.prototype.transition=c8;const yc=t=>()=>t;function u8(t,{sourceEvent:a,target:s,transform:o,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:a,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:c}})}function ga(t,a,s){this.k=t,this.x=a,this.y=s}ga.prototype={constructor:ga,scale:function(t){return t===1?this:new ga(this.k*t,this.x,this.y)},translate:function(t,a){return t===0&a===0?this:new ga(this.k,this.x+this.k*t,this.y+this.k*a)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var yu=new ga(1,0,0);B1.prototype=ga.prototype;function B1(t){for(;!t.__zoom;)if(!(t=t.parentNode))return yu;return t.__zoom}function sh(t){t.stopImmediatePropagation()}function io(t){t.preventDefault(),t.stopImmediatePropagation()}function d8(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function f8(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function fy(){return this.__zoom||yu}function h8(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function m8(){return navigator.maxTouchPoints||"ontouchstart"in this}function p8(t,a,s){var o=t.invertX(a[0][0])-s[0][0],c=t.invertX(a[1][0])-s[1][0],u=t.invertY(a[0][1])-s[0][1],d=t.invertY(a[1][1])-s[1][1];return t.translate(c>o?(o+c)/2:Math.min(0,o)||Math.max(0,c),d>u?(u+d)/2:Math.min(0,u)||Math.max(0,d))}function L1(){var t=d8,a=f8,s=p8,o=h8,c=m8,u=[0,1/0],d=[[-1/0,-1/0],[1/0,1/0]],m=250,p=zc,g=mu("start","zoom","end"),y,x,b,N=500,S=150,C=0,_=10;function E($){$.property("__zoom",fy).on("wheel.zoom",q,{passive:!1}).on("mousedown.zoom",H).on("dblclick.zoom",F).filter(c).on("touchstart.zoom",Q).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",ne).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}E.transform=function($,I,z,R){var U=$.selection?$.selection():$;U.property("__zoom",fy),$!==U?w($,I,z,R):U.interrupt().each(function(){O(this,arguments).event(R).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},E.scaleBy=function($,I,z,R){E.scaleTo($,function(){var U=this.__zoom.k,L=typeof I=="function"?I.apply(this,arguments):I;return U*L},z,R)},E.scaleTo=function($,I,z,R){E.transform($,function(){var U=a.apply(this,arguments),L=this.__zoom,K=z==null?A(U):typeof z=="function"?z.apply(this,arguments):z,B=L.invert(K),P=typeof I=="function"?I.apply(this,arguments):I;return s(T(D(L,P),K,B),U,d)},z,R)},E.translateBy=function($,I,z,R){E.transform($,function(){return s(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof z=="function"?z.apply(this,arguments):z),a.apply(this,arguments),d)},null,R)},E.translateTo=function($,I,z,R,U){E.transform($,function(){var L=a.apply(this,arguments),K=this.__zoom,B=R==null?A(L):typeof R=="function"?R.apply(this,arguments):R;return s(yu.translate(B[0],B[1]).scale(K.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof z=="function"?-z.apply(this,arguments):-z),L,d)},R,U)};function D($,I){return I=Math.max(u[0],Math.min(u[1],I)),I===$.k?$:new ga(I,$.x,$.y)}function T($,I,z){var R=I[0]-z[0]*$.k,U=I[1]-z[1]*$.k;return R===$.x&&U===$.y?$:new ga($.k,R,U)}function A($){return[(+$[0][0]+ +$[1][0])/2,(+$[0][1]+ +$[1][1])/2]}function w($,I,z,R){$.on("start.zoom",function(){O(this,arguments).event(R).start()}).on("interrupt.zoom end.zoom",function(){O(this,arguments).event(R).end()}).tween("zoom",function(){var U=this,L=arguments,K=O(U,L).event(R),B=a.apply(U,L),P=z==null?A(B):typeof z=="function"?z.apply(U,L):z,ae=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),G=U.__zoom,re=typeof I=="function"?I.apply(U,L):I,de=p(G.invert(P).concat(ae/G.k),re.invert(P).concat(ae/re.k));return function(ue){if(ue===1)ue=re;else{var V=de(ue),ce=ae/V[2];ue=new ga(ce,P[0]-V[0]*ce,P[1]-V[1]*ce)}K.zoom(null,ue)}})}function O($,I,z){return!z&&$.__zooming||new M($,I)}function M($,I){this.that=$,this.args=I,this.active=0,this.sourceEvent=null,this.extent=a.apply($,I),this.taps=0}M.prototype={event:function($){return $&&(this.sourceEvent=$),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function($,I){return this.mouse&&$!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&$!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&$!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function($){var I=Ft(this.that).datum();g.call($,this.that,new u8($,{sourceEvent:this.sourceEvent,target:E,transform:this.that.__zoom,dispatch:g}),I)}};function q($,...I){if(!t.apply(this,arguments))return;var z=O(this,I).event($),R=this.__zoom,U=Math.max(u[0],Math.min(u[1],R.k*Math.pow(2,o.apply(this,arguments)))),L=wn($);if(z.wheel)(z.mouse[0][0]!==L[0]||z.mouse[0][1]!==L[1])&&(z.mouse[1]=R.invert(z.mouse[0]=L)),clearTimeout(z.wheel);else{if(R.k===U)return;z.mouse=[L,R.invert(L)],Lc(this),z.start()}io($),z.wheel=setTimeout(K,S),z.zoom("mouse",s(T(D(R,U),z.mouse[0],z.mouse[1]),z.extent,d));function K(){z.wheel=null,z.end()}}function H($,...I){if(b||!t.apply(this,arguments))return;var z=$.currentTarget,R=O(this,I,!0).event($),U=Ft($.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",ae,!0),L=wn($,z),K=$.clientX,B=$.clientY;v1($.view),sh($),R.mouse=[L,this.__zoom.invert(L)],Lc(this),R.start();function P(G){if(io(G),!R.moved){var re=G.clientX-K,de=G.clientY-B;R.moved=re*re+de*de>C}R.event(G).zoom("mouse",s(T(R.that.__zoom,R.mouse[0]=wn(G,z),R.mouse[1]),R.extent,d))}function ae(G){U.on("mousemove.zoom mouseup.zoom",null),w1(G.view,R.moved),io(G),R.event(G).end()}}function F($,...I){if(t.apply(this,arguments)){var z=this.__zoom,R=wn($.changedTouches?$.changedTouches[0]:$,this),U=z.invert(R),L=z.k*($.shiftKey?.5:2),K=s(T(D(z,L),R,U),a.apply(this,I),d);io($),m>0?Ft(this).transition().duration(m).call(w,K,R,$):Ft(this).call(E.transform,K,R,$)}}function Q($,...I){if(t.apply(this,arguments)){var z=$.touches,R=z.length,U=O(this,I,$.changedTouches.length===R).event($),L,K,B,P;for(sh($),K=0;K<R;++K)B=z[K],P=wn(B,this),P=[P,this.__zoom.invert(P),B.identifier],U.touch0?!U.touch1&&U.touch0[2]!==P[2]&&(U.touch1=P,U.taps=0):(U.touch0=P,L=!0,U.taps=1+!!y);y&&(y=clearTimeout(y)),L&&(U.taps<2&&(x=P[0],y=setTimeout(function(){y=null},N)),Lc(this),U.start())}}function Z($,...I){if(this.__zooming){var z=O(this,I).event($),R=$.changedTouches,U=R.length,L,K,B,P;for(io($),L=0;L<U;++L)K=R[L],B=wn(K,this),z.touch0&&z.touch0[2]===K.identifier?z.touch0[0]=B:z.touch1&&z.touch1[2]===K.identifier&&(z.touch1[0]=B);if(K=z.that.__zoom,z.touch1){var ae=z.touch0[0],G=z.touch0[1],re=z.touch1[0],de=z.touch1[1],ue=(ue=re[0]-ae[0])*ue+(ue=re[1]-ae[1])*ue,V=(V=de[0]-G[0])*V+(V=de[1]-G[1])*V;K=D(K,Math.sqrt(ue/V)),B=[(ae[0]+re[0])/2,(ae[1]+re[1])/2],P=[(G[0]+de[0])/2,(G[1]+de[1])/2]}else if(z.touch0)B=z.touch0[0],P=z.touch0[1];else return;z.zoom("touch",s(T(K,B,P),z.extent,d))}}function ne($,...I){if(this.__zooming){var z=O(this,I).event($),R=$.changedTouches,U=R.length,L,K;for(sh($),b&&clearTimeout(b),b=setTimeout(function(){b=null},N),L=0;L<U;++L)K=R[L],z.touch0&&z.touch0[2]===K.identifier?delete z.touch0:z.touch1&&z.touch1[2]===K.identifier&&delete z.touch1;if(z.touch1&&!z.touch0&&(z.touch0=z.touch1,delete z.touch1),z.touch0)z.touch0[1]=this.__zoom.invert(z.touch0[0]);else if(z.end(),z.taps===2&&(K=wn(K,this),Math.hypot(x[0]-K[0],x[1]-K[1])<_)){var B=Ft(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return E.wheelDelta=function($){return arguments.length?(o=typeof $=="function"?$:yc(+$),E):o},E.filter=function($){return arguments.length?(t=typeof $=="function"?$:yc(!!$),E):t},E.touchable=function($){return arguments.length?(c=typeof $=="function"?$:yc(!!$),E):c},E.extent=function($){return arguments.length?(a=typeof $=="function"?$:yc([[+$[0][0],+$[0][1]],[+$[1][0],+$[1][1]]]),E):a},E.scaleExtent=function($){return arguments.length?(u[0]=+$[0],u[1]=+$[1],E):[u[0],u[1]]},E.translateExtent=function($){return arguments.length?(d[0][0]=+$[0][0],d[1][0]=+$[1][0],d[0][1]=+$[0][1],d[1][1]=+$[1][1],E):[[d[0][0],d[0][1]],[d[1][0],d[1][1]]]},E.constrain=function($){return arguments.length?(s=$,E):s},E.duration=function($){return arguments.length?(m=+$,E):m},E.interpolate=function($){return arguments.length?(p=$,E):p},E.on=function(){var $=g.on.apply(g,arguments);return $===g?E:$},E.clickDistance=function($){return arguments.length?(C=($=+$)*$,E):Math.sqrt(C)},E.tapDistance=function($){return arguments.length?(_=+$,E):_},E}const Vn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:a,sourceHandle:s,targetHandle:o})=>`Couldn't create edge for ${t} handle id: "${t==="source"?s:o}", edge id: ${a}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},wo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],H1=["Enter"," ","Escape"],$1={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:a,y:s})=>`Moved selected node ${t}. New position, x: ${a}, y: ${s}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Gr;(function(t){t.Strict="strict",t.Loose="loose"})(Gr||(Gr={}));var $s;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})($s||($s={}));var jo;(function(t){t.Partial="partial",t.Full="full"})(jo||(jo={}));const q1={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var ts;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(ts||(ts={}));var Jc;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Jc||(Jc={}));var xe;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(xe||(xe={}));const hy={[xe.Left]:xe.Right,[xe.Right]:xe.Left,[xe.Top]:xe.Bottom,[xe.Bottom]:xe.Top};function U1(t){return t===null?null:t?"valid":"invalid"}const V1=t=>"id"in t&&"source"in t&&"target"in t,g8=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),ym=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),Oo=(t,a=[0,0])=>{const{width:s,height:o}=Na(t),c=t.origin??a,u=s*c[0],d=o*c[1];return{x:t.position.x-u,y:t.position.y-d}},x8=(t,a={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const s=t.reduce((o,c)=>{const u=typeof c=="string";let d=!a.nodeLookup&&!u?c:void 0;a.nodeLookup&&(d=u?a.nodeLookup.get(c):ym(c)?c:a.nodeLookup.get(c.id));const m=d?eu(d,a.nodeOrigin):{x:0,y:0,x2:0,y2:0};return bu(o,m)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return vu(s)},Bo=(t,a={})=>{let s={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return t.forEach(c=>{(a.filter===void 0||a.filter(c))&&(s=bu(s,eu(c)),o=!0)}),o?vu(s):{x:0,y:0,width:0,height:0}},bm=(t,a,[s,o,c]=[0,0,1],u=!1,d=!1)=>{const m={...Ho(a,[s,o,c]),width:a.width/c,height:a.height/c},p=[];for(const g of t.values()){const{measured:y,selectable:x=!0,hidden:b=!1}=g;if(d&&!x||b)continue;const N=y.width??g.width??g.initialWidth??null,S=y.height??g.height??g.initialHeight??null,C=No(m,Fr(g)),_=(N??0)*(S??0),E=u&&C>0;(!g.internals.handleBounds||E||C>=_||g.dragging)&&p.push(g)}return p},y8=(t,a)=>{const s=new Set;return t.forEach(o=>{s.add(o.id)}),a.filter(o=>s.has(o.source)||s.has(o.target))};function b8(t,a){const s=new Map,o=a?.nodes?new Set(a.nodes.map(c=>c.id)):null;return t.forEach(c=>{c.measured.width&&c.measured.height&&(a?.includeHiddenNodes||!c.hidden)&&(!o||o.has(c.id))&&s.set(c.id,c)}),s}async function v8({nodes:t,width:a,height:s,panZoom:o,minZoom:c,maxZoom:u},d){if(t.size===0)return Promise.resolve(!0);const m=b8(t,d),p=Bo(m),g=vm(p,a,s,d?.minZoom??c,d?.maxZoom??u,d?.padding??.1);return await o.setViewport(g,{duration:d?.duration,ease:d?.ease,interpolate:d?.interpolate}),Promise.resolve(!0)}function Y1({nodeId:t,nextPosition:a,nodeLookup:s,nodeOrigin:o=[0,0],nodeExtent:c,onError:u}){const d=s.get(t),m=d.parentId?s.get(d.parentId):void 0,{x:p,y:g}=m?m.internals.positionAbsolute:{x:0,y:0},y=d.origin??o;let x=d.extent||c;if(d.extent==="parent"&&!d.expandParent)if(!m)u?.("005",Vn.error005());else{const N=m.measured.width,S=m.measured.height;N&&S&&(x=[[p,g],[p+N,g+S]])}else m&&Zr(d.extent)&&(x=[[d.extent[0][0]+p,d.extent[0][1]+g],[d.extent[1][0]+p,d.extent[1][1]+g]]);const b=Zr(x)?Vs(a,x,d.measured):a;return(d.measured.width===void 0||d.measured.height===void 0)&&u?.("015",Vn.error015()),{position:{x:b.x-p+(d.measured.width??0)*y[0],y:b.y-g+(d.measured.height??0)*y[1]},positionAbsolute:b}}async function w8({nodesToRemove:t=[],edgesToRemove:a=[],nodes:s,edges:o,onBeforeDelete:c}){const u=new Set(t.map(b=>b.id)),d=[];for(const b of s){if(b.deletable===!1)continue;const N=u.has(b.id),S=!N&&b.parentId&&d.find(C=>C.id===b.parentId);(N||S)&&d.push(b)}const m=new Set(a.map(b=>b.id)),p=o.filter(b=>b.deletable!==!1),y=y8(d,p);for(const b of p)m.has(b.id)&&!y.find(S=>S.id===b.id)&&y.push(b);if(!c)return{edges:y,nodes:d};const x=await c({nodes:d,edges:y});return typeof x=="boolean"?x?{edges:y,nodes:d}:{edges:[],nodes:[]}:x}const Qr=(t,a=0,s=1)=>Math.min(Math.max(t,a),s),Vs=(t={x:0,y:0},a,s)=>({x:Qr(t.x,a[0][0],a[1][0]-(s?.width??0)),y:Qr(t.y,a[0][1],a[1][1]-(s?.height??0))});function P1(t,a,s){const{width:o,height:c}=Na(s),{x:u,y:d}=s.internals.positionAbsolute;return Vs(t,[[u,d],[u+o,d+c]],a)}const my=(t,a,s)=>t<a?Qr(Math.abs(t-a),1,a)/a:t>s?-Qr(Math.abs(t-s),1,a)/a:0,I1=(t,a,s=15,o=40)=>{const c=my(t.x,o,a.width-o)*s,u=my(t.y,o,a.height-o)*s;return[c,u]},bu=(t,a)=>({x:Math.min(t.x,a.x),y:Math.min(t.y,a.y),x2:Math.max(t.x2,a.x2),y2:Math.max(t.y2,a.y2)}),Lh=({x:t,y:a,width:s,height:o})=>({x:t,y:a,x2:t+s,y2:a+o}),vu=({x:t,y:a,x2:s,y2:o})=>({x:t,y:a,width:s-t,height:o-a}),Fr=(t,a=[0,0])=>{const{x:s,y:o}=ym(t)?t.internals.positionAbsolute:Oo(t,a);return{x:s,y:o,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},eu=(t,a=[0,0])=>{const{x:s,y:o}=ym(t)?t.internals.positionAbsolute:Oo(t,a);return{x:s,y:o,x2:s+(t.measured?.width??t.width??t.initialWidth??0),y2:o+(t.measured?.height??t.height??t.initialHeight??0)}},X1=(t,a)=>vu(bu(Lh(t),Lh(a))),No=(t,a)=>{const s=Math.max(0,Math.min(t.x+t.width,a.x+a.width)-Math.max(t.x,a.x)),o=Math.max(0,Math.min(t.y+t.height,a.y+a.height)-Math.max(t.y,a.y));return Math.ceil(s*o)},py=t=>Nn(t.width)&&Nn(t.height)&&Nn(t.x)&&Nn(t.y),Nn=t=>!isNaN(t)&&isFinite(t),j8=(t,a)=>{},Lo=(t,a=[1,1])=>({x:a[0]*Math.round(t.x/a[0]),y:a[1]*Math.round(t.y/a[1])}),Ho=({x:t,y:a},[s,o,c],u=!1,d=[1,1])=>{const m={x:(t-s)/c,y:(a-o)/c};return u?Lo(m,d):m},tu=({x:t,y:a},[s,o,c])=>({x:t*c+s,y:a*c+o});function Rr(t,a){if(typeof t=="number")return Math.floor((a-a/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const s=parseFloat(t);if(!Number.isNaN(s))return Math.floor(s)}if(typeof t=="string"&&t.endsWith("%")){const s=parseFloat(t);if(!Number.isNaN(s))return Math.floor(a*s*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function N8(t,a,s){if(typeof t=="string"||typeof t=="number"){const o=Rr(t,s),c=Rr(t,a);return{top:o,right:c,bottom:o,left:c,x:c*2,y:o*2}}if(typeof t=="object"){const o=Rr(t.top??t.y??0,s),c=Rr(t.bottom??t.y??0,s),u=Rr(t.left??t.x??0,a),d=Rr(t.right??t.x??0,a);return{top:o,right:d,bottom:c,left:u,x:u+d,y:o+c}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function S8(t,a,s,o,c,u){const{x:d,y:m}=tu(t,[a,s,o]),{x:p,y:g}=tu({x:t.x+t.width,y:t.y+t.height},[a,s,o]),y=c-p,x=u-g;return{left:Math.floor(d),top:Math.floor(m),right:Math.floor(y),bottom:Math.floor(x)}}const vm=(t,a,s,o,c,u)=>{const d=N8(u,a,s),m=(a-d.x)/t.width,p=(s-d.y)/t.height,g=Math.min(m,p),y=Qr(g,o,c),x=t.x+t.width/2,b=t.y+t.height/2,N=a/2-x*y,S=s/2-b*y,C=S8(t,N,S,y,a,s),_={left:Math.min(C.left-d.left,0),top:Math.min(C.top-d.top,0),right:Math.min(C.right-d.right,0),bottom:Math.min(C.bottom-d.bottom,0)};return{x:N-_.left+_.right,y:S-_.top+_.bottom,zoom:y}},So=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Zr(t){return t!=null&&t!=="parent"}function Na(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function G1(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function Q1(t,a={width:0,height:0},s,o,c){const u={...t},d=o.get(s);if(d){const m=d.origin||c;u.x+=d.internals.positionAbsolute.x-(a.width??0)*m[0],u.y+=d.internals.positionAbsolute.y-(a.height??0)*m[1]}return u}function gy(t,a){if(t.size!==a.size)return!1;for(const s of t)if(!a.has(s))return!1;return!0}function _8(){let t,a;return{promise:new Promise((o,c)=>{t=o,a=c}),resolve:t,reject:a}}function E8(t){return{...$1,...t||{}}}function mo(t,{snapGrid:a=[0,0],snapToGrid:s=!1,transform:o,containerBounds:c}){const{x:u,y:d}=Sn(t),m=Ho({x:u-(c?.left??0),y:d-(c?.top??0)},o),{x:p,y:g}=s?Lo(m,a):m;return{xSnapped:p,ySnapped:g,...m}}const wm=t=>({width:t.offsetWidth,height:t.offsetHeight}),F1=t=>t?.getRootNode?.()||window?.document,C8=["INPUT","SELECT","TEXTAREA"];function Z1(t){const a=t.composedPath?.()?.[0]||t.target;return a?.nodeType!==1?!1:C8.includes(a.nodeName)||a.hasAttribute("contenteditable")||!!a.closest(".nokey")}const W1=t=>"clientX"in t,Sn=(t,a)=>{const s=W1(t),o=s?t.clientX:t.touches?.[0].clientX,c=s?t.clientY:t.touches?.[0].clientY;return{x:o-(a?.left??0),y:c-(a?.top??0)}},xy=(t,a,s,o,c)=>{const u=a.querySelectorAll(`.${t}`);return!u||!u.length?null:Array.from(u).map(d=>{const m=d.getBoundingClientRect();return{id:d.getAttribute("data-handleid"),type:t,nodeId:c,position:d.getAttribute("data-handlepos"),x:(m.left-s.left)/o,y:(m.top-s.top)/o,...wm(d)}})};function K1({sourceX:t,sourceY:a,targetX:s,targetY:o,sourceControlX:c,sourceControlY:u,targetControlX:d,targetControlY:m}){const p=t*.125+c*.375+d*.375+s*.125,g=a*.125+u*.375+m*.375+o*.125,y=Math.abs(p-t),x=Math.abs(g-a);return[p,g,y,x]}function bc(t,a){return t>=0?.5*t:a*25*Math.sqrt(-t)}function yy({pos:t,x1:a,y1:s,x2:o,y2:c,c:u}){switch(t){case xe.Left:return[a-bc(a-o,u),s];case xe.Right:return[a+bc(o-a,u),s];case xe.Top:return[a,s-bc(s-c,u)];case xe.Bottom:return[a,s+bc(c-s,u)]}}function J1({sourceX:t,sourceY:a,sourcePosition:s=xe.Bottom,targetX:o,targetY:c,targetPosition:u=xe.Top,curvature:d=.25}){const[m,p]=yy({pos:s,x1:t,y1:a,x2:o,y2:c,c:d}),[g,y]=yy({pos:u,x1:o,y1:c,x2:t,y2:a,c:d}),[x,b,N,S]=K1({sourceX:t,sourceY:a,targetX:o,targetY:c,sourceControlX:m,sourceControlY:p,targetControlX:g,targetControlY:y});return[`M${t},${a} C${m},${p} ${g},${y} ${o},${c}`,x,b,N,S]}function ev({sourceX:t,sourceY:a,targetX:s,targetY:o}){const c=Math.abs(s-t)/2,u=s<t?s+c:s-c,d=Math.abs(o-a)/2,m=o<a?o+d:o-d;return[u,m,c,d]}function T8({sourceNode:t,targetNode:a,selected:s=!1,zIndex:o=0,elevateOnSelect:c=!1,zIndexMode:u="basic"}){if(u==="manual")return o;const d=c&&s?o+1e3:o,m=Math.max(t.parentId||c&&t.selected?t.internals.z:0,a.parentId||c&&a.selected?a.internals.z:0);return d+m}function M8({sourceNode:t,targetNode:a,width:s,height:o,transform:c}){const u=bu(eu(t),eu(a));u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d={x:-c[0]/c[2],y:-c[1]/c[2],width:s/c[2],height:o/c[2]};return No(d,vu(u))>0}const A8=({source:t,sourceHandle:a,target:s,targetHandle:o})=>`xy-edge__${t}${a||""}-${s}${o||""}`,k8=(t,a)=>a.some(s=>s.source===t.source&&s.target===t.target&&(s.sourceHandle===t.sourceHandle||!s.sourceHandle&&!t.sourceHandle)&&(s.targetHandle===t.targetHandle||!s.targetHandle&&!t.targetHandle)),tv=(t,a,s={})=>{if(!t.source||!t.target)return a;const o=s.getEdgeId||A8;let c;return V1(t)?c={...t}:c={...t,id:o(t)},k8(c,a)?a:(c.sourceHandle===null&&delete c.sourceHandle,c.targetHandle===null&&delete c.targetHandle,a.concat(c))};function nv({sourceX:t,sourceY:a,targetX:s,targetY:o}){const[c,u,d,m]=ev({sourceX:t,sourceY:a,targetX:s,targetY:o});return[`M ${t},${a}L ${s},${o}`,c,u,d,m]}const by={[xe.Left]:{x:-1,y:0},[xe.Right]:{x:1,y:0},[xe.Top]:{x:0,y:-1},[xe.Bottom]:{x:0,y:1}},R8=({source:t,sourcePosition:a=xe.Bottom,target:s})=>a===xe.Left||a===xe.Right?t.x<s.x?{x:1,y:0}:{x:-1,y:0}:t.y<s.y?{x:0,y:1}:{x:0,y:-1},vy=(t,a)=>Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2));function D8({source:t,sourcePosition:a=xe.Bottom,target:s,targetPosition:o=xe.Top,center:c,offset:u,stepPosition:d}){const m=by[a],p=by[o],g={x:t.x+m.x*u,y:t.y+m.y*u},y={x:s.x+p.x*u,y:s.y+p.y*u},x=R8({source:g,sourcePosition:a,target:y}),b=x.x!==0?"x":"y",N=x[b];let S=[],C,_;const E={x:0,y:0},D={x:0,y:0},[,,T,A]=ev({sourceX:t.x,sourceY:t.y,targetX:s.x,targetY:s.y});if(m[b]*p[b]===-1){b==="x"?(C=c.x??g.x+(y.x-g.x)*d,_=c.y??(g.y+y.y)/2):(C=c.x??(g.x+y.x)/2,_=c.y??g.y+(y.y-g.y)*d);const O=[{x:C,y:g.y},{x:C,y:y.y}],M=[{x:g.x,y:_},{x:y.x,y:_}];m[b]===N?S=b==="x"?O:M:S=b==="x"?M:O}else{const O=[{x:g.x,y:y.y}],M=[{x:y.x,y:g.y}];if(b==="x"?S=m.x===N?M:O:S=m.y===N?O:M,a===o){const Z=Math.abs(t[b]-s[b]);if(Z<=u){const ne=Math.min(u-1,u-Z);m[b]===N?E[b]=(g[b]>t[b]?-1:1)*ne:D[b]=(y[b]>s[b]?-1:1)*ne}}if(a!==o){const Z=b==="x"?"y":"x",ne=m[b]===p[Z],$=g[Z]>y[Z],I=g[Z]<y[Z];(m[b]===1&&(!ne&&$||ne&&I)||m[b]!==1&&(!ne&&I||ne&&$))&&(S=b==="x"?O:M)}const q={x:g.x+E.x,y:g.y+E.y},H={x:y.x+D.x,y:y.y+D.y},F=Math.max(Math.abs(q.x-S[0].x),Math.abs(H.x-S[0].x)),Q=Math.max(Math.abs(q.y-S[0].y),Math.abs(H.y-S[0].y));F>=Q?(C=(q.x+H.x)/2,_=S[0].y):(C=S[0].x,_=(q.y+H.y)/2)}return[[t,{x:g.x+E.x,y:g.y+E.y},...S,{x:y.x+D.x,y:y.y+D.y},s],C,_,T,A]}function z8(t,a,s,o){const c=Math.min(vy(t,a)/2,vy(a,s)/2,o),{x:u,y:d}=a;if(t.x===u&&u===s.x||t.y===d&&d===s.y)return`L${u} ${d}`;if(t.y===d){const g=t.x<s.x?-1:1,y=t.y<s.y?1:-1;return`L ${u+c*g},${d}Q ${u},${d} ${u},${d+c*y}`}const m=t.x<s.x?1:-1,p=t.y<s.y?-1:1;return`L ${u},${d+c*p}Q ${u},${d} ${u+c*m},${d}`}function Hh({sourceX:t,sourceY:a,sourcePosition:s=xe.Bottom,targetX:o,targetY:c,targetPosition:u=xe.Top,borderRadius:d=5,centerX:m,centerY:p,offset:g=20,stepPosition:y=.5}){const[x,b,N,S,C]=D8({source:{x:t,y:a},sourcePosition:s,target:{x:o,y:c},targetPosition:u,center:{x:m,y:p},offset:g,stepPosition:y});return[x.reduce((E,D,T)=>{let A="";return T>0&&T<x.length-1?A=z8(x[T-1],D,x[T+1],d):A=`${T===0?"M":"L"}${D.x} ${D.y}`,E+=A,E},""),b,N,S,C]}function wy(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function O8(t){const{sourceNode:a,targetNode:s}=t;if(!wy(a)||!wy(s))return null;const o=a.internals.handleBounds||jy(a.handles),c=s.internals.handleBounds||jy(s.handles),u=Ny(o?.source??[],t.sourceHandle),d=Ny(t.connectionMode===Gr.Strict?c?.target??[]:(c?.target??[]).concat(c?.source??[]),t.targetHandle);if(!u||!d)return t.onError?.("008",Vn.error008(u?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const m=u?.position||xe.Bottom,p=d?.position||xe.Top,g=Ys(a,u,m),y=Ys(s,d,p);return{sourceX:g.x,sourceY:g.y,targetX:y.x,targetY:y.y,sourcePosition:m,targetPosition:p}}function jy(t){if(!t)return null;const a=[],s=[];for(const o of t)o.width=o.width??1,o.height=o.height??1,o.type==="source"?a.push(o):o.type==="target"&&s.push(o);return{source:a,target:s}}function Ys(t,a,s=xe.Left,o=!1){const c=(a?.x??0)+t.internals.positionAbsolute.x,u=(a?.y??0)+t.internals.positionAbsolute.y,{width:d,height:m}=a??Na(t);if(o)return{x:c+d/2,y:u+m/2};switch(a?.position??s){case xe.Top:return{x:c+d/2,y:u};case xe.Right:return{x:c+d,y:u+m/2};case xe.Bottom:return{x:c+d/2,y:u+m};case xe.Left:return{x:c,y:u+m/2}}}function Ny(t,a){return t&&(a?t.find(s=>s.id===a):t[0])||null}function $h(t,a){return t?typeof t=="string"?t:`${a?`${a}__`:""}${Object.keys(t).sort().map(o=>`${o}=${t[o]}`).join("&")}`:""}function B8(t,{id:a,defaultColor:s,defaultMarkerStart:o,defaultMarkerEnd:c}){const u=new Set;return t.reduce((d,m)=>([m.markerStart||o,m.markerEnd||c].forEach(p=>{if(p&&typeof p=="object"){const g=$h(p,a);u.has(g)||(d.push({id:g,color:p.color||s,...p}),u.add(g))}}),d),[]).sort((d,m)=>d.id.localeCompare(m.id))}const av=1e3,L8=10,jm={nodeOrigin:[0,0],nodeExtent:wo,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},H8={...jm,checkEquality:!0};function Nm(t,a){const s={...t};for(const o in a)a[o]!==void 0&&(s[o]=a[o]);return s}function $8(t,a,s){const o=Nm(jm,s);for(const c of t.values())if(c.parentId)_m(c,t,a,o);else{const u=Oo(c,o.nodeOrigin),d=Zr(c.extent)?c.extent:o.nodeExtent,m=Vs(u,d,Na(c));c.internals.positionAbsolute=m}}function q8(t,a){if(!t.handles)return t.measured?a?.internals.handleBounds:void 0;const s=[],o=[];for(const c of t.handles){const u={id:c.id,width:c.width??1,height:c.height??1,nodeId:t.id,x:c.x,y:c.y,position:c.position,type:c.type};c.type==="source"?s.push(u):c.type==="target"&&o.push(u)}return{source:s,target:o}}function Sm(t){return t==="manual"}function qh(t,a,s,o={}){const c=Nm(H8,o),u={i:0},d=new Map(a),m=c?.elevateNodesOnSelect&&!Sm(c.zIndexMode)?av:0;let p=t.length>0;a.clear(),s.clear();for(const g of t){let y=d.get(g.id);if(c.checkEquality&&g===y?.internals.userNode)a.set(g.id,y);else{const x=Oo(g,c.nodeOrigin),b=Zr(g.extent)?g.extent:c.nodeExtent,N=Vs(x,b,Na(g));y={...c.defaults,...g,measured:{width:g.measured?.width,height:g.measured?.height},internals:{positionAbsolute:N,handleBounds:q8(g,y),z:sv(g,m,c.zIndexMode),userNode:g}},a.set(g.id,y)}(y.measured===void 0||y.measured.width===void 0||y.measured.height===void 0)&&!y.hidden&&(p=!1),g.parentId&&_m(y,a,s,o,u)}return p}function U8(t,a){if(!t.parentId)return;const s=a.get(t.parentId);s?s.set(t.id,t):a.set(t.parentId,new Map([[t.id,t]]))}function _m(t,a,s,o,c){const{elevateNodesOnSelect:u,nodeOrigin:d,nodeExtent:m,zIndexMode:p}=Nm(jm,o),g=t.parentId,y=a.get(g);if(!y){console.warn(`Parent node ${g} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}U8(t,s),c&&!y.parentId&&y.internals.rootParentIndex===void 0&&p==="auto"&&(y.internals.rootParentIndex=++c.i,y.internals.z=y.internals.z+c.i*L8),c&&y.internals.rootParentIndex!==void 0&&(c.i=y.internals.rootParentIndex);const x=u&&!Sm(p)?av:0,{x:b,y:N,z:S}=V8(t,y,d,m,x,p),{positionAbsolute:C}=t.internals,_=b!==C.x||N!==C.y;(_||S!==t.internals.z)&&a.set(t.id,{...t,internals:{...t.internals,positionAbsolute:_?{x:b,y:N}:C,z:S}})}function sv(t,a,s){const o=Nn(t.zIndex)?t.zIndex:0;return Sm(s)?o:o+(t.selected?a:0)}function V8(t,a,s,o,c,u){const{x:d,y:m}=a.internals.positionAbsolute,p=Na(t),g=Oo(t,s),y=Zr(t.extent)?Vs(g,t.extent,p):g;let x=Vs({x:d+y.x,y:m+y.y},o,p);t.extent==="parent"&&(x=P1(x,p,a));const b=sv(t,c,u),N=a.internals.z??0;return{x:x.x,y:x.y,z:N>=b?N+1:b}}function Em(t,a,s,o=[0,0]){const c=[],u=new Map;for(const d of t){const m=a.get(d.parentId);if(!m)continue;const p=u.get(d.parentId)?.expandedRect??Fr(m),g=X1(p,d.rect);u.set(d.parentId,{expandedRect:g,parent:m})}return u.size>0&&u.forEach(({expandedRect:d,parent:m},p)=>{const g=m.internals.positionAbsolute,y=Na(m),x=m.origin??o,b=d.x<g.x?Math.round(Math.abs(g.x-d.x)):0,N=d.y<g.y?Math.round(Math.abs(g.y-d.y)):0,S=Math.max(y.width,Math.round(d.width)),C=Math.max(y.height,Math.round(d.height)),_=(S-y.width)*x[0],E=(C-y.height)*x[1];(b>0||N>0||_||E)&&(c.push({id:p,type:"position",position:{x:m.position.x-b+_,y:m.position.y-N+E}}),s.get(p)?.forEach(D=>{t.some(T=>T.id===D.id)||c.push({id:D.id,type:"position",position:{x:D.position.x+b,y:D.position.y+N}})})),(y.width<d.width||y.height<d.height||b||N)&&c.push({id:p,type:"dimensions",setAttributes:!0,dimensions:{width:S+(b?x[0]*b-_:0),height:C+(N?x[1]*N-E:0)}})}),c}function Y8(t,a,s,o,c,u,d){const m=o?.querySelector(".xyflow__viewport");let p=!1;if(!m)return{changes:[],updatedInternals:p};const g=[],y=window.getComputedStyle(m),{m22:x}=new window.DOMMatrixReadOnly(y.transform),b=[];for(const N of t.values()){const S=a.get(N.id);if(!S)continue;if(S.hidden){a.set(S.id,{...S,internals:{...S.internals,handleBounds:void 0}}),p=!0;continue}const C=wm(N.nodeElement),_=S.measured.width!==C.width||S.measured.height!==C.height;if(!!(C.width&&C.height&&(_||!S.internals.handleBounds||N.force))){const D=N.nodeElement.getBoundingClientRect(),T=Zr(S.extent)?S.extent:u;let{positionAbsolute:A}=S.internals;S.parentId&&S.extent==="parent"?A=P1(A,C,a.get(S.parentId)):T&&(A=Vs(A,T,C));const w={...S,measured:C,internals:{...S.internals,positionAbsolute:A,handleBounds:{source:xy("source",N.nodeElement,D,x,S.id),target:xy("target",N.nodeElement,D,x,S.id)}}};a.set(S.id,w),S.parentId&&_m(w,a,s,{nodeOrigin:c,zIndexMode:d}),p=!0,_&&(g.push({id:S.id,type:"dimensions",dimensions:C}),S.expandParent&&S.parentId&&b.push({id:S.id,parentId:S.parentId,rect:Fr(w,c)}))}}if(b.length>0){const N=Em(b,a,s,c);g.push(...N)}return{changes:g,updatedInternals:p}}async function P8({delta:t,panZoom:a,transform:s,translateExtent:o,width:c,height:u}){if(!a||!t.x&&!t.y)return Promise.resolve(!1);const d=await a.setViewportConstrained({x:s[0]+t.x,y:s[1]+t.y,zoom:s[2]},[[0,0],[c,u]],o),m=!!d&&(d.x!==s[0]||d.y!==s[1]||d.k!==s[2]);return Promise.resolve(m)}function Sy(t,a,s,o,c,u){let d=c;const m=o.get(d)||new Map;o.set(d,m.set(s,a)),d=`${c}-${t}`;const p=o.get(d)||new Map;if(o.set(d,p.set(s,a)),u){d=`${c}-${t}-${u}`;const g=o.get(d)||new Map;o.set(d,g.set(s,a))}}function rv(t,a,s){t.clear(),a.clear();for(const o of s){const{source:c,target:u,sourceHandle:d=null,targetHandle:m=null}=o,p={edgeId:o.id,source:c,target:u,sourceHandle:d,targetHandle:m},g=`${c}-${d}--${u}-${m}`,y=`${u}-${m}--${c}-${d}`;Sy("source",p,y,t,c,d),Sy("target",p,g,t,u,m),a.set(o.id,o)}}function iv(t,a){if(!t.parentId)return!1;const s=a.get(t.parentId);return s?s.selected?!0:iv(s,a):!1}function _y(t,a,s){let o=t;do{if(o?.matches?.(a))return!0;if(o===s)return!1;o=o?.parentElement}while(o);return!1}function I8(t,a,s,o){const c=new Map;for(const[u,d]of t)if((d.selected||d.id===o)&&(!d.parentId||!iv(d,t))&&(d.draggable||a&&typeof d.draggable>"u")){const m=t.get(u);m&&c.set(u,{id:u,position:m.position||{x:0,y:0},distance:{x:s.x-m.internals.positionAbsolute.x,y:s.y-m.internals.positionAbsolute.y},extent:m.extent,parentId:m.parentId,origin:m.origin,expandParent:m.expandParent,internals:{positionAbsolute:m.internals.positionAbsolute||{x:0,y:0}},measured:{width:m.measured.width??0,height:m.measured.height??0}})}return c}function rh({nodeId:t,dragItems:a,nodeLookup:s,dragging:o=!0}){const c=[];for(const[d,m]of a){const p=s.get(d)?.internals.userNode;p&&c.push({...p,position:m.position,dragging:o})}if(!t)return[c[0],c];const u=s.get(t)?.internals.userNode;return[u?{...u,position:a.get(t)?.position||u.position,dragging:o}:c[0],c]}function X8({dragItems:t,snapGrid:a,x:s,y:o}){const c=t.values().next().value;if(!c)return null;const u={x:s-c.distance.x,y:o-c.distance.y},d=Lo(u,a);return{x:d.x-u.x,y:d.y-u.y}}function G8({onNodeMouseDown:t,getStoreItems:a,onDragStart:s,onDrag:o,onDragStop:c}){let u={x:null,y:null},d=0,m=new Map,p=!1,g={x:0,y:0},y=null,x=!1,b=null,N=!1,S=!1,C=null;function _({noDragClassName:D,handleSelector:T,domNode:A,isSelectable:w,nodeId:O,nodeClickDistance:M=0}){b=Ft(A);function q({x:Z,y:ne}){const{nodeLookup:$,nodeExtent:I,snapGrid:z,snapToGrid:R,nodeOrigin:U,onNodeDrag:L,onSelectionDrag:K,onError:B,updateNodePositions:P}=a();u={x:Z,y:ne};let ae=!1;const G=m.size>1,re=G&&I?Lh(Bo(m)):null,de=G&&R?X8({dragItems:m,snapGrid:z,x:Z,y:ne}):null;for(const[ue,V]of m){if(!$.has(ue))continue;let ce={x:Z-V.distance.x,y:ne-V.distance.y};R&&(ce=de?{x:Math.round(ce.x+de.x),y:Math.round(ce.y+de.y)}:Lo(ce,z));let he=null;if(G&&I&&!V.extent&&re){const{positionAbsolute:be}=V.internals,Se=be.x-re.x+I[0][0],Ae=be.x+V.measured.width-re.x2+I[1][0],Ee=be.y-re.y+I[0][1],$e=be.y+V.measured.height-re.y2+I[1][1];he=[[Se,Ee],[Ae,$e]]}const{position:ve,positionAbsolute:ge}=Y1({nodeId:ue,nextPosition:ce,nodeLookup:$,nodeExtent:he||I,nodeOrigin:U,onError:B});ae=ae||V.position.x!==ve.x||V.position.y!==ve.y,V.position=ve,V.internals.positionAbsolute=ge}if(S=S||ae,!!ae&&(P(m,!0),C&&(o||L||!O&&K))){const[ue,V]=rh({nodeId:O,dragItems:m,nodeLookup:$});o?.(C,m,ue,V),L?.(C,ue,V),O||K?.(C,V)}}async function H(){if(!y)return;const{transform:Z,panBy:ne,autoPanSpeed:$,autoPanOnNodeDrag:I}=a();if(!I){p=!1,cancelAnimationFrame(d);return}const[z,R]=I1(g,y,$);(z!==0||R!==0)&&(u.x=(u.x??0)-z/Z[2],u.y=(u.y??0)-R/Z[2],await ne({x:z,y:R})&&q(u)),d=requestAnimationFrame(H)}function F(Z){const{nodeLookup:ne,multiSelectionActive:$,nodesDraggable:I,transform:z,snapGrid:R,snapToGrid:U,selectNodesOnDrag:L,onNodeDragStart:K,onSelectionDragStart:B,unselectNodesAndEdges:P}=a();x=!0,(!L||!w)&&!$&&O&&(ne.get(O)?.selected||P()),w&&L&&O&&t?.(O);const ae=mo(Z.sourceEvent,{transform:z,snapGrid:R,snapToGrid:U,containerBounds:y});if(u=ae,m=I8(ne,I,ae,O),m.size>0&&(s||K||!O&&B)){const[G,re]=rh({nodeId:O,dragItems:m,nodeLookup:ne});s?.(Z.sourceEvent,m,G,re),K?.(Z.sourceEvent,G,re),O||B?.(Z.sourceEvent,re)}}const Q=j1().clickDistance(M).on("start",Z=>{const{domNode:ne,nodeDragThreshold:$,transform:I,snapGrid:z,snapToGrid:R}=a();y=ne?.getBoundingClientRect()||null,N=!1,S=!1,C=Z.sourceEvent,$===0&&F(Z),u=mo(Z.sourceEvent,{transform:I,snapGrid:z,snapToGrid:R,containerBounds:y}),g=Sn(Z.sourceEvent,y)}).on("drag",Z=>{const{autoPanOnNodeDrag:ne,transform:$,snapGrid:I,snapToGrid:z,nodeDragThreshold:R,nodeLookup:U}=a(),L=mo(Z.sourceEvent,{transform:$,snapGrid:I,snapToGrid:z,containerBounds:y});if(C=Z.sourceEvent,(Z.sourceEvent.type==="touchmove"&&Z.sourceEvent.touches.length>1||O&&!U.has(O))&&(N=!0),!N){if(!p&&ne&&x&&(p=!0,H()),!x){const K=Sn(Z.sourceEvent,y),B=K.x-g.x,P=K.y-g.y;Math.sqrt(B*B+P*P)>R&&F(Z)}(u.x!==L.xSnapped||u.y!==L.ySnapped)&&m&&x&&(g=Sn(Z.sourceEvent,y),q(L))}}).on("end",Z=>{if(!(!x||N)&&(p=!1,x=!1,cancelAnimationFrame(d),m.size>0)){const{nodeLookup:ne,updateNodePositions:$,onNodeDragStop:I,onSelectionDragStop:z}=a();if(S&&($(m,!1),S=!1),c||I||!O&&z){const[R,U]=rh({nodeId:O,dragItems:m,nodeLookup:ne,dragging:!1});c?.(Z.sourceEvent,m,R,U),I?.(Z.sourceEvent,R,U),O||z?.(Z.sourceEvent,U)}}}).filter(Z=>{const ne=Z.target;return!Z.button&&(!D||!_y(ne,`.${D}`,A))&&(!T||_y(ne,T,A))});b.call(Q)}function E(){b?.on(".drag",null)}return{update:_,destroy:E}}function Q8(t,a,s){const o=[],c={x:t.x-s,y:t.y-s,width:s*2,height:s*2};for(const u of a.values())No(c,Fr(u))>0&&o.push(u);return o}const F8=250;function Z8(t,a,s,o){let c=[],u=1/0;const d=Q8(t,s,a+F8);for(const m of d){const p=[...m.internals.handleBounds?.source??[],...m.internals.handleBounds?.target??[]];for(const g of p){if(o.nodeId===g.nodeId&&o.type===g.type&&o.id===g.id)continue;const{x:y,y:x}=Ys(m,g,g.position,!0),b=Math.sqrt(Math.pow(y-t.x,2)+Math.pow(x-t.y,2));b>a||(b<u?(c=[{...g,x:y,y:x}],u=b):b===u&&c.push({...g,x:y,y:x}))}}if(!c.length)return null;if(c.length>1){const m=o.type==="source"?"target":"source";return c.find(p=>p.type===m)??c[0]}return c[0]}function ov(t,a,s,o,c,u=!1){const d=o.get(t);if(!d)return null;const m=c==="strict"?d.internals.handleBounds?.[a]:[...d.internals.handleBounds?.source??[],...d.internals.handleBounds?.target??[]],p=(s?m?.find(g=>g.id===s):m?.[0])??null;return p&&u?{...p,...Ys(d,p,p.position,!0)}:p}function lv(t,a){return t||(a?.classList.contains("target")?"target":a?.classList.contains("source")?"source":null)}function W8(t,a){let s=null;return a?s=!0:t&&!a&&(s=!1),s}const cv=()=>!0;function K8(t,{connectionMode:a,connectionRadius:s,handleId:o,nodeId:c,edgeUpdaterType:u,isTarget:d,domNode:m,nodeLookup:p,lib:g,autoPanOnConnect:y,flowId:x,panBy:b,cancelConnection:N,onConnectStart:S,onConnect:C,onConnectEnd:_,isValidConnection:E=cv,onReconnectEnd:D,updateConnection:T,getTransform:A,getFromHandle:w,autoPanSpeed:O,dragThreshold:M=1,handleDomNode:q}){const H=F1(t.target);let F=0,Q;const{x:Z,y:ne}=Sn(t),$=lv(u,q),I=m?.getBoundingClientRect();let z=!1;if(!I||!$)return;const R=ov(c,$,o,p,a);if(!R)return;let U=Sn(t,I),L=!1,K=null,B=!1,P=null;function ae(){if(!y||!I)return;const[ve,ge]=I1(U,I,O);b({x:ve,y:ge}),F=requestAnimationFrame(ae)}const G={...R,nodeId:c,type:$,position:R.position},re=p.get(c);let ue={inProgress:!0,isValid:null,from:Ys(re,G,xe.Left,!0),fromHandle:G,fromPosition:G.position,fromNode:re,to:U,toHandle:null,toPosition:hy[G.position],toNode:null,pointer:U};function V(){z=!0,T(ue),S?.(t,{nodeId:c,handleId:o,handleType:$})}M===0&&V();function ce(ve){if(!z){const{x:$e,y:De}=Sn(ve),yt=$e-Z,pt=De-ne;if(!(yt*yt+pt*pt>M*M))return;V()}if(!w()||!G){he(ve);return}const ge=A();U=Sn(ve,I),Q=Z8(Ho(U,ge,!1,[1,1]),s,p,G),L||(ae(),L=!0);const be=uv(ve,{handle:Q,connectionMode:a,fromNodeId:c,fromHandleId:o,fromType:d?"target":"source",isValidConnection:E,doc:H,lib:g,flowId:x,nodeLookup:p});P=be.handleDomNode,K=be.connection,B=W8(!!Q,be.isValid);const Se=p.get(c),Ae=Se?Ys(Se,G,xe.Left,!0):ue.from,Ee={...ue,from:Ae,isValid:B,to:be.toHandle&&B?tu({x:be.toHandle.x,y:be.toHandle.y},ge):U,toHandle:be.toHandle,toPosition:B&&be.toHandle?be.toHandle.position:hy[G.position],toNode:be.toHandle?p.get(be.toHandle.nodeId):null,pointer:U};T(Ee),ue=Ee}function he(ve){if(!("touches"in ve&&ve.touches.length>0)){if(z){(Q||P)&&K&&B&&C?.(K);const{inProgress:ge,...be}=ue,Se={...be,toPosition:ue.toHandle?ue.toPosition:null};_?.(ve,Se),u&&D?.(ve,Se)}N(),cancelAnimationFrame(F),L=!1,B=!1,K=null,P=null,H.removeEventListener("mousemove",ce),H.removeEventListener("mouseup",he),H.removeEventListener("touchmove",ce),H.removeEventListener("touchend",he)}}H.addEventListener("mousemove",ce),H.addEventListener("mouseup",he),H.addEventListener("touchmove",ce),H.addEventListener("touchend",he)}function uv(t,{handle:a,connectionMode:s,fromNodeId:o,fromHandleId:c,fromType:u,doc:d,lib:m,flowId:p,isValidConnection:g=cv,nodeLookup:y}){const x=u==="target",b=a?d.querySelector(`.${m}-flow__handle[data-id="${p}-${a?.nodeId}-${a?.id}-${a?.type}"]`):null,{x:N,y:S}=Sn(t),C=d.elementFromPoint(N,S),_=C?.classList.contains(`${m}-flow__handle`)?C:b,E={handleDomNode:_,isValid:!1,connection:null,toHandle:null};if(_){const D=lv(void 0,_),T=_.getAttribute("data-nodeid"),A=_.getAttribute("data-handleid"),w=_.classList.contains("connectable"),O=_.classList.contains("connectableend");if(!T||!D)return E;const M={source:x?T:o,sourceHandle:x?A:c,target:x?o:T,targetHandle:x?c:A};E.connection=M;const H=w&&O&&(s===Gr.Strict?x&&D==="source"||!x&&D==="target":T!==o||A!==c);E.isValid=H&&g(M),E.toHandle=ov(T,D,A,y,s,!0)}return E}const Uh={onPointerDown:K8,isValid:uv};function J8({domNode:t,panZoom:a,getTransform:s,getViewScale:o}){const c=Ft(t);function u({translateExtent:m,width:p,height:g,zoomStep:y=1,pannable:x=!0,zoomable:b=!0,inversePan:N=!1}){const S=T=>{if(T.sourceEvent.type!=="wheel"||!a)return;const A=s(),w=T.sourceEvent.ctrlKey&&So()?10:1,O=-T.sourceEvent.deltaY*(T.sourceEvent.deltaMode===1?.05:T.sourceEvent.deltaMode?1:.002)*y,M=A[2]*Math.pow(2,O*w);a.scaleTo(M)};let C=[0,0];const _=T=>{(T.sourceEvent.type==="mousedown"||T.sourceEvent.type==="touchstart")&&(C=[T.sourceEvent.clientX??T.sourceEvent.touches[0].clientX,T.sourceEvent.clientY??T.sourceEvent.touches[0].clientY])},E=T=>{const A=s();if(T.sourceEvent.type!=="mousemove"&&T.sourceEvent.type!=="touchmove"||!a)return;const w=[T.sourceEvent.clientX??T.sourceEvent.touches[0].clientX,T.sourceEvent.clientY??T.sourceEvent.touches[0].clientY],O=[w[0]-C[0],w[1]-C[1]];C=w;const M=o()*Math.max(A[2],Math.log(A[2]))*(N?-1:1),q={x:A[0]-O[0]*M,y:A[1]-O[1]*M},H=[[0,0],[p,g]];a.setViewportConstrained({x:q.x,y:q.y,zoom:A[2]},H,m)},D=L1().on("start",_).on("zoom",x?E:null).on("zoom.wheel",b?S:null);c.call(D,{})}function d(){c.on("zoom",null)}return{update:u,destroy:d,pointer:wn}}const wu=t=>({x:t.x,y:t.y,zoom:t.k}),ih=({x:t,y:a,zoom:s})=>yu.translate(t,a).scale(s),Or=(t,a)=>t.target.closest(`.${a}`),dv=(t,a)=>a===2&&Array.isArray(t)&&t.includes(2),eT=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,oh=(t,a=0,s=eT,o=()=>{})=>{const c=typeof a=="number"&&a>0;return c||o(),c?t.transition().duration(a).ease(s).on("end",o):t},fv=t=>{const a=t.ctrlKey&&So()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*a};function tT({zoomPanValues:t,noWheelClassName:a,d3Selection:s,d3Zoom:o,panOnScrollMode:c,panOnScrollSpeed:u,zoomOnPinch:d,onPanZoomStart:m,onPanZoom:p,onPanZoomEnd:g}){return y=>{if(Or(y,a))return y.ctrlKey&&y.preventDefault(),!1;y.preventDefault(),y.stopImmediatePropagation();const x=s.property("__zoom").k||1;if(y.ctrlKey&&d){const _=wn(y),E=fv(y),D=x*Math.pow(2,E);o.scaleTo(s,D,_,y);return}const b=y.deltaMode===1?20:1;let N=c===$s.Vertical?0:y.deltaX*b,S=c===$s.Horizontal?0:y.deltaY*b;!So()&&y.shiftKey&&c!==$s.Vertical&&(N=y.deltaY*b,S=0),o.translateBy(s,-(N/x)*u,-(S/x)*u,{internal:!0});const C=wu(s.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(p?.(y,C),t.panScrollTimeout=setTimeout(()=>{g?.(y,C),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,m?.(y,C))}}function nT({noWheelClassName:t,preventScrolling:a,d3ZoomHandler:s}){return function(o,c){const u=o.type==="wheel",d=!a&&u&&!o.ctrlKey,m=Or(o,t);if(o.ctrlKey&&u&&m&&o.preventDefault(),d||m)return null;o.preventDefault(),s.call(this,o,c)}}function aT({zoomPanValues:t,onDraggingChange:a,onPanZoomStart:s}){return o=>{if(o.sourceEvent?.internal)return;const c=wu(o.transform);t.mouseButton=o.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=c,o.sourceEvent?.type==="mousedown"&&a(!0),s&&s?.(o.sourceEvent,c)}}function sT({zoomPanValues:t,panOnDrag:a,onPaneContextMenu:s,onTransformChange:o,onPanZoom:c}){return u=>{t.usedRightMouseButton=!!(s&&dv(a,t.mouseButton??0)),u.sourceEvent?.sync||o([u.transform.x,u.transform.y,u.transform.k]),c&&!u.sourceEvent?.internal&&c?.(u.sourceEvent,wu(u.transform))}}function rT({zoomPanValues:t,panOnDrag:a,panOnScroll:s,onDraggingChange:o,onPanZoomEnd:c,onPaneContextMenu:u}){return d=>{if(!d.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,u&&dv(a,t.mouseButton??0)&&!t.usedRightMouseButton&&d.sourceEvent&&u(d.sourceEvent),t.usedRightMouseButton=!1,o(!1),c)){const m=wu(d.transform);t.prevViewport=m,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{c?.(d.sourceEvent,m)},s?150:0)}}}function iT({zoomActivationKeyPressed:t,zoomOnScroll:a,zoomOnPinch:s,panOnDrag:o,panOnScroll:c,zoomOnDoubleClick:u,userSelectionActive:d,noWheelClassName:m,noPanClassName:p,lib:g,connectionInProgress:y}){return x=>{const b=t||a,N=s&&x.ctrlKey,S=x.type==="wheel";if(x.button===1&&x.type==="mousedown"&&(Or(x,`${g}-flow__node`)||Or(x,`${g}-flow__edge`)))return!0;if(!o&&!b&&!c&&!u&&!s||d||y&&!S||Or(x,m)&&S||Or(x,p)&&(!S||c&&S&&!t)||!s&&x.ctrlKey&&S)return!1;if(!s&&x.type==="touchstart"&&x.touches?.length>1)return x.preventDefault(),!1;if(!b&&!c&&!N&&S||!o&&(x.type==="mousedown"||x.type==="touchstart")||Array.isArray(o)&&!o.includes(x.button)&&x.type==="mousedown")return!1;const C=Array.isArray(o)&&o.includes(x.button)||!x.button||x.button<=1;return(!x.ctrlKey||S)&&C}}function oT({domNode:t,minZoom:a,maxZoom:s,translateExtent:o,viewport:c,onPanZoom:u,onPanZoomStart:d,onPanZoomEnd:m,onDraggingChange:p}){const g={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},y=t.getBoundingClientRect(),x=L1().scaleExtent([a,s]).translateExtent(o),b=Ft(t).call(x);D({x:c.x,y:c.y,zoom:Qr(c.zoom,a,s)},[[0,0],[y.width,y.height]],o);const N=b.on("wheel.zoom"),S=b.on("dblclick.zoom");x.wheelDelta(fv);function C(Q,Z){return b?new Promise(ne=>{x?.interpolate(Z?.interpolate==="linear"?ho:zc).transform(oh(b,Z?.duration,Z?.ease,()=>ne(!0)),Q)}):Promise.resolve(!1)}function _({noWheelClassName:Q,noPanClassName:Z,onPaneContextMenu:ne,userSelectionActive:$,panOnScroll:I,panOnDrag:z,panOnScrollMode:R,panOnScrollSpeed:U,preventScrolling:L,zoomOnPinch:K,zoomOnScroll:B,zoomOnDoubleClick:P,zoomActivationKeyPressed:ae,lib:G,onTransformChange:re,connectionInProgress:de,paneClickDistance:ue,selectionOnDrag:V}){$&&!g.isZoomingOrPanning&&E();const ce=I&&!ae&&!$;x.clickDistance(V?1/0:!Nn(ue)||ue<0?0:ue);const he=ce?tT({zoomPanValues:g,noWheelClassName:Q,d3Selection:b,d3Zoom:x,panOnScrollMode:R,panOnScrollSpeed:U,zoomOnPinch:K,onPanZoomStart:d,onPanZoom:u,onPanZoomEnd:m}):nT({noWheelClassName:Q,preventScrolling:L,d3ZoomHandler:N});if(b.on("wheel.zoom",he,{passive:!1}),!$){const ge=aT({zoomPanValues:g,onDraggingChange:p,onPanZoomStart:d});x.on("start",ge);const be=sT({zoomPanValues:g,panOnDrag:z,onPaneContextMenu:!!ne,onPanZoom:u,onTransformChange:re});x.on("zoom",be);const Se=rT({zoomPanValues:g,panOnDrag:z,panOnScroll:I,onPaneContextMenu:ne,onPanZoomEnd:m,onDraggingChange:p});x.on("end",Se)}const ve=iT({zoomActivationKeyPressed:ae,panOnDrag:z,zoomOnScroll:B,panOnScroll:I,zoomOnDoubleClick:P,zoomOnPinch:K,userSelectionActive:$,noPanClassName:Z,noWheelClassName:Q,lib:G,connectionInProgress:de});x.filter(ve),P?b.on("dblclick.zoom",S):b.on("dblclick.zoom",null)}function E(){x.on("zoom",null)}async function D(Q,Z,ne){const $=ih(Q),I=x?.constrain()($,Z,ne);return I&&await C(I),new Promise(z=>z(I))}async function T(Q,Z){const ne=ih(Q);return await C(ne,Z),new Promise($=>$(ne))}function A(Q){if(b){const Z=ih(Q),ne=b.property("__zoom");(ne.k!==Q.zoom||ne.x!==Q.x||ne.y!==Q.y)&&x?.transform(b,Z,null,{sync:!0})}}function w(){const Q=b?B1(b.node()):{x:0,y:0,k:1};return{x:Q.x,y:Q.y,zoom:Q.k}}function O(Q,Z){return b?new Promise(ne=>{x?.interpolate(Z?.interpolate==="linear"?ho:zc).scaleTo(oh(b,Z?.duration,Z?.ease,()=>ne(!0)),Q)}):Promise.resolve(!1)}function M(Q,Z){return b?new Promise(ne=>{x?.interpolate(Z?.interpolate==="linear"?ho:zc).scaleBy(oh(b,Z?.duration,Z?.ease,()=>ne(!0)),Q)}):Promise.resolve(!1)}function q(Q){x?.scaleExtent(Q)}function H(Q){x?.translateExtent(Q)}function F(Q){const Z=!Nn(Q)||Q<0?0:Q;x?.clickDistance(Z)}return{update:_,destroy:E,setViewport:T,setViewportConstrained:D,getViewport:w,scaleTo:O,scaleBy:M,setScaleExtent:q,setTranslateExtent:H,syncViewport:A,setClickDistance:F}}var Wr;(function(t){t.Line="line",t.Handle="handle"})(Wr||(Wr={}));function lT({width:t,prevWidth:a,height:s,prevHeight:o,affectsX:c,affectsY:u}){const d=t-a,m=s-o,p=[d>0?1:d<0?-1:0,m>0?1:m<0?-1:0];return d&&c&&(p[0]=p[0]*-1),m&&u&&(p[1]=p[1]*-1),p}function Ey(t){const a=t.includes("right")||t.includes("left"),s=t.includes("bottom")||t.includes("top"),o=t.includes("left"),c=t.includes("top");return{isHorizontal:a,isVertical:s,affectsX:o,affectsY:c}}function Ja(t,a){return Math.max(0,a-t)}function es(t,a){return Math.max(0,t-a)}function vc(t,a,s){return Math.max(0,a-t,t-s)}function Cy(t,a){return t?!a:a}function cT(t,a,s,o,c,u,d,m){let{affectsX:p,affectsY:g}=a;const{isHorizontal:y,isVertical:x}=a,b=y&&x,{xSnapped:N,ySnapped:S}=s,{minWidth:C,maxWidth:_,minHeight:E,maxHeight:D}=o,{x:T,y:A,width:w,height:O,aspectRatio:M}=t;let q=Math.floor(y?N-t.pointerX:0),H=Math.floor(x?S-t.pointerY:0);const F=w+(p?-q:q),Q=O+(g?-H:H),Z=-u[0]*w,ne=-u[1]*O;let $=vc(F,C,_),I=vc(Q,E,D);if(d){let U=0,L=0;p&&q<0?U=Ja(T+q+Z,d[0][0]):!p&&q>0&&(U=es(T+F+Z,d[1][0])),g&&H<0?L=Ja(A+H+ne,d[0][1]):!g&&H>0&&(L=es(A+Q+ne,d[1][1])),$=Math.max($,U),I=Math.max(I,L)}if(m){let U=0,L=0;p&&q>0?U=es(T+q,m[0][0]):!p&&q<0&&(U=Ja(T+F,m[1][0])),g&&H>0?L=es(A+H,m[0][1]):!g&&H<0&&(L=Ja(A+Q,m[1][1])),$=Math.max($,U),I=Math.max(I,L)}if(c){if(y){const U=vc(F/M,E,D)*M;if($=Math.max($,U),d){let L=0;!p&&!g||p&&!g&&b?L=es(A+ne+F/M,d[1][1])*M:L=Ja(A+ne+(p?q:-q)/M,d[0][1])*M,$=Math.max($,L)}if(m){let L=0;!p&&!g||p&&!g&&b?L=Ja(A+F/M,m[1][1])*M:L=es(A+(p?q:-q)/M,m[0][1])*M,$=Math.max($,L)}}if(x){const U=vc(Q*M,C,_)/M;if(I=Math.max(I,U),d){let L=0;!p&&!g||g&&!p&&b?L=es(T+Q*M+Z,d[1][0])/M:L=Ja(T+(g?H:-H)*M+Z,d[0][0])/M,I=Math.max(I,L)}if(m){let L=0;!p&&!g||g&&!p&&b?L=Ja(T+Q*M,m[1][0])/M:L=es(T+(g?H:-H)*M,m[0][0])/M,I=Math.max(I,L)}}}H=H+(H<0?I:-I),q=q+(q<0?$:-$),c&&(b?F>Q*M?H=(Cy(p,g)?-q:q)/M:q=(Cy(p,g)?-H:H)*M:y?(H=q/M,g=p):(q=H*M,p=g));const z=p?T+q:T,R=g?A+H:A;return{width:w+(p?-q:q),height:O+(g?-H:H),x:u[0]*q*(p?-1:1)+z,y:u[1]*H*(g?-1:1)+R}}const hv={width:0,height:0,x:0,y:0},uT={...hv,pointerX:0,pointerY:0,aspectRatio:1};function dT(t){return[[0,0],[t.measured.width,t.measured.height]]}function fT(t,a,s){const o=a.position.x+t.position.x,c=a.position.y+t.position.y,u=t.measured.width??0,d=t.measured.height??0,m=s[0]*u,p=s[1]*d;return[[o-m,c-p],[o+u-m,c+d-p]]}function hT({domNode:t,nodeId:a,getStoreItems:s,onChange:o,onEnd:c}){const u=Ft(t);let d={controlDirection:Ey("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function m({controlPosition:g,boundaries:y,keepAspectRatio:x,resizeDirection:b,onResizeStart:N,onResize:S,onResizeEnd:C,shouldResize:_}){let E={...hv},D={...uT};d={boundaries:y,resizeDirection:b,keepAspectRatio:x,controlDirection:Ey(g)};let T,A=null,w=[],O,M,q,H=!1;const F=j1().on("start",Q=>{const{nodeLookup:Z,transform:ne,snapGrid:$,snapToGrid:I,nodeOrigin:z,paneDomNode:R}=s();if(T=Z.get(a),!T)return;A=R?.getBoundingClientRect()??null;const{xSnapped:U,ySnapped:L}=mo(Q.sourceEvent,{transform:ne,snapGrid:$,snapToGrid:I,containerBounds:A});E={width:T.measured.width??0,height:T.measured.height??0,x:T.position.x??0,y:T.position.y??0},D={...E,pointerX:U,pointerY:L,aspectRatio:E.width/E.height},O=void 0,T.parentId&&(T.extent==="parent"||T.expandParent)&&(O=Z.get(T.parentId),M=O&&T.extent==="parent"?dT(O):void 0),w=[],q=void 0;for(const[K,B]of Z)if(B.parentId===a&&(w.push({id:K,position:{...B.position},extent:B.extent}),B.extent==="parent"||B.expandParent)){const P=fT(B,T,B.origin??z);q?q=[[Math.min(P[0][0],q[0][0]),Math.min(P[0][1],q[0][1])],[Math.max(P[1][0],q[1][0]),Math.max(P[1][1],q[1][1])]]:q=P}N?.(Q,{...E})}).on("drag",Q=>{const{transform:Z,snapGrid:ne,snapToGrid:$,nodeOrigin:I}=s(),z=mo(Q.sourceEvent,{transform:Z,snapGrid:ne,snapToGrid:$,containerBounds:A}),R=[];if(!T)return;const{x:U,y:L,width:K,height:B}=E,P={},ae=T.origin??I,{width:G,height:re,x:de,y:ue}=cT(D,d.controlDirection,z,d.boundaries,d.keepAspectRatio,ae,M,q),V=G!==K,ce=re!==B,he=de!==U&&V,ve=ue!==L&&ce;if(!he&&!ve&&!V&&!ce)return;if((he||ve||ae[0]===1||ae[1]===1)&&(P.x=he?de:E.x,P.y=ve?ue:E.y,E.x=P.x,E.y=P.y,w.length>0)){const Ae=de-U,Ee=ue-L;for(const $e of w)$e.position={x:$e.position.x-Ae+ae[0]*(G-K),y:$e.position.y-Ee+ae[1]*(re-B)},R.push($e)}if((V||ce)&&(P.width=V&&(!d.resizeDirection||d.resizeDirection==="horizontal")?G:E.width,P.height=ce&&(!d.resizeDirection||d.resizeDirection==="vertical")?re:E.height,E.width=P.width,E.height=P.height),O&&T.expandParent){const Ae=ae[0]*(P.width??0);P.x&&P.x<Ae&&(E.x=Ae,D.x=D.x-(P.x-Ae));const Ee=ae[1]*(P.height??0);P.y&&P.y<Ee&&(E.y=Ee,D.y=D.y-(P.y-Ee))}const ge=lT({width:E.width,prevWidth:K,height:E.height,prevHeight:B,affectsX:d.controlDirection.affectsX,affectsY:d.controlDirection.affectsY}),be={...E,direction:ge};_?.(Q,be)!==!1&&(H=!0,S?.(Q,be),o(P,R))}).on("end",Q=>{H&&(C?.(Q,{...E}),c?.({...E}),H=!1)});u.call(F)}function p(){u.on(".drag",null)}return{update:m,destroy:p}}var lh={exports:{}},ch={},uh={exports:{}},dh={};var Ty;function mT(){if(Ty)return dh;Ty=1;var t=Eo();function a(x,b){return x===b&&(x!==0||1/x===1/b)||x!==x&&b!==b}var s=typeof Object.is=="function"?Object.is:a,o=t.useState,c=t.useEffect,u=t.useLayoutEffect,d=t.useDebugValue;function m(x,b){var N=b(),S=o({inst:{value:N,getSnapshot:b}}),C=S[0].inst,_=S[1];return u(function(){C.value=N,C.getSnapshot=b,p(C)&&_({inst:C})},[x,N,b]),c(function(){return p(C)&&_({inst:C}),x(function(){p(C)&&_({inst:C})})},[x]),d(N),N}function p(x){var b=x.getSnapshot;x=x.value;try{var N=b();return!s(x,N)}catch{return!0}}function g(x,b){return b()}var y=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?g:m;return dh.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:y,dh}var My;function pT(){return My||(My=1,uh.exports=mT()),uh.exports}var Ay;function gT(){if(Ay)return ch;Ay=1;var t=Eo(),a=pT();function s(g,y){return g===y&&(g!==0||1/g===1/y)||g!==g&&y!==y}var o=typeof Object.is=="function"?Object.is:s,c=a.useSyncExternalStore,u=t.useRef,d=t.useEffect,m=t.useMemo,p=t.useDebugValue;return ch.useSyncExternalStoreWithSelector=function(g,y,x,b,N){var S=u(null);if(S.current===null){var C={hasValue:!1,value:null};S.current=C}else C=S.current;S=m(function(){function E(O){if(!D){if(D=!0,T=O,O=b(O),N!==void 0&&C.hasValue){var M=C.value;if(N(M,O))return A=M}return A=O}if(M=A,o(T,O))return M;var q=b(O);return N!==void 0&&N(M,q)?(T=O,M):(T=O,A=q)}var D=!1,T,A,w=x===void 0?null:x;return[function(){return E(y())},w===null?void 0:function(){return E(w())}]},[y,x,b,N]);var _=c(g,S[0],S[1]);return d(function(){C.hasValue=!0,C.value=_},[_]),p(_),_},ch}var ky;function xT(){return ky||(ky=1,lh.exports=gT()),lh.exports}var yT=xT();const bT=Yh(yT),vT={},Ry=t=>{let a;const s=new Set,o=(y,x)=>{const b=typeof y=="function"?y(a):y;if(!Object.is(b,a)){const N=a;a=x??(typeof b!="object"||b===null)?b:Object.assign({},a,b),s.forEach(S=>S(a,N))}},c=()=>a,p={setState:o,getState:c,getInitialState:()=>g,subscribe:y=>(s.add(y),()=>s.delete(y)),destroy:()=>{(vT?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},g=a=t(o,c,p);return p},wT=t=>t?Ry(t):Ry,{useDebugValue:jT}=zr,{useSyncExternalStoreWithSelector:NT}=bT,ST=t=>t;function mv(t,a=ST,s){const o=NT(t.subscribe,t.getState,t.getServerState||t.getInitialState,a,s);return jT(o),o}const Dy=(t,a)=>{const s=wT(t),o=(c,u=a)=>mv(s,c,u);return Object.assign(o,s),o},_T=(t,a)=>t?Dy(t,a):Dy;function We(t,a){if(Object.is(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;if(t instanceof Map&&a instanceof Map){if(t.size!==a.size)return!1;for(const[o,c]of t)if(!Object.is(c,a.get(o)))return!1;return!0}if(t instanceof Set&&a instanceof Set){if(t.size!==a.size)return!1;for(const o of t)if(!a.has(o))return!1;return!0}const s=Object.keys(t);if(s.length!==Object.keys(a).length)return!1;for(const o of s)if(!Object.prototype.hasOwnProperty.call(a,o)||!Object.is(t[o],a[o]))return!1;return!0}const ju=j.createContext(null),ET=ju.Provider,pv=Vn.error001();function Oe(t,a){const s=j.useContext(ju);if(s===null)throw new Error(pv);return mv(s,t,a)}function Ke(){const t=j.useContext(ju);if(t===null)throw new Error(pv);return j.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const zy={display:"none"},CT={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},gv="react-flow__node-desc",xv="react-flow__edge-desc",TT="react-flow__aria-live",MT=t=>t.ariaLiveMessage,AT=t=>t.ariaLabelConfig;function kT({rfId:t}){const a=Oe(MT);return r.jsx("div",{id:`${TT}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:CT,children:a})}function RT({rfId:t,disableKeyboardA11y:a}){const s=Oe(AT);return r.jsxs(r.Fragment,{children:[r.jsx("div",{id:`${gv}-${t}`,style:zy,children:a?s["node.a11yDescription.default"]:s["node.a11yDescription.keyboardDisabled"]}),r.jsx("div",{id:`${xv}-${t}`,style:zy,children:s["edge.a11yDescription.default"]}),!a&&r.jsx(kT,{rfId:t})]})}const Nu=j.forwardRef(({position:t="top-left",children:a,className:s,style:o,...c},u)=>{const d=`${t}`.split("-");return r.jsx("div",{className:ft(["react-flow__panel",s,...d]),style:o,ref:u,...c,children:a})});Nu.displayName="Panel";function DT({proOptions:t,position:a="bottom-right"}){return t?.hideAttribution?null:r.jsx(Nu,{position:a,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:r.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const zT=t=>{const a=[],s=[];for(const[,o]of t.nodeLookup)o.selected&&a.push(o.internals.userNode);for(const[,o]of t.edgeLookup)o.selected&&s.push(o);return{selectedNodes:a,selectedEdges:s}},wc=t=>t.id;function OT(t,a){return We(t.selectedNodes.map(wc),a.selectedNodes.map(wc))&&We(t.selectedEdges.map(wc),a.selectedEdges.map(wc))}function BT({onSelectionChange:t}){const a=Ke(),{selectedNodes:s,selectedEdges:o}=Oe(zT,OT);return j.useEffect(()=>{const c={nodes:s,edges:o};t?.(c),a.getState().onSelectionChangeHandlers.forEach(u=>u(c))},[s,o,t]),null}const LT=t=>!!t.onSelectionChangeHandlers;function HT({onSelectionChange:t}){const a=Oe(LT);return t||a?r.jsx(BT,{onSelectionChange:t}):null}const yv=[0,0],$T={x:0,y:0,zoom:1},qT=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Oy=[...qT,"rfId"],UT=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges}),By={translateExtent:wo,nodeOrigin:yv,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function VT(t){const{setNodes:a,setEdges:s,setMinZoom:o,setMaxZoom:c,setTranslateExtent:u,setNodeExtent:d,reset:m,setDefaultNodesAndEdges:p}=Oe(UT,We),g=Ke();j.useEffect(()=>(p(t.defaultNodes,t.defaultEdges),()=>{y.current=By,m()}),[]);const y=j.useRef(By);return j.useEffect(()=>{for(const x of Oy){const b=t[x],N=y.current[x];b!==N&&(typeof t[x]>"u"||(x==="nodes"?a(b):x==="edges"?s(b):x==="minZoom"?o(b):x==="maxZoom"?c(b):x==="translateExtent"?u(b):x==="nodeExtent"?d(b):x==="ariaLabelConfig"?g.setState({ariaLabelConfig:E8(b)}):x==="fitView"?g.setState({fitViewQueued:b}):x==="fitViewOptions"?g.setState({fitViewOptions:b}):g.setState({[x]:b})))}y.current=t},Oy.map(x=>t[x])),null}function Ly(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function YT(t){const[a,s]=j.useState(t==="system"?null:t);return j.useEffect(()=>{if(t!=="system"){s(t);return}const o=Ly(),c=()=>s(o?.matches?"dark":"light");return c(),o?.addEventListener("change",c),()=>{o?.removeEventListener("change",c)}},[t]),a!==null?a:Ly()?.matches?"dark":"light"}const Hy=typeof document<"u"?document:null;function _o(t=null,a={target:Hy,actInsideInputWithModifier:!0}){const[s,o]=j.useState(!1),c=j.useRef(!1),u=j.useRef(new Set([])),[d,m]=j.useMemo(()=>{if(t!==null){const g=(Array.isArray(t)?t:[t]).filter(x=>typeof x=="string").map(x=>x.replace("+",`
`).replace(`

`,`
+`).split(`
`)),y=g.reduce((x,b)=>x.concat(...b),[]);return[g,y]}return[[],[]]},[t]);return j.useEffect(()=>{const p=a?.target??Hy,g=a?.actInsideInputWithModifier??!0;if(t!==null){const y=N=>{if(c.current=N.ctrlKey||N.metaKey||N.shiftKey||N.altKey,(!c.current||c.current&&!g)&&Z1(N))return!1;const C=qy(N.code,m);if(u.current.add(N[C]),$y(d,u.current,!1)){const _=N.composedPath?.()?.[0]||N.target,E=_?.nodeName==="BUTTON"||_?.nodeName==="A";a.preventDefault!==!1&&(c.current||!E)&&N.preventDefault(),o(!0)}},x=N=>{const S=qy(N.code,m);$y(d,u.current,!0)?(o(!1),u.current.clear()):u.current.delete(N[S]),N.key==="Meta"&&u.current.clear(),c.current=!1},b=()=>{u.current.clear(),o(!1)};return p?.addEventListener("keydown",y),p?.addEventListener("keyup",x),window.addEventListener("blur",b),window.addEventListener("contextmenu",b),()=>{p?.removeEventListener("keydown",y),p?.removeEventListener("keyup",x),window.removeEventListener("blur",b),window.removeEventListener("contextmenu",b)}}},[t,o]),s}function $y(t,a,s){return t.filter(o=>s||o.length===a.size).some(o=>o.every(c=>a.has(c)))}function qy(t,a){return a.includes(t)?"code":"key"}const PT=()=>{const t=Ke();return j.useMemo(()=>({zoomIn:a=>{const{panZoom:s}=t.getState();return s?s.scaleBy(1.2,{duration:a?.duration}):Promise.resolve(!1)},zoomOut:a=>{const{panZoom:s}=t.getState();return s?s.scaleBy(1/1.2,{duration:a?.duration}):Promise.resolve(!1)},zoomTo:(a,s)=>{const{panZoom:o}=t.getState();return o?o.scaleTo(a,{duration:s?.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(a,s)=>{const{transform:[o,c,u],panZoom:d}=t.getState();return d?(await d.setViewport({x:a.x??o,y:a.y??c,zoom:a.zoom??u},s),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[a,s,o]=t.getState().transform;return{x:a,y:s,zoom:o}},setCenter:async(a,s,o)=>t.getState().setCenter(a,s,o),fitBounds:async(a,s)=>{const{width:o,height:c,minZoom:u,maxZoom:d,panZoom:m}=t.getState(),p=vm(a,o,c,u,d,s?.padding??.1);return m?(await m.setViewport(p,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(a,s={})=>{const{transform:o,snapGrid:c,snapToGrid:u,domNode:d}=t.getState();if(!d)return a;const{x:m,y:p}=d.getBoundingClientRect(),g={x:a.x-m,y:a.y-p},y=s.snapGrid??c,x=s.snapToGrid??u;return Ho(g,o,x,y)},flowToScreenPosition:a=>{const{transform:s,domNode:o}=t.getState();if(!o)return a;const{x:c,y:u}=o.getBoundingClientRect(),d=tu(a,s);return{x:d.x+c,y:d.y+u}}}),[])};function bv(t,a){const s=[],o=new Map,c=[];for(const u of t)if(u.type==="add"){c.push(u);continue}else if(u.type==="remove"||u.type==="replace")o.set(u.id,[u]);else{const d=o.get(u.id);d?d.push(u):o.set(u.id,[u])}for(const u of a){const d=o.get(u.id);if(!d){s.push(u);continue}if(d[0].type==="remove")continue;if(d[0].type==="replace"){s.push({...d[0].item});continue}const m={...u};for(const p of d)IT(p,m);s.push(m)}return c.length&&c.forEach(u=>{u.index!==void 0?s.splice(u.index,0,{...u.item}):s.push({...u.item})}),s}function IT(t,a){switch(t.type){case"select":{a.selected=t.selected;break}case"position":{typeof t.position<"u"&&(a.position=t.position),typeof t.dragging<"u"&&(a.dragging=t.dragging);break}case"dimensions":{typeof t.dimensions<"u"&&(a.measured={...t.dimensions},t.setAttributes&&((t.setAttributes===!0||t.setAttributes==="width")&&(a.width=t.dimensions.width),(t.setAttributes===!0||t.setAttributes==="height")&&(a.height=t.dimensions.height))),typeof t.resizing=="boolean"&&(a.resizing=t.resizing);break}}}function vv(t,a){return bv(t,a)}function wv(t,a){return bv(t,a)}function zs(t,a){return{id:t,type:"select",selected:a}}function Br(t,a=new Set,s=!1){const o=[];for(const[c,u]of t){const d=a.has(c);!(u.selected===void 0&&!d)&&u.selected!==d&&(s&&(u.selected=d),o.push(zs(u.id,d)))}return o}function Uy({items:t=[],lookup:a}){const s=[],o=new Map(t.map(c=>[c.id,c]));for(const[c,u]of t.entries()){const d=a.get(u.id),m=d?.internals?.userNode??d;m!==void 0&&m!==u&&s.push({id:u.id,item:u,type:"replace"}),m===void 0&&s.push({item:u,type:"add",index:c})}for(const[c]of a)o.get(c)===void 0&&s.push({id:c,type:"remove"});return s}function Vy(t){return{id:t.id,type:"remove"}}const Yy=t=>g8(t),XT=t=>V1(t);function jv(t){return j.forwardRef(t)}const GT=typeof window<"u"?j.useLayoutEffect:j.useEffect;function Py(t){const[a,s]=j.useState(BigInt(0)),[o]=j.useState(()=>QT(()=>s(c=>c+BigInt(1))));return GT(()=>{const c=o.get();c.length&&(t(c),o.reset())},[a]),o}function QT(t){let a=[];return{get:()=>a,reset:()=>{a=[]},push:s=>{a.push(s),t()}}}const Nv=j.createContext(null);function FT({children:t}){const a=Ke(),s=j.useCallback(m=>{const{nodes:p=[],setNodes:g,hasDefaultNodes:y,onNodesChange:x,nodeLookup:b,fitViewQueued:N,onNodesChangeMiddlewareMap:S}=a.getState();let C=p;for(const E of m)C=typeof E=="function"?E(C):E;let _=Uy({items:C,lookup:b});for(const E of S.values())_=E(_);y&&g(C),_.length>0?x?.(_):N&&window.requestAnimationFrame(()=>{const{fitViewQueued:E,nodes:D,setNodes:T}=a.getState();E&&T(D)})},[]),o=Py(s),c=j.useCallback(m=>{const{edges:p=[],setEdges:g,hasDefaultEdges:y,onEdgesChange:x,edgeLookup:b}=a.getState();let N=p;for(const S of m)N=typeof S=="function"?S(N):S;y?g(N):x&&x(Uy({items:N,lookup:b}))},[]),u=Py(c),d=j.useMemo(()=>({nodeQueue:o,edgeQueue:u}),[]);return r.jsx(Nv.Provider,{value:d,children:t})}function ZT(){const t=j.useContext(Nv);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}const WT=t=>!!t.panZoom;function Cm(){const t=PT(),a=Ke(),s=ZT(),o=Oe(WT),c=j.useMemo(()=>{const u=x=>a.getState().nodeLookup.get(x),d=x=>{s.nodeQueue.push(x)},m=x=>{s.edgeQueue.push(x)},p=x=>{const{nodeLookup:b,nodeOrigin:N}=a.getState(),S=Yy(x)?x:b.get(x.id),C=S.parentId?Q1(S.position,S.measured,S.parentId,b,N):S.position,_={...S,position:C,width:S.measured?.width??S.width,height:S.measured?.height??S.height};return Fr(_)},g=(x,b,N={replace:!1})=>{d(S=>S.map(C=>{if(C.id===x){const _=typeof b=="function"?b(C):b;return N.replace&&Yy(_)?_:{...C,..._}}return C}))},y=(x,b,N={replace:!1})=>{m(S=>S.map(C=>{if(C.id===x){const _=typeof b=="function"?b(C):b;return N.replace&&XT(_)?_:{...C,..._}}return C}))};return{getNodes:()=>a.getState().nodes.map(x=>({...x})),getNode:x=>u(x)?.internals.userNode,getInternalNode:u,getEdges:()=>{const{edges:x=[]}=a.getState();return x.map(b=>({...b}))},getEdge:x=>a.getState().edgeLookup.get(x),setNodes:d,setEdges:m,addNodes:x=>{const b=Array.isArray(x)?x:[x];s.nodeQueue.push(N=>[...N,...b])},addEdges:x=>{const b=Array.isArray(x)?x:[x];s.edgeQueue.push(N=>[...N,...b])},toObject:()=>{const{nodes:x=[],edges:b=[],transform:N}=a.getState(),[S,C,_]=N;return{nodes:x.map(E=>({...E})),edges:b.map(E=>({...E})),viewport:{x:S,y:C,zoom:_}}},deleteElements:async({nodes:x=[],edges:b=[]})=>{const{nodes:N,edges:S,onNodesDelete:C,onEdgesDelete:_,triggerNodeChanges:E,triggerEdgeChanges:D,onDelete:T,onBeforeDelete:A}=a.getState(),{nodes:w,edges:O}=await w8({nodesToRemove:x,edgesToRemove:b,nodes:N,edges:S,onBeforeDelete:A}),M=O.length>0,q=w.length>0;if(M){const H=O.map(Vy);_?.(O),D(H)}if(q){const H=w.map(Vy);C?.(w),E(H)}return(q||M)&&T?.({nodes:w,edges:O}),{deletedNodes:w,deletedEdges:O}},getIntersectingNodes:(x,b=!0,N)=>{const S=py(x),C=S?x:p(x),_=N!==void 0;return C?(N||a.getState().nodes).filter(E=>{const D=a.getState().nodeLookup.get(E.id);if(D&&!S&&(E.id===x.id||!D.internals.positionAbsolute))return!1;const T=Fr(_?E:D),A=No(T,C);return b&&A>0||A>=T.width*T.height||A>=C.width*C.height}):[]},isNodeIntersecting:(x,b,N=!0)=>{const C=py(x)?x:p(x);if(!C)return!1;const _=No(C,b);return N&&_>0||_>=b.width*b.height||_>=C.width*C.height},updateNode:g,updateNodeData:(x,b,N={replace:!1})=>{g(x,S=>{const C=typeof b=="function"?b(S):b;return N.replace?{...S,data:C}:{...S,data:{...S.data,...C}}},N)},updateEdge:y,updateEdgeData:(x,b,N={replace:!1})=>{y(x,S=>{const C=typeof b=="function"?b(S):b;return N.replace?{...S,data:C}:{...S,data:{...S.data,...C}}},N)},getNodesBounds:x=>{const{nodeLookup:b,nodeOrigin:N}=a.getState();return x8(x,{nodeLookup:b,nodeOrigin:N})},getHandleConnections:({type:x,id:b,nodeId:N})=>Array.from(a.getState().connectionLookup.get(`${N}-${x}${b?`-${b}`:""}`)?.values()??[]),getNodeConnections:({type:x,handleId:b,nodeId:N})=>Array.from(a.getState().connectionLookup.get(`${N}${x?b?`-${x}-${b}`:`-${x}`:""}`)?.values()??[]),fitView:async x=>{const b=a.getState().fitViewResolver??_8();return a.setState({fitViewQueued:!0,fitViewOptions:x,fitViewResolver:b}),s.nodeQueue.push(N=>[...N]),b.promise}}},[]);return j.useMemo(()=>({...c,...t,viewportInitialized:o}),[o])}const Iy=t=>t.selected,KT=typeof window<"u"?window:void 0;function JT({deleteKeyCode:t,multiSelectionKeyCode:a}){const s=Ke(),{deleteElements:o}=Cm(),c=_o(t,{actInsideInputWithModifier:!1}),u=_o(a,{target:KT});j.useEffect(()=>{if(c){const{edges:d,nodes:m}=s.getState();o({nodes:m.filter(Iy),edges:d.filter(Iy)}),s.setState({nodesSelectionActive:!1})}},[c]),j.useEffect(()=>{s.setState({multiSelectionActive:u})},[u])}function eM(t){const a=Ke();j.useEffect(()=>{const s=()=>{if(!t.current||!(t.current.checkVisibility?.()??!0))return!1;const o=wm(t.current);(o.height===0||o.width===0)&&a.getState().onError?.("004",Vn.error004()),a.setState({width:o.width||500,height:o.height||500})};if(t.current){s(),window.addEventListener("resize",s);const o=new ResizeObserver(()=>s());return o.observe(t.current),()=>{window.removeEventListener("resize",s),o&&t.current&&o.unobserve(t.current)}}},[])}const Su={position:"absolute",width:"100%",height:"100%",top:0,left:0},tM=t=>({userSelectionActive:t.userSelectionActive,lib:t.lib,connectionInProgress:t.connection.inProgress});function nM({onPaneContextMenu:t,zoomOnScroll:a=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:c=.5,panOnScrollMode:u=$s.Free,zoomOnDoubleClick:d=!0,panOnDrag:m=!0,defaultViewport:p,translateExtent:g,minZoom:y,maxZoom:x,zoomActivationKeyCode:b,preventScrolling:N=!0,children:S,noWheelClassName:C,noPanClassName:_,onViewportChange:E,isControlledViewport:D,paneClickDistance:T,selectionOnDrag:A}){const w=Ke(),O=j.useRef(null),{userSelectionActive:M,lib:q,connectionInProgress:H}=Oe(tM,We),F=_o(b),Q=j.useRef();eM(O);const Z=j.useCallback(ne=>{E?.({x:ne[0],y:ne[1],zoom:ne[2]}),D||w.setState({transform:ne})},[E,D]);return j.useEffect(()=>{if(O.current){Q.current=oT({domNode:O.current,minZoom:y,maxZoom:x,translateExtent:g,viewport:p,onDraggingChange:z=>w.setState({paneDragging:z}),onPanZoomStart:(z,R)=>{const{onViewportChangeStart:U,onMoveStart:L}=w.getState();L?.(z,R),U?.(R)},onPanZoom:(z,R)=>{const{onViewportChange:U,onMove:L}=w.getState();L?.(z,R),U?.(R)},onPanZoomEnd:(z,R)=>{const{onViewportChangeEnd:U,onMoveEnd:L}=w.getState();L?.(z,R),U?.(R)}});const{x:ne,y:$,zoom:I}=Q.current.getViewport();return w.setState({panZoom:Q.current,transform:[ne,$,I],domNode:O.current.closest(".react-flow")}),()=>{Q.current?.destroy()}}},[]),j.useEffect(()=>{Q.current?.update({onPaneContextMenu:t,zoomOnScroll:a,zoomOnPinch:s,panOnScroll:o,panOnScrollSpeed:c,panOnScrollMode:u,zoomOnDoubleClick:d,panOnDrag:m,zoomActivationKeyPressed:F,preventScrolling:N,noPanClassName:_,userSelectionActive:M,noWheelClassName:C,lib:q,onTransformChange:Z,connectionInProgress:H,selectionOnDrag:A,paneClickDistance:T})},[t,a,s,o,c,u,d,m,F,N,_,M,C,q,Z,H,A,T]),r.jsx("div",{className:"react-flow__renderer",ref:O,style:Su,children:S})}const aM=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function sM(){const{userSelectionActive:t,userSelectionRect:a}=Oe(aM,We);return t&&a?r.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:a.width,height:a.height,transform:`translate(${a.x}px, ${a.y}px)`}}):null}const fh=(t,a)=>s=>{s.target===a.current&&t?.(s)},rM=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,connectionInProgress:t.connection.inProgress,dragging:t.paneDragging});function iM({isSelecting:t,selectionKeyPressed:a,selectionMode:s=jo.Full,panOnDrag:o,paneClickDistance:c,selectionOnDrag:u,onSelectionStart:d,onSelectionEnd:m,onPaneClick:p,onPaneContextMenu:g,onPaneScroll:y,onPaneMouseEnter:x,onPaneMouseMove:b,onPaneMouseLeave:N,children:S}){const C=Ke(),{userSelectionActive:_,elementsSelectable:E,dragging:D,connectionInProgress:T}=Oe(rM,We),A=E&&(t||_),w=j.useRef(null),O=j.useRef(),M=j.useRef(new Set),q=j.useRef(new Set),H=j.useRef(!1),F=U=>{if(H.current||T){H.current=!1;return}p?.(U),C.getState().resetSelectedElements(),C.setState({nodesSelectionActive:!1})},Q=U=>{if(Array.isArray(o)&&o?.includes(2)){U.preventDefault();return}g?.(U)},Z=y?U=>y(U):void 0,ne=U=>{H.current&&(U.stopPropagation(),H.current=!1)},$=U=>{const{domNode:L}=C.getState();if(O.current=L?.getBoundingClientRect(),!O.current)return;const K=U.target===w.current;if(!K&&!!U.target.closest(".nokey")||!t||!(u&&K||a)||U.button!==0||!U.isPrimary)return;U.target?.setPointerCapture?.(U.pointerId),H.current=!1;const{x:ae,y:G}=Sn(U.nativeEvent,O.current);C.setState({userSelectionRect:{width:0,height:0,startX:ae,startY:G,x:ae,y:G}}),K||(U.stopPropagation(),U.preventDefault())},I=U=>{const{userSelectionRect:L,transform:K,nodeLookup:B,edgeLookup:P,connectionLookup:ae,triggerNodeChanges:G,triggerEdgeChanges:re,defaultEdgeOptions:de,resetSelectedElements:ue}=C.getState();if(!O.current||!L)return;const{x:V,y:ce}=Sn(U.nativeEvent,O.current),{startX:he,startY:ve}=L;if(!H.current){const Ee=a?0:c;if(Math.hypot(V-he,ce-ve)<=Ee)return;ue(),d?.(U)}H.current=!0;const ge={startX:he,startY:ve,x:V<he?V:he,y:ce<ve?ce:ve,width:Math.abs(V-he),height:Math.abs(ce-ve)},be=M.current,Se=q.current;M.current=new Set(bm(B,ge,K,s===jo.Partial,!0).map(Ee=>Ee.id)),q.current=new Set;const Ae=de?.selectable??!0;for(const Ee of M.current){const $e=ae.get(Ee);if($e)for(const{edgeId:De}of $e.values()){const yt=P.get(De);yt&&(yt.selectable??Ae)&&q.current.add(De)}}if(!gy(be,M.current)){const Ee=Br(B,M.current,!0);G(Ee)}if(!gy(Se,q.current)){const Ee=Br(P,q.current);re(Ee)}C.setState({userSelectionRect:ge,userSelectionActive:!0,nodesSelectionActive:!1})},z=U=>{U.button===0&&(U.target?.releasePointerCapture?.(U.pointerId),!_&&U.target===w.current&&C.getState().userSelectionRect&&F?.(U),C.setState({userSelectionActive:!1,userSelectionRect:null}),H.current&&(m?.(U),C.setState({nodesSelectionActive:M.current.size>0})))},R=o===!0||Array.isArray(o)&&o.includes(0);return r.jsxs("div",{className:ft(["react-flow__pane",{draggable:R,dragging:D,selection:t}]),onClick:A?void 0:fh(F,w),onContextMenu:fh(Q,w),onWheel:fh(Z,w),onPointerEnter:A?void 0:x,onPointerMove:A?I:b,onPointerUp:A?z:void 0,onPointerDownCapture:A?$:void 0,onClickCapture:A?ne:void 0,onPointerLeave:N,ref:w,style:Su,children:[S,r.jsx(sM,{})]})}function Vh({id:t,store:a,unselect:s=!1,nodeRef:o}){const{addSelectedNodes:c,unselectNodesAndEdges:u,multiSelectionActive:d,nodeLookup:m,onError:p}=a.getState(),g=m.get(t);if(!g){p?.("012",Vn.error012(t));return}a.setState({nodesSelectionActive:!1}),g.selected?(s||g.selected&&d)&&(u({nodes:[g],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):c([t])}function Sv({nodeRef:t,disabled:a=!1,noDragClassName:s,handleSelector:o,nodeId:c,isSelectable:u,nodeClickDistance:d}){const m=Ke(),[p,g]=j.useState(!1),y=j.useRef();return j.useEffect(()=>{y.current=G8({getStoreItems:()=>m.getState(),onNodeMouseDown:x=>{Vh({id:x,store:m,nodeRef:t})},onDragStart:()=>{g(!0)},onDragStop:()=>{g(!1)}})},[]),j.useEffect(()=>{if(a)y.current?.destroy();else if(t.current)return y.current?.update({noDragClassName:s,handleSelector:o,domNode:t.current,isSelectable:u,nodeId:c,nodeClickDistance:d}),()=>{y.current?.destroy()}},[s,o,a,u,t,c]),p}const oM=t=>a=>a.selected&&(a.draggable||t&&typeof a.draggable>"u");function _v(){const t=Ke();return j.useCallback(s=>{const{nodeExtent:o,snapToGrid:c,snapGrid:u,nodesDraggable:d,onError:m,updateNodePositions:p,nodeLookup:g,nodeOrigin:y}=t.getState(),x=new Map,b=oM(d),N=c?u[0]:5,S=c?u[1]:5,C=s.direction.x*N*s.factor,_=s.direction.y*S*s.factor;for(const[,E]of g){if(!b(E))continue;let D={x:E.internals.positionAbsolute.x+C,y:E.internals.positionAbsolute.y+_};c&&(D=Lo(D,u));const{position:T,positionAbsolute:A}=Y1({nodeId:E.id,nextPosition:D,nodeLookup:g,nodeExtent:o,nodeOrigin:y,onError:m});E.position=T,E.internals.positionAbsolute=A,x.set(E.id,E)}p(x)},[])}const Tm=j.createContext(null),lM=Tm.Provider;Tm.Consumer;const Ev=()=>j.useContext(Tm),cM=t=>({connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName,rfId:t.rfId}),uM=(t,a,s)=>o=>{const{connectionClickStartHandle:c,connectionMode:u,connection:d}=o,{fromHandle:m,toHandle:p,isValid:g}=d,y=p?.nodeId===t&&p?.id===a&&p?.type===s;return{connectingFrom:m?.nodeId===t&&m?.id===a&&m?.type===s,connectingTo:y,clickConnecting:c?.nodeId===t&&c?.id===a&&c?.type===s,isPossibleEndHandle:u===Gr.Strict?m?.type!==s:t!==m?.nodeId||a!==m?.id,connectionInProcess:!!m,clickConnectionInProcess:!!c,valid:y&&g}};function dM({type:t="source",position:a=xe.Top,isValidConnection:s,isConnectable:o=!0,isConnectableStart:c=!0,isConnectableEnd:u=!0,id:d,onConnect:m,children:p,className:g,onMouseDown:y,onTouchStart:x,...b},N){const S=d||null,C=t==="target",_=Ke(),E=Ev(),{connectOnClick:D,noPanClassName:T,rfId:A}=Oe(cM,We),{connectingFrom:w,connectingTo:O,clickConnecting:M,isPossibleEndHandle:q,connectionInProcess:H,clickConnectionInProcess:F,valid:Q}=Oe(uM(E,S,t),We);E||_.getState().onError?.("010",Vn.error010());const Z=I=>{const{defaultEdgeOptions:z,onConnect:R,hasDefaultEdges:U}=_.getState(),L={...z,...I};if(U){const{edges:K,setEdges:B}=_.getState();B(tv(L,K))}R?.(L),m?.(L)},ne=I=>{if(!E)return;const z=W1(I.nativeEvent);if(c&&(z&&I.button===0||!z)){const R=_.getState();Uh.onPointerDown(I.nativeEvent,{handleDomNode:I.currentTarget,autoPanOnConnect:R.autoPanOnConnect,connectionMode:R.connectionMode,connectionRadius:R.connectionRadius,domNode:R.domNode,nodeLookup:R.nodeLookup,lib:R.lib,isTarget:C,handleId:S,nodeId:E,flowId:R.rfId,panBy:R.panBy,cancelConnection:R.cancelConnection,onConnectStart:R.onConnectStart,onConnectEnd:R.onConnectEnd,updateConnection:R.updateConnection,onConnect:Z,isValidConnection:s||R.isValidConnection,getTransform:()=>_.getState().transform,getFromHandle:()=>_.getState().connection.fromHandle,autoPanSpeed:R.autoPanSpeed,dragThreshold:R.connectionDragThreshold})}z?y?.(I):x?.(I)},$=I=>{const{onClickConnectStart:z,onClickConnectEnd:R,connectionClickStartHandle:U,connectionMode:L,isValidConnection:K,lib:B,rfId:P,nodeLookup:ae,connection:G}=_.getState();if(!E||!U&&!c)return;if(!U){z?.(I.nativeEvent,{nodeId:E,handleId:S,handleType:t}),_.setState({connectionClickStartHandle:{nodeId:E,type:t,id:S}});return}const re=F1(I.target),de=s||K,{connection:ue,isValid:V}=Uh.isValid(I.nativeEvent,{handle:{nodeId:E,id:S,type:t},connectionMode:L,fromNodeId:U.nodeId,fromHandleId:U.id||null,fromType:U.type,isValidConnection:de,flowId:P,doc:re,lib:B,nodeLookup:ae});V&&ue&&Z(ue);const ce=structuredClone(G);delete ce.inProgress,ce.toPosition=ce.toHandle?ce.toHandle.position:null,R?.(I,ce),_.setState({connectionClickStartHandle:null})};return r.jsx("div",{"data-handleid":S,"data-nodeid":E,"data-handlepos":a,"data-id":`${A}-${E}-${S}-${t}`,className:ft(["react-flow__handle",`react-flow__handle-${a}`,"nodrag",T,g,{source:!C,target:C,connectable:o,connectablestart:c,connectableend:u,clickconnecting:M,connectingfrom:w,connectingto:O,valid:Q,connectionindicator:o&&(!H||q)&&(H||F?u:c)}]),onMouseDown:ne,onTouchStart:ne,onClick:D?$:void 0,ref:N,...b,children:p})}const Kr=j.memo(jv(dM));function fM({data:t,isConnectable:a,sourcePosition:s=xe.Bottom}){return r.jsxs(r.Fragment,{children:[t?.label,r.jsx(Kr,{type:"source",position:s,isConnectable:a})]})}function hM({data:t,isConnectable:a,targetPosition:s=xe.Top,sourcePosition:o=xe.Bottom}){return r.jsxs(r.Fragment,{children:[r.jsx(Kr,{type:"target",position:s,isConnectable:a}),t?.label,r.jsx(Kr,{type:"source",position:o,isConnectable:a})]})}function mM(){return null}function pM({data:t,isConnectable:a,targetPosition:s=xe.Top}){return r.jsxs(r.Fragment,{children:[r.jsx(Kr,{type:"target",position:s,isConnectable:a}),t?.label]})}const nu={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Xy={input:fM,default:hM,output:pM,group:mM};function gM(t){return t.internals.handleBounds===void 0?{width:t.width??t.initialWidth??t.style?.width,height:t.height??t.initialHeight??t.style?.height}:{width:t.width??t.style?.width,height:t.height??t.style?.height}}const xM=t=>{const{width:a,height:s,x:o,y:c}=Bo(t.nodeLookup,{filter:u=>!!u.selected});return{width:Nn(a)?a:null,height:Nn(s)?s:null,userSelectionActive:t.userSelectionActive,transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]}) translate(${o}px,${c}px)`}};function yM({onSelectionContextMenu:t,noPanClassName:a,disableKeyboardA11y:s}){const o=Ke(),{width:c,height:u,transformString:d,userSelectionActive:m}=Oe(xM,We),p=_v(),g=j.useRef(null);if(j.useEffect(()=>{s||g.current?.focus({preventScroll:!0})},[s]),Sv({nodeRef:g}),m||!c||!u)return null;const y=t?b=>{const N=o.getState().nodes.filter(S=>S.selected);t(b,N)}:void 0,x=b=>{Object.prototype.hasOwnProperty.call(nu,b.key)&&(b.preventDefault(),p({direction:nu[b.key],factor:b.shiftKey?4:1}))};return r.jsx("div",{className:ft(["react-flow__nodesselection","react-flow__container",a]),style:{transform:d},children:r.jsx("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:y,tabIndex:s?void 0:-1,onKeyDown:s?void 0:x,style:{width:c,height:u}})})}const Gy=typeof window<"u"?window:void 0,bM=t=>({nodesSelectionActive:t.nodesSelectionActive,userSelectionActive:t.userSelectionActive});function Cv({children:t,onPaneClick:a,onPaneMouseEnter:s,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:u,onPaneScroll:d,paneClickDistance:m,deleteKeyCode:p,selectionKeyCode:g,selectionOnDrag:y,selectionMode:x,onSelectionStart:b,onSelectionEnd:N,multiSelectionKeyCode:S,panActivationKeyCode:C,zoomActivationKeyCode:_,elementsSelectable:E,zoomOnScroll:D,zoomOnPinch:T,panOnScroll:A,panOnScrollSpeed:w,panOnScrollMode:O,zoomOnDoubleClick:M,panOnDrag:q,defaultViewport:H,translateExtent:F,minZoom:Q,maxZoom:Z,preventScrolling:ne,onSelectionContextMenu:$,noWheelClassName:I,noPanClassName:z,disableKeyboardA11y:R,onViewportChange:U,isControlledViewport:L}){const{nodesSelectionActive:K,userSelectionActive:B}=Oe(bM,We),P=_o(g,{target:Gy}),ae=_o(C,{target:Gy}),G=ae||q,re=ae||A,de=y&&G!==!0,ue=P||B||de;return JT({deleteKeyCode:p,multiSelectionKeyCode:S}),r.jsx(nM,{onPaneContextMenu:u,elementsSelectable:E,zoomOnScroll:D,zoomOnPinch:T,panOnScroll:re,panOnScrollSpeed:w,panOnScrollMode:O,zoomOnDoubleClick:M,panOnDrag:!P&&G,defaultViewport:H,translateExtent:F,minZoom:Q,maxZoom:Z,zoomActivationKeyCode:_,preventScrolling:ne,noWheelClassName:I,noPanClassName:z,onViewportChange:U,isControlledViewport:L,paneClickDistance:m,selectionOnDrag:de,children:r.jsxs(iM,{onSelectionStart:b,onSelectionEnd:N,onPaneClick:a,onPaneMouseEnter:s,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:u,onPaneScroll:d,panOnDrag:G,isSelecting:!!ue,selectionMode:x,selectionKeyPressed:P,paneClickDistance:m,selectionOnDrag:de,children:[t,K&&r.jsx(yM,{onSelectionContextMenu:$,noPanClassName:z,disableKeyboardA11y:R})]})})}Cv.displayName="FlowRenderer";const vM=j.memo(Cv),wM=t=>a=>t?bm(a.nodeLookup,{x:0,y:0,width:a.width,height:a.height},a.transform,!0).map(s=>s.id):Array.from(a.nodeLookup.keys());function jM(t){return Oe(j.useCallback(wM(t),[t]),We)}const NM=t=>t.updateNodeInternals;function SM(){const t=Oe(NM),[a]=j.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(s=>{const o=new Map;s.forEach(c=>{const u=c.target.getAttribute("data-id");o.set(u,{id:u,nodeElement:c.target,force:!0})}),t(o)}));return j.useEffect(()=>()=>{a?.disconnect()},[a]),a}function _M({node:t,nodeType:a,hasDimensions:s,resizeObserver:o}){const c=Ke(),u=j.useRef(null),d=j.useRef(null),m=j.useRef(t.sourcePosition),p=j.useRef(t.targetPosition),g=j.useRef(a),y=s&&!!t.internals.handleBounds;return j.useEffect(()=>{u.current&&!t.hidden&&(!y||d.current!==u.current)&&(d.current&&o?.unobserve(d.current),o?.observe(u.current),d.current=u.current)},[y,t.hidden]),j.useEffect(()=>()=>{d.current&&(o?.unobserve(d.current),d.current=null)},[]),j.useEffect(()=>{if(u.current){const x=g.current!==a,b=m.current!==t.sourcePosition,N=p.current!==t.targetPosition;(x||b||N)&&(g.current=a,m.current=t.sourcePosition,p.current=t.targetPosition,c.getState().updateNodeInternals(new Map([[t.id,{id:t.id,nodeElement:u.current,force:!0}]])))}},[t.id,a,t.sourcePosition,t.targetPosition]),u}function EM({id:t,onClick:a,onMouseEnter:s,onMouseMove:o,onMouseLeave:c,onContextMenu:u,onDoubleClick:d,nodesDraggable:m,elementsSelectable:p,nodesConnectable:g,nodesFocusable:y,resizeObserver:x,noDragClassName:b,noPanClassName:N,disableKeyboardA11y:S,rfId:C,nodeTypes:_,nodeClickDistance:E,onError:D}){const{node:T,internals:A,isParent:w}=Oe(V=>{const ce=V.nodeLookup.get(t),he=V.parentLookup.has(t);return{node:ce,internals:ce.internals,isParent:he}},We);let O=T.type||"default",M=_?.[O]||Xy[O];M===void 0&&(D?.("003",Vn.error003(O)),O="default",M=_?.default||Xy.default);const q=!!(T.draggable||m&&typeof T.draggable>"u"),H=!!(T.selectable||p&&typeof T.selectable>"u"),F=!!(T.connectable||g&&typeof T.connectable>"u"),Q=!!(T.focusable||y&&typeof T.focusable>"u"),Z=Ke(),ne=G1(T),$=_M({node:T,nodeType:O,hasDimensions:ne,resizeObserver:x}),I=Sv({nodeRef:$,disabled:T.hidden||!q,noDragClassName:b,handleSelector:T.dragHandle,nodeId:t,isSelectable:H,nodeClickDistance:E}),z=_v();if(T.hidden)return null;const R=Na(T),U=gM(T),L=H||q||a||s||o||c,K=s?V=>s(V,{...A.userNode}):void 0,B=o?V=>o(V,{...A.userNode}):void 0,P=c?V=>c(V,{...A.userNode}):void 0,ae=u?V=>u(V,{...A.userNode}):void 0,G=d?V=>d(V,{...A.userNode}):void 0,re=V=>{const{selectNodesOnDrag:ce,nodeDragThreshold:he}=Z.getState();H&&(!ce||!q||he>0)&&Vh({id:t,store:Z,nodeRef:$}),a&&a(V,{...A.userNode})},de=V=>{if(!(Z1(V.nativeEvent)||S)){if(H1.includes(V.key)&&H){const ce=V.key==="Escape";Vh({id:t,store:Z,unselect:ce,nodeRef:$})}else if(q&&T.selected&&Object.prototype.hasOwnProperty.call(nu,V.key)){V.preventDefault();const{ariaLabelConfig:ce}=Z.getState();Z.setState({ariaLiveMessage:ce["node.a11yDescription.ariaLiveMessage"]({direction:V.key.replace("Arrow","").toLowerCase(),x:~~A.positionAbsolute.x,y:~~A.positionAbsolute.y})}),z({direction:nu[V.key],factor:V.shiftKey?4:1})}}},ue=()=>{if(S||!$.current?.matches(":focus-visible"))return;const{transform:V,width:ce,height:he,autoPanOnNodeFocus:ve,setCenter:ge}=Z.getState();if(!ve)return;bm(new Map([[t,T]]),{x:0,y:0,width:ce,height:he},V,!0).length>0||ge(T.position.x+R.width/2,T.position.y+R.height/2,{zoom:V[2]})};return r.jsx("div",{className:ft(["react-flow__node",`react-flow__node-${O}`,{[N]:q},T.className,{selected:T.selected,selectable:H,parent:w,draggable:q,dragging:I}]),ref:$,style:{zIndex:A.z,transform:`translate(${A.positionAbsolute.x}px,${A.positionAbsolute.y}px)`,pointerEvents:L?"all":"none",visibility:ne?"visible":"hidden",...T.style,...U},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:K,onMouseMove:B,onMouseLeave:P,onContextMenu:ae,onClick:re,onDoubleClick:G,onKeyDown:Q?de:void 0,tabIndex:Q?0:void 0,onFocus:Q?ue:void 0,role:T.ariaRole??(Q?"group":void 0),"aria-roledescription":"node","aria-describedby":S?void 0:`${gv}-${C}`,"aria-label":T.ariaLabel,...T.domAttributes,children:r.jsx(lM,{value:t,children:r.jsx(M,{id:t,data:T.data,type:O,positionAbsoluteX:A.positionAbsolute.x,positionAbsoluteY:A.positionAbsolute.y,selected:T.selected??!1,selectable:H,draggable:q,deletable:T.deletable??!0,isConnectable:F,sourcePosition:T.sourcePosition,targetPosition:T.targetPosition,dragging:I,dragHandle:T.dragHandle,zIndex:A.z,parentId:T.parentId,...R})})})}var CM=j.memo(EM);const TM=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,onError:t.onError});function Tv(t){const{nodesDraggable:a,nodesConnectable:s,nodesFocusable:o,elementsSelectable:c,onError:u}=Oe(TM,We),d=jM(t.onlyRenderVisibleElements),m=SM();return r.jsx("div",{className:"react-flow__nodes",style:Su,children:d.map(p=>r.jsx(CM,{id:p,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:m,nodesDraggable:a,nodesConnectable:s,nodesFocusable:o,elementsSelectable:c,nodeClickDistance:t.nodeClickDistance,onError:u},p))})}Tv.displayName="NodeRenderer";const MM=j.memo(Tv);function AM(t){return Oe(j.useCallback(s=>{if(!t)return s.edges.map(c=>c.id);const o=[];if(s.width&&s.height)for(const c of s.edges){const u=s.nodeLookup.get(c.source),d=s.nodeLookup.get(c.target);u&&d&&M8({sourceNode:u,targetNode:d,width:s.width,height:s.height,transform:s.transform})&&o.push(c.id)}return o},[t]),We)}const kM=({color:t="none",strokeWidth:a=1})=>{const s={strokeWidth:a,...t&&{stroke:t}};return r.jsx("polyline",{className:"arrow",style:s,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},RM=({color:t="none",strokeWidth:a=1})=>{const s={strokeWidth:a,...t&&{stroke:t,fill:t}};return r.jsx("polyline",{className:"arrowclosed",style:s,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Qy={[Jc.Arrow]:kM,[Jc.ArrowClosed]:RM};function DM(t){const a=Ke();return j.useMemo(()=>Object.prototype.hasOwnProperty.call(Qy,t)?Qy[t]:(a.getState().onError?.("009",Vn.error009(t)),null),[t])}const zM=({id:t,type:a,color:s,width:o=12.5,height:c=12.5,markerUnits:u="strokeWidth",strokeWidth:d,orient:m="auto-start-reverse"})=>{const p=DM(a);return p?r.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${o}`,markerHeight:`${c}`,viewBox:"-10 -10 20 20",markerUnits:u,orient:m,refX:"0",refY:"0",children:r.jsx(p,{color:s,strokeWidth:d})}):null},Mv=({defaultColor:t,rfId:a})=>{const s=Oe(u=>u.edges),o=Oe(u=>u.defaultEdgeOptions),c=j.useMemo(()=>B8(s,{id:a,defaultColor:t,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[s,o,a,t]);return c.length?r.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:r.jsx("defs",{children:c.map(u=>r.jsx(zM,{id:u.id,type:u.type,color:u.color,width:u.width,height:u.height,markerUnits:u.markerUnits,strokeWidth:u.strokeWidth,orient:u.orient},u.id))})}):null};Mv.displayName="MarkerDefinitions";var OM=j.memo(Mv);function Av({x:t,y:a,label:s,labelStyle:o,labelShowBg:c=!0,labelBgStyle:u,labelBgPadding:d=[2,4],labelBgBorderRadius:m=2,children:p,className:g,...y}){const[x,b]=j.useState({x:1,y:0,width:0,height:0}),N=ft(["react-flow__edge-textwrapper",g]),S=j.useRef(null);return j.useEffect(()=>{if(S.current){const C=S.current.getBBox();b({x:C.x,y:C.y,width:C.width,height:C.height})}},[s]),s?r.jsxs("g",{transform:`translate(${t-x.width/2} ${a-x.height/2})`,className:N,visibility:x.width?"visible":"hidden",...y,children:[c&&r.jsx("rect",{width:x.width+2*d[0],x:-d[0],y:-d[1],height:x.height+2*d[1],className:"react-flow__edge-textbg",style:u,rx:m,ry:m}),r.jsx("text",{className:"react-flow__edge-text",y:x.height/2,dy:"0.3em",ref:S,style:o,children:s}),p]}):null}Av.displayName="EdgeText";const BM=j.memo(Av);function _u({path:t,labelX:a,labelY:s,label:o,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:m,labelBgBorderRadius:p,interactionWidth:g=20,...y}){return r.jsxs(r.Fragment,{children:[r.jsx("path",{...y,d:t,fill:"none",className:ft(["react-flow__edge-path",y.className])}),g?r.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}):null,o&&Nn(a)&&Nn(s)?r.jsx(BM,{x:a,y:s,label:o,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:m,labelBgBorderRadius:p}):null]})}function Fy({pos:t,x1:a,y1:s,x2:o,y2:c}){return t===xe.Left||t===xe.Right?[.5*(a+o),s]:[a,.5*(s+c)]}function kv({sourceX:t,sourceY:a,sourcePosition:s=xe.Bottom,targetX:o,targetY:c,targetPosition:u=xe.Top}){const[d,m]=Fy({pos:s,x1:t,y1:a,x2:o,y2:c}),[p,g]=Fy({pos:u,x1:o,y1:c,x2:t,y2:a}),[y,x,b,N]=K1({sourceX:t,sourceY:a,targetX:o,targetY:c,sourceControlX:d,sourceControlY:m,targetControlX:p,targetControlY:g});return[`M${t},${a} C${d},${m} ${p},${g} ${o},${c}`,y,x,b,N]}function Rv(t){return j.memo(({id:a,sourceX:s,sourceY:o,targetX:c,targetY:u,sourcePosition:d,targetPosition:m,label:p,labelStyle:g,labelShowBg:y,labelBgStyle:x,labelBgPadding:b,labelBgBorderRadius:N,style:S,markerEnd:C,markerStart:_,interactionWidth:E})=>{const[D,T,A]=kv({sourceX:s,sourceY:o,sourcePosition:d,targetX:c,targetY:u,targetPosition:m}),w=t.isInternal?void 0:a;return r.jsx(_u,{id:w,path:D,labelX:T,labelY:A,label:p,labelStyle:g,labelShowBg:y,labelBgStyle:x,labelBgPadding:b,labelBgBorderRadius:N,style:S,markerEnd:C,markerStart:_,interactionWidth:E})})}const LM=Rv({isInternal:!1}),Dv=Rv({isInternal:!0});LM.displayName="SimpleBezierEdge";Dv.displayName="SimpleBezierEdgeInternal";function zv(t){return j.memo(({id:a,sourceX:s,sourceY:o,targetX:c,targetY:u,label:d,labelStyle:m,labelShowBg:p,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:x,style:b,sourcePosition:N=xe.Bottom,targetPosition:S=xe.Top,markerEnd:C,markerStart:_,pathOptions:E,interactionWidth:D})=>{const[T,A,w]=Hh({sourceX:s,sourceY:o,sourcePosition:N,targetX:c,targetY:u,targetPosition:S,borderRadius:E?.borderRadius,offset:E?.offset,stepPosition:E?.stepPosition}),O=t.isInternal?void 0:a;return r.jsx(_u,{id:O,path:T,labelX:A,labelY:w,label:d,labelStyle:m,labelShowBg:p,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:x,style:b,markerEnd:C,markerStart:_,interactionWidth:D})})}const Ov=zv({isInternal:!1}),Bv=zv({isInternal:!0});Ov.displayName="SmoothStepEdge";Bv.displayName="SmoothStepEdgeInternal";function Lv(t){return j.memo(({id:a,...s})=>{const o=t.isInternal?void 0:a;return r.jsx(Ov,{...s,id:o,pathOptions:j.useMemo(()=>({borderRadius:0,offset:s.pathOptions?.offset}),[s.pathOptions?.offset])})})}const HM=Lv({isInternal:!1}),Hv=Lv({isInternal:!0});HM.displayName="StepEdge";Hv.displayName="StepEdgeInternal";function $v(t){return j.memo(({id:a,sourceX:s,sourceY:o,targetX:c,targetY:u,label:d,labelStyle:m,labelShowBg:p,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:x,style:b,markerEnd:N,markerStart:S,interactionWidth:C})=>{const[_,E,D]=nv({sourceX:s,sourceY:o,targetX:c,targetY:u}),T=t.isInternal?void 0:a;return r.jsx(_u,{id:T,path:_,labelX:E,labelY:D,label:d,labelStyle:m,labelShowBg:p,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:x,style:b,markerEnd:N,markerStart:S,interactionWidth:C})})}const $M=$v({isInternal:!1}),qv=$v({isInternal:!0});$M.displayName="StraightEdge";qv.displayName="StraightEdgeInternal";function Uv(t){return j.memo(({id:a,sourceX:s,sourceY:o,targetX:c,targetY:u,sourcePosition:d=xe.Bottom,targetPosition:m=xe.Top,label:p,labelStyle:g,labelShowBg:y,labelBgStyle:x,labelBgPadding:b,labelBgBorderRadius:N,style:S,markerEnd:C,markerStart:_,pathOptions:E,interactionWidth:D})=>{const[T,A,w]=J1({sourceX:s,sourceY:o,sourcePosition:d,targetX:c,targetY:u,targetPosition:m,curvature:E?.curvature}),O=t.isInternal?void 0:a;return r.jsx(_u,{id:O,path:T,labelX:A,labelY:w,label:p,labelStyle:g,labelShowBg:y,labelBgStyle:x,labelBgPadding:b,labelBgBorderRadius:N,style:S,markerEnd:C,markerStart:_,interactionWidth:D})})}const qM=Uv({isInternal:!1}),Vv=Uv({isInternal:!0});qM.displayName="BezierEdge";Vv.displayName="BezierEdgeInternal";const Zy={default:Vv,straight:qv,step:Hv,smoothstep:Bv,simplebezier:Dv},Wy={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},UM=(t,a,s)=>s===xe.Left?t-a:s===xe.Right?t+a:t,VM=(t,a,s)=>s===xe.Top?t-a:s===xe.Bottom?t+a:t,Ky="react-flow__edgeupdater";function Jy({position:t,centerX:a,centerY:s,radius:o=10,onMouseDown:c,onMouseEnter:u,onMouseOut:d,type:m}){return r.jsx("circle",{onMouseDown:c,onMouseEnter:u,onMouseOut:d,className:ft([Ky,`${Ky}-${m}`]),cx:UM(a,o,t),cy:VM(s,o,t),r:o,stroke:"transparent",fill:"transparent"})}function YM({isReconnectable:t,reconnectRadius:a,edge:s,sourceX:o,sourceY:c,targetX:u,targetY:d,sourcePosition:m,targetPosition:p,onReconnect:g,onReconnectStart:y,onReconnectEnd:x,setReconnecting:b,setUpdateHover:N}){const S=Ke(),C=(A,w)=>{if(A.button!==0)return;const{autoPanOnConnect:O,domNode:M,isValidConnection:q,connectionMode:H,connectionRadius:F,lib:Q,onConnectStart:Z,onConnectEnd:ne,cancelConnection:$,nodeLookup:I,rfId:z,panBy:R,updateConnection:U}=S.getState(),L=w.type==="target",K=(ae,G)=>{b(!1),x?.(ae,s,w.type,G)},B=ae=>g?.(s,ae),P=(ae,G)=>{b(!0),y?.(A,s,w.type),Z?.(ae,G)};Uh.onPointerDown(A.nativeEvent,{autoPanOnConnect:O,connectionMode:H,connectionRadius:F,domNode:M,handleId:w.id,nodeId:w.nodeId,nodeLookup:I,isTarget:L,edgeUpdaterType:w.type,lib:Q,flowId:z,cancelConnection:$,panBy:R,isValidConnection:q,onConnect:B,onConnectStart:P,onConnectEnd:ne,onReconnectEnd:K,updateConnection:U,getTransform:()=>S.getState().transform,getFromHandle:()=>S.getState().connection.fromHandle,dragThreshold:S.getState().connectionDragThreshold,handleDomNode:A.currentTarget})},_=A=>C(A,{nodeId:s.target,id:s.targetHandle??null,type:"target"}),E=A=>C(A,{nodeId:s.source,id:s.sourceHandle??null,type:"source"}),D=()=>N(!0),T=()=>N(!1);return r.jsxs(r.Fragment,{children:[(t===!0||t==="source")&&r.jsx(Jy,{position:m,centerX:o,centerY:c,radius:a,onMouseDown:_,onMouseEnter:D,onMouseOut:T,type:"source"}),(t===!0||t==="target")&&r.jsx(Jy,{position:p,centerX:u,centerY:d,radius:a,onMouseDown:E,onMouseEnter:D,onMouseOut:T,type:"target"})]})}function PM({id:t,edgesFocusable:a,edgesReconnectable:s,elementsSelectable:o,onClick:c,onDoubleClick:u,onContextMenu:d,onMouseEnter:m,onMouseMove:p,onMouseLeave:g,reconnectRadius:y,onReconnect:x,onReconnectStart:b,onReconnectEnd:N,rfId:S,edgeTypes:C,noPanClassName:_,onError:E,disableKeyboardA11y:D}){let T=Oe(ge=>ge.edgeLookup.get(t));const A=Oe(ge=>ge.defaultEdgeOptions);T=A?{...A,...T}:T;let w=T.type||"default",O=C?.[w]||Zy[w];O===void 0&&(E?.("011",Vn.error011(w)),w="default",O=C?.default||Zy.default);const M=!!(T.focusable||a&&typeof T.focusable>"u"),q=typeof x<"u"&&(T.reconnectable||s&&typeof T.reconnectable>"u"),H=!!(T.selectable||o&&typeof T.selectable>"u"),F=j.useRef(null),[Q,Z]=j.useState(!1),[ne,$]=j.useState(!1),I=Ke(),{zIndex:z,sourceX:R,sourceY:U,targetX:L,targetY:K,sourcePosition:B,targetPosition:P}=Oe(j.useCallback(ge=>{const be=ge.nodeLookup.get(T.source),Se=ge.nodeLookup.get(T.target);if(!be||!Se)return{zIndex:T.zIndex,...Wy};const Ae=O8({id:t,sourceNode:be,targetNode:Se,sourceHandle:T.sourceHandle||null,targetHandle:T.targetHandle||null,connectionMode:ge.connectionMode,onError:E});return{zIndex:T8({selected:T.selected,zIndex:T.zIndex,sourceNode:be,targetNode:Se,elevateOnSelect:ge.elevateEdgesOnSelect,zIndexMode:ge.zIndexMode}),...Ae||Wy}},[T.source,T.target,T.sourceHandle,T.targetHandle,T.selected,T.zIndex]),We),ae=j.useMemo(()=>T.markerStart?`url('#${$h(T.markerStart,S)}')`:void 0,[T.markerStart,S]),G=j.useMemo(()=>T.markerEnd?`url('#${$h(T.markerEnd,S)}')`:void 0,[T.markerEnd,S]);if(T.hidden||R===null||U===null||L===null||K===null)return null;const re=ge=>{const{addSelectedEdges:be,unselectNodesAndEdges:Se,multiSelectionActive:Ae}=I.getState();H&&(I.setState({nodesSelectionActive:!1}),T.selected&&Ae?(Se({nodes:[],edges:[T]}),F.current?.blur()):be([t])),c&&c(ge,T)},de=u?ge=>{u(ge,{...T})}:void 0,ue=d?ge=>{d(ge,{...T})}:void 0,V=m?ge=>{m(ge,{...T})}:void 0,ce=p?ge=>{p(ge,{...T})}:void 0,he=g?ge=>{g(ge,{...T})}:void 0,ve=ge=>{if(!D&&H1.includes(ge.key)&&H){const{unselectNodesAndEdges:be,addSelectedEdges:Se}=I.getState();ge.key==="Escape"?(F.current?.blur(),be({edges:[T]})):Se([t])}};return r.jsx("svg",{style:{zIndex:z},children:r.jsxs("g",{className:ft(["react-flow__edge",`react-flow__edge-${w}`,T.className,_,{selected:T.selected,animated:T.animated,inactive:!H&&!c,updating:Q,selectable:H}]),onClick:re,onDoubleClick:de,onContextMenu:ue,onMouseEnter:V,onMouseMove:ce,onMouseLeave:he,onKeyDown:M?ve:void 0,tabIndex:M?0:void 0,role:T.ariaRole??(M?"group":"img"),"aria-roledescription":"edge","data-id":t,"data-testid":`rf__edge-${t}`,"aria-label":T.ariaLabel===null?void 0:T.ariaLabel||`Edge from ${T.source} to ${T.target}`,"aria-describedby":M?`${xv}-${S}`:void 0,ref:F,...T.domAttributes,children:[!ne&&r.jsx(O,{id:t,source:T.source,target:T.target,type:T.type,selected:T.selected,animated:T.animated,selectable:H,deletable:T.deletable??!0,label:T.label,labelStyle:T.labelStyle,labelShowBg:T.labelShowBg,labelBgStyle:T.labelBgStyle,labelBgPadding:T.labelBgPadding,labelBgBorderRadius:T.labelBgBorderRadius,sourceX:R,sourceY:U,targetX:L,targetY:K,sourcePosition:B,targetPosition:P,data:T.data,style:T.style,sourceHandleId:T.sourceHandle,targetHandleId:T.targetHandle,markerStart:ae,markerEnd:G,pathOptions:"pathOptions"in T?T.pathOptions:void 0,interactionWidth:T.interactionWidth}),q&&r.jsx(YM,{edge:T,isReconnectable:q,reconnectRadius:y,onReconnect:x,onReconnectStart:b,onReconnectEnd:N,sourceX:R,sourceY:U,targetX:L,targetY:K,sourcePosition:B,targetPosition:P,setUpdateHover:Z,setReconnecting:$})]})})}var IM=j.memo(PM);const XM=t=>({edgesFocusable:t.edgesFocusable,edgesReconnectable:t.edgesReconnectable,elementsSelectable:t.elementsSelectable,connectionMode:t.connectionMode,onError:t.onError});function Yv({defaultMarkerColor:t,onlyRenderVisibleElements:a,rfId:s,edgeTypes:o,noPanClassName:c,onReconnect:u,onEdgeContextMenu:d,onEdgeMouseEnter:m,onEdgeMouseMove:p,onEdgeMouseLeave:g,onEdgeClick:y,reconnectRadius:x,onEdgeDoubleClick:b,onReconnectStart:N,onReconnectEnd:S,disableKeyboardA11y:C}){const{edgesFocusable:_,edgesReconnectable:E,elementsSelectable:D,onError:T}=Oe(XM,We),A=AM(a);return r.jsxs("div",{className:"react-flow__edges",children:[r.jsx(OM,{defaultColor:t,rfId:s}),A.map(w=>r.jsx(IM,{id:w,edgesFocusable:_,edgesReconnectable:E,elementsSelectable:D,noPanClassName:c,onReconnect:u,onContextMenu:d,onMouseEnter:m,onMouseMove:p,onMouseLeave:g,onClick:y,reconnectRadius:x,onDoubleClick:b,onReconnectStart:N,onReconnectEnd:S,rfId:s,onError:T,edgeTypes:o,disableKeyboardA11y:C},w))]})}Yv.displayName="EdgeRenderer";const GM=j.memo(Yv),QM=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function FM({children:t}){const a=Oe(QM);return r.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:a},children:t})}function ZM(t){const a=Cm(),s=j.useRef(!1);j.useEffect(()=>{!s.current&&a.viewportInitialized&&t&&(setTimeout(()=>t(a),1),s.current=!0)},[t,a.viewportInitialized])}const WM=t=>t.panZoom?.syncViewport;function KM(t){const a=Oe(WM),s=Ke();return j.useEffect(()=>{t&&(a?.(t),s.setState({transform:[t.x,t.y,t.zoom]}))},[t,a]),null}function JM(t){return t.connection.inProgress?{...t.connection,to:Ho(t.connection.to,t.transform)}:{...t.connection}}function eA(t){return JM}function tA(t){const a=eA();return Oe(a,We)}const nA=t=>({nodesConnectable:t.nodesConnectable,isValid:t.connection.isValid,inProgress:t.connection.inProgress,width:t.width,height:t.height});function aA({containerStyle:t,style:a,type:s,component:o}){const{nodesConnectable:c,width:u,height:d,isValid:m,inProgress:p}=Oe(nA,We);return!(u&&c&&p)?null:r.jsx("svg",{style:t,width:u,height:d,className:"react-flow__connectionline react-flow__container",children:r.jsx("g",{className:ft(["react-flow__connection",U1(m)]),children:r.jsx(Pv,{style:a,type:s,CustomComponent:o,isValid:m})})})}const Pv=({style:t,type:a=ts.Bezier,CustomComponent:s,isValid:o})=>{const{inProgress:c,from:u,fromNode:d,fromHandle:m,fromPosition:p,to:g,toNode:y,toHandle:x,toPosition:b,pointer:N}=tA();if(!c)return;if(s)return r.jsx(s,{connectionLineType:a,connectionLineStyle:t,fromNode:d,fromHandle:m,fromX:u.x,fromY:u.y,toX:g.x,toY:g.y,fromPosition:p,toPosition:b,connectionStatus:U1(o),toNode:y,toHandle:x,pointer:N});let S="";const C={sourceX:u.x,sourceY:u.y,sourcePosition:p,targetX:g.x,targetY:g.y,targetPosition:b};switch(a){case ts.Bezier:[S]=J1(C);break;case ts.SimpleBezier:[S]=kv(C);break;case ts.Step:[S]=Hh({...C,borderRadius:0});break;case ts.SmoothStep:[S]=Hh(C);break;default:[S]=nv(C)}return r.jsx("path",{d:S,fill:"none",className:"react-flow__connection-path",style:t})};Pv.displayName="ConnectionLine";const sA={};function eb(t=sA){j.useRef(t),Ke(),j.useEffect(()=>{},[t])}function rA(){Ke(),j.useRef(!1),j.useEffect(()=>{},[])}function Iv({nodeTypes:t,edgeTypes:a,onInit:s,onNodeClick:o,onEdgeClick:c,onNodeDoubleClick:u,onEdgeDoubleClick:d,onNodeMouseEnter:m,onNodeMouseMove:p,onNodeMouseLeave:g,onNodeContextMenu:y,onSelectionContextMenu:x,onSelectionStart:b,onSelectionEnd:N,connectionLineType:S,connectionLineStyle:C,connectionLineComponent:_,connectionLineContainerStyle:E,selectionKeyCode:D,selectionOnDrag:T,selectionMode:A,multiSelectionKeyCode:w,panActivationKeyCode:O,zoomActivationKeyCode:M,deleteKeyCode:q,onlyRenderVisibleElements:H,elementsSelectable:F,defaultViewport:Q,translateExtent:Z,minZoom:ne,maxZoom:$,preventScrolling:I,defaultMarkerColor:z,zoomOnScroll:R,zoomOnPinch:U,panOnScroll:L,panOnScrollSpeed:K,panOnScrollMode:B,zoomOnDoubleClick:P,panOnDrag:ae,onPaneClick:G,onPaneMouseEnter:re,onPaneMouseMove:de,onPaneMouseLeave:ue,onPaneScroll:V,onPaneContextMenu:ce,paneClickDistance:he,nodeClickDistance:ve,onEdgeContextMenu:ge,onEdgeMouseEnter:be,onEdgeMouseMove:Se,onEdgeMouseLeave:Ae,reconnectRadius:Ee,onReconnect:$e,onReconnectStart:De,onReconnectEnd:yt,noDragClassName:pt,noWheelClassName:hn,noPanClassName:En,disableKeyboardA11y:Cn,nodeExtent:rt,rfId:Pn,viewport:mn,onViewportChange:en}){return eb(t),eb(a),rA(),ZM(s),KM(mn),r.jsx(vM,{onPaneClick:G,onPaneMouseEnter:re,onPaneMouseMove:de,onPaneMouseLeave:ue,onPaneContextMenu:ce,onPaneScroll:V,paneClickDistance:he,deleteKeyCode:q,selectionKeyCode:D,selectionOnDrag:T,selectionMode:A,onSelectionStart:b,onSelectionEnd:N,multiSelectionKeyCode:w,panActivationKeyCode:O,zoomActivationKeyCode:M,elementsSelectable:F,zoomOnScroll:R,zoomOnPinch:U,zoomOnDoubleClick:P,panOnScroll:L,panOnScrollSpeed:K,panOnScrollMode:B,panOnDrag:ae,defaultViewport:Q,translateExtent:Z,minZoom:ne,maxZoom:$,onSelectionContextMenu:x,preventScrolling:I,noDragClassName:pt,noWheelClassName:hn,noPanClassName:En,disableKeyboardA11y:Cn,onViewportChange:en,isControlledViewport:!!mn,children:r.jsxs(FM,{children:[r.jsx(GM,{edgeTypes:a,onEdgeClick:c,onEdgeDoubleClick:d,onReconnect:$e,onReconnectStart:De,onReconnectEnd:yt,onlyRenderVisibleElements:H,onEdgeContextMenu:ge,onEdgeMouseEnter:be,onEdgeMouseMove:Se,onEdgeMouseLeave:Ae,reconnectRadius:Ee,defaultMarkerColor:z,noPanClassName:En,disableKeyboardA11y:Cn,rfId:Pn}),r.jsx(aA,{style:C,type:S,component:_,containerStyle:E}),r.jsx("div",{className:"react-flow__edgelabel-renderer"}),r.jsx(MM,{nodeTypes:t,onNodeClick:o,onNodeDoubleClick:u,onNodeMouseEnter:m,onNodeMouseMove:p,onNodeMouseLeave:g,onNodeContextMenu:y,nodeClickDistance:ve,onlyRenderVisibleElements:H,noPanClassName:En,noDragClassName:pt,disableKeyboardA11y:Cn,nodeExtent:rt,rfId:Pn}),r.jsx("div",{className:"react-flow__viewport-portal"})]})})}Iv.displayName="GraphView";const iA=j.memo(Iv),tb=({nodes:t,edges:a,defaultNodes:s,defaultEdges:o,width:c,height:u,fitView:d,fitViewOptions:m,minZoom:p=.5,maxZoom:g=2,nodeOrigin:y,nodeExtent:x,zIndexMode:b="basic"}={})=>{const N=new Map,S=new Map,C=new Map,_=new Map,E=o??a??[],D=s??t??[],T=y??[0,0],A=x??wo;rv(C,_,E);const w=qh(D,N,S,{nodeOrigin:T,nodeExtent:A,zIndexMode:b});let O=[0,0,1];if(d&&c&&u){const M=Bo(N,{filter:Q=>!!((Q.width||Q.initialWidth)&&(Q.height||Q.initialHeight))}),{x:q,y:H,zoom:F}=vm(M,c,u,p,g,m?.padding??.1);O=[q,H,F]}return{rfId:"1",width:c??0,height:u??0,transform:O,nodes:D,nodesInitialized:w,nodeLookup:N,parentLookup:S,edges:E,edgeLookup:_,connectionLookup:C,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:s!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:p,maxZoom:g,translateExtent:wo,nodeExtent:A,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Gr.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:T,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:d??!1,fitViewOptions:m,fitViewResolver:null,connection:{...q1},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:j8,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:$1,zIndexMode:b,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},oA=({nodes:t,edges:a,defaultNodes:s,defaultEdges:o,width:c,height:u,fitView:d,fitViewOptions:m,minZoom:p,maxZoom:g,nodeOrigin:y,nodeExtent:x,zIndexMode:b})=>_T((N,S)=>{async function C(){const{nodeLookup:_,panZoom:E,fitViewOptions:D,fitViewResolver:T,width:A,height:w,minZoom:O,maxZoom:M}=S();E&&(await v8({nodes:_,width:A,height:w,panZoom:E,minZoom:O,maxZoom:M},D),T?.resolve(!0),N({fitViewResolver:null}))}return{...tb({nodes:t,edges:a,width:c,height:u,fitView:d,fitViewOptions:m,minZoom:p,maxZoom:g,nodeOrigin:y,nodeExtent:x,defaultNodes:s,defaultEdges:o,zIndexMode:b}),setNodes:_=>{const{nodeLookup:E,parentLookup:D,nodeOrigin:T,elevateNodesOnSelect:A,fitViewQueued:w,zIndexMode:O}=S(),M=qh(_,E,D,{nodeOrigin:T,nodeExtent:x,elevateNodesOnSelect:A,checkEquality:!0,zIndexMode:O});w&&M?(C(),N({nodes:_,nodesInitialized:M,fitViewQueued:!1,fitViewOptions:void 0})):N({nodes:_,nodesInitialized:M})},setEdges:_=>{const{connectionLookup:E,edgeLookup:D}=S();rv(E,D,_),N({edges:_})},setDefaultNodesAndEdges:(_,E)=>{if(_){const{setNodes:D}=S();D(_),N({hasDefaultNodes:!0})}if(E){const{setEdges:D}=S();D(E),N({hasDefaultEdges:!0})}},updateNodeInternals:_=>{const{triggerNodeChanges:E,nodeLookup:D,parentLookup:T,domNode:A,nodeOrigin:w,nodeExtent:O,debug:M,fitViewQueued:q,zIndexMode:H}=S(),{changes:F,updatedInternals:Q}=Y8(_,D,T,A,w,O,H);Q&&($8(D,T,{nodeOrigin:w,nodeExtent:O,zIndexMode:H}),q?(C(),N({fitViewQueued:!1,fitViewOptions:void 0})):N({}),F?.length>0&&(M&&console.log("React Flow: trigger node changes",F),E?.(F)))},updateNodePositions:(_,E=!1)=>{const D=[];let T=[];const{nodeLookup:A,triggerNodeChanges:w,connection:O,updateConnection:M,onNodesChangeMiddlewareMap:q}=S();for(const[H,F]of _){const Q=A.get(H),Z=!!(Q?.expandParent&&Q?.parentId&&F?.position),ne={id:H,type:"position",position:Z?{x:Math.max(0,F.position.x),y:Math.max(0,F.position.y)}:F.position,dragging:E};if(Q&&O.inProgress&&O.fromNode.id===Q.id){const $=Ys(Q,O.fromHandle,xe.Left,!0);M({...O,from:$})}Z&&Q.parentId&&D.push({id:H,parentId:Q.parentId,rect:{...F.internals.positionAbsolute,width:F.measured.width??0,height:F.measured.height??0}}),T.push(ne)}if(D.length>0){const{parentLookup:H,nodeOrigin:F}=S(),Q=Em(D,A,H,F);T.push(...Q)}for(const H of q.values())T=H(T);w(T)},triggerNodeChanges:_=>{const{onNodesChange:E,setNodes:D,nodes:T,hasDefaultNodes:A,debug:w}=S();if(_?.length){if(A){const O=vv(_,T);D(O)}w&&console.log("React Flow: trigger node changes",_),E?.(_)}},triggerEdgeChanges:_=>{const{onEdgesChange:E,setEdges:D,edges:T,hasDefaultEdges:A,debug:w}=S();if(_?.length){if(A){const O=wv(_,T);D(O)}w&&console.log("React Flow: trigger edge changes",_),E?.(_)}},addSelectedNodes:_=>{const{multiSelectionActive:E,edgeLookup:D,nodeLookup:T,triggerNodeChanges:A,triggerEdgeChanges:w}=S();if(E){const O=_.map(M=>zs(M,!0));A(O);return}A(Br(T,new Set([..._]),!0)),w(Br(D))},addSelectedEdges:_=>{const{multiSelectionActive:E,edgeLookup:D,nodeLookup:T,triggerNodeChanges:A,triggerEdgeChanges:w}=S();if(E){const O=_.map(M=>zs(M,!0));w(O);return}w(Br(D,new Set([..._]))),A(Br(T,new Set,!0))},unselectNodesAndEdges:({nodes:_,edges:E}={})=>{const{edges:D,nodes:T,nodeLookup:A,triggerNodeChanges:w,triggerEdgeChanges:O}=S(),M=_||T,q=E||D,H=M.map(Q=>{const Z=A.get(Q.id);return Z&&(Z.selected=!1),zs(Q.id,!1)}),F=q.map(Q=>zs(Q.id,!1));w(H),O(F)},setMinZoom:_=>{const{panZoom:E,maxZoom:D}=S();E?.setScaleExtent([_,D]),N({minZoom:_})},setMaxZoom:_=>{const{panZoom:E,minZoom:D}=S();E?.setScaleExtent([D,_]),N({maxZoom:_})},setTranslateExtent:_=>{S().panZoom?.setTranslateExtent(_),N({translateExtent:_})},resetSelectedElements:()=>{const{edges:_,nodes:E,triggerNodeChanges:D,triggerEdgeChanges:T,elementsSelectable:A}=S();if(!A)return;const w=E.reduce((M,q)=>q.selected?[...M,zs(q.id,!1)]:M,[]),O=_.reduce((M,q)=>q.selected?[...M,zs(q.id,!1)]:M,[]);D(w),T(O)},setNodeExtent:_=>{const{nodes:E,nodeLookup:D,parentLookup:T,nodeOrigin:A,elevateNodesOnSelect:w,nodeExtent:O,zIndexMode:M}=S();_[0][0]===O[0][0]&&_[0][1]===O[0][1]&&_[1][0]===O[1][0]&&_[1][1]===O[1][1]||(qh(E,D,T,{nodeOrigin:A,nodeExtent:_,elevateNodesOnSelect:w,checkEquality:!1,zIndexMode:M}),N({nodeExtent:_}))},panBy:_=>{const{transform:E,width:D,height:T,panZoom:A,translateExtent:w}=S();return P8({delta:_,panZoom:A,transform:E,translateExtent:w,width:D,height:T})},setCenter:async(_,E,D)=>{const{width:T,height:A,maxZoom:w,panZoom:O}=S();if(!O)return Promise.resolve(!1);const M=typeof D?.zoom<"u"?D.zoom:w;return await O.setViewport({x:T/2-_*M,y:A/2-E*M,zoom:M},{duration:D?.duration,ease:D?.ease,interpolate:D?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{N({connection:{...q1}})},updateConnection:_=>{N({connection:_})},reset:()=>N({...tb()})}},Object.is);function lA({initialNodes:t,initialEdges:a,defaultNodes:s,defaultEdges:o,initialWidth:c,initialHeight:u,initialMinZoom:d,initialMaxZoom:m,initialFitViewOptions:p,fitView:g,nodeOrigin:y,nodeExtent:x,zIndexMode:b,children:N}){const[S]=j.useState(()=>oA({nodes:t,edges:a,defaultNodes:s,defaultEdges:o,width:c,height:u,fitView:g,minZoom:d,maxZoom:m,fitViewOptions:p,nodeOrigin:y,nodeExtent:x,zIndexMode:b}));return r.jsx(ET,{value:S,children:r.jsx(FT,{children:N})})}function cA({children:t,nodes:a,edges:s,defaultNodes:o,defaultEdges:c,width:u,height:d,fitView:m,fitViewOptions:p,minZoom:g,maxZoom:y,nodeOrigin:x,nodeExtent:b,zIndexMode:N}){return j.useContext(ju)?r.jsx(r.Fragment,{children:t}):r.jsx(lA,{initialNodes:a,initialEdges:s,defaultNodes:o,defaultEdges:c,initialWidth:u,initialHeight:d,fitView:m,initialFitViewOptions:p,initialMinZoom:g,initialMaxZoom:y,nodeOrigin:x,nodeExtent:b,zIndexMode:N,children:t})}const uA={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function dA({nodes:t,edges:a,defaultNodes:s,defaultEdges:o,className:c,nodeTypes:u,edgeTypes:d,onNodeClick:m,onEdgeClick:p,onInit:g,onMove:y,onMoveStart:x,onMoveEnd:b,onConnect:N,onConnectStart:S,onConnectEnd:C,onClickConnectStart:_,onClickConnectEnd:E,onNodeMouseEnter:D,onNodeMouseMove:T,onNodeMouseLeave:A,onNodeContextMenu:w,onNodeDoubleClick:O,onNodeDragStart:M,onNodeDrag:q,onNodeDragStop:H,onNodesDelete:F,onEdgesDelete:Q,onDelete:Z,onSelectionChange:ne,onSelectionDragStart:$,onSelectionDrag:I,onSelectionDragStop:z,onSelectionContextMenu:R,onSelectionStart:U,onSelectionEnd:L,onBeforeDelete:K,connectionMode:B,connectionLineType:P=ts.Bezier,connectionLineStyle:ae,connectionLineComponent:G,connectionLineContainerStyle:re,deleteKeyCode:de="Backspace",selectionKeyCode:ue="Shift",selectionOnDrag:V=!1,selectionMode:ce=jo.Full,panActivationKeyCode:he="Space",multiSelectionKeyCode:ve=So()?"Meta":"Control",zoomActivationKeyCode:ge=So()?"Meta":"Control",snapToGrid:be,snapGrid:Se,onlyRenderVisibleElements:Ae=!1,selectNodesOnDrag:Ee,nodesDraggable:$e,autoPanOnNodeFocus:De,nodesConnectable:yt,nodesFocusable:pt,nodeOrigin:hn=yv,edgesFocusable:En,edgesReconnectable:Cn,elementsSelectable:rt=!0,defaultViewport:Pn=$T,minZoom:mn=.5,maxZoom:en=2,translateExtent:In=wo,preventScrolling:pn=!0,nodeExtent:Xn,defaultMarkerColor:cs="#b1b1b7",zoomOnScroll:oi=!0,zoomOnPinch:us=!0,panOnScroll:Ct=!1,panOnScrollSpeed:Tn=.5,panOnScrollMode:Tt=$s.Free,zoomOnDoubleClick:Tu=!0,panOnDrag:Mu=!0,onPaneClick:Au,onPaneMouseEnter:Is,onPaneMouseMove:Xs,onPaneMouseLeave:Gs,onPaneScroll:Gn,onPaneContextMenu:Qs,paneClickDistance:ds=1,nodeClickDistance:ku=0,children:Uo,onReconnect:li,onReconnectStart:fs,onReconnectEnd:Ru,onEdgeContextMenu:Vo,onEdgeDoubleClick:Yo,onEdgeMouseEnter:Po,onEdgeMouseMove:ci,onEdgeMouseLeave:ui,reconnectRadius:Io=10,onNodesChange:Xo,onEdgesChange:Mn,noDragClassName:ht="nodrag",noWheelClassName:Nt="nowheel",noPanClassName:Qn="nopan",fitView:Fs,fitViewOptions:Go,connectOnClick:Du,attributionPosition:Qo,proOptions:hs,defaultEdgeOptions:di,elevateNodesOnSelect:Sa=!0,elevateEdgesOnSelect:_a=!1,disableKeyboardA11y:Ea=!1,autoPanOnConnect:Ca,autoPanOnNodeDrag:it,autoPanSpeed:Fo,connectionRadius:Zo,isValidConnection:Fn,onError:Ta,style:zu,id:fi,nodeDragThreshold:Wo,connectionDragThreshold:Ou,viewport:Zs,onViewportChange:Ws,width:gn,height:kt,colorMode:Ko="light",debug:Bu,onScroll:Ks,ariaLabelConfig:Jo,zIndexMode:ms="basic",...Lu},Rt){const ps=fi||"1",el=YT(Ko),hi=j.useCallback(Zn=>{Zn.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ks?.(Zn)},[Ks]);return r.jsx("div",{"data-testid":"rf__wrapper",...Lu,onScroll:hi,style:{...zu,...uA},ref:Rt,className:ft(["react-flow",c,el]),id:fi,role:"application",children:r.jsxs(cA,{nodes:t,edges:a,width:gn,height:kt,fitView:Fs,fitViewOptions:Go,minZoom:mn,maxZoom:en,nodeOrigin:hn,nodeExtent:Xn,zIndexMode:ms,children:[r.jsx(iA,{onInit:g,onNodeClick:m,onEdgeClick:p,onNodeMouseEnter:D,onNodeMouseMove:T,onNodeMouseLeave:A,onNodeContextMenu:w,onNodeDoubleClick:O,nodeTypes:u,edgeTypes:d,connectionLineType:P,connectionLineStyle:ae,connectionLineComponent:G,connectionLineContainerStyle:re,selectionKeyCode:ue,selectionOnDrag:V,selectionMode:ce,deleteKeyCode:de,multiSelectionKeyCode:ve,panActivationKeyCode:he,zoomActivationKeyCode:ge,onlyRenderVisibleElements:Ae,defaultViewport:Pn,translateExtent:In,minZoom:mn,maxZoom:en,preventScrolling:pn,zoomOnScroll:oi,zoomOnPinch:us,zoomOnDoubleClick:Tu,panOnScroll:Ct,panOnScrollSpeed:Tn,panOnScrollMode:Tt,panOnDrag:Mu,onPaneClick:Au,onPaneMouseEnter:Is,onPaneMouseMove:Xs,onPaneMouseLeave:Gs,onPaneScroll:Gn,onPaneContextMenu:Qs,paneClickDistance:ds,nodeClickDistance:ku,onSelectionContextMenu:R,onSelectionStart:U,onSelectionEnd:L,onReconnect:li,onReconnectStart:fs,onReconnectEnd:Ru,onEdgeContextMenu:Vo,onEdgeDoubleClick:Yo,onEdgeMouseEnter:Po,onEdgeMouseMove:ci,onEdgeMouseLeave:ui,reconnectRadius:Io,defaultMarkerColor:cs,noDragClassName:ht,noWheelClassName:Nt,noPanClassName:Qn,rfId:ps,disableKeyboardA11y:Ea,nodeExtent:Xn,viewport:Zs,onViewportChange:Ws}),r.jsx(VT,{nodes:t,edges:a,defaultNodes:s,defaultEdges:o,onConnect:N,onConnectStart:S,onConnectEnd:C,onClickConnectStart:_,onClickConnectEnd:E,nodesDraggable:$e,autoPanOnNodeFocus:De,nodesConnectable:yt,nodesFocusable:pt,edgesFocusable:En,edgesReconnectable:Cn,elementsSelectable:rt,elevateNodesOnSelect:Sa,elevateEdgesOnSelect:_a,minZoom:mn,maxZoom:en,nodeExtent:Xn,onNodesChange:Xo,onEdgesChange:Mn,snapToGrid:be,snapGrid:Se,connectionMode:B,translateExtent:In,connectOnClick:Du,defaultEdgeOptions:di,fitView:Fs,fitViewOptions:Go,onNodesDelete:F,onEdgesDelete:Q,onDelete:Z,onNodeDragStart:M,onNodeDrag:q,onNodeDragStop:H,onSelectionDrag:I,onSelectionDragStart:$,onSelectionDragStop:z,onMove:y,onMoveStart:x,onMoveEnd:b,noPanClassName:Qn,nodeOrigin:hn,rfId:ps,autoPanOnConnect:Ca,autoPanOnNodeDrag:it,autoPanSpeed:Fo,onError:Ta,connectionRadius:Zo,isValidConnection:Fn,selectNodesOnDrag:Ee,nodeDragThreshold:Wo,connectionDragThreshold:Ou,onBeforeDelete:K,debug:Bu,ariaLabelConfig:Jo,zIndexMode:ms}),r.jsx(HT,{onSelectionChange:ne}),Uo,r.jsx(DT,{proOptions:hs,position:Qo}),r.jsx(RT,{rfId:ps,disableKeyboardA11y:Ea})]})})}var fA=jv(dA);function hA({dimensions:t,lineWidth:a,variant:s,className:o}){return r.jsx("path",{strokeWidth:a,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`,className:ft(["react-flow__background-pattern",s,o])})}function mA({radius:t,className:a}){return r.jsx("circle",{cx:t,cy:t,r:t,className:ft(["react-flow__background-pattern","dots",a])})}var ss;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(ss||(ss={}));const pA={[ss.Dots]:1,[ss.Lines]:1,[ss.Cross]:6},gA=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function Xv({id:t,variant:a=ss.Dots,gap:s=20,size:o,lineWidth:c=1,offset:u=0,color:d,bgColor:m,style:p,className:g,patternClassName:y}){const x=j.useRef(null),{transform:b,patternId:N}=Oe(gA,We),S=o||pA[a],C=a===ss.Dots,_=a===ss.Cross,E=Array.isArray(s)?s:[s,s],D=[E[0]*b[2]||1,E[1]*b[2]||1],T=S*b[2],A=Array.isArray(u)?u:[u,u],w=_?[T,T]:D,O=[A[0]*b[2]||1+w[0]/2,A[1]*b[2]||1+w[1]/2],M=`${N}${t||""}`;return r.jsxs("svg",{className:ft(["react-flow__background",g]),style:{...p,...Su,"--xy-background-color-props":m,"--xy-background-pattern-color-props":d},ref:x,"data-testid":"rf__background",children:[r.jsx("pattern",{id:M,x:b[0]%D[0],y:b[1]%D[1],width:D[0],height:D[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${O[0]},-${O[1]})`,children:C?r.jsx(mA,{radius:T/2,className:y}):r.jsx(hA,{dimensions:w,lineWidth:c,variant:a,className:y})}),r.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${M})`})]})}Xv.displayName="Background";const xA=j.memo(Xv);function yA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:r.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function bA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:r.jsx("path",{d:"M0 0h32v4.2H0z"})})}function vA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:r.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function wA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:r.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function jA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:r.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function jc({children:t,className:a,...s}){return r.jsx("button",{type:"button",className:ft(["react-flow__controls-button",a]),...s,children:t})}const NA=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom,ariaLabelConfig:t.ariaLabelConfig});function Gv({style:t,showZoom:a=!0,showFitView:s=!0,showInteractive:o=!0,fitViewOptions:c,onZoomIn:u,onZoomOut:d,onFitView:m,onInteractiveChange:p,className:g,children:y,position:x="bottom-left",orientation:b="vertical","aria-label":N}){const S=Ke(),{isInteractive:C,minZoomReached:_,maxZoomReached:E,ariaLabelConfig:D}=Oe(NA,We),{zoomIn:T,zoomOut:A,fitView:w}=Cm(),O=()=>{T(),u?.()},M=()=>{A(),d?.()},q=()=>{w(c),m?.()},H=()=>{S.setState({nodesDraggable:!C,nodesConnectable:!C,elementsSelectable:!C}),p?.(!C)},F=b==="horizontal"?"horizontal":"vertical";return r.jsxs(Nu,{className:ft(["react-flow__controls",F,g]),position:x,style:t,"data-testid":"rf__controls","aria-label":N??D["controls.ariaLabel"],children:[a&&r.jsxs(r.Fragment,{children:[r.jsx(jc,{onClick:O,className:"react-flow__controls-zoomin",title:D["controls.zoomIn.ariaLabel"],"aria-label":D["controls.zoomIn.ariaLabel"],disabled:E,children:r.jsx(yA,{})}),r.jsx(jc,{onClick:M,className:"react-flow__controls-zoomout",title:D["controls.zoomOut.ariaLabel"],"aria-label":D["controls.zoomOut.ariaLabel"],disabled:_,children:r.jsx(bA,{})})]}),s&&r.jsx(jc,{className:"react-flow__controls-fitview",onClick:q,title:D["controls.fitView.ariaLabel"],"aria-label":D["controls.fitView.ariaLabel"],children:r.jsx(vA,{})}),o&&r.jsx(jc,{className:"react-flow__controls-interactive",onClick:H,title:D["controls.interactive.ariaLabel"],"aria-label":D["controls.interactive.ariaLabel"],children:C?r.jsx(jA,{}):r.jsx(wA,{})}),y]})}Gv.displayName="Controls";const SA=j.memo(Gv);function _A({id:t,x:a,y:s,width:o,height:c,style:u,color:d,strokeColor:m,strokeWidth:p,className:g,borderRadius:y,shapeRendering:x,selected:b,onClick:N}){const{background:S,backgroundColor:C}=u||{},_=d||S||C;return r.jsx("rect",{className:ft(["react-flow__minimap-node",{selected:b},g]),x:a,y:s,rx:y,ry:y,width:o,height:c,style:{fill:_,stroke:m,strokeWidth:p},shapeRendering:x,onClick:N?E=>N(E,t):void 0})}const EA=j.memo(_A),CA=t=>t.nodes.map(a=>a.id),hh=t=>t instanceof Function?t:()=>t;function TA({nodeStrokeColor:t,nodeColor:a,nodeClassName:s="",nodeBorderRadius:o=5,nodeStrokeWidth:c,nodeComponent:u=EA,onClick:d}){const m=Oe(CA,We),p=hh(a),g=hh(t),y=hh(s),x=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return r.jsx(r.Fragment,{children:m.map(b=>r.jsx(AA,{id:b,nodeColorFunc:p,nodeStrokeColorFunc:g,nodeClassNameFunc:y,nodeBorderRadius:o,nodeStrokeWidth:c,NodeComponent:u,onClick:d,shapeRendering:x},b))})}function MA({id:t,nodeColorFunc:a,nodeStrokeColorFunc:s,nodeClassNameFunc:o,nodeBorderRadius:c,nodeStrokeWidth:u,shapeRendering:d,NodeComponent:m,onClick:p}){const{node:g,x:y,y:x,width:b,height:N}=Oe(S=>{const{internals:C}=S.nodeLookup.get(t),_=C.userNode,{x:E,y:D}=C.positionAbsolute,{width:T,height:A}=Na(_);return{node:_,x:E,y:D,width:T,height:A}},We);return!g||g.hidden||!G1(g)?null:r.jsx(m,{x:y,y:x,width:b,height:N,style:g.style,selected:!!g.selected,className:o(g),color:a(g),borderRadius:c,strokeColor:s(g),strokeWidth:u,shapeRendering:d,onClick:p,id:g.id})}const AA=j.memo(MA);var kA=j.memo(TA);const RA=200,DA=150,zA=t=>!t.hidden,OA=t=>{const a={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:a,boundingRect:t.nodeLookup.size>0?X1(Bo(t.nodeLookup,{filter:zA}),a):a,rfId:t.rfId,panZoom:t.panZoom,translateExtent:t.translateExtent,flowWidth:t.width,flowHeight:t.height,ariaLabelConfig:t.ariaLabelConfig}},BA="react-flow__minimap-desc";function Qv({style:t,className:a,nodeStrokeColor:s,nodeColor:o,nodeClassName:c="",nodeBorderRadius:u=5,nodeStrokeWidth:d,nodeComponent:m,bgColor:p,maskColor:g,maskStrokeColor:y,maskStrokeWidth:x,position:b="bottom-right",onClick:N,onNodeClick:S,pannable:C=!1,zoomable:_=!1,ariaLabel:E,inversePan:D,zoomStep:T=1,offsetScale:A=5}){const w=Ke(),O=j.useRef(null),{boundingRect:M,viewBB:q,rfId:H,panZoom:F,translateExtent:Q,flowWidth:Z,flowHeight:ne,ariaLabelConfig:$}=Oe(OA,We),I=t?.width??RA,z=t?.height??DA,R=M.width/I,U=M.height/z,L=Math.max(R,U),K=L*I,B=L*z,P=A*L,ae=M.x-(K-M.width)/2-P,G=M.y-(B-M.height)/2-P,re=K+P*2,de=B+P*2,ue=`${BA}-${H}`,V=j.useRef(0),ce=j.useRef();V.current=L,j.useEffect(()=>{if(O.current&&F)return ce.current=J8({domNode:O.current,panZoom:F,getTransform:()=>w.getState().transform,getViewScale:()=>V.current}),()=>{ce.current?.destroy()}},[F]),j.useEffect(()=>{ce.current?.update({translateExtent:Q,width:Z,height:ne,inversePan:D,pannable:C,zoomStep:T,zoomable:_})},[C,_,D,T,Q,Z,ne]);const he=N?be=>{const[Se,Ae]=ce.current?.pointer(be)||[0,0];N(be,{x:Se,y:Ae})}:void 0,ve=S?j.useCallback((be,Se)=>{const Ae=w.getState().nodeLookup.get(Se).internals.userNode;S(be,Ae)},[]):void 0,ge=E??$["minimap.ariaLabel"];return r.jsx(Nu,{position:b,style:{...t,"--xy-minimap-background-color-props":typeof p=="string"?p:void 0,"--xy-minimap-mask-background-color-props":typeof g=="string"?g:void 0,"--xy-minimap-mask-stroke-color-props":typeof y=="string"?y:void 0,"--xy-minimap-mask-stroke-width-props":typeof x=="number"?x*L:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof s=="string"?s:void 0,"--xy-minimap-node-stroke-width-props":typeof d=="number"?d:void 0},className:ft(["react-flow__minimap",a]),"data-testid":"rf__minimap",children:r.jsxs("svg",{width:I,height:z,viewBox:`${ae} ${G} ${re} ${de}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":ue,ref:O,onClick:he,children:[ge&&r.jsx("title",{id:ue,children:ge}),r.jsx(kA,{onClick:ve,nodeColor:o,nodeStrokeColor:s,nodeBorderRadius:u,nodeClassName:c,nodeStrokeWidth:d,nodeComponent:m}),r.jsx("path",{className:"react-flow__minimap-mask",d:`M${ae-P},${G-P}h${re+P*2}v${de+P*2}h${-re-P*2}z
        M${q.x},${q.y}h${q.width}v${q.height}h${-q.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Qv.displayName="MiniMap";const LA=j.memo(Qv),HA=t=>a=>t?`${Math.max(1/a.transform[2],1)}`:void 0,$A={[Wr.Line]:"right",[Wr.Handle]:"bottom-right"};function qA({nodeId:t,position:a,variant:s=Wr.Handle,className:o,style:c=void 0,children:u,color:d,minWidth:m=10,minHeight:p=10,maxWidth:g=Number.MAX_VALUE,maxHeight:y=Number.MAX_VALUE,keepAspectRatio:x=!1,resizeDirection:b,autoScale:N=!0,shouldResize:S,onResizeStart:C,onResize:_,onResizeEnd:E}){const D=Ev(),T=typeof t=="string"?t:D,A=Ke(),w=j.useRef(null),O=s===Wr.Handle,M=Oe(j.useCallback(HA(O&&N),[O,N]),We),q=j.useRef(null),H=a??$A[s];j.useEffect(()=>{if(!(!w.current||!T))return q.current||(q.current=hT({domNode:w.current,nodeId:T,getStoreItems:()=>{const{nodeLookup:Q,transform:Z,snapGrid:ne,snapToGrid:$,nodeOrigin:I,domNode:z}=A.getState();return{nodeLookup:Q,transform:Z,snapGrid:ne,snapToGrid:$,nodeOrigin:I,paneDomNode:z}},onChange:(Q,Z)=>{const{triggerNodeChanges:ne,nodeLookup:$,parentLookup:I,nodeOrigin:z}=A.getState(),R=[],U={x:Q.x,y:Q.y},L=$.get(T);if(L&&L.expandParent&&L.parentId){const K=L.origin??z,B=Q.width??L.measured.width??0,P=Q.height??L.measured.height??0,ae={id:L.id,parentId:L.parentId,rect:{width:B,height:P,...Q1({x:Q.x??L.position.x,y:Q.y??L.position.y},{width:B,height:P},L.parentId,$,K)}},G=Em([ae],$,I,z);R.push(...G),U.x=Q.x?Math.max(K[0]*B,Q.x):void 0,U.y=Q.y?Math.max(K[1]*P,Q.y):void 0}if(U.x!==void 0&&U.y!==void 0){const K={id:T,type:"position",position:{...U}};R.push(K)}if(Q.width!==void 0&&Q.height!==void 0){const B={id:T,type:"dimensions",resizing:!0,setAttributes:b?b==="horizontal"?"width":"height":!0,dimensions:{width:Q.width,height:Q.height}};R.push(B)}for(const K of Z){const B={...K,type:"position"};R.push(B)}ne(R)},onEnd:({width:Q,height:Z})=>{const ne={id:T,type:"dimensions",resizing:!1,dimensions:{width:Q,height:Z}};A.getState().triggerNodeChanges([ne])}})),q.current.update({controlPosition:H,boundaries:{minWidth:m,minHeight:p,maxWidth:g,maxHeight:y},keepAspectRatio:x,resizeDirection:b,onResizeStart:C,onResize:_,onResizeEnd:E,shouldResize:S}),()=>{q.current?.destroy()}},[H,m,p,g,y,x,C,_,E,S]);const F=H.split("-");return r.jsx("div",{className:ft(["react-flow__resize-control","nodrag",...F,s,o]),ref:w,style:{...c,scale:M,...d&&{[O?"backgroundColor":"borderColor"]:d}},children:u})}j.memo(qA);const mh=[{id:"trigger-1",type:"trigger",position:{x:250,y:50},data:{label:"Inicio",config:{type:"classification",conditions:{intent:["sales"]}}}}],UA=[],ii=Mb((t,a)=>({flowId:null,flowName:"Nuevo Flujo",flowSlug:null,isActive:!1,isSaved:!0,nodes:mh,edges:UA,selectedNode:null,selectedEdge:null,isSidebarOpen:!0,isPropertiesOpen:!1,onNodesChange:s=>{t({nodes:vv(s,a().nodes),isSaved:!1})},onEdgesChange:s=>{t({edges:wv(s,a().edges),isSaved:!1})},onConnect:s=>{t({edges:tv({...s,type:"smoothstep",animated:!0,style:{stroke:"#25D366",strokeWidth:2}},a().edges),isSaved:!1})},addNode:(s,o)=>{const c=`${s}-${Date.now()}`,d={id:c,type:s,position:o,data:{trigger:{label:"Trigger",config:{type:"classification",conditions:{}}},message:{label:"Mensaje",content:"Escribe tu mensaje aqu..."},question:{label:"Pregunta",content:"Cul es tu opcin?",variable:"respuesta",options:[]},condition:{label:"Condicin",conditions:[]},action:{label:"Accin",action:"",payload:{}},transfer:{label:"Transferir",content:"Transfiriendo a un agente..."},end:{label:"Fin"}}[s]||{label:s}};return t({nodes:[...a().nodes,d],isSaved:!1}),c},updateNodeData:(s,o)=>{t({nodes:a().nodes.map(c=>c.id===s?{...c,data:{...c.data,...o}}:c),isSaved:!1})},deleteNode:s=>{t({nodes:a().nodes.filter(o=>o.id!==s),edges:a().edges.filter(o=>o.source!==s&&o.target!==s),selectedNode:null,isSaved:!1})},setSelectedNode:s=>t({selectedNode:s,isPropertiesOpen:!!s}),setSelectedEdge:s=>t({selectedEdge:s}),clearSelection:()=>t({selectedNode:null,selectedEdge:null}),toggleSidebar:()=>t({isSidebarOpen:!a().isSidebarOpen}),toggleProperties:()=>t({isPropertiesOpen:!a().isPropertiesOpen}),setFlowMeta:s=>t({flowId:s.id,flowName:s.name,flowSlug:s.slug,isActive:s.is_active}),loadFlow:s=>{const o={trigger:"Inicio",message:"Mensaje",question:"Pregunta",condition:"Condicin",action:"Accin",transfer:"Transferir",end:"Fin"},c=(s.nodes||[]).map(u=>{let d=o[u.type]||u.type;return u.content&&u.content.length>0&&(d=u.content.substring(0,25)+(u.content.length>25?"...":"")),u.action&&(d=`Accin: ${u.action}`),{id:u.id,type:u.type,position:u.position||{x:250,y:50},data:{label:d,content:u.content,variable:u.variable,options:u.options,conditions:u.conditions,action:u.action,payload:u.payload,config:u.config||(u.type==="trigger"?s.trigger_config:void 0)}}});t({flowId:s.id,flowName:s.name,flowSlug:s.slug,isActive:s.is_active,nodes:c.length>0?c:mh,edges:s.connections?.map(u=>({id:`${u.from}-${u.to}`,source:u.from,target:u.to,type:"smoothstep",animated:!0,label:u.label,style:{stroke:"#25D366",strokeWidth:2}}))||[],isSaved:!0})},resetFlow:()=>t({flowId:null,flowName:"Nuevo Flujo",flowSlug:null,isActive:!1,nodes:mh,edges:[],selectedNode:null,isSaved:!0}),markSaved:()=>t({isSaved:!0}),exportFlow:()=>{const s=a();return{name:s.flowName,trigger_config:s.nodes.find(o=>o.type==="trigger")?.data.config||{},nodes:s.nodes.map(o=>({id:o.id,type:o.type,content:o.data.content,variable:o.data.variable,options:o.data.options,conditions:o.data.conditions,action:o.data.action,payload:o.data.payload,position:o.position})),connections:s.edges.map(o=>({from:o.source,to:o.target,label:o.label}))}}}));function VA({onTestClick:t}){const{flowId:a,flowName:s,isActive:o,isSaved:c,exportFlow:u,markSaved:d,loadFlow:m,resetFlow:p,setFlowMeta:g}=ii(),[y,x]=j.useState(!1),[b,N]=j.useState(!1),[S,C]=j.useState([]),[_,E]=j.useState(s),D=async()=>{x(!0);try{const M=u();if(M.name=_,a)await C_(a,M);else{const q=await E_(M);g({id:q.id,name:_,slug:q.slug,is_active:!1})}d(),alert("Flujo guardado correctamente")}catch(M){alert("Error al guardar: "+M.message)}finally{x(!1)}},T=async()=>{if(!a){alert("Primero guarda el flujo");return}try{await i1(a,!o),g({id:a,name:_,is_active:!o}),alert(o?"Flujo desactivado":"Flujo activado")}catch(M){alert("Error: "+M.message)}},A=async()=>{try{const M=await r1();C(M.flows||[]),N(!0)}catch(M){alert("Error cargando flujos: "+M.message)}},w=async M=>{try{const q=await Th(M.id);m(q.flow),E(q.flow.name),N(!1)}catch(q){alert("Error cargando flujo: "+q.message)}},O=()=>{!c&&!confirm("Tienes cambios sin guardar. Continuar?")||(p(),E("Nuevo Flujo"))};return r.jsxs("div",{style:{height:"56px",background:"white",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("span",{style:{fontSize:"24px"},children:""}),r.jsx("span",{style:{fontWeight:600,color:"#075E54"},children:"Flow Builder"})]}),r.jsx("div",{style:{borderLeft:"1px solid #e5e7eb",height:"24px"}}),r.jsx("input",{type:"text",value:_,onChange:M=>E(M.target.value),style:{border:"none",fontSize:"15px",fontWeight:500,background:"transparent",width:"200px"},placeholder:"Nombre del flujo"}),!c&&r.jsx("span",{style:{fontSize:"11px",background:"#fef3c7",color:"#92400e",padding:"2px 8px",borderRadius:"4px"},children:"Sin guardar"}),o&&r.jsx("span",{style:{fontSize:"11px",background:"#d1fae5",color:"#065f46",padding:"2px 8px",borderRadius:"4px"},children:"Activo"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("button",{onClick:t,style:{padding:"8px 16px",background:"linear-gradient(135deg, #075E54 0%, #128C7E 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:500},children:" Probar"}),r.jsx("div",{style:{borderLeft:"1px solid #e5e7eb",height:"24px",margin:"0 4px"}}),r.jsx("button",{onClick:O,style:{padding:"8px 16px",background:"white",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"13px"},children:"+ Nuevo"}),r.jsx("button",{onClick:A,style:{padding:"8px 16px",background:"white",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"13px"},children:" Abrir"}),r.jsx("button",{onClick:D,disabled:y,style:{padding:"8px 16px",background:"#25D366",color:"white",border:"none",borderRadius:"6px",cursor:y?"wait":"pointer",fontSize:"13px",fontWeight:500},children:y?"Guardando...":" Guardar"}),a&&r.jsx("button",{onClick:T,style:{padding:"8px 16px",background:o?"#fee2e2":"#d1fae5",color:o?"#dc2626":"#065f46",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:500},children:o?" Desactivar":" Activar"})]}),b&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",width:"400px",maxHeight:"500px",overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"16px"},children:[r.jsx("h3",{style:{margin:0},children:"Seleccionar flujo"}),r.jsx("button",{onClick:()=>N(!1),style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px"},children:""})]}),S.length===0?r.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:"No hay flujos guardados"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:S.map(M=>r.jsxs("div",{onClick:()=>w(M),style:{padding:"12px",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseOver:q=>q.currentTarget.style.background="#f9fafb",onMouseOut:q=>q.currentTarget.style.background="white",children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:500},children:M.name}),r.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:M.slug})]}),M.is_active&&r.jsx("span",{style:{fontSize:"10px",background:"#d1fae5",color:"#065f46",padding:"2px 6px",borderRadius:"4px"},children:"Activo"})]},M.id))})]})})]})}const YA=[{type:"trigger",label:"Trigger",icon:"",color:"#667eea",description:"Inicio del flujo"},{type:"message",label:"Mensaje",icon:"",color:"#25D366",description:"Enviar mensaje"},{type:"question",label:"Pregunta",icon:"",color:"#34B7F1",description:"Preguntar y esperar"},{type:"condition",label:"Condicin",icon:"",color:"#f59e0b",description:"Bifurcacin"},{type:"action",label:"Accin",icon:"",color:"#6366f1",description:"Ejecutar accin"},{type:"ai_response",label:"Respuesta IA",icon:"",color:"#8b5cf6",description:"Generar con IA"},{type:"webhook",label:"Webhook",icon:"",color:"#f97316",description:"Llamar API externa"},{type:"delay",label:"Espera",icon:"",color:"#64748b",description:"Pausar X segundos"},{type:"transfer",label:"Transferir",icon:"",color:"#ec4899",description:"Pasar a humano"},{type:"end",label:"Fin",icon:"",color:"#ef4444",description:"Terminar flujo"}];function PA(){const{isSidebarOpen:t,toggleSidebar:a}=ii(),s=(o,c)=>{o.dataTransfer.setData("application/reactflow",c),o.dataTransfer.effectAllowed="move"};return t?r.jsxs("div",{style:{width:"240px",background:"white",borderRight:"1px solid #e5e7eb",padding:"16px",display:"flex",flexDirection:"column",height:"100%"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[r.jsx("h3",{style:{margin:0,fontSize:"14px",fontWeight:600},children:"Nodos"}),r.jsx("button",{onClick:a,style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",color:"#6b7280"},children:""})]}),r.jsx("p",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"16px"},children:"Arrastra los nodos al canvas para construir tu flujo"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:YA.map(o=>r.jsxs("div",{draggable:!0,onDragStart:c=>s(c,o.type),style:{padding:"10px 12px",borderRadius:"8px",cursor:"grab",display:"flex",alignItems:"center",gap:"10px",background:`${o.color}15`,border:`1px solid ${o.color}30`,transition:"all 0.2s"},onMouseOver:c=>{c.currentTarget.style.transform="translateX(4px)",c.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},onMouseOut:c=>{c.currentTarget.style.transform="none",c.currentTarget.style.boxShadow="none"},children:[r.jsx("span",{style:{fontSize:"20px"},children:o.icon}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:500,fontSize:"13px"},children:o.label}),r.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:o.description})]})]},o.type))})]}):r.jsxs("button",{onClick:a,style:{position:"absolute",left:10,top:10,zIndex:10,background:"white",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[r.jsx("span",{children:""})," Nodos"]})}const nb={trigger:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none"},message:{background:"white",border:"2px solid #25D366"},question:{background:"white",border:"2px solid #34B7F1"},condition:{background:"#fef3c7",border:"2px solid #f59e0b"},action:{background:"#e0e7ff",border:"2px solid #6366f1"},transfer:{background:"#fce7f3",border:"2px solid #ec4899"},end:{background:"#fee2e2",border:"2px solid #ef4444"}},IA={trigger:"",message:"",question:"",condition:"",action:"",transfer:"",end:""};function XA({id:t,data:a,type:s,selected:o}){const c=nb[s]||nb.message,u=IA[s]||"",d=s!=="end",m=s!=="trigger";return r.jsxs("div",{style:{...c,padding:"12px 16px",borderRadius:"8px",minWidth:"180px",maxWidth:"250px",boxShadow:o?"0 0 0 2px #3b82f6":"0 2px 8px rgba(0,0,0,0.1)",cursor:"pointer"},children:[m&&r.jsx(Kr,{type:"target",position:xe.Top,style:{background:"#6b7280",width:10,height:10}}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[r.jsx("span",{style:{fontSize:"16px"},children:u}),r.jsx("strong",{style:{fontSize:"13px"},children:a.label||s})]}),a.content&&r.jsxs("div",{style:{fontSize:"11px",opacity:.8,marginTop:"4px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.content.substring(0,40),a.content.length>40?"...":""]}),a.options&&a.options.length>0&&r.jsxs("div",{style:{fontSize:"10px",marginTop:"6px",opacity:.7},children:[a.options.length," opciones"]}),d&&r.jsx(Kr,{type:"source",position:xe.Bottom,style:{background:"#25D366",width:10,height:10}})]})}const Rs=j.memo(XA),GA={trigger:t=>r.jsx(Rs,{...t,type:"trigger"}),message:t=>r.jsx(Rs,{...t,type:"message"}),question:t=>r.jsx(Rs,{...t,type:"question"}),condition:t=>r.jsx(Rs,{...t,type:"condition"}),action:t=>r.jsx(Rs,{...t,type:"action"}),transfer:t=>r.jsx(Rs,{...t,type:"transfer"}),end:t=>r.jsx(Rs,{...t,type:"end"})};function QA(){const t=j.useRef(null),{nodes:a,edges:s,onNodesChange:o,onEdgesChange:c,onConnect:u,addNode:d,setSelectedNode:m}=ii(),p=j.useCallback(b=>{b.preventDefault(),b.dataTransfer.dropEffect="move"},[]),g=j.useCallback(b=>{b.preventDefault();const N=b.dataTransfer.getData("application/reactflow");if(!N)return;const S=t.current.getBoundingClientRect(),C={x:b.clientX-S.left-90,y:b.clientY-S.top-25};d(N,C)},[d]),y=j.useCallback((b,N)=>{m(N)},[m]),x=j.useCallback(()=>{m(null)},[m]);return r.jsx("div",{ref:t,style:{flex:1,height:"100%"},children:r.jsxs(fA,{nodes:a,edges:s,onNodesChange:o,onEdgesChange:c,onConnect:u,onDrop:g,onDragOver:p,onNodeClick:y,onPaneClick:x,nodeTypes:GA,fitView:!0,snapToGrid:!0,snapGrid:[15,15],defaultEdgeOptions:{type:"smoothstep",animated:!0,style:{stroke:"#25D366",strokeWidth:2}},children:[r.jsx(xA,{color:"#e5e7eb",gap:20}),r.jsx(SA,{}),r.jsx(LA,{nodeColor:b=>({trigger:"#667eea",message:"#25D366",question:"#34B7F1",condition:"#f59e0b",action:"#6366f1",transfer:"#ec4899",end:"#ef4444"})[b.type]||"#6b7280",maskColor:"rgba(255, 255, 255, 0.8)"})]})})}const FA=[{value:"sales",label:"Ventas",color:"#10b981"},{value:"support",label:"Soporte",color:"#3b82f6"},{value:"complaint",label:"Quejas",color:"#ef4444"},{value:"info",label:"Informacin",color:"#8b5cf6"},{value:"greeting",label:"Saludo",color:"#f59e0b"}],ZA=[{value:"low",label:"Baja"},{value:"medium",label:"Media"},{value:"high",label:"Alta"},{value:"critical",label:"Crtica"}];function WA(){const{selectedNode:t,updateNodeData:a,deleteNode:s,isPropertiesOpen:o,toggleProperties:c}=ii(),[u,d]=j.useState({}),[m,p]=j.useState({type:"keyword",keywords:[],conditions:{}}),[g,y]=j.useState([]),x=At(w=>w.token);j.useEffect(()=>{t&&(d(t.data||{}),t.type==="trigger"&&t.data?.config&&p(t.data.config))},[t]),j.useEffect(()=>{t?.type==="transfer"&&g.length===0&&x&&fetch("/api/departments",{headers:{Authorization:`Bearer ${x}`}}).then(w=>w.json()).then(w=>y(w.departments||[])).catch(()=>{})},[t?.type,x]);const b=(w,O)=>{const M={...u,[w]:O};d(M),a(t.id,{[w]:O})},N=(w,O,M)=>{const q=[...u.options||[]];q[w]={...q[w],[O]:M},b("options",q)},S=()=>{const w=[...u.options||[],{label:"Nueva opcin",value:""}];b("options",w)},C=w=>{const O=u.options.filter((M,q)=>q!==w);b("options",O)},_=w=>{const O={type:w,keywords:[],conditions:{}};p(O),a(t.id,{config:O})},E=w=>{const O=w.split(",").map(q=>q.trim()).filter(q=>q),M={...m,keywords:O};p(M),a(t.id,{config:M})},D=w=>{const O=m.conditions?.intent||[];let M;O.includes(w)?M=O.filter(H=>H!==w):M=[...O,w];const q={...m,conditions:{...m.conditions,intent:M}};p(q),a(t.id,{config:q})},T=w=>{const O={...m,conditions:{...m.conditions,urgency:w}};p(O),a(t.id,{config:O})},A=w=>{const O={...m,conditions:{...m.conditions,min_lead_score:parseInt(w)||0}};p(O),a(t.id,{config:O})};return!o||!t?null:r.jsxs("div",{style:{width:"300px",background:"white",borderLeft:"1px solid #e5e7eb",padding:"16px",height:"100%",overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[r.jsx("h3",{style:{margin:0,fontSize:"14px",fontWeight:600},children:"Propiedades"}),r.jsx("button",{onClick:c,style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",color:"#6b7280"},children:""})]}),r.jsxs("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"16px"},children:["Tipo: ",r.jsx("strong",{children:t.type})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Etiqueta"}),r.jsx("input",{type:"text",value:u.label||"",onChange:w=>b("label",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"}})]}),t.type==="trigger"&&r.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,marginBottom:"12px",color:"#475569"},children:"Configuracin del Trigger"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"6px",color:"#64748b"},children:"Tipo de activacin"}),r.jsx("div",{style:{display:"flex",gap:"6px"},children:[{value:"keyword",label:"Palabras clave"},{value:"classification",label:"Clasificacin"},{value:"always",label:"Siempre"}].map(w=>r.jsx("button",{onClick:()=>_(w.value),style:{flex:1,padding:"8px 4px",fontSize:"11px",border:m.type===w.value?"2px solid #25D366":"1px solid #d1d5db",borderRadius:"6px",background:m.type===w.value?"#dcfce7":"white",color:m.type===w.value?"#166534":"#6b7280",cursor:"pointer",fontWeight:m.type===w.value?600:400},children:w.label},w.value))})]}),m.type==="keyword"&&r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#64748b"},children:"Palabras clave (separadas por coma)"}),r.jsx("input",{type:"text",value:(m.keywords||[]).join(", "),onChange:w=>E(w.target.value),placeholder:"precio, costo, cotizar, cuanto",style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}}),r.jsx("p",{style:{fontSize:"10px",color:"#94a3b8",marginTop:"4px"},children:"El flujo se activa si el mensaje contiene alguna de estas palabras"})]}),m.type==="classification"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"6px",color:"#64748b"},children:"Intenciones del mensaje"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:FA.map(w=>{const O=(m.conditions?.intent||[]).includes(w.value);return r.jsxs("button",{onClick:()=>D(w.value),style:{padding:"6px 10px",fontSize:"11px",border:O?`2px solid ${w.color}`:"1px solid #d1d5db",borderRadius:"16px",background:O?`${w.color}20`:"white",color:O?w.color:"#6b7280",cursor:"pointer",fontWeight:O?600:400},children:[O&&" ",w.label]},w.value)})})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#64748b"},children:"Urgencia mnima"}),r.jsxs("select",{value:m.conditions?.urgency||"",onChange:w=>T(w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},children:[r.jsx("option",{value:"",children:"Cualquiera"}),ZA.map(w=>r.jsx("option",{value:w.value,children:w.label},w.value))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#64748b"},children:"Lead score mnimo"}),r.jsx("input",{type:"number",min:"0",max:"100",value:m.conditions?.min_lead_score||0,onChange:w=>A(w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}}),r.jsx("p",{style:{fontSize:"10px",color:"#94a3b8",marginTop:"4px"},children:"Solo activa si el lead tiene este puntaje o ms (0-100)"})]})]}),m.type==="always"&&r.jsx("div",{style:{padding:"12px",background:"#fef3c7",borderRadius:"6px",border:"1px solid #fcd34d"},children:r.jsx("p",{style:{fontSize:"11px",color:"#92400e",margin:0},children:" Este flujo se activar para TODOS los mensajes entrantes que no coincidan con otros flujos. salo como flujo por defecto."})})]}),["message","question","transfer"].includes(t.type)&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Contenido del mensaje"}),r.jsx("textarea",{value:u.content||"",onChange:w=>b("content",w.target.value),rows:4,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px",resize:"vertical"},placeholder:"Escribe el mensaje..."}),r.jsxs("p",{style:{fontSize:"11px",color:"#6b7280",marginTop:"4px"},children:["Usa ","{{variable}}"," para insertar variables"]})]}),t.type==="transfer"&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Departamento destino"}),r.jsxs("select",{value:u.targetDepartmentId||"",onChange:w=>b("targetDepartmentId",w.target.value?Number(w.target.value):null),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"},children:[r.jsx("option",{value:"",children:"Auto (detectar por intent)"}),g.filter(w=>w.active).map(w=>r.jsx("option",{value:w.id,children:w.display_name||w.name},w.id))]}),r.jsx("p",{style:{fontSize:"11px",color:"#6b7280",marginTop:"4px"},children:'Si seleccionas "Auto", se usar el intent detectado para asignar departamento'})]}),t.type==="question"&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Guardar respuesta en variable"}),r.jsx("input",{type:"text",value:u.variable||"",onChange:w=>b("variable",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"},placeholder:"nombre_variable"})]}),t.type==="question"&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"8px"},children:"Opciones de respuesta"}),(u.options||[]).map((w,O)=>r.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[r.jsx("input",{type:"text",value:w.label,onChange:M=>N(O,"label",M.target.value),placeholder:"Texto",style:{flex:1,padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}}),r.jsx("input",{type:"text",value:w.value,onChange:M=>N(O,"value",M.target.value),placeholder:"Valor",style:{width:"80px",padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}}),r.jsx("button",{onClick:()=>C(O),style:{background:"#fee2e2",border:"none",borderRadius:"4px",padding:"0 8px",cursor:"pointer",color:"#ef4444"},children:""})]},O)),r.jsx("button",{onClick:S,style:{background:"#f3f4f6",border:"1px dashed #d1d5db",borderRadius:"6px",padding:"8px",width:"100%",cursor:"pointer",fontSize:"12px"},children:"+ Agregar opcin"})]}),t.type==="action"&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Tipo de accin"}),r.jsxs("select",{value:u.action||"",onChange:w=>b("action",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"},children:[r.jsx("option",{value:"",children:"Selecciona..."}),r.jsx("option",{value:"notify_sales",children:"Notificar a ventas"}),r.jsx("option",{value:"create_ticket",children:"Crear ticket"}),r.jsx("option",{value:"save_lead",children:"Guardar lead"}),r.jsx("option",{value:"send_email",children:"Enviar email"}),r.jsx("option",{value:"webhook",children:"Llamar webhook"}),r.jsx("option",{value:"search_faq",children:"Buscar en FAQ"})]})]}),t.type==="ai_response"&&r.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#f5f3ff",borderRadius:"8px",border:"1px solid #c4b5fd"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,marginBottom:"12px",color:"#5b21b6"},children:" Configuracin de IA"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Prompt del sistema"}),r.jsx("textarea",{value:u.system_prompt||"",onChange:w=>b("system_prompt",w.target.value),rows:3,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",resize:"vertical"},placeholder:"Eres un asistente de ventas amable y profesional..."})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Prompt del usuario"}),r.jsx("textarea",{value:u.user_prompt||"",onChange:w=>b("user_prompt",w.target.value),rows:2,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",resize:"vertical"},placeholder:"El cliente pregunta: {{initial_message}}"}),r.jsxs("p",{style:{fontSize:"10px",color:"#94a3b8",marginTop:"4px"},children:["Usa ","{{variable}}"," para insertar datos dinmicos"]})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Modelo"}),r.jsxs("select",{value:u.model||"gpt-4o-mini",onChange:w=>b("model",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},children:[r.jsx("option",{value:"gpt-4o-mini",children:"GPT-4o Mini (rpido)"}),r.jsx("option",{value:"gpt-4o",children:"GPT-4o (preciso)"}),r.jsx("option",{value:"gpt-4-turbo",children:"GPT-4 Turbo"})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Temperatura"}),r.jsx("input",{type:"number",min:"0",max:"1",step:"0.1",value:u.temperature||.7,onChange:w=>b("temperature",parseFloat(w.target.value)),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Max tokens"}),r.jsx("input",{type:"number",min:"50",max:"2000",step:"50",value:u.max_tokens||200,onChange:w=>b("max_tokens",parseInt(w.target.value)),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Guardar respuesta en variable (opcional)"}),r.jsx("input",{type:"text",value:u.variable||"",onChange:w=>b("variable",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},placeholder:"ai_response"})]})]}),t.type==="webhook"&&r.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#fff7ed",borderRadius:"8px",border:"1px solid #fed7aa"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,marginBottom:"12px",color:"#c2410c"},children:" Configuracin de Webhook"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"URL del endpoint"}),r.jsx("input",{type:"text",value:u.url||"",onChange:w=>b("url",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},placeholder:"https://api.ejemplo.com/endpoint"})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Mtodo HTTP"}),r.jsxs("select",{value:u.method||"POST",onChange:w=>b("method",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},children:[r.jsx("option",{value:"GET",children:"GET"}),r.jsx("option",{value:"POST",children:"POST"}),r.jsx("option",{value:"PUT",children:"PUT"}),r.jsx("option",{value:"PATCH",children:"PATCH"}),r.jsx("option",{value:"DELETE",children:"DELETE"})]})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Headers (JSON)"}),r.jsx("textarea",{value:u.headers||`{
  "Content-Type": "application/json"
}`,onChange:w=>b("headers",w.target.value),rows:3,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"11px",fontFamily:"monospace",resize:"vertical"}})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsxs("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:["Body (JSON) - Usa ","{{variable}}"," para datos dinmicos"]}),r.jsx("textarea",{value:u.body||`{
  "phone": "{{phone}}",
  "message": "{{initial_message}}"
}`,onChange:w=>b("body",w.target.value),rows:4,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"11px",fontFamily:"monospace",resize:"vertical"}})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Timeout (ms)"}),r.jsx("input",{type:"number",min:"1000",max:"30000",step:"1000",value:u.timeout||5e3,onChange:w=>b("timeout",parseInt(w.target.value)),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Guardar respuesta en variable"}),r.jsx("input",{type:"text",value:u.variable||"",onChange:w=>b("variable",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},placeholder:"api_response"})]})]}),t.type==="delay"&&r.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #cbd5e1"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,marginBottom:"12px",color:"#475569"},children:" Configuracin de Espera"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Segundos de espera"}),r.jsx("input",{type:"number",min:"1",max:"60",step:"1",value:u.seconds||2,onChange:w=>b("seconds",parseInt(w.target.value)),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"}}),r.jsx("p",{style:{fontSize:"10px",color:"#94a3b8",marginTop:"4px"},children:"Entre 1 y 60 segundos. Recomendado: 2-5 seg para parecer ms humano."})]}),r.jsx("div",{children:r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[r.jsx("input",{type:"checkbox",checked:u.typing_indicator!==!1,onChange:w=>b("typing_indicator",w.target.checked),style:{width:"16px",height:"16px"}}),r.jsx("span",{style:{fontSize:"12px",color:"#374151"},children:'Mostrar "escribiendo..." mientras espera'})]})})]}),r.jsx("div",{style:{marginTop:"24px",paddingTop:"16px",borderTop:"1px solid #e5e7eb"},children:r.jsx("button",{onClick:()=>s(t.id),style:{width:"100%",padding:"10px",background:"#fee2e2",border:"1px solid #fecaca",borderRadius:"6px",color:"#dc2626",cursor:"pointer",fontWeight:500,fontSize:"13px"},children:" Eliminar nodo"})})]})}function KA({isOpen:t,onClose:a}){const{nodes:s,edges:o,flowName:c}=ii(),[u,d]=j.useState([]),[m,p]=j.useState(""),[g,y]=j.useState(null),[x,b]=j.useState({}),[N,S]=j.useState(!1),[C,_]=j.useState(null),[E,D]=j.useState("local"),[T,A]=j.useState(!1),w=j.useRef(null);j.useEffect(()=>{w.current?.scrollIntoView({behavior:"smooth"})},[u]),j.useEffect(()=>{t&&O()},[t]);const O=()=>{d([{type:"system",text:`Simulando flujo: "${c}"`},{type:"system",text:"Escribe un mensaje para iniciar..."}]),b({}),y(null),S(!0),_(null)},M=R=>s.find(U=>U.id===R),q=(R,U=null)=>{const L=o.find(K=>!(K.source!==R||U&&K.label&&K.label!==U));return L?M(L.target):null},H=()=>s.find(R=>R.type==="trigger"),F=async R=>{if(!R){Z("system"," Flujo terminado (no hay siguiente nodo)"),S(!0);return}switch(_(R.id),y(R.id),await ne(300),R.type){case"trigger":Z("system"," Trigger activado");const U=q(R.id);F(U);break;case"message":const L=Q(R.data.content||"Mensaje vaco");Z("bot",L),await ne(500);const K=q(R.id);F(K);break;case"question":const B=Q(R.data.content||"?");Z("bot",B),R.data.options&&R.data.options.length>0&&Z("options",R.data.options),S(!0),y(R.id);break;case"condition":Z("system"," Evaluando condicin..."),await ne(300);const P=R.data.conditions||[];let ae=null;for(const Ee of P){if(Ee.else){ae=Ee.goto;break}const $e=Ee.if?.match(/(\w+)\s*==\s*["']?(\w+)["']?/);if($e){const[,De,yt]=$e;if(x[De]===yt){ae=Ee.goto,Z("system",` Condicin cumplida: ${De} = ${yt}`);break}}}const G=M(ae)||q(R.id);F(G);break;case"action":Z("system",` Ejecutando accin: ${R.data.action||"sin definir"}`),await ne(500);const re=q(R.id);F(re);break;case"ai_response":Z("system"," Generando respuesta con IA..."),A(!0),await ne(1500),A(!1);const de=R.data.system_prompt||"",ue=Q(R.data.user_prompt||""),V=`[Respuesta IA simulada]
${de.substring(0,50)}...
Para: "${ue.substring(0,50)}..."`;Z("bot",V),R.data.variable&&(b(Ee=>({...Ee,[R.data.variable]:"respuesta_ia_simulada"})),Z("system",` Variable "${R.data.variable}" = respuesta IA`)),await ne(300);const ce=q(R.id);F(ce);break;case"webhook":Z("system",` Llamando webhook: ${R.data.url||"URL no definida"}`),Z("system",`   Mtodo: ${R.data.method||"POST"}`),A(!0),await ne(1e3),A(!1);const he={success:!0,data:{status:"ok",simulated:!0}};Z("system",` Webhook respondi: ${JSON.stringify(he).substring(0,50)}...`),R.data.variable&&b(Ee=>({...Ee,[R.data.variable]:he}));const ve=q(R.id);F(ve);break;case"delay":const ge=R.data.seconds||2,be=R.data.typing_indicator!==!1;Z("system",` Esperando ${ge} segundos...`),be&&A(!0),await ne(ge*1e3),be&&A(!1);const Se=q(R.id);F(Se);break;case"transfer":Z("bot",R.data.content||"Transfiriendo a un agente..."),Z("system"," Conversacin transferida a humano"),S(!0);break;case"end":Z("system"," Flujo completado"),S(!0);break;default:Z("system",`Nodo desconocido: ${R.type}`);const Ae=q(R.id);F(Ae)}},Q=R=>R&&R.replace(/\{\{(\w+)\}\}/g,(U,L)=>x[L]||U),Z=(R,U)=>{d(L=>[...L,{type:R,text:U,time:new Date}])},ne=R=>new Promise(U=>setTimeout(U,R)),$=()=>{if(!m.trim())return;const R=m.trim();p(""),Z("user",R),S(!1);const U=M(g);if(U?.type==="question"&&U.data.variable){let L=R;if(U.data.options){const K=U.data.options.find(B=>B.label.toLowerCase()===R.toLowerCase()||B.value===R);K&&(L=K.value)}b(K=>({...K,[U.data.variable]:L})),Z("system",` Variable "${U.data.variable}" = "${L}"`),setTimeout(()=>{const K=q(g);F(K)},300)}else if(!g){const L=H();L?F(L):Z("system"," No hay nodo Trigger en el flujo")}},I=R=>{p(R.label),setTimeout(()=>$(),100)},z=R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),$())};return t?r.jsxs("div",{style:{position:"fixed",right:"20px",bottom:"20px",width:"380px",height:"550px",background:"white",borderRadius:"16px",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",zIndex:1e3,overflow:"hidden"},children:[r.jsxs("div",{style:{background:"linear-gradient(135deg, #075E54 0%, #128C7E 100%)",color:"white",padding:"12px 16px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:600,fontSize:"15px"},children:" Simulador de Chat"}),r.jsx("div",{style:{fontSize:"12px",opacity:.8},children:"Prueba tu flujo aqu"})]}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsx("button",{onClick:O,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px"},children:""}),r.jsx("button",{onClick:a,style:{background:"none",border:"none",color:"white",fontSize:"20px",cursor:"pointer",padding:"0 4px"},children:""})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"4px"},children:[r.jsx("button",{onClick:()=>D("local"),style:{flex:1,background:E==="local"?"white":"transparent",color:E==="local"?"#075E54":"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"11px",fontWeight:E==="local"?600:400},children:"Local"}),r.jsx("button",{onClick:()=>D("server"),style:{flex:1,background:E==="server"?"white":"transparent",color:E==="server"?"#075E54":"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"11px",fontWeight:E==="server"?600:400},children:"Servidor"})]})]}),Object.keys(x).length>0&&r.jsxs("div",{style:{background:"#f0fdf4",padding:"8px 16px",fontSize:"11px",borderBottom:"1px solid #e5e7eb"},children:[r.jsx("strong",{children:"Variables:"})," ",Object.entries(x).map(([R,U])=>r.jsxs("span",{style:{background:"#dcfce7",padding:"2px 6px",borderRadius:"4px",marginLeft:"4px"},children:[R,"=",typeof U=="object"?JSON.stringify(U).substring(0,30)+"...":String(U)]},R))]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"16px",background:"#e5ddd5",backgroundImage:'url("data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%239C92AC" fill-opacity="0.05"%3E%3Cpath d="M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")'},children:[u.map((R,U)=>r.jsx(JA,{message:R,onOptionClick:I},U)),T&&r.jsx("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"8px"},children:r.jsxs("div",{style:{background:"white",padding:"12px 16px",borderRadius:"12px 12px 12px 0",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",display:"flex",gap:"4px"},children:[r.jsx("span",{className:"typing-dot",style:{width:"8px",height:"8px",background:"#90a3ae",borderRadius:"50%",animation:"typing 1.4s infinite ease-in-out",animationDelay:"0s"}}),r.jsx("span",{className:"typing-dot",style:{width:"8px",height:"8px",background:"#90a3ae",borderRadius:"50%",animation:"typing 1.4s infinite ease-in-out",animationDelay:"0.2s"}}),r.jsx("span",{className:"typing-dot",style:{width:"8px",height:"8px",background:"#90a3ae",borderRadius:"50%",animation:"typing 1.4s infinite ease-in-out",animationDelay:"0.4s"}})]})}),r.jsx("div",{ref:w})]}),r.jsxs("div",{style:{padding:"12px",background:"#f0f2f5",display:"flex",gap:"8px"},children:[r.jsx("input",{type:"text",value:m,onChange:R=>p(R.target.value),onKeyPress:z,placeholder:N?"Escribe un mensaje...":"Esperando respuesta...",disabled:!N,style:{flex:1,padding:"10px 16px",border:"none",borderRadius:"24px",fontSize:"14px",outline:"none"}}),r.jsx("button",{onClick:$,disabled:!N||!m.trim(),style:{background:"#25D366",color:"white",border:"none",borderRadius:"50%",width:"40px",height:"40px",cursor:N&&m.trim()?"pointer":"not-allowed",opacity:N&&m.trim()?1:.5,fontSize:"18px"},children:""})]})]}):null}function JA({message:t,onOptionClick:a}){const{type:s,text:o}=t,c=d=>typeof d=="object"&&d!==null?JSON.stringify(d,null,2):String(d);if(s==="system")return r.jsx("div",{style:{textAlign:"center",margin:"8px 0",fontSize:"11px",color:"#667781",background:"rgba(255,255,255,0.8)",padding:"4px 12px",borderRadius:"8px",display:"inline-block",width:"100%"},children:c(o)});if(s==="options")return r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",margin:"8px 0"},children:o.map((d,m)=>r.jsx("button",{onClick:()=>a(d),style:{background:"white",border:"1px solid #25D366",color:"#25D366",padding:"8px 16px",borderRadius:"16px",cursor:"pointer",fontSize:"13px",fontWeight:500},children:d.label},m))});const u=s==="user";return r.jsx("div",{style:{display:"flex",justifyContent:u?"flex-end":"flex-start",marginBottom:"8px"},children:r.jsx("div",{style:{maxWidth:"80%",padding:"8px 12px",borderRadius:u?"12px 12px 0 12px":"12px 12px 12px 0",background:u?"#dcf8c6":"white",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",fontSize:"14px",lineHeight:"1.4",whiteSpace:"pre-wrap"},children:c(o)})})}const ph=[{title:"Bienvenido al Flow Builder!",description:"Crea flujos de conversacin para tu chatbot de WhatsApp de forma visual, sin escribir cdigo.",icon:"",image:null},{title:"Arrastra nodos al canvas",description:"En la barra izquierda encontrars los nodos disponibles. Arrstralos al canvas para construir tu flujo.",icon:"",tips:[" Mensaje: Enva un texto al usuario"," Pregunta: Espera una respuesta del usuario"," Condicin: Bifurca el flujo segn una variable"," Accin: Ejecuta una accin (notificar, guardar, etc.)"]},{title:"Conecta los nodos",description:"Arrastra desde el punto verde (salida) de un nodo hasta el punto gris (entrada) de otro para conectarlos.",icon:"",tips:["El flujo siempre empieza en el Trigger","Puedes tener mltiples caminos con Condiciones","Termina con un nodo Fin o Transferir"]},{title:"Configura cada nodo",description:"Haz clic en un nodo para ver sus propiedades a la derecha. Ah puedes editar el contenido, opciones y variables.",icon:"",tips:["Usa {{variable}} para insertar datos dinmicos","Las preguntas guardan la respuesta en una variable","Las condiciones evalan esas variables"]},{title:"Guarda y activa!",description:"Cuando termines, guarda tu flujo y actvalo para que empiece a responder mensajes automticamente.",icon:"",tips:["Puedes tener varios flujos, pero solo algunos activos",'Usa "Abrir" para cargar flujos guardados',"Las plantillas te dan flujos de ejemplo para empezar"]}];function ek({onComplete:t}){const[a,s]=j.useState(0),[o,c]=j.useState(!1),u=ph[a],d=a===ph.length-1,m=()=>{d?c(!0):s(a+1)},p=()=>{t(null)},g=y=>{t(y)};return o?r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"600px",width:"90%"},children:[r.jsx("h2",{style:{margin:"0 0 8px 0",fontSize:"24px"},children:"Cmo quieres empezar?"}),r.jsx("p",{style:{color:"#6b7280",margin:"0 0 24px 0"},children:"Puedes empezar desde cero o usar una plantilla predefinida"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[r.jsx(Nc,{icon:"",title:"Empezar vaco",description:"Canvas en blanco para crear tu propio flujo",onClick:()=>g(null)}),r.jsx(Nc,{icon:"",title:"Embudo de Ventas",description:"Califica leads y gualos a la compra",onClick:()=>g("sales_funnel"),color:"#25D366"}),r.jsx(Nc,{icon:"",title:"Embudo de Soporte",description:"Resuelve dudas con FAQ y escala a humanos",onClick:()=>g("support_funnel"),color:"#34B7F1"}),r.jsx(Nc,{icon:"",title:"Captura de Leads",description:"Recolecta informacin de contacto",onClick:()=>g("lead_capture"),color:"#f59e0b"})]}),r.jsx("button",{onClick:()=>g(null),style:{marginTop:"16px",padding:"8px",background:"none",border:"none",color:"#6b7280",cursor:"pointer",fontSize:"13px",width:"100%"},children:"Saltar y empezar vaco "})]})}):r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"90%",textAlign:"center"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"8px",marginBottom:"24px"},children:ph.map((y,x)=>r.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:x===a?"#25D366":"#e5e7eb",transition:"background 0.2s"}},x))}),r.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:u.icon}),r.jsx("h2",{style:{margin:"0 0 12px 0",fontSize:"24px",color:"#111827"},children:u.title}),r.jsx("p",{style:{color:"#6b7280",margin:"0 0 20px 0",lineHeight:"1.6"},children:u.description}),u.tips&&r.jsx("div",{style:{background:"#f9fafb",borderRadius:"8px",padding:"16px",textAlign:"left",marginBottom:"24px"},children:u.tips.map((y,x)=>r.jsx("div",{style:{fontSize:"13px",color:"#4b5563",marginBottom:x<u.tips.length-1?"8px":0},children:y},x))}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:p,style:{padding:"12px 24px",background:"white",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"14px",color:"#6b7280"},children:"Saltar"}),r.jsx("button",{onClick:m,style:{padding:"12px 24px",background:"#25D366",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:d?"Empezar":"Siguiente"})]})]})})}function Nc({icon:t,title:a,description:s,onClick:o,color:c}){return r.jsxs("div",{onClick:o,style:{padding:"16px",border:"2px solid #e5e7eb",borderRadius:"12px",cursor:"pointer",transition:"all 0.2s",textAlign:"left"},onMouseOver:u=>{u.currentTarget.style.borderColor=c||"#25D366",u.currentTarget.style.transform="translateY(-2px)"},onMouseOut:u=>{u.currentTarget.style.borderColor="#e5e7eb",u.currentTarget.style.transform="none"},children:[r.jsx("div",{style:{fontSize:"28px",marginBottom:"8px"},children:t}),r.jsx("div",{style:{fontWeight:600,fontSize:"14px",marginBottom:"4px"},children:a}),r.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:s})]})}function tk(){const{id:t}=Fj(),[a,s]=j.useState(!1),[o,c]=j.useState(!1),[u,d]=j.useState(null),[m,p]=j.useState(!1),{loadFlow:g}=ii();j.useEffect(()=>{t?y(t):localStorage.getItem("flowbuilder_onboarding_seen")||c(!0)},[t]);const y=async N=>{p(!0);try{const S=await Th(N);if(S.flow)g(S.flow),x(`Flujo "${S.flow.name}" cargado correctamente`,"success");else throw new Error("No se pudo obtener los datos del flujo")}catch(S){console.error("Error loading flow:",S),x(`Error al cargar flujo: ${S.message}`,"error")}finally{p(!1)}},x=(N,S="info")=>{d({message:N,type:S}),setTimeout(()=>d(null),4e3)},b=async N=>{if(localStorage.setItem("flowbuilder_onboarding_seen","true"),c(!1),N){p(!0);try{console.log("Creating flow from template:",N);const S=await o1(N,null);if(console.log("Template created, result:",S),S.id){const C=await Th(S.id);if(console.log("Flow data loaded:",C),C.flow)g(C.flow),x(`Flujo "${C.flow.name}" cargado correctamente`,"success");else throw new Error("No se pudo obtener los datos del flujo")}else throw new Error("No se recibi el ID del flujo creado")}catch(S){console.error("Error loading template:",S),x(`Error al cargar template: ${S.message}`,"error")}finally{p(!1)}}};return r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[r.jsx(VA,{onTestClick:()=>s(!0)}),r.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[r.jsx(PA,{}),r.jsx(QA,{}),r.jsx(WA,{})]}),r.jsxs("button",{onClick:()=>s(!0),style:{position:"fixed",right:"20px",bottom:"20px",background:"linear-gradient(135deg, #075E54 0%, #25D366 100%)",color:"white",border:"none",borderRadius:"50px",padding:"14px 24px",cursor:"pointer",boxShadow:"0 4px 15px rgba(37, 211, 102, 0.4)",fontSize:"14px",fontWeight:600,display:a?"none":"flex",alignItems:"center",gap:"8px",zIndex:100},children:[r.jsx("span",{style:{fontSize:"18px"},children:""}),"Probar flujo"]}),m&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:r.jsxs("div",{style:{background:"white",padding:"24px 32px",borderRadius:"12px",display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx("div",{style:{width:"24px",height:"24px",border:"3px solid #e5e7eb",borderTop:"3px solid #25D366",borderRadius:"50%",animation:"spin 1s linear infinite"}}),r.jsx("span",{children:"Cargando flujo..."})]})}),u&&r.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",padding:"12px 20px",borderRadius:"8px",background:u.type==="success"?"#10b981":u.type==="error"?"#ef4444":"#3b82f6",color:"white",fontWeight:500,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1002,animation:"slideIn 0.3s ease"},children:[u.type==="success"&&" ",u.type==="error"&&" ",u.message]}),r.jsx(KA,{isOpen:a,onClose:()=>s(!1)}),o&&r.jsx(ek,{onComplete:b})]})}const Mm="/api/flow-logs";async function Am(t,a){if(!t.ok){let s=a;try{const o=await t.json();o.error&&(s=o.error)}catch{}throw new Error(s)}return t.json()}async function nk(t={}){const a=new URLSearchParams(t).toString(),s=await fetch(`${Mm}?${a}`);return Am(s,"Error al cargar logs")}async function ak(t){const a=await fetch(`${Mm}/${t}`);return Am(a,"Log no encontrado")}async function sk(t=7){const a=await fetch(`${Mm}/stats/summary?days=${t}`);return Am(a,"Error al cargar estadsticas")}const oo={completed:{label:"Completado",color:"#10b981",icon:qc},failed:{label:"Fallido",color:"#ef4444",icon:em},transferred:{label:"Transferido",color:"#f59e0b",icon:Wh},running:{label:"En progreso",color:"#3b82f6",icon:ns},timeout:{label:"Timeout",color:"#6b7280",icon:Ur}};function rk(){const[t,a]=j.useState([]),[s,o]=j.useState(null),[c,u]=j.useState(!0),[d,m]=j.useState(null),[p,g]=j.useState(!1),[y,x]=j.useState({status:"",phone:"",flow_id:""});j.useEffect(()=>{b()},[]);const b=async()=>{u(!0);try{const[_,E]=await Promise.all([nk({limit:50,...y}),sk(7)]);a(_.logs||[]),o(E.stats)}catch(_){console.error("Error loading logs:",_)}finally{u(!1)}},N=async _=>{g(!0);try{const E=await ak(_.id);m(E.log)}catch(E){console.error("Error loading log detail:",E)}finally{g(!1)}},S=(_,E)=>{x(D=>({...D,[_]:E}))},C=()=>{b()};return c?r.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Logs de Ejecucin"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Historial de ejecucin de flujos"})]}),r.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 transition",children:[r.jsx(ls,{className:"w-4 h-4"}),"Actualizar"]})]}),s&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Total ejecuciones"}),r.jsx("p",{className:"text-2xl font-bold text-gray-800",children:s.total_executions||0}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"ltimos 7 das"})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Tasa de completado"}),r.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[s.completion_rate||0,"%"]}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[s.completed||0," completados"]})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Fallidos"}),r.jsx("p",{className:"text-2xl font-bold text-red-500",children:s.failed||0}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Requieren atencin"})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo promedio"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.avg_duration_ms?`${Math.round(s.avg_duration_ms)}ms`:"-"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Por ejecucin"})]})]}),r.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm mb-6",children:r.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(nm,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Filtrar:"})]}),r.jsxs("select",{value:y.status,onChange:_=>S("status",_.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:"completed",children:"Completados"}),r.jsx("option",{value:"failed",children:"Fallidos"}),r.jsx("option",{value:"transferred",children:"Transferidos"}),r.jsx("option",{value:"running",children:"En progreso"})]}),r.jsx("input",{type:"text",value:y.phone,onChange:_=>S("phone",_.target.value),placeholder:"Telfono...",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none w-40"}),r.jsx("button",{onClick:C,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm transition",children:"Aplicar"})]})}),r.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:t.length===0?r.jsxs("div",{className:"p-12 text-center text-gray-400",children:[r.jsx(ns,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"No hay logs de ejecucin"}),r.jsx("p",{className:"text-sm mt-1",children:"Los logs aparecern cuando se ejecuten flujos"})]}):r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left text-xs text-gray-500 uppercase tracking-wider",children:[r.jsx("th",{className:"px-4 py-3",children:"Fecha"}),r.jsx("th",{className:"px-4 py-3",children:"Flujo"}),r.jsx("th",{className:"px-4 py-3",children:"Telfono"}),r.jsx("th",{className:"px-4 py-3",children:"Estado"}),r.jsx("th",{className:"px-4 py-3",children:"Nodos"}),r.jsx("th",{className:"px-4 py-3",children:"Duracin"}),r.jsx("th",{className:"px-4 py-3"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(_=>{const E=oo[_.status]||oo.running,D=E.icon;return r.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[r.jsxs("td",{className:"px-4 py-3 text-sm",children:[r.jsx("div",{className:"text-gray-800",children:du(new Date(_.started_at),"dd/MM HH:mm")}),r.jsx("div",{className:"text-xs text-gray-400",children:si(new Date(_.started_at),{addSuffix:!0,locale:os})})]}),r.jsxs("td",{className:"px-4 py-3",children:[r.jsx("div",{className:"font-medium text-gray-800",children:_.flow_name||"Sin nombre"}),r.jsx("div",{className:"text-xs text-gray-400",children:_.trigger_type})]}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ru,{className:"w-3 h-3 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-700",children:_.phone})]})}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{background:`${E.color}20`,color:E.color},children:[r.jsx(D,{className:"w-3 h-3"}),E.label]})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:_.total_nodes_executed||0}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:_.total_duration_ms?`${Math.round(_.total_duration_ms)}ms`:"-"}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("button",{onClick:()=>N(_),className:"p-2 hover:bg-gray-100 rounded-lg transition",title:"Ver detalle",children:r.jsx(Mo,{className:"w-4 h-4 text-gray-400"})})})]},_.id)})})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>m(null),children:r.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[80vh] overflow-auto m-4",onClick:_=>_.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:"Detalle de Ejecucin"}),r.jsx("button",{onClick:()=>m(null),className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(qn,{className:"w-4 h-4"})})]}),p?r.jsx("div",{className:"p-8 text-center",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"})}):r.jsxs("div",{className:"p-4 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Flujo"}),r.jsx("p",{className:"font-medium",children:d.flow_name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Telfono"}),r.jsx("p",{className:"font-medium",children:d.phone})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Mensaje trigger"}),r.jsx("p",{className:"text-sm bg-gray-100 p-2 rounded",children:d.trigger_message||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Estado final"}),r.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{background:`${oo[d.status]?.color}20`,color:oo[d.status]?.color},children:oo[d.status]?.label})]})]}),d.variables&&Object.keys(d.variables).length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Variables capturadas"}),r.jsx("div",{className:"bg-gray-50 rounded-lg p-3 space-y-1",children:Object.entries(d.variables).map(([_,E])=>r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsxs("span",{className:"font-mono text-purple-600",children:[_,":"]}),r.jsx("span",{className:"text-gray-700",children:String(E)})]},_))})]}),d.steps&&d.steps.length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Nodos ejecutados"}),r.jsx("div",{className:"space-y-2",children:d.steps.map((_,E)=>r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-xs font-medium",children:E+1}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium text-sm",children:_.node_id}),r.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-200 rounded text-gray-600",children:_.node_type}),r.jsxs("span",{className:"text-xs text-gray-400",children:[_.duration_ms,"ms"]})]}),_.output&&r.jsx("p",{className:"text-sm text-gray-600 mt-1 break-words",children:_.output})]})]},E))})]}),d.error_message&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[r.jsx("p",{className:"text-xs text-red-600 font-medium mb-1",children:"Error"}),r.jsx("p",{className:"text-sm text-red-700",children:d.error_message}),d.error_node_id&&r.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["En nodo: ",d.error_node_id]})]})]})]})})]})}const Eu="/api/leads";async function Cu(t,a){if(!t.ok){let s=a;try{const o=await t.json();o.error&&(s=o.error)}catch{}throw new Error(s)}return t.json()}async function ik(t={}){const a=new URLSearchParams(t).toString(),s=await fetch(`${Eu}?${a}`);return Cu(s,"Error al cargar leads")}async function ok(){const t=await fetch(`${Eu}/stats`);return Cu(t,"Error al cargar estadsticas")}async function lk(t,a){const s=await fetch(`${Eu}/${encodeURIComponent(t)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return Cu(s,"Error al actualizar lead")}async function ck(t,a,s){const o=await fetch(`${Eu}/${encodeURIComponent(t)}/adjust-score`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adjustment:a,reason:s})});return Cu(o,"Error al ajustar score")}const Sc={new:{label:"Nuevo",color:"#6b7280",bg:"#f3f4f6"},engaged:{label:"Interesado",color:"#3b82f6",bg:"#dbeafe"},qualified:{label:"Calificado",color:"#10b981",bg:"#d1fae5"},customer:{label:"Cliente",color:"#8b5cf6",bg:"#ede9fe"},inactive:{label:"Inactivo",color:"#9ca3af",bg:"#f9fafb"}},ab={hot:{color:"#ef4444",label:"Caliente",range:"80-100"},warm:{color:"#f59e0b",label:"Tibio",range:"50-79"},cold:{color:"#3b82f6",label:"Fro",range:"20-49"},new:{color:"#6b7280",label:"Nuevo",range:"0-19"}};function uk(t){return t>=80?"hot":t>=50?"warm":t>=20?"cold":"new"}function dk(){const t=Ps(),[a,s]=j.useState([]),[o,c]=j.useState(null),[u,d]=j.useState(!0),[m,p]=j.useState(null),[g,y]=j.useState({status:"",min_score:"",search:"",sort_by:"current_score",sort_dir:"desc"});j.useEffect(()=>{x()},[]);const x=async()=>{d(!0);try{const[_,E]=await Promise.all([ik({limit:100,...g}),ok()]);s(_.leads||[]),c(E)}catch(_){console.error("Error loading leads:",_)}finally{d(!1)}},b=(_,E)=>{y(D=>({...D,[_]:E}))},N=()=>{x()},S=async(_,E)=>{try{await lk(_,{status:E}),x()}catch(D){console.error("Error updating lead:",D)}},C=async(_,E)=>{try{await ck(_,E,"Manual adjustment"),x()}catch(D){console.error("Error adjusting score:",D)}};return u?r.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Gestin de Leads"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Administra y califica tus leads"})]}),r.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 transition",children:[r.jsx(ls,{className:"w-4 h-4"}),"Actualizar"]})]}),o&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Total Leads"}),r.jsx("p",{className:"text-2xl font-bold text-gray-800",children:o.stats?.total_leads||0})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Score Promedio"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o.stats?.avg_score||0})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Nuevos"}),r.jsx("p",{className:"text-2xl font-bold text-gray-600",children:o.stats?.new_leads||0})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Calificados"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:o.stats?.qualified_leads||0})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Clientes"}),r.jsx("p",{className:"text-2xl font-bold text-purple-600",children:o.stats?.customers||0})]})]}),o?.score_distribution&&r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm mb-6",children:[r.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Distribucin de Scores"}),r.jsx("div",{className:"flex gap-4",children:Object.entries(ab).map(([_,E])=>{const D=o.score_distribution.find(T=>T.category===_)?.count||0;return r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:E.color}}),r.jsxs("span",{className:"text-sm text-gray-600",children:[E.label,": ",r.jsx("strong",{children:D})]})]},_)})})]}),r.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm mb-6",children:r.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(nm,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Filtrar:"})]}),r.jsxs("div",{className:"relative",children:[r.jsx(sm,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),r.jsx("input",{type:"text",value:g.search,onChange:_=>b("search",_.target.value),placeholder:"Buscar...",className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none w-48"})]}),r.jsxs("select",{value:g.status,onChange:_=>b("status",_.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:"",children:"Todos los estados"}),Object.entries(Sc).map(([_,E])=>r.jsx("option",{value:_,children:E.label},_))]}),r.jsxs("select",{value:g.min_score,onChange:_=>b("min_score",_.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:"",children:"Todos los scores"}),r.jsx("option",{value:"80",children:"Score 80+ (Caliente)"}),r.jsx("option",{value:"50",children:"Score 50+ (Tibio)"}),r.jsx("option",{value:"20",children:"Score 20+ (Fro)"})]}),r.jsxs("select",{value:`${g.sort_by}-${g.sort_dir}`,onChange:_=>{const[E,D]=_.target.value.split("-");b("sort_by",E),b("sort_dir",D)},className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:"current_score-desc",children:"Mayor score"}),r.jsx("option",{value:"current_score-asc",children:"Menor score"}),r.jsx("option",{value:"last_interaction-desc",children:"Ms reciente"}),r.jsx("option",{value:"total_messages-desc",children:"Ms mensajes"})]}),r.jsx("button",{onClick:N,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm transition",children:"Aplicar"})]})}),r.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:a.length===0?r.jsxs("div",{className:"p-12 text-center text-gray-400",children:[r.jsx(cu,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"No hay leads registrados"}),r.jsx("p",{className:"text-sm mt-1",children:"Los leads se crean automticamente cuando interactan"})]}):r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left text-xs text-gray-500 uppercase tracking-wider",children:[r.jsx("th",{className:"px-4 py-3",children:"Lead"}),r.jsx("th",{className:"px-4 py-3",children:"Score"}),r.jsx("th",{className:"px-4 py-3",children:"Estado"}),r.jsx("th",{className:"px-4 py-3",children:"Mensajes"}),r.jsx("th",{className:"px-4 py-3",children:"ltima actividad"}),r.jsx("th",{className:"px-4 py-3",children:"Acciones"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:a.map(_=>{const E=uk(_.current_score),D=ab[E],T=Sc[_.status]||Sc.new;return r.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-green-600 font-medium",children:_.contact_name?.[0]?.toUpperCase()||_.phone.slice(-2)})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-800",children:_.contact_name||"Sin nombre"}),r.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[r.jsx(ru,{className:"w-3 h-3"}),_.phone]})]})]})}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm",style:{background:`${D.color}20`,color:D.color},children:_.current_score}),r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsx("button",{onClick:()=>C(_.phone,5),className:"p-1 hover:bg-green-100 rounded text-green-600",title:"+5 puntos",children:r.jsx(iu,{className:"w-3 h-3"})}),r.jsx("button",{onClick:()=>C(_.phone,-5),className:"p-1 hover:bg-red-100 rounded text-red-600",title:"-5 puntos",children:r.jsx(Rb,{className:"w-3 h-3"})})]})]})}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("select",{value:_.status,onChange:A=>S(_.phone,A.target.value),className:"px-2 py-1 rounded-full text-xs font-medium border-0 cursor-pointer",style:{background:T.bg,color:T.color},children:Object.entries(Sc).map(([A,w])=>r.jsx("option",{value:A,children:w.label},A))})}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[r.jsx(qt,{className:"w-4 h-4"}),_.total_messages||_.message_count||0]})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:_.last_interaction?si(new Date(_.last_interaction),{addSuffix:!0,locale:os}):"-"}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("button",{onClick:()=>t(`/conversations?phone=${encodeURIComponent(_.phone)}`),className:"p-2 hover:bg-gray-100 rounded-lg transition",title:"Ver conversacin",children:r.jsx(Mo,{className:"w-4 h-4 text-gray-400"})})})]},_.phone)})})]})})]})}const $o="/api/flow-analytics";async function qo(t,a){if(!t.ok){let s=a;try{const o=await t.json();o.error&&(s=o.error)}catch{}throw new Error(s)}return t.json()}async function fk(t=7){const a=await fetch(`${$o}/summary?days=${t}`);return qo(a,"Error al cargar resumen")}async function hk(t=14){const a=await fetch(`${$o}/timeline?days=${t}`);return qo(a,"Error al cargar timeline")}async function mk(t=7){const a=await fetch(`${$o}/by-flow?days=${t}`);return qo(a,"Error al cargar mtricas por flujo")}async function pk(t=7){const a=await fetch(`${$o}/by-hour?days=${t}`);return qo(a,"Error al cargar distribucin horaria")}async function gk(t=7){const a=await fetch(`${$o}/trigger-types?days=${t}`);return qo(a,"Error al cargar tipos de trigger")}function xk(){const[t,a]=j.useState(null),[s,o]=j.useState([]),[c,u]=j.useState([]),[d,m]=j.useState([]),[p,g]=j.useState([]),[y,x]=j.useState(!0),[b,N]=j.useState(7);j.useEffect(()=>{S()},[b]);const S=async()=>{x(!0);try{const[E,D,T,A,w]=await Promise.all([fk(b),hk(b),mk(b),pk(b),gk(b)]);a(E.summary),o(D.timeline||[]),u(T.flows||[]),m(A.hourly||[]),g(w.trigger_types||[])}catch(E){console.error("Error loading analytics:",E)}finally{x(!1)}};if(y)return r.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})});const C=Math.max(...s.map(E=>E.total),1),_=Math.max(...d.map(E=>E.executions),1);return r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Analytics de Flujos"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Mtricas y anlisis de rendimiento"})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("select",{value:b,onChange:E=>N(parseInt(E.target.value)),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:7,children:"ltimos 7 das"}),r.jsx("option",{value:14,children:"ltimos 14 das"}),r.jsx("option",{value:30,children:"ltimos 30 das"})]}),r.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 transition",children:[r.jsx(ls,{className:"w-4 h-4"}),"Actualizar"]})]})]}),t&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[r.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Total Ejecuciones"}),r.jsx("p",{className:"text-3xl font-bold text-gray-800 mt-1",children:t.executions.total}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.executions.unique_users," usuarios nicos"]})]}),r.jsx("div",{className:"p-3 bg-blue-50 rounded-xl",children:r.jsx(ns,{className:"w-6 h-6 text-blue-600"})})]})}),r.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Tasa de Completado"}),r.jsxs("p",{className:"text-3xl font-bold text-green-600 mt-1",children:[t.executions.completion_rate,"%"]}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.executions.completed," completados"]})]}),r.jsx("div",{className:"p-3 bg-green-50 rounded-xl",children:r.jsx(qc,{className:"w-6 h-6 text-green-600"})})]})}),r.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Fallidos"}),r.jsx("p",{className:"text-3xl font-bold text-red-500 mt-1",children:t.executions.failed}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.executions.transferred," transferidos"]})]}),r.jsx("div",{className:"p-3 bg-red-50 rounded-xl",children:r.jsx(em,{className:"w-6 h-6 text-red-500"})})]})}),r.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo Promedio"}),r.jsxs("p",{className:"text-3xl font-bold text-purple-600 mt-1",children:[t.executions.avg_duration_ms,"ms"]}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.executions.avg_nodes," nodos promedio"]})]}),r.jsx("div",{className:"p-3 bg-purple-50 rounded-xl",children:r.jsx(Ur,{className:"w-6 h-6 text-purple-600"})})]})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6 mb-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(Vc,{className:"w-5 h-5 text-gray-400"}),"Ejecuciones por da"]}),s.length===0?r.jsx("div",{className:"text-center text-gray-400 py-8",children:"No hay datos para mostrar"}):r.jsx("div",{className:"flex items-end gap-2 h-40",children:s.map((E,D)=>r.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[r.jsxs("div",{className:"w-full flex flex-col gap-0.5",style:{height:"120px"},children:[r.jsx("div",{className:"w-full bg-green-500 rounded-t",style:{height:`${E.completed/C*100}%`},title:`Completados: ${E.completed}`}),r.jsx("div",{className:"w-full bg-red-400",style:{height:`${E.failed/C*100}%`},title:`Fallidos: ${E.failed}`}),r.jsx("div",{className:"w-full bg-yellow-400 rounded-b",style:{height:`${E.transferred/C*100}%`},title:`Transferidos: ${E.transferred}`})]}),r.jsx("div",{className:"text-xs text-gray-400 mt-2",children:du(new Date(E.date),"dd/MM")})]},D))}),r.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-gray-100",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-green-500"}),r.jsx("span",{className:"text-xs text-gray-500",children:"Completados"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-red-400"}),r.jsx("span",{className:"text-xs text-gray-500",children:"Fallidos"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-yellow-400"}),r.jsx("span",{className:"text-xs text-gray-500",children:"Transferidos"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(am,{className:"w-5 h-5 text-gray-400"}),"Rendimiento por Flujo"]}),c.length===0?r.jsx("div",{className:"text-center text-gray-400 py-8",children:"No hay flujos configurados"}):r.jsx("div",{className:"space-y-3",children:c.slice(0,5).map((E,D)=>r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center text-sm font-medium text-gray-600",children:D+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium text-gray-800 truncate",children:E.flow_name}),r.jsxs("span",{className:"text-sm text-gray-500",children:[E.recent_executions," ejecuciones"]})]}),r.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[r.jsx("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-green-500",style:{width:`${E.completion_rate}%`}})}),r.jsxs("span",{className:"text-xs text-gray-400",children:[E.completion_rate,"%"]})]})]})]},E.flow_id))}),r.jsx(Os,{to:"/flows",className:"block text-center text-sm text-green-600 hover:text-green-700 mt-4 pt-4 border-t border-gray-100",children:"Ver todos los flujos"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(Ur,{className:"w-5 h-5 text-gray-400"}),"Actividad por Hora"]}),r.jsx("div",{className:"flex items-end gap-1 h-32",children:d.map((E,D)=>r.jsx("div",{className:"flex-1 bg-blue-500 rounded-t transition-all hover:bg-blue-600",style:{height:`${E.executions/_*100}%`,minHeight:E.executions>0?"4px":"0"},title:`${E.hour}:00 - ${E.executions} ejecuciones`},D))}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[r.jsx("span",{children:"00:00"}),r.jsx("span",{children:"06:00"}),r.jsx("span",{children:"12:00"}),r.jsx("span",{children:"18:00"}),r.jsx("span",{children:"23:00"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(Jh,{className:"w-5 h-5 text-gray-400"}),"Distribucin por Tipo de Trigger"]}),p.length===0?r.jsx("div",{className:"text-center text-gray-400 py-8",children:"No hay datos de triggers"}):r.jsx("div",{className:"flex gap-6",children:p.map((E,D)=>{const T=["#10b981","#3b82f6","#f59e0b","#8b5cf6","#ec4899"],A=T[D%T.length],w=p.reduce((M,q)=>M+q.count,0),O=w>0?Math.round(E.count/w*100):0;return r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2",style:{background:`${A}20`},children:r.jsxs("span",{className:"text-xl font-bold",style:{color:A},children:[O,"%"]})}),r.jsx("p",{className:"text-sm font-medium text-gray-800 capitalize",children:E.trigger_type}),r.jsxs("p",{className:"text-xs text-gray-400",children:[E.count," ejecuciones"]})]},E.trigger_type)})})]})]})}function yk(){const[t,a]=j.useState([]),[s,o]=j.useState(null),[c,u]=j.useState({running:0,connectedMonitors:0}),[d,m]=j.useState(!1);return j.useEffect(()=>{const p=new EventSource("/api/flow-monitor/stream");return p.onopen=()=>m(!0),p.onerror=()=>m(!1),p.onmessage=g=>{const y=JSON.parse(g.data);switch(y.type){case"connected":u({running:y.activeCount,connectedMonitors:0});break;case"active_execution":a(x=>x.find(N=>N.executionId===y.executionId)?x:[y,...x]);break;case"flow_started":a(x=>[y,...x]);break;case"node_started":case"node_completed":a(x=>x.map(b=>b.executionId===y.executionId?{...b,currentNodeId:y.nodeId,currentNodeType:y.nodeType,variables:y.variables,steps:y.type==="node_completed"?[...b.steps||[],{nodeId:y.nodeId,nodeType:y.nodeType,durationMs:y.durationMs,status:y.status,timestamp:y.timestamp}]:b.steps}:b));break;case"flow_completed":case"flow_error":case"flow_transferred":a(x=>x.map(b=>b.executionId===y.executionId?{...b,status:y.type.replace("flow_",""),completedAt:y.timestamp}:b));break}},()=>p.close()},[]),r.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[r.jsx("header",{className:"bg-white border-b px-6 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Monitor de Flujos"}),r.jsx("p",{className:"text-gray-500",children:"Tiempo real"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${d?"bg-green-500":"bg-red-500"}`}),r.jsx("span",{className:"text-sm text-gray-600",children:d?"Conectado":"Desconectado"})]}),r.jsxs("div",{className:"text-sm text-gray-600",children:[t.filter(p=>!p.status).length," ejecuciones activas"]})]})]})}),r.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[r.jsxs("aside",{className:"w-80 bg-white border-r overflow-y-auto",children:[r.jsx("div",{className:"p-4 border-b",children:r.jsx("h2",{className:"font-semibold text-gray-700",children:"Ejecuciones"})}),r.jsx("div",{className:"divide-y",children:t.length===0?r.jsx("div",{className:"p-8 text-center text-gray-400",children:"Sin ejecuciones"}):t.map(p=>r.jsx("button",{onClick:()=>o(p),className:`w-full p-4 text-left hover:bg-gray-50 transition ${s?.executionId===p.executionId?"bg-green-50":""}`,children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(ru,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),r.jsx("span",{className:"font-mono text-sm text-gray-700 truncate",children:p.phone})]}),r.jsx("p",{className:"text-xs text-gray-500 truncate mb-1",children:p.flowName||p.flowSlug}),p.currentNodeId&&r.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[r.jsx(ns,{className:"w-3 h-3 text-green-500"}),r.jsx("span",{className:"text-gray-600",children:p.currentNodeId})]})]}),r.jsxs("div",{children:[p.status==="completed"&&r.jsx(qc,{className:"w-5 h-5 text-green-500"}),p.status==="error"&&r.jsx(em,{className:"w-5 h-5 text-red-500"}),p.status==="transferred"&&r.jsx(Ls,{className:"w-5 h-5 text-yellow-500"}),!p.status&&r.jsx(ns,{className:"w-5 h-5 text-green-500 animate-pulse"})]})]})},p.executionId))})]}),r.jsx("main",{className:"flex-1 flex",children:s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 p-6 overflow-auto",children:r.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-700 mb-4",children:"Ejecucin del Flujo"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Flujo:"}),r.jsx("p",{className:"font-medium",children:s.flowName})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Telfono:"}),r.jsx("p",{className:"font-mono text-sm",children:s.phone})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Nodo Actual:"}),r.jsx("p",{className:"font-mono text-sm",children:s.currentNodeId||"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Tipo de Nodo:"}),r.jsx("p",{className:"font-mono text-sm",children:s.currentNodeType||"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),r.jsxs("p",{className:"font-medium",children:[s.status==="completed"&&"Completado ",s.status==="error"&&"Error ",s.status==="transferred"&&"Transferido ",!s.status&&"En ejecucin..."]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Iniciado:"}),r.jsx("p",{className:"text-sm",children:s.timestamp?new Date(s.timestamp).toLocaleString("es-CL"):"N/A"})]}),s.completedAt&&r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Completado:"}),r.jsx("p",{className:"text-sm",children:new Date(s.completedAt).toLocaleString("es-CL")})]})]})]})}),r.jsxs("aside",{className:"w-96 bg-white border-l overflow-y-auto",children:[r.jsx("div",{className:"p-4 border-b",children:r.jsx("h2",{className:"font-semibold text-gray-700",children:"Detalles"})}),r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Variables"}),r.jsx("div",{className:"bg-gray-50 rounded p-3 font-mono text-xs",children:r.jsx("pre",{className:"whitespace-pre-wrap break-words",children:JSON.stringify(s.variables||{},null,2)})})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Timeline"}),r.jsx("div",{className:"space-y-2",children:s.steps&&s.steps.length>0?s.steps.map((p,g)=>r.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[r.jsx(qc,{className:"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium text-gray-700",children:p.nodeId}),r.jsxs("p",{className:"text-gray-500",children:[p.nodeType,"  ",p.durationMs,"ms"]}),p.timestamp&&r.jsx("p",{className:"text-gray-400",children:new Date(p.timestamp).toLocaleTimeString("es-CL")})]})]},g)):r.jsx("p",{className:"text-gray-400 text-sm",children:"Sin eventos an"})})]})]})]})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:r.jsxs("div",{className:"text-center",children:[r.jsx(ns,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),r.jsx("p",{children:"Selecciona una ejecucin para ver detalles"})]})})})]})]})}const Dr=()=>{const t=At.getState().token;return{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}}};function bk(){const[t,a]=j.useState([]),[s,o]=j.useState([]),[c,u]=j.useState(!0),[d,m]=j.useState(!1),[p,g]=j.useState(null),[y,x]=j.useState({}),[b,N]=j.useState({username:"",password:"",name:"",email:"",role:"agent",departmentId:"",avatarColor:"#6366f1"}),[S,C]=j.useState(""),[_,E]=j.useState(!1),D=async()=>{try{const[H,F]=await Promise.all([fetch("/api/agents",{headers:Dr()}),fetch("/api/departments",{headers:Dr()})]),Q=await H.json(),Z=await F.json();Q.ok&&a(Q.agents),Z.ok&&o(Z.departments)}catch(H){console.error("Error loading data:",H)}finally{u(!1)}};j.useEffect(()=>{D()},[]);const T=()=>{g(null),N({username:"",password:"",name:"",email:"",role:"agent",departmentId:"",avatarColor:"#6366f1"}),C(""),m(!0)},A=H=>{g(H),N({username:H.username,password:"",name:H.name,email:H.email||"",role:H.role,departmentId:H.department_id||"",avatarColor:H.avatar_color||"#6366f1"}),C(""),m(!0)},w=async H=>{H.preventDefault(),C(""),E(!0);try{const F={name:b.name,email:b.email||null,role:b.role,departmentId:b.departmentId?Number(b.departmentId):null,avatarColor:b.avatarColor};if(p){b.password&&(F.password=b.password);const Z=await(await fetch(`/api/agents/${p.id}`,{method:"PUT",headers:Dr(),body:JSON.stringify(F)})).json();if(!Z.ok)throw new Error(Z.error)}else{F.username=b.username,F.password=b.password;const Z=await(await fetch("/api/agents",{method:"POST",headers:Dr(),body:JSON.stringify(F)})).json();if(!Z.ok)throw new Error(Z.error)}m(!1),D()}catch(F){C(F.message)}finally{E(!1)}},O=async H=>{if(confirm(`Desactivar agente "${H.name}"?`))try{await fetch(`/api/agents/${H.id}`,{method:"DELETE",headers:Dr()}),D()}catch(F){alert("Error: "+F.message)}},M=async H=>{if(confirm(`Regenerar API key de "${H.name}"? La anterior dejara de funcionar.`))try{const Q=await(await fetch(`/api/agents/${H.id}/regenerate-api-key`,{method:"POST",headers:Dr()})).json();Q.ok&&(D(),alert(`Nueva API key: ${Q.apiKey}`))}catch(F){alert("Error: "+F.message)}},q=["#6366f1","#22c55e","#ef4444","#f59e0b","#3b82f6","#ec4899","#8b5cf6","#14b8a6","#f97316","#06b6d4"];return c?r.jsx("div",{className:"p-8 flex justify-center",children:r.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full"})}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agentes"}),r.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Gestiona los agentes del sistema"})]}),r.jsxs("button",{onClick:T,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2.5 rounded-lg transition font-medium",children:[r.jsx(Pr,{className:"w-4 h-4"})," Nuevo Agente"]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Agente"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Rol"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Departamento"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Estado"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"API Key"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Ultimo Login"}),r.jsx("th",{className:"text-right px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Acciones"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-100",children:[t.map(H=>r.jsxs("tr",{className:`hover:bg-gray-50 ${H.status==="inactive"?"opacity-50":""}`,children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-9 h-9 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:H.avatar_color||"#6366f1"},children:r.jsx("span",{className:"text-white text-sm font-medium",children:H.name?.[0]?.toUpperCase()})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900 text-sm",children:H.name}),r.jsxs("p",{className:"text-xs text-gray-400",children:["@",H.username]})]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${H.role==="supervisor"?"bg-purple-50 text-purple-700":"bg-blue-50 text-blue-700"}`,children:[H.role==="supervisor"?r.jsx(is,{className:"w-3 h-3"}):r.jsx(Ls,{className:"w-3 h-3"}),H.role==="supervisor"?"Supervisor":"Agente"]})}),r.jsx("td",{className:"px-6 py-4",children:H.department_name?r.jsx("span",{className:"text-sm px-2 py-1 rounded-full",style:{backgroundColor:`${H.department_color}20`,color:H.department_color},children:H.department_name}):r.jsx("span",{className:"text-xs text-gray-400",children:"Sin asignar"})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H.status==="active"?"bg-green-50 text-green-700":"bg-gray-100 text-gray-500"}`,children:H.status==="active"?"Activo":"Inactivo"})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("code",{className:"text-xs text-gray-400 font-mono",children:y[H.id]?H.api_key:H.api_key?"":"-"}),H.api_key&&r.jsx("button",{onClick:()=>x(F=>({...F,[H.id]:!F[H.id]})),className:"p-1 text-gray-400 hover:text-gray-600",children:y[H.id]?r.jsx(AS,{className:"w-3 h-3"}):r.jsx(tm,{className:"w-3 h-3"})})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"text-xs text-gray-400",children:H.last_login?new Date(H.last_login).toLocaleString("es-CL"):"Nunca"})}),r.jsx("td",{className:"px-6 py-4 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-1",children:[r.jsx("button",{onClick:()=>A(H),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Editar",children:r.jsx(ou,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>M(H),className:"p-2 text-gray-400 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg",title:"Regenerar API Key",children:r.jsx(US,{className:"w-4 h-4"})}),H.status==="active"&&r.jsx("button",{onClick:()=>O(H),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Desactivar",children:r.jsx(ai,{className:"w-4 h-4"})})]})})]},H.id)),!t.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"text-center py-12 text-gray-400",children:"No hay agentes. Crea el primero."})})]})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:p?"Editar Agente":"Nuevo Agente"}),S&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4",children:S}),r.jsxs("form",{onSubmit:w,className:"space-y-4",children:[!p&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),r.jsx("input",{type:"text",value:b.username,onChange:H=>N({...b,username:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,minLength:3})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:p?"Nueva Contrasena (dejar vacio para no cambiar)":"Contrasena"}),r.jsx("input",{type:"password",value:b.password,onChange:H=>N({...b,password:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!p,minLength:6})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo"}),r.jsx("input",{type:"text",value:b.name,onChange:H=>N({...b,name:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (opcional)"}),r.jsx("input",{type:"email",value:b.email,onChange:H=>N({...b,email:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),r.jsxs("select",{value:b.role,onChange:H=>N({...b,role:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"agent",children:"Agente"}),r.jsx("option",{value:"supervisor",children:"Supervisor"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),r.jsxs("select",{value:b.departmentId,onChange:H=>N({...b,departmentId:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"",children:"Sin asignar"}),s.filter(H=>H.active).map(H=>r.jsx("option",{value:H.id,children:H.display_name},H.id))]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color avatar"}),r.jsx("div",{className:"flex gap-2",children:q.map(H=>r.jsx("button",{type:"button",onClick:()=>N({...b,avatarColor:H}),className:`w-8 h-8 rounded-full transition ${b.avatarColor===H?"ring-2 ring-offset-2 ring-gray-400":""}`,style:{backgroundColor:H}},H))})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancelar"}),r.jsx("button",{type:"submit",disabled:_,className:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition disabled:opacity-50",children:_?"Guardando...":p?"Guardar":"Crear"})]})]})]})})]})}const _c=()=>{const t=At.getState().token;return{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}}};function vk(){const[t,a]=j.useState([]),[s,o]=j.useState(!0),[c,u]=j.useState(!1),[d,m]=j.useState(null),[p,g]=j.useState({name:"",displayName:"",icon:"MessageSquare",color:"#6f42c1",autoAssignIntents:""}),[y,x]=j.useState(""),[b,N]=j.useState(!1),S=async()=>{try{const O=await(await fetch("/api/departments",{headers:_c()})).json();O.ok&&a(O.departments)}catch(w){console.error("Error loading departments:",w)}finally{o(!1)}};j.useEffect(()=>{S()},[]);const C=()=>{m(null),g({name:"",displayName:"",icon:"MessageSquare",color:"#6f42c1",autoAssignIntents:""}),x(""),u(!0)},_=w=>{m(w);const O=w.auto_assign_intents,M=Array.isArray(O)?O.join(", "):typeof O=="string"?JSON.parse(O||"[]").join(", "):"";g({name:w.name,displayName:w.display_name,icon:w.icon||"MessageSquare",color:w.color||"#6f42c1",autoAssignIntents:M}),x(""),u(!0)},E=async w=>{w.preventDefault(),x(""),N(!0);try{const O=p.autoAssignIntents.split(",").map(M=>M.trim().toLowerCase()).filter(Boolean);if(d){const q=await(await fetch(`/api/departments/${d.id}`,{method:"PUT",headers:_c(),body:JSON.stringify({displayName:p.displayName,icon:p.icon,color:p.color,autoAssignIntents:O})})).json();if(!q.ok)throw new Error(q.error)}else{const q=await(await fetch("/api/departments",{method:"POST",headers:_c(),body:JSON.stringify({name:p.name.toLowerCase().replace(/\s+/g,"_"),displayName:p.displayName,icon:p.icon,color:p.color,autoAssignIntents:O})})).json();if(!q.ok)throw new Error(q.error)}u(!1),S()}catch(O){x(O.message)}finally{N(!1)}},D=async w=>{if(confirm(`Desactivar departamento "${w.display_name}"?`))try{const M=await(await fetch(`/api/departments/${w.id}`,{method:"DELETE",headers:_c()})).json();if(!M.ok)throw new Error(M.error);S()}catch(O){alert("Error: "+O.message)}},T=["#28a745","#17a2b8","#ffc107","#6f42c1","#dc3545","#fd7e14","#20c997","#6610f2","#e83e8c","#007bff"],A=["MessageSquare","ShoppingCart","Wrench","Package","Phone","Mail","Star","Heart","Zap","Globe"];return s?r.jsx("div",{className:"p-8 flex justify-center",children:r.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full"})}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Departamentos"}),r.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Organiza los agentes por area"})]}),r.jsxs("button",{onClick:C,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2.5 rounded-lg transition font-medium",children:[r.jsx(iu,{className:"w-4 h-4"})," Nuevo Departamento"]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(w=>{const O=Array.isArray(w.auto_assign_intents)?w.auto_assign_intents:JSON.parse(w.auto_assign_intents||"[]");return r.jsxs("div",{className:`bg-white rounded-xl border-2 p-5 ${w.active?"border-gray-200":"border-gray-100 opacity-50"}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${w.color}20`},children:r.jsx("span",{className:"text-lg",style:{color:w.color},children:w.icon==="ShoppingCart"?"":w.icon==="Wrench"?"":w.icon==="Package"?"":""})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:w.display_name}),r.jsxs("p",{className:"text-xs text-gray-400",children:["@",w.name]})]})]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>_(w),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",children:r.jsx(ou,{className:"w-4 h-4"})}),w.name!=="general"&&w.active&&r.jsx("button",{onClick:()=>D(w),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",children:r.jsx(ai,{className:"w-4 h-4"})})]})]}),r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsxs("span",{className:"text-xs text-gray-500",children:[w.agent_count||0," agentes"]}),r.jsx("span",{className:"w-1 h-1 bg-gray-300 rounded-full"}),r.jsx("span",{className:`text-xs ${w.active?"text-green-600":"text-gray-400"}`,children:w.active?"Activo":"Inactivo"})]}),O.length>0&&r.jsxs("div",{children:[r.jsxs("p",{className:"text-xs text-gray-400 mb-1.5 flex items-center gap-1",children:[r.jsx(g5,{className:"w-3 h-3"})," Intents auto-asignados:"]}),r.jsx("div",{className:"flex flex-wrap gap-1",children:O.map((M,q)=>r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600",children:M},q))})]})]},w.id)})}),c&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:d?"Editar Departamento":"Nuevo Departamento"}),y&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4",children:y}),r.jsxs("form",{onSubmit:E,className:"space-y-4",children:[!d&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Identificador (slug)"}),r.jsx("input",{type:"text",value:p.name,onChange:w=>g({...p,name:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,placeholder:"ej: ventas, soporte"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre visible"}),r.jsx("input",{type:"text",value:p.displayName,onChange:w=>g({...p,displayName:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,placeholder:"ej: Ventas, Soporte Tecnico"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),r.jsx("div",{className:"flex gap-2",children:T.map(w=>r.jsx("button",{type:"button",onClick:()=>g({...p,color:w}),className:`w-8 h-8 rounded-full transition ${p.color===w?"ring-2 ring-offset-2 ring-gray-400":""}`,style:{backgroundColor:w}},w))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icono"}),r.jsx("select",{value:p.icon,onChange:w=>g({...p,icon:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:A.map(w=>r.jsx("option",{value:w,children:w},w))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Intents para auto-asignacion"}),r.jsx("input",{type:"text",value:p.autoAssignIntents,onChange:w=>g({...p,autoAssignIntents:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"ventas, comprar, precio (separados por coma)"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Cuando el chatbot detecta estos intents, asigna automaticamente a este departamento."})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancelar"}),r.jsx("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition disabled:opacity-50",children:b?"Guardando...":d?"Guardar":"Crear"})]})]})]})})]})}const Ut="/api/learning",at=()=>{const t=At.getState().token;return{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}}};async function st(t){const a=await t.json();if(!t.ok||!a.ok)throw new Error(a.error||"Error en la solicitud");return a}async function wk(){const t=await fetch(`${Ut}/stats`,{headers:at()});return st(t)}async function jk(t={}){const a=Object.fromEntries(Object.entries(t).filter(([,c])=>c!==""&&c!=null)),s=new URLSearchParams(a).toString(),o=await fetch(`${Ut}/pairs${s?"?"+s:""}`,{headers:at()});return st(o)}async function sb(t,a){const s=await fetch(`${Ut}/pairs/${t}`,{method:"PATCH",headers:at(),body:JSON.stringify({status:a})});return st(s)}async function Nk(t){const a=await fetch(`${Ut}/pairs/${t}`,{method:"DELETE",headers:at()});return st(a)}async function Sk(t,a){const s=await fetch(`${Ut}/reprocess`,{method:"POST",headers:at(),body:JSON.stringify({from:t||void 0,to:a||void 0})});return st(s)}async function _k(t=!0){const a=await fetch(`${Ut}/prices?active=${t}`,{headers:at()});return st(a)}async function Ek(t){const a=await fetch(`${Ut}/prices`,{method:"POST",headers:at(),body:JSON.stringify(t)});return st(a)}async function Ck(t,a){const s=await fetch(`${Ut}/prices/${t}`,{method:"PUT",headers:at(),body:JSON.stringify(a)});return st(s)}async function Tk(t){const a=await fetch(`${Ut}/prices/${t}`,{method:"DELETE",headers:at()});return st(a)}async function rb(t=!1){const a=await fetch(`${Ut}/brain-report${t?"?force=true":""}`,{headers:at()});return st(a)}async function Mk(){const t=await fetch("/api/chatbot/config",{headers:at()});return st(t)}async function Ak(t){const a=await fetch("/api/chatbot/config",{method:"PUT",headers:at(),body:JSON.stringify(t)});return st(a)}async function kk(t=null){const a=t?`?phone=${encodeURIComponent(t)}`:"",s=await fetch(`/api/chatbot/current-prompt${a}`,{headers:at()});return st(s)}async function Rk(t=50,a=0){const s=await fetch(`/api/chat/bot-conversations?limit=${t}&offset=${a}`,{headers:at()});return st(s)}async function Dk(t){const a=await fetch(`/api/chat/bot-conversations/${t}/messages`,{headers:at()});return st(a)}async function zk(t,a,s){const o=await fetch(`/api/chat/bot-conversations/${t}/correct`,{method:"POST",headers:at(),body:JSON.stringify({messageId:a,correctedAnswer:s})});return st(o)}async function Ok(t,a,s=!1){const o=await fetch("/api/chat/simulate",{method:"POST",headers:at(),body:JSON.stringify({phone:t,message:a,debug:s})});return st(o)}async function Bk(t,a){const s=await fetch(`${Ut}/quick-correct`,{method:"POST",headers:at(),body:JSON.stringify({question:t,correctedAnswer:a})});return st(s)}async function Lk(){const t=await fetch(`${Ut}/behavioral-rules`,{headers:at()});return st(t)}async function Fv(t){const a=await fetch(`${Ut}/behavioral-rules`,{method:"POST",headers:at(),body:JSON.stringify(t)});return st(a)}async function Hk(t){const a=await fetch(`${Ut}/behavioral-rules/${t}`,{method:"DELETE",headers:at()});return st(a)}function $k({onSubmit:t,onCancel:a,submitting:s}){const[o,c]=j.useState("factual"),[u,d]=j.useState(""),[m,p]=j.useState(""),g=()=>{if(o==="factual"){if(!u.trim())return;t({type:"factual",content:u.trim()})}else{if(!m.trim())return;t({type:"behavioral",content:m.trim()})}},y=o==="factual"?u.trim().length>0:m.trim().length>0;return r.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 shadow-sm",children:[r.jsxs("div",{className:"flex gap-2 mb-3",children:[r.jsx("button",{onClick:()=>c("factual"),className:`flex-1 text-[11px] font-medium py-1.5 px-3 rounded-lg transition ${o==="factual"?"bg-blue-600 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:"Respuesta incorrecta"}),r.jsx("button",{onClick:()=>c("behavioral"),className:`flex-1 text-[11px] font-medium py-1.5 px-3 rounded-lg transition ${o==="behavioral"?"bg-purple-600 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:"Regla de comportamiento"})]}),o==="factual"&&r.jsxs("div",{children:[r.jsx("textarea",{value:u,onChange:x=>d(x.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-gray-800 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Cual es la respuesta correcta?",autoFocus:!0}),r.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Esto creara un nuevo par Q&A aprobado"})]}),o==="behavioral"&&r.jsxs("div",{children:[r.jsx("textarea",{value:m,onChange:x=>p(x.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-gray-800 bg-white focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none",placeholder:"Ej: Nunca ofrezcas descuentos sin autorizacion",autoFocus:!0}),r.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Esta regla se agregara a las instrucciones permanentes"})]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsxs("button",{onClick:g,disabled:s||!y,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium text-white transition disabled:opacity-50 ${o==="factual"?"bg-blue-600 hover:bg-blue-700":"bg-purple-600 hover:bg-purple-700"}`,children:[r.jsx(Et,{className:"w-3 h-3"}),s?"Guardando...":"Guardar"]}),r.jsxs("button",{onClick:a,className:"flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 text-gray-600 rounded-lg text-xs hover:bg-gray-50 transition",children:[r.jsx(qn,{className:"w-3 h-3"}),"Cancelar"]})]})]})}function qk({message:t,index:a,correcting:s,onStartCorrection:o,onSubmitCorrection:c,onCancelCorrection:u,onRetest:d,submitting:m}){const{role:p,text:g,time:y,corrected:x,correctionType:b}=t;return p==="system"?r.jsx("div",{className:"flex justify-center",children:r.jsx("span",{className:"text-[10px] text-red-500 bg-red-50 px-3 py-1 rounded-full",children:g})}):p==="user"?r.jsx("div",{className:"flex justify-end",children:r.jsxs("div",{className:"max-w-[80%] rounded-2xl px-4 py-2.5 bg-indigo-600 text-white",children:[r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g}),r.jsx("span",{className:"text-[9px] opacity-50 block mt-1",children:y instanceof Date?y.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"}):new Date(y).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})})]})}):r.jsx("div",{className:"flex justify-start",children:r.jsxs("div",{className:"max-w-[80%]",children:[r.jsxs("div",{className:"rounded-2xl px-4 py-2.5 bg-white text-gray-800 border border-gray-200 shadow-sm",children:[r.jsx("span",{className:"text-[9px] font-semibold uppercase tracking-wider text-purple-500 block mb-1",children:"BOT IA"}),r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g}),r.jsxs("div",{className:"flex items-center justify-between mt-1.5 gap-3",children:[r.jsx("span",{className:"text-[9px] opacity-50",children:y instanceof Date?y.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"}):new Date(y).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})}),r.jsxs("div",{className:"flex items-center gap-2",children:[x&&b==="factual"&&r.jsxs("span",{className:"text-[9px] font-semibold text-green-600 flex items-center gap-0.5 bg-green-50 px-1.5 py-0.5 rounded-full",children:[r.jsx(Et,{className:"w-2.5 h-2.5"})," Corregido"]}),x&&b==="behavioral"&&r.jsxs("span",{className:"text-[9px] font-semibold text-purple-600 flex items-center gap-0.5 bg-purple-50 px-1.5 py-0.5 rounded-full",children:[r.jsx(is,{className:"w-2.5 h-2.5"})," Regla agregada"]}),x&&r.jsxs("button",{onClick:()=>d(a),className:"text-[9px] font-semibold text-amber-600 hover:text-amber-700 flex items-center gap-0.5 bg-amber-50 px-1.5 py-0.5 rounded-full transition",children:[r.jsx(Ob,{className:"w-2.5 h-2.5"})," Re-probar"]}),!x&&r.jsxs("button",{onClick:()=>o(a),className:"text-[9px] font-semibold text-purple-600 hover:text-purple-800 flex items-center gap-0.5 transition",children:[r.jsx(Db,{className:"w-2.5 h-2.5"})," Corregir"]})]})]})]}),s===a&&r.jsx("div",{className:"mt-2",children:r.jsx($k,{onSubmit:N=>c(a,N),onCancel:u,submitting:m})})]})})}function Uk({messages:t,input:a,setInput:s,loading:o,onSend:c,onReset:u,correcting:d,setCorrecting:m,onSubmitCorrection:p,submitting:g,onRetest:y,endRef:x}){const b=N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),c())};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50",children:[t.length===0&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx(qt,{className:"w-10 h-10 text-gray-300 mx-auto mb-3"}),r.jsx("p",{className:"text-sm text-gray-400",children:"Escribe un mensaje para probar la IA"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Usa el mismo motor que WhatsApp real"})]}),t.map((N,S)=>r.jsx(qk,{message:N,index:S,correcting:d,onStartCorrection:C=>m(C),onSubmitCorrection:p,onCancelCorrection:()=>m(null),onRetest:y,submitting:g},S)),o&&r.jsx("div",{className:"flex justify-start",children:r.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl px-4 py-3 shadow-sm",children:r.jsxs("div",{className:"flex gap-1.5",children:[r.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),r.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),r.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),r.jsx("div",{ref:x})]}),r.jsx("div",{className:"border-t border-gray-200 p-3 bg-white flex-shrink-0",children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",value:a,onChange:N=>s(N.target.value),onKeyDown:b,placeholder:"Escribe un mensaje...",className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",disabled:o,autoFocus:!0}),r.jsx("button",{onClick:c,disabled:o||!a.trim(),className:"bg-indigo-600 hover:bg-indigo-700 text-white p-2.5 rounded-xl transition disabled:opacity-50",children:r.jsx(rm,{className:"w-4 h-4"})})]})})]})}function Vk({stats:t,flashField:a}){const[s,o]=j.useState(!1);if(!t)return null;const{approvedPairs:c=0,activePrices:u=0,behavioralRules:d=0,instructionsChars:m=0,model:p="desconocido",fidelityLevel:g="medium",temperature:y=.4}=t;return r.jsxs("div",{className:"bg-amber-50 border-b border-amber-200 flex-shrink-0",children:[r.jsxs("button",{onClick:()=>o(!s),className:"w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-amber-100/50 transition",children:[r.jsx(Ln,{className:"w-4 h-4 text-amber-600 flex-shrink-0"}),r.jsxs("span",{className:"text-[11px] text-amber-800 font-medium flex-1 truncate",children:[c," Q&A | ",u," Precios | ",p," | temp ",y]}),s?r.jsx(gS,{className:"w-3.5 h-3.5 text-amber-500 flex-shrink-0"}):r.jsx(Mo,{className:"w-3.5 h-3.5 text-amber-500 flex-shrink-0"})]}),s&&r.jsxs("div",{className:"px-3 pb-3 grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(rs,{className:"w-3 h-3 text-indigo-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Q&A"})]}),r.jsx("span",{className:"text-sm font-bold text-gray-800",children:c})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(Vr,{className:"w-3 h-3 text-green-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Precios"})]}),r.jsx("span",{className:"text-sm font-bold text-gray-800",children:u})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(is,{className:"w-3 h-3 text-purple-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Reglas"})]}),r.jsx("span",{className:"text-sm font-bold text-gray-800",children:d})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(ni,{className:"w-3 h-3 text-blue-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Instrucciones"})]}),r.jsxs("span",{className:"text-sm font-bold text-gray-800",children:[m," chars"]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(Yr,{className:"w-3 h-3 text-amber-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Modelo"})]}),r.jsx("span",{className:"text-[11px] font-bold text-gray-800",children:p})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(lu,{className:"w-3 h-3 text-red-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Fidelidad"})]}),r.jsx("span",{className:"text-[11px] font-bold text-gray-800 capitalize",children:g})]})]})]})}const ib={completed:{circle:"bg-green-50 text-green-600 border-green-200",icon:Et},skipped:{circle:"bg-gray-50 text-gray-400 border-gray-200",icon:Rb},processing:{circle:"bg-blue-100 text-blue-600 border-blue-200 animate-pulse",icon:IS},error:{circle:"bg-red-50 text-red-600 border-red-200",icon:qn}};function ob({step:t,expanded:a,onToggle:s,animationDelay:o=0,children:c}){const{id:u,label:d,summary:m,timing:p,status:g,detail:y,icon:x}=t,b=ib[g]||ib.completed,N=b.icon;return r.jsx("div",{className:"relative",style:{animation:`stepAppear 0.3s ease-out ${o}ms both`},children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:`w-[30px] h-[30px] rounded-full border flex items-center justify-center flex-shrink-0 ${b.circle}`,style:g==="processing"?{animation:"pulseGlow 2s ease-in-out infinite"}:{},children:x?r.jsx(x,{className:"w-3.5 h-3.5"}):r.jsx(N,{className:`w-3.5 h-3.5 ${g==="processing"?"animate-spin":""}`})}),r.jsxs("div",{className:"flex-1 min-w-0 pt-0.5",children:[r.jsxs("div",{className:`flex items-center gap-2 ${y||c?"cursor-pointer":""}`,onClick:()=>(y||c)&&s(u),children:[r.jsx("span",{className:"text-xs font-medium text-gray-700",children:d}),m&&r.jsx("span",{className:"text-[10px] text-gray-400 truncate",children:m}),r.jsxs("div",{className:"flex items-center gap-1.5 ml-auto flex-shrink-0",children:[p!=null&&r.jsxs("span",{className:"text-[10px] font-mono bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded",children:[p,"ms"]}),(y||c)&&r.jsx(Mo,{className:`w-3 h-3 text-gray-400 transition-transform duration-200 ${a?"rotate-90":""}`})]})]}),r.jsxs("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${a?"max-h-[500px] opacity-100 mt-2":"max-h-0 opacity-0"}`,children:[y&&r.jsx("div",{className:"bg-gray-50 rounded-lg p-2.5 text-[10px] font-mono text-gray-600 whitespace-pre-wrap break-all",children:typeof y=="string"?y:JSON.stringify(y,null,2)}),c&&r.jsx("div",{className:"pl-2 border-l-2 border-gray-100 space-y-2 mt-1",children:c})]})]})]})})}function Yk(t){if(!t)return[];const a=[];a.push({id:"message_received",label:"Mensaje recibido",summary:t.inputMessage?`"${t.inputMessage.slice(0,40)}${t.inputMessage.length>40?"...":""}"`:"",timing:0,status:"completed",icon:qt,detail:t.entry?{phone:t.entry.phone,channel:t.entry.channel,sessionId:t.entry.sessionId,sessionCreated:t.sessionCreated}:null});const s=t.modeCheck;a.push({id:"session_mode",label:"Modo sesion",summary:s?`${s.mode} (${s.modeSource})  ${s.outcome}`:"automatic",timing:null,status:s?.outcome==="proceed"?"completed":s?"error":"skipped",icon:is,detail:s||null});const o=t.globalKeyword;a.push({id:"global_keywords",label:"Keywords globales",summary:o?.matched?`Match: "${o.keyword}"  ${o.action}`:"Sin match",timing:null,status:o?.matched?"completed":"skipped",icon:Ao,detail:o||null});const c=t.sessionState;a.push({id:"active_session",label:"Sesion activa",summary:c?.hasActiveSession?`Flujo #${c.flowId} en nodo ${c.currentNodeId}`:"Sin flujo activo",timing:null,status:c?.hasActiveSession?"completed":"skipped",icon:ls,detail:c||null});const u=t.classification;a.push({id:"classification",label:"Clasificacion",summary:u?.ran?`Intent: ${u.intent?.type||"unknown"} (${Math.round((u.intent?.confidence||0)*100)}%)  ${u.sentiment||"neutral"}  Lead: ${u.leadScore?.value||0}`:"No ejecutada",timing:u?.durationMs||null,status:u?.ran?"completed":"skipped",icon:lu,expandable:!0,detail:u||null});const d=t.flowMatching;a.push({id:"flow_match",label:"Match flujos",summary:d?`${d.activeFlowCount||0} flujos  ${d.outcome==="flow_matched"?`Match: ${d.matchedFlow?.flowName}`:d.outcome==="default_used"?"Default usado":"Sin match  AI"}`:"No evaluado",timing:null,status:d?.outcome==="flow_matched"?"completed":d?.outcome==="no_match"?"skipped":"completed",icon:am,expandable:!!d?.flowsEvaluated?.length,detail:d?{...d,flowsDetail:d.flowsEvaluated?.map(p=>`${p.matched?"":""} ${p.flowName} (${p.triggerType})  ${p.reason||""}`)}:null});const m=t.aiFallback;if(m){const p=[];p.push({id:"ai_contact",label:"Contacto",summary:m.userName?`${m.userName}`:"Sin nombre",timing:null,status:"completed",icon:Ls,detail:m.contactFields||null});const g=m.knowledge,y=g?(g.vectorSearch?.results?.length||0)+(g.bm25Search?.resultsCount||0):0;p.push({id:"ai_knowledge",label:"Conocimiento",summary:g?`${g.combinedCount||0} pares (vector: ${g.vectorSearch?.results?.length||0}, BM25: ${g.bm25Search?.resultsCount||0})`:"0 pares",timing:g?.vectorSearch?.durationMs||null,status:y>0?"completed":"skipped",icon:rs,expandable:y>0,detail:g?{retrieverAvailable:g.retrieverAvailable,vectorResults:g.vectorSearch?.results||[],bm25Results:g.bm25Search?.results||[]}:null});const x=m.priceQuery;p.push({id:"ai_prices",label:"Precios",summary:x?x.isPriceQuery?`${x.pricesFound?.length||0} precios encontrados`:"No es consulta de precio":"No consultado",timing:x?.durationMs||null,status:x?.pricesFound?.length>0?"completed":"skipped",icon:Vr,detail:x||null});const b=m.conversationHistory;p.push({id:"ai_history",label:"Historial",summary:b?`${b.turnsLoaded||0} turnos`:"0 turnos",timing:null,status:b?.turnsLoaded>0?"completed":"skipped",icon:Ur,detail:b||null});const N=m.prompt;p.push({id:"ai_prompt",label:"Prompt construido",summary:N?`~${N.estimatedTokens||"?"} tokens  ${N.totalMessagesInArray||"?"} msgs${N.knowledgeInjected?" +conocimiento":""}${N.behavioralRulesInjected?" +reglas":""}`:"",timing:null,status:"completed",icon:ni,expandable:!0,detail:N||null});const S=m.openaiCall;p.push({id:"ai_openai",label:"OpenAI",summary:S?`${S.model}  temp ${S.temperature}  ${S.durationMs}ms  ${S.totalTokens||"?"} tokens`:"Esperando...",timing:S?.durationMs||null,status:S?"completed":"processing",icon:Yr,expandable:!!S,detail:S?{model:S.model,temperature:S.temperature,maxTokens:S.maxTokens,durationMs:S.durationMs,promptTokens:S.promptTokens,completionTokens:S.completionTokens,finishReason:S.finishReason,responsePreview:S.responseText?.slice(0,200)}:null});const C=m.delivery;p.push({id:"ai_delivery",label:"Entrega",summary:C?`${C.splitInto} msg(s) enviados`:"",timing:null,status:C?"completed":"skipped",icon:rm,detail:C||null}),a.push({id:"ai_fallback",label:"AI Fallback",summary:t.result?.totalPipelineMs?`Total: ${t.result.totalPipelineMs}ms`:"",timing:t.result?.totalPipelineMs||null,status:m.error?"error":"completed",icon:Ln,detail:m.error||null,children:p})}return!m&&t.result&&a.push({id:"result",label:"Resultado",summary:`${t.result.type}  ${t.result.responseSent?"Respuesta enviada":"Sin respuesta"}`,timing:t.result.totalPipelineMs||null,status:t.result.responseSent?"completed":"skipped",icon:Et,detail:t.result}),a}function Pk(){return[{id:"message_received",label:"Mensaje recibido",summary:"",timing:0,status:"completed",icon:qt},{id:"session_mode",label:"Modo sesion",summary:"Evaluando...",timing:null,status:"processing",icon:is},{id:"global_keywords",label:"Keywords globales",summary:"Buscando...",timing:null,status:"processing",icon:Ao},{id:"active_session",label:"Sesion activa",summary:"Verificando...",timing:null,status:"processing",icon:ls},{id:"classification",label:"Clasificacion",summary:"Analizando...",timing:null,status:"processing",icon:lu},{id:"ai_fallback",label:"AI Fallback",summary:"Procesando...",timing:null,status:"processing",icon:Ln}]}function Ik({trace:t,isLoading:a}){const[s,o]=j.useState(new Set),c=d=>{o(m=>{const p=new Set(m);return p.has(d)?p.delete(d):p.add(d),p})},u=a&&!t?Pk():Yk(t);return!u.length&&!a?r.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[r.jsx(Ln,{className:"w-12 h-12 text-gray-200 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Envia un mensaje para ver el pipeline"}),r.jsx("p",{className:"text-[10px] text-gray-300 mt-1",children:"Cada paso del cerebro se mostrara aqui"})]}):r.jsxs("div",{className:"p-4 overflow-y-auto flex-1",children:[t?.result?.totalPipelineMs&&r.jsxs("div",{className:"mb-4 flex items-center gap-2 text-[10px]",children:[r.jsxs("span",{className:"px-2 py-0.5 bg-amber-50 text-amber-700 rounded-full font-semibold",children:["Total: ",t.result.totalPipelineMs,"ms"]}),r.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-500 rounded-full",children:t.result.type}),t.result.responseSent&&r.jsxs("span",{className:"px-2 py-0.5 bg-green-50 text-green-600 rounded-full",children:[t.result.responseTexts?.length||0," respuesta(s)"]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute left-[14px] top-[30px] bottom-0 w-0.5 bg-gray-200"}),r.jsx("div",{className:"space-y-3 relative",children:u.map((d,m)=>r.jsx(ob,{step:d,expanded:s.has(d.id),onToggle:c,animationDelay:m*100,children:d.children&&s.has(d.id)&&r.jsx("div",{className:"mt-2 ml-4 pl-6 border-l-2 border-blue-200 space-y-2",children:d.children.map((p,g)=>r.jsx(ob,{step:p,expanded:s.has(p.id),onToggle:c,animationDelay:g*60},p.id))})},d.id))})]})]})}function gh({label:t,labelColor:a,bgColor:s,textColor:o,content:c}){return c?r.jsxs("div",{className:"mb-4",children:[r.jsx("span",{className:`text-[10px] uppercase tracking-wider font-semibold ${a} block mb-1.5`,children:t}),r.jsx("pre",{className:`${s} ${o} rounded-lg p-3 text-[11px] overflow-x-auto whitespace-pre-wrap font-mono leading-relaxed max-h-[300px] overflow-y-auto`,children:c})]}):null}function Xk({trace:t}){if(!t)return r.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[r.jsx(Uc,{className:"w-10 h-10 text-gray-300 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400",children:"Sin datos de prompt"})]});const a=t.aiFallback||{},s=a.prompt||{},o=a.openaiCall||{},c=s.estimatedTokens||"?",u=s.totalSystemPromptChars||"?",d=o.model||"?",m=s.totalMessagesInArray||"?",p=s.systemPromptFull||null,g=s.behavioralRulesText||null,y=s.customInstructionsText||null,x=o.responseText||null;return r.jsxs("div",{className:"p-4 overflow-y-auto",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[r.jsxs("span",{className:"text-[10px] font-medium px-2.5 py-1 rounded-full bg-amber-100 text-amber-800",children:["~",c," tokens"]}),r.jsxs("span",{className:"text-[10px] font-medium px-2.5 py-1 rounded-full bg-gray-100 text-gray-600",children:[u," chars"]}),r.jsx("span",{className:"text-[10px] font-medium px-2.5 py-1 rounded-full bg-indigo-100 text-indigo-700",children:d}),r.jsxs("span",{className:"text-[10px] font-medium px-2.5 py-1 rounded-full bg-purple-100 text-purple-700",children:[m," msgs"]})]}),r.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-4",children:[s.isCustomSystemPrompt&&r.jsx("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 font-medium",children:"Prompt personalizado"}),s.knowledgeInjected&&r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 font-medium",children:["+",s.knowledgePairsInjected," pares Q&A"]}),s.pricesInjected&&r.jsx("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-green-100 text-green-700 font-medium",children:"+precios"}),s.behavioralRulesInjected&&r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-purple-100 text-purple-700 font-medium",children:["+",s.behavioralRulesCount," reglas"]}),s.hasCustomInstructions&&r.jsx("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 font-medium",children:"+instrucciones admin"}),r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-500 font-medium",children:["Fidelidad: ",s.fidelityLevel||"?"]})]}),r.jsx(gh,{label:"System Prompt Completo",labelColor:"text-gray-400",bgColor:"bg-gray-900",textColor:"text-gray-100",content:p}),g&&r.jsx(gh,{label:"Reglas de Comportamiento",labelColor:"text-purple-400",bgColor:"bg-purple-950",textColor:"text-purple-100",content:g}),y&&r.jsx(gh,{label:"Instrucciones del Admin",labelColor:"text-yellow-400",bgColor:"bg-yellow-950",textColor:"text-yellow-100",content:y}),x&&r.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[r.jsxs("span",{className:"text-[10px] uppercase tracking-wider font-semibold text-emerald-500 flex items-center gap-1 mb-1.5",children:[r.jsx(Yr,{className:"w-3 h-3"})," Respuesta de OpenAI"]}),r.jsx("pre",{className:"bg-emerald-950 text-emerald-100 rounded-lg p-3 text-[11px] overflow-x-auto whitespace-pre-wrap font-mono leading-relaxed border border-emerald-800",children:x}),o.durationMs&&r.jsx("div",{className:"flex gap-2 mt-2",children:r.jsxs("span",{className:"text-[9px] text-gray-400",children:[o.durationMs,"ms  ",o.totalTokens||"?"," tokens  ",o.finishReason||"?"]})})]}),!p&&!x&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx(ni,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),r.jsx("p",{className:"text-xs text-gray-400",children:"No hay datos de prompt disponibles en este trace"}),r.jsx("p",{className:"text-[10px] text-gray-300 mt-1",children:"Asegurate de enviar un mensaje con Rayos X activado"})]})]})}function Gk({trace:t,sessionCorrections:a}){const s=t?.aiFallback||{},o=s.knowledge||{},c=o.vectorSearch?.results||[],u=o.bm25Search?.results||[],d=[...c,...u],m=s.priceQuery||{},p=m.pricesFound||[],g=a&&a.length>0,y=d.length>0,x=p.length>0;return r.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[g&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-semibold uppercase tracking-wider text-amber-600 mb-2 flex items-center gap-1",children:[r.jsx(wS,{className:"w-3 h-3"}),"Correcciones de esta sesion"]}),r.jsx("div",{className:"space-y-2",children:a.map((b,N)=>r.jsxs("div",{className:`rounded-lg p-3 border text-[11px] ${b.type==="factual"?"bg-blue-50 border-blue-200 text-blue-800":"bg-purple-50 border-purple-200 text-purple-800"}`,children:[r.jsx("div",{className:"flex items-center gap-1.5 mb-1",children:b.type==="factual"?r.jsxs(r.Fragment,{children:[r.jsx(Et,{className:"w-3 h-3"}),r.jsx("span",{className:"font-semibold",children:"Respuesta corregida"})]}):r.jsxs(r.Fragment,{children:[r.jsx(is,{className:"w-3 h-3"}),r.jsx("span",{className:"font-semibold",children:"Regla agregada"})]})}),b.type==="factual"?r.jsxs(r.Fragment,{children:[b.question&&r.jsxs("p",{className:"text-[10px] opacity-70 mb-0.5",children:["P: ",b.question]}),r.jsxs("p",{children:["R: ",b.correctedAnswer]})]}):r.jsx("p",{children:b.rule})]},N))})]}),o.retrieverAvailable!==void 0&&r.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[r.jsxs("span",{className:`text-[9px] px-2 py-0.5 rounded-full font-medium ${o.retrieverAvailable?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:["Retriever: ",o.retrieverAvailable?"Disponible":"No disponible"]}),o.vectorSearch?.durationMs&&r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-500 font-medium",children:["Busqueda: ",o.vectorSearch.durationMs,"ms"]}),r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-600 font-medium",children:[o.combinedCount||0," resultados combinados"]})]}),c.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-semibold uppercase tracking-wider text-indigo-600 mb-2 flex items-center gap-1",children:[r.jsx(sm,{className:"w-3 h-3"}),"Busqueda vectorial (",c.length,")"]}),r.jsx("div",{className:"space-y-2",children:c.map((b,N)=>r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3 shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx("span",{className:"text-[9px] font-semibold px-1.5 py-0.5 rounded-full bg-indigo-50 text-indigo-600",children:b.source==="learned"?"Aprendido":b.source||"Vector"}),b.similarityScore!=null&&r.jsxs("span",{className:"text-[9px] font-mono text-gray-400",children:[Math.round((b.similarityScore||0)*100),"% similitud"]}),b.qualityScore!=null&&r.jsxs("span",{className:"text-[9px] font-mono text-amber-500",children:["Q:",b.qualityScore]})]}),r.jsxs("p",{className:"text-[11px] font-medium text-gray-700 mb-0.5",children:["P: ",b.question]}),r.jsxs("p",{className:"text-[11px] text-gray-500",children:["R: ",b.answerPreview]})]},`v-${N}`))})]}),u.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-semibold uppercase tracking-wider text-teal-600 mb-2 flex items-center gap-1",children:[r.jsx(rs,{className:"w-3 h-3"}),"Busqueda BM25 / FAQ (",u.length,")"]}),r.jsx("div",{className:"space-y-2",children:u.map((b,N)=>r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3 shadow-sm",children:[r.jsx("span",{className:"text-[9px] font-semibold px-1.5 py-0.5 rounded-full bg-teal-50 text-teal-600",children:b.source==="faq"?"FAQ":b.source||"BM25"}),r.jsxs("p",{className:"text-[11px] font-medium text-gray-700 mt-1.5 mb-0.5",children:["P: ",b.question]}),r.jsxs("p",{className:"text-[11px] text-gray-500",children:["R: ",b.answerPreview]})]},`b-${N}`))})]}),x&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-semibold uppercase tracking-wider text-green-600 mb-2 flex items-center gap-1",children:[r.jsx(Vr,{className:"w-3 h-3"}),"Precios encontrados (",p.length,")"]}),m.extractedProduct&&r.jsxs("p",{className:"text-[10px] text-gray-500 mb-2",children:["Producto detectado: ",r.jsx("span",{className:"font-medium text-gray-700",children:m.extractedProduct}),m.extractedVariant&&r.jsxs(r.Fragment,{children:["  Variante: ",r.jsx("span",{className:"font-medium text-gray-700",children:m.extractedVariant})]})]}),r.jsx("div",{className:"bg-green-50 rounded-lg border border-green-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-green-200",children:[r.jsx("th",{className:"text-left px-3 py-1.5 text-[9px] font-semibold text-green-700 uppercase",children:"Producto"}),r.jsx("th",{className:"text-left px-3 py-1.5 text-[9px] font-semibold text-green-700 uppercase",children:"Variante"}),r.jsx("th",{className:"text-right px-3 py-1.5 text-[9px] font-semibold text-green-700 uppercase",children:"Precio"})]})}),r.jsx("tbody",{className:"divide-y divide-green-100",children:p.map((b,N)=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-3 py-1.5 text-[11px] text-gray-700 font-medium",children:b.productName||"-"}),r.jsx("td",{className:"px-3 py-1.5 text-[11px] text-gray-500",children:b.variant||"-"}),r.jsxs("td",{className:"px-3 py-1.5 text-[11px] text-gray-700 font-mono text-right font-medium",children:["$",Number(b.price||0).toLocaleString("es-CL")]})]},N))})]})})]}),m.isPriceQuery&&!x&&r.jsxs("div",{className:"rounded-lg p-3 bg-yellow-50 border border-yellow-200 text-[11px] text-yellow-800",children:[r.jsx(Vr,{className:"w-3.5 h-3.5 inline mr-1"}),"Se detecto consulta de precio pero no se encontraron resultados",m.extractedProduct&&r.jsxs(r.Fragment,{children:[' para "',m.extractedProduct,'"']})]}),!y&&!x&&!g&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[r.jsx(rs,{className:"w-10 h-10 text-gray-300 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"No se inyecto conocimiento en esta respuesta"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"El bot puede haber respondido solo con el prompt base"})]})]})}function Qk({trace:t}){const s=(t?.aiFallback||{}).conversationHistory||{},o=s.turns||[],c=s.turnsLoaded||o.length;return o.length?r.jsxs("div",{className:"p-4 overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(qt,{className:"w-4 h-4 text-purple-500"}),r.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:[c," turnos cargados como contexto"]})]}),r.jsx("div",{className:"space-y-2",children:o.map((u,d)=>{const m=u.direction==="incoming"||u.direction==="in",p=u.text||"";return r.jsx("div",{className:`flex ${m?"justify-start":"justify-end"}`,children:r.jsxs("div",{className:`max-w-[85%] rounded-xl px-3 py-2 ${m?"bg-gray-100 text-gray-700":"bg-purple-50 text-purple-800 border border-purple-200"}`,children:[!m&&r.jsx("span",{className:"text-[8px] font-semibold uppercase tracking-wider text-purple-500 block mb-0.5",children:"BOT"}),r.jsx("p",{className:"text-[11px] whitespace-pre-wrap leading-relaxed",children:p}),u.timestamp&&r.jsx("span",{className:"text-[8px] opacity-40 block mt-0.5",children:new Date(u.timestamp).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})})]})},d)})})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[r.jsx(Ur,{className:"w-10 h-10 text-gray-300 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Sin historial de conversacion"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Este es el primer mensaje de la sesion"})]})}const Fk=[{id:"pipeline",label:"Pipeline",icon:ns},{id:"prompt",label:"Prompt",icon:Uc},{id:"knowledge",label:"Conocimiento",icon:rs},{id:"history",label:"Historial",icon:qt}];function Zk({activeTab:t,setActiveTab:a,trace:s,knowledgeStats:o,sessionCorrections:c,isLoading:u}){return r.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[o&&r.jsx(Vk,{stats:o}),r.jsx("div",{className:"flex border-b border-gray-200 bg-white px-2 flex-shrink-0",children:Fk.map(d=>{const m=d.icon,p=t===d.id;return r.jsxs("button",{onClick:()=>a(d.id),className:`flex items-center gap-1.5 px-3 py-2.5 text-[11px] font-medium border-b-2 transition ${p?"border-amber-500 text-amber-700 bg-amber-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(m,{className:"w-3.5 h-3.5"}),d.label]},d.id)})}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:!s&&!u?r.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[r.jsx(Ao,{className:"w-10 h-10 text-amber-300 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Envia un mensaje para ver el pipeline"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"El debug se activa con cada mensaje"})]}):r.jsxs(r.Fragment,{children:[t==="pipeline"&&r.jsx(Ik,{trace:s,isLoading:u}),t==="prompt"&&r.jsx(Xk,{trace:s}),t==="knowledge"&&r.jsx(Gk,{trace:s,sessionCorrections:c}),t==="history"&&r.jsx(Qk,{trace:s})]})})]})}function Wk({show:t,onClose:a}){const[s,o]=j.useState(!1),[c,u]=j.useState("pipeline"),[d,m]=j.useState([]),[p,g]=j.useState(""),[y,x]=j.useState(!1),[b,N]=j.useState(()=>`tester_admin_${Date.now()}`),[S,C]=j.useState(null),[_,E]=j.useState(null),[D,T]=j.useState([]),[A,w]=j.useState(null),[O,M]=j.useState(!1),q=j.useRef(null);j.useEffect(()=>{q.current&&q.current.scrollIntoView({behavior:"smooth"})},[d,y]);const H=async()=>{const ne=p.trim();if(!(!ne||y)){g(""),m($=>[...$,{role:"user",text:ne,time:new Date}]),x(!0),C(null);try{const $=await Ok(b,ne,s),I=$.responses||[],z=$.trace||null;if(I.length>0?m(R=>[...R,...I.map(U=>({role:"bot",text:U,time:new Date,trace:z,corrected:!1,correctionType:null}))]):m(R=>[...R,{role:"bot",text:"(sin respuesta del bot)",time:new Date,trace:z}]),z){C(z);const R=z.aiFallback||{},U=R.prompt||{},L=R.openaiCall||{};E({approvedPairs:U.knowledgePairsInjected||0,activePrices:R.priceQuery?.pricesFound?.length||0,behavioralRules:U.behavioralRulesCount||0,instructionsChars:U.totalSystemPromptChars||0,model:L.model||"unknown",fidelityLevel:U.fidelityLevel||"enhanced",temperature:L.temperature||.5})}}catch($){m(I=>[...I,{role:"system",text:"Error: "+$.message,time:new Date}])}finally{x(!1)}}},F=()=>{m([]),N(`tester_admin_${Date.now()}`),C(null),E(null),T([]),w(null)},Q=async(ne,{type:$,content:I})=>{M(!0);try{if($==="factual"){let z="";for(let R=ne-1;R>=0;R--)if(d[R].role==="user"){z=d[R].text;break}await Bk(z,I),m(R=>R.map((U,L)=>L===ne?{...U,corrected:!0,correctionType:"factual"}:U)),T(R=>[...R,{type:"factual",index:ne,question:z,correctedAnswer:I,time:new Date}])}else await Fv({rule:I}),m(z=>z.map((R,U)=>U===ne?{...R,corrected:!0,correctionType:"behavioral"}:R)),T(z=>[...z,{type:"behavioral",index:ne,rule:I,time:new Date}]);w(null)}catch(z){console.error("Error submitting correction:",z)}finally{M(!1)}},Z=async ne=>{let $="";for(let I=ne-1;I>=0;I--)if(d[I].role==="user"){$=d[I].text;break}$&&g($)};return t?r.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",children:[r.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:a}),r.jsxs("div",{className:`relative bg-white shadow-2xl flex flex-col h-full transition-all duration-500 ease-out ${s?"w-full max-w-[56rem]":"w-full max-w-md"}`,onClick:ne=>ne.stopPropagation(),children:[r.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 px-5 py-4 flex items-center justify-between flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-3 text-white",children:[r.jsx(zb,{className:"w-5 h-5"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-sm",children:"Probador IA"}),r.jsx("p",{className:"text-[10px] text-purple-200",children:"Prueba tu prompt en tiempo real"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>o(!s),className:`flex items-center gap-1.5 text-[10px] px-3 py-1.5 rounded-full font-semibold transition-all ${s?"bg-amber-400 text-amber-900 shadow-lg shadow-amber-400/30":"bg-white/20 text-white hover:bg-white/30"}`,children:[r.jsx(Ao,{className:"w-3.5 h-3.5"}),"Rayos X"]}),r.jsx("button",{onClick:F,className:"text-[10px] bg-white/20 hover:bg-white/30 text-white px-2.5 py-1.5 rounded-full font-medium transition",children:r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(ls,{className:"w-3 h-3"}),"Nueva conv."]})}),r.jsx("button",{onClick:a,className:"p-1 text-white/70 hover:text-white rounded",children:r.jsx(qn,{className:"w-5 h-5"})})]})]}),r.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[r.jsx("div",{className:`flex flex-col ${s?"w-[400px] flex-shrink-0 border-r border-gray-200":"flex-1"}`,children:r.jsx(Uk,{messages:d,input:p,setInput:g,loading:y,onSend:H,onReset:F,correcting:A,setCorrecting:w,onSubmitCorrection:Q,submitting:O,onRetest:Z,endRef:q})}),s&&r.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-gray-50",children:r.jsx(Zk,{activeTab:c,setActiveTab:u,trace:S,knowledgeStats:_,sessionCorrections:D,isLoading:y})})]})]})]}):null}const Kk=[{id:"brain",label:"Cerebro IA",icon:Ln},{id:"instructions",label:"Instrucciones",icon:ni},{id:"bot-conversations",label:"Conversaciones IA",icon:qt},{id:"dashboard",label:"Dashboard",icon:Jh},{id:"pairs",label:"Pares Q&A",icon:rs},{id:"prices",label:"Precios",icon:Vr}];function Jk({label:t,value:a}){const s=a>=80?"#10b981":a>=50?"#f59e0b":"#ef4444",o=2*Math.PI*36,c=o-a/100*o;return r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4 flex flex-col items-center",children:[r.jsxs("svg",{width:"88",height:"88",className:"mb-2",children:[r.jsx("circle",{cx:"44",cy:"44",r:"36",fill:"none",stroke:"#f3f4f6",strokeWidth:"8"}),r.jsx("circle",{cx:"44",cy:"44",r:"36",fill:"none",stroke:s,strokeWidth:"8",strokeDasharray:o,strokeDashoffset:c,strokeLinecap:"round",transform:"rotate(-90 44 44)",className:"transition-all duration-700"}),r.jsxs("text",{x:"44",y:"48",textAnchor:"middle",fontSize:"18",fontWeight:"bold",fill:"#1f2937",children:[a,"%"]})]}),r.jsx("span",{className:"text-xs text-gray-500 text-center",children:t})]})}const e7={confianza_general:"Confianza General",cobertura_temas:"Cobertura de Temas",calidad_respuestas:"Calidad Respuestas",actualizacion_precios:"Precios Actualizados"},t7={puede_responder_precios:"Responder Precios",puede_comparar_productos:"Comparar Productos",puede_recomendar:"Recomendar",puede_dar_plazos:"Informar Plazos",puede_informar_despacho:"Informar Despacho"},xh={pending:{label:"Pendiente",cls:"bg-yellow-50 text-yellow-700"},approved:{label:"Aprobado",cls:"bg-green-50 text-green-700"},rejected:{label:"Rechazado",cls:"bg-red-50 text-red-700"}};function n7(){const[t,a]=j.useState(null),[s,o]=j.useState(!0),[c,u]=j.useState(!1),[d,m]=j.useState(null),[p,g]=j.useState(!1),[y,x]=j.useState("");j.useEffect(()=>{b()},[]);const b=async()=>{o(!0),x("");try{const C=await rb(!1);a(C.report),m(C.generated_at),g(C.cached)}catch(C){x(C.message)}finally{o(!1)}},N=async()=>{u(!0),x("");try{const C=await rb(!0);a(C.report),m(C.generated_at),g(!1)}catch(C){x(C.message)}finally{u(!1)}};if(s)return r.jsx("div",{className:"flex items-center justify-center py-20",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})});if(y&&!t)return r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[r.jsx(lo,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),r.jsx("p",{className:"text-red-700",children:y}),r.jsx("button",{onClick:b,className:"mt-3 text-sm text-red-600 underline",children:"Reintentar"})]});const S=t?.ai_analysis;return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-8 text-white",children:r.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center",children:r.jsx(Ln,{className:"w-8 h-8"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Cerebro IA"}),r.jsxs("p",{className:"text-indigo-200 text-sm mt-1",children:[d?`Ultimo analisis: ${si(new Date(d),{addSuffix:!0,locale:os})}`:"Sin analisis previo",p&&" (cacheado)"]})]})]}),r.jsxs("button",{onClick:N,disabled:c,className:"flex items-center gap-2 bg-white/20 hover:bg-white/30 px-4 py-2.5 rounded-lg transition disabled:opacity-50",children:[r.jsx(ls,{className:`w-4 h-4 ${c?"animate-spin":""}`}),c?"Generando...":"Regenerar Analisis"]})]})}),t?.ai_available===!1&&r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 flex items-center gap-3",children:[r.jsx(lo,{className:"w-5 h-5 text-yellow-600 flex-shrink-0"}),r.jsx("p",{className:"text-yellow-800 text-sm",children:"OpenAI no configurado. Se muestran datos basicos sin analisis IA. Configure OPENAI_API_KEY para el reporte completo."})]}),t?.stats&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsx(dn,{title:"Pares Aprobados",value:t.stats.approved,icon:rs,color:"green",subtitle:"Base de conocimiento"}),r.jsx(dn,{title:"Pendientes",value:t.stats.pending,icon:lo,color:"yellow",subtitle:"Por revisar"}),r.jsx(dn,{title:"Precios Activos",value:t.stats.active_prices,icon:Vr,color:"blue",subtitle:"Productos con precio"}),r.jsx(dn,{title:"Calidad Promedio",value:`${t.stats.avg_quality||0}/100`,icon:Vc,color:"purple",subtitle:"Score Q&A"})]}),y&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm",children:y}),S?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:r.jsxs("div",{className:"border-l-4 border-indigo-500 pl-4",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[r.jsx(Yr,{className:"w-5 h-5 text-indigo-500"})," Resumen General"]}),r.jsx("p",{className:"text-gray-600 leading-relaxed",children:S.resumen})]})}),S.metricas_confianza&&r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(S.metricas_confianza).map(([C,_])=>r.jsx(Jk,{label:e7[C]||C,value:Number(_)||0},C))}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(lu,{className:"w-5 h-5 text-green-500"})," Temas Dominados"]}),(S.temas_dominados||[]).length===0?r.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"Sin temas detectados aun"}):r.jsx("div",{className:"space-y-3",children:S.temas_dominados.map((C,_)=>r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:"text-gray-700 font-medium",children:C.tema}),r.jsxs("span",{className:"text-gray-500",children:[C.confianza,"% (",C.ejemplos," ej.)"]})]}),r.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${C.confianza}%`,backgroundColor:C.confianza>=80?"#10b981":C.confianza>=50?"#f59e0b":"#ef4444"}})}),C.detalle&&r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:C.detalle})]},_))})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(lo,{className:"w-5 h-5 text-yellow-500"})," Brechas de Conocimiento"]}),(S.brechas_conocimiento||[]).length===0?r.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"Sin brechas detectadas"}):r.jsx("div",{className:"space-y-3",children:S.brechas_conocimiento.map((C,_)=>r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${C.prioridad==="alta"?"bg-red-100 text-red-700":C.prioridad==="media"?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"}`,children:C.prioridad}),r.jsx("span",{className:"font-medium text-gray-800 text-sm",children:C.area})]}),r.jsx("p",{className:"text-gray-500 text-sm",children:C.descripcion})]},_))})]})]}),S.capacidades&&r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(Ao,{className:"w-5 h-5 text-blue-500"})," Capacidades"]}),r.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(S.capacidades).map(([C,_])=>r.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${_?"bg-green-50 text-green-700":"bg-gray-100 text-gray-400"}`,children:[_?r.jsx(Et,{className:"w-4 h-4"}):r.jsx(qn,{className:"w-4 h-4"}),t7[C]||C]},C))})]}),S.razonamiento&&r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[r.jsx(Ln,{className:"w-5 h-5 text-purple-500"})," Razonamiento"]}),r.jsx("p",{className:"text-gray-600 leading-relaxed italic",children:S.razonamiento})]}),S.recomendaciones?.length>0&&r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[r.jsx(Vc,{className:"w-5 h-5 text-indigo-500"})," Recomendaciones"]}),r.jsx("ul",{className:"space-y-2",children:S.recomendaciones.map((C,_)=>r.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-600",children:[r.jsx(Yr,{className:"w-4 h-4 text-indigo-400 mt-0.5 flex-shrink-0"}),C]},_))})]}),r.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-xs text-gray-400 flex items-center justify-between",children:[r.jsxs("span",{children:["Datos base: ",t?.stats?.approved||0," pares aprobados, ",t?.stats?.active_prices||0," precios"]}),r.jsx("span",{children:t?.ai_available?"Analisis generado por IA":"Datos sin analisis IA"})]})]}):r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-12 text-center",children:[r.jsx(Ln,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-400",children:'Sin datos de analisis. Aprueba pares Q&A y presiona "Regenerar Analisis".'})]})]})}function a7({stats:t}){if(!t)return r.jsx("p",{className:"text-gray-400 text-center py-8",children:"Cargando estadisticas..."});const a=Object.entries(t.by_channel||{}),s=a.reduce((o,[,c])=>o+c,0)||1;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsx(dn,{title:"Total Pares",value:t.total,icon:rs,color:"blue",subtitle:"Q&A aprendidos"}),r.jsx(dn,{title:"Aprobados",value:t.approved,icon:Et,color:"green",subtitle:`${t.with_embedding} con embedding`}),r.jsx(dn,{title:"Pendientes",value:t.pending,icon:lo,color:"yellow",subtitle:"Por revisar"}),r.jsx(dn,{title:"Calidad Promedio",value:`${t.avg_quality||0}/100`,icon:Vc,color:"purple",subtitle:"Score de calidad"})]}),a.length>0&&r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"Distribucion por Canal"}),r.jsx("div",{className:"space-y-3",children:a.map(([o,c])=>r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:"text-gray-700 font-medium capitalize",children:o}),r.jsxs("span",{className:"text-gray-500",children:[c," pares (",Math.round(c/s*100),"%)"]})]}),r.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-indigo-500 rounded-full transition-all",style:{width:`${Math.round(c/s*100)}%`}})})]},o))})]})]})}function s7(){const[t,a]=j.useState([]),[s,o]=j.useState(1),[c,u]=j.useState(1),[d,m]=j.useState(0),[p,g]=j.useState(!0),[y,x]=j.useState({status:"",channel:"",minQuality:""}),[b,N]=j.useState(null),[S,C]=j.useState(!1),[_,E]=j.useState({from:"",to:""}),[D,T]=j.useState(!1);j.useEffect(()=>{A()},[s,y]);const A=async()=>{g(!0);try{const F=await jk({page:s,limit:20,...y});a(F.pairs),u(F.pages),m(F.total)}catch(F){console.error(F)}finally{g(!1)}},w=async F=>{try{await sb(F,"approved"),A()}catch(Q){alert(Q.message)}},O=async F=>{try{await sb(F,"rejected"),A()}catch(Q){alert(Q.message)}},M=async F=>{if(confirm("Eliminar este par permanentemente?"))try{await Nk(F),A()}catch(Q){alert(Q.message)}},q=async()=>{T(!0);try{const F=await Sk(_.from,_.to);alert(`Reprocesadas: ${F.processed} sesiones`),C(!1),A()}catch(F){alert(F.message)}finally{T(!1)}},H=(F,Q)=>{x(Z=>({...Z,[F]:Q})),o(1)};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs("select",{value:y.status,onChange:F=>H("status",F.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:"pending",children:"Pendientes"}),r.jsx("option",{value:"approved",children:"Aprobados"}),r.jsx("option",{value:"rejected",children:"Rechazados"})]}),r.jsxs("select",{value:y.channel,onChange:F=>H("channel",F.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"",children:"Todos los canales"}),r.jsx("option",{value:"whatsapp",children:"WhatsApp"}),r.jsx("option",{value:"instagram",children:"Instagram"})]}),r.jsx("input",{type:"number",placeholder:"Calidad min.",value:y.minQuality,onChange:F=>H("minQuality",F.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm w-28",min:"0",max:"100"}),r.jsxs("span",{className:"text-sm text-gray-400 ml-auto",children:[d," pares en total"]}),r.jsxs("button",{onClick:()=>C(!0),className:"flex items-center gap-1 text-sm text-indigo-600 hover:text-indigo-700 font-medium",children:[r.jsx(ls,{className:"w-4 h-4"})," Reprocesar"]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Pregunta"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Respuesta"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Calidad"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Canal"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Estado"}),r.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Acciones"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:p?r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-8 text-gray-400",children:"Cargando..."})}):t.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-12 text-gray-400",children:"No hay pares que coincidan con los filtros"})}):t.map(F=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 max-w-[200px] truncate",children:F.question}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-[250px] truncate",children:F.answer}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("span",{className:`text-sm font-medium ${F.quality_score>=80?"text-green-600":F.quality_score>=50?"text-yellow-600":"text-red-600"}`,children:F.quality_score})}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600 capitalize",children:F.channel})}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${xh[F.status]?.cls||""}`,children:xh[F.status]?.label||F.status})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-1",children:[r.jsx("button",{onClick:()=>N(F),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Ver detalle",children:r.jsx(tm,{className:"w-4 h-4"})}),F.status!=="approved"&&r.jsx("button",{onClick:()=>w(F.id),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg",title:"Aprobar",children:r.jsx(Et,{className:"w-4 h-4"})}),F.status!=="rejected"&&r.jsx("button",{onClick:()=>O(F.id),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded-lg",title:"Rechazar",children:r.jsx(qn,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>M(F.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Eliminar",children:r.jsx(ai,{className:"w-4 h-4"})})]})})]},F.id))})]})}),c>1&&r.jsxs("div",{className:"flex items-center justify-center gap-4",children:[r.jsx("button",{onClick:()=>o(F=>Math.max(1,F-1)),disabled:s===1,className:"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-30",children:r.jsx(yS,{className:"w-5 h-5"})}),r.jsxs("span",{className:"text-sm text-gray-600",children:["Pagina ",s," de ",c]}),r.jsx("button",{onClick:()=>o(F=>Math.min(c,F+1)),disabled:s===c,className:"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-30",children:r.jsx(Mo,{className:"w-5 h-5"})})]}),b&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>N(null),children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg p-6",onClick:F=>F.stopPropagation(),children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Detalle del Par Q&A"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mb-1",children:"Pregunta del cliente"}),r.jsx("p",{className:"text-gray-800 bg-gray-50 rounded-lg p-3 text-sm",children:b.question})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mb-1",children:"Respuesta del agente"}),r.jsx("p",{className:"text-gray-800 bg-gray-50 rounded-lg p-3 text-sm whitespace-pre-wrap",children:b.answer})]}),r.jsxs("div",{className:"flex gap-4 text-sm text-gray-500",children:[r.jsxs("span",{children:["Calidad: ",r.jsx("strong",{className:"text-gray-700",children:b.quality_score})]}),r.jsxs("span",{children:["Canal: ",r.jsx("strong",{className:"text-gray-700 capitalize",children:b.channel})]}),r.jsxs("span",{children:["Estado: ",r.jsx("strong",{className:"text-gray-700",children:xh[b.status]?.label})]})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[b.status!=="approved"&&r.jsx("button",{onClick:()=>{w(b.id),N(null)},className:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition text-sm font-medium",children:"Aprobar"}),b.status!=="rejected"&&r.jsx("button",{onClick:()=>{O(b.id),N(null)},className:"flex-1 px-4 py-2.5 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition text-sm font-medium",children:"Rechazar"}),r.jsx("button",{onClick:()=>N(null),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition text-sm",children:"Cerrar"})]})]})}),S&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>C(!1),children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6",onClick:F=>F.stopPropagation(),children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Reprocesar Sesiones"}),r.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Extrae pares Q&A de conversaciones pasadas. Opcional: filtra por rango de fechas."}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Desde (opcional)"}),r.jsx("input",{type:"date",value:_.from,onChange:F=>E(Q=>({...Q,from:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hasta (opcional)"}),r.jsx("input",{type:"date",value:_.to,onChange:F=>E(Q=>({...Q,to:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>C(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition text-sm",children:"Cancelar"}),r.jsx("button",{onClick:q,disabled:D,className:"flex-1 px-4 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition text-sm font-medium disabled:opacity-50",children:D?"Procesando...":"Reprocesar"})]})]})})]})}function r7(){const[t,a]=j.useState([]),[s,o]=j.useState(!0),[c,u]=j.useState(!1),[d,m]=j.useState(!1),[p,g]=j.useState(null),[y,x]=j.useState({product_name:"",variant:"",price:"",currency:"CLP",notes:""}),[b,N]=j.useState(!1),[S,C]=j.useState("");j.useEffect(()=>{_()},[c]);const _=async()=>{o(!0);try{const w=await _k(!c);a(w.prices)}catch(w){console.error(w)}finally{o(!1)}},E=()=>{g(null),x({product_name:"",variant:"",price:"",currency:"CLP",notes:""}),C(""),m(!0)},D=w=>{g(w),x({product_name:w.product_name,variant:w.variant||"",price:w.price,currency:w.currency||"CLP",notes:w.notes||""}),C(""),m(!0)},T=async w=>{w.preventDefault(),C(""),N(!0);try{p?await Ck(p.id,{product_name:y.product_name,variant:y.variant||null,price:Number(y.price),currency:y.currency,notes:y.notes||null}):await Ek({product_name:y.product_name,variant:y.variant||null,price:Number(y.price),currency:y.currency,notes:y.notes||null}),m(!1),_()}catch(O){C(O.message)}finally{N(!1)}},A=async w=>{if(confirm("Desactivar este precio?"))try{await Tk(w),_()}catch(O){alert(O.message)}};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx("input",{type:"checkbox",checked:c,onChange:w=>u(w.target.checked),className:"rounded border-gray-300"}),"Mostrar inactivos"]}),r.jsxs("button",{onClick:E,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2.5 rounded-lg transition font-medium text-sm",children:[r.jsx(iu,{className:"w-4 h-4"})," Nuevo Precio"]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Producto"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Variante"}),r.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Precio"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Estado"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Notas"}),r.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Acciones"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:s?r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-8 text-gray-400",children:"Cargando..."})}):t.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-12 text-gray-400",children:"No hay precios. Crea el primero."})}):t.map(w=>r.jsxs("tr",{className:`hover:bg-gray-50 ${w.is_active?"":"opacity-50"}`,children:[r.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-800",children:w.product_name}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:w.variant||"-"}),r.jsxs("td",{className:"px-4 py-3 text-sm text-right font-mono font-medium text-gray-800",children:[w.currency," $",Number(w.price).toLocaleString("es-CL")]}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${w.is_active?"bg-green-50 text-green-700":"bg-gray-100 text-gray-500"}`,children:w.is_active?"Activo":"Inactivo"})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-[200px] truncate",children:w.notes||"-"}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-1",children:[r.jsx("button",{onClick:()=>D(w),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Editar",children:r.jsx(ou,{className:"w-4 h-4"})}),w.is_active&&r.jsx("button",{onClick:()=>A(w.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Desactivar",children:r.jsx(ai,{className:"w-4 h-4"})})]})})]},w.id))})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>m(!1),children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",onClick:w=>w.stopPropagation(),children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:p?"Editar Precio":"Nuevo Precio"}),S&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4",children:S}),r.jsxs("form",{onSubmit:T,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Producto"}),r.jsx("input",{type:"text",value:y.product_name,onChange:w=>x({...y,product_name:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,placeholder:"Ej: Colchon Spring"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Variante (opcional)"}),r.jsx("input",{type:"text",value:y.variant,onChange:w=>x({...y,variant:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Ej: King, Queen, 2 Plazas"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio"}),r.jsx("input",{type:"number",value:y.price,onChange:w=>x({...y,price:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,min:"0",step:"1"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda"}),r.jsxs("select",{value:y.currency,onChange:w=>x({...y,currency:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"CLP",children:"CLP"}),r.jsx("option",{value:"USD",children:"USD"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (opcional)"}),r.jsx("input",{type:"text",value:y.notes,onChange:w=>x({...y,notes:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Ej: Precio promocional hasta Marzo"})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition text-sm",children:"Cancelar"}),r.jsx("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition text-sm font-medium disabled:opacity-50",children:b?"Guardando...":p?"Guardar":"Crear"})]})]})]})})]})}const lb=`Eres un vendedor humano de Respaldos Chile que conversa por WhatsApp e Instagram.
Respaldos Chile vende respaldos de cama, cabeceras y accesorios de dormitorio.

Hablas como una persona real, cercana y profesional (chileno neutro).
Nada de lenguaje robotico, corporativo ni de catalogo.

Los mensajes deben ser cortos y naturales:
- Maximo 3-4 lineas
- Una sola idea por mensaje
- Cierra siempre con una pregunta que avance la conversacion

Si conoces el nombre del cliente ({{nombre}}), usalo naturalmente.

FLUJO DE CONVERSACION:
1. Si es primer mensaje o saludo: responde con un saludo corto y pregunta abierta tipo "en que te puedo ayudar?" o "cuentame, en que andas?". NO menciones productos, respaldos, cabeceras ni nada especifico. El cliente puede querer cualquier cosa: comprar, reclamar, preguntar por un pedido, cotizar, o algo que no tiene nada que ver con respaldos.
2. Espera a que el cliente diga que necesita antes de asumir NADA.
3. Si falta info (medida, estilo, color): pregunta antes de recomendar. Una pregunta por mensaje. NO preguntes cosas obvias ni redundantes (ej: si quiere un respaldo de cama, no preguntes "donde lo vas a poner" porque es obvio que es en su dormitorio).
4. Si ya tienes contexto: sugiere maximo 2 opciones, condicionadas a lo que dijo el cliente.
5. Si el cliente tiene dudas: responde con calma, no contradigas, confirma si no sabes.
6. Si quiere comprar o pagar: "Te conecto con alguien del equipo para cerrar eso"
7. Nunca saltes etapas: no cotices sin contexto, no recomiendes sin entender.

Reglas estrictas:
- NUNCA asumas el motivo de contacto del cliente. Pregunta primero.
- NUNCA inventes materiales, modelos, estilos ni tipos de producto. Si no tienes info concreta de lo que vendemos, di "Dejame confirmarlo con el equipo y te respondo al tiro"
- No usar listas ni formato de catalogo
- No entregar fichas tecnicas ni especificaciones duras
- No inventar precios, plazos, stock ni condiciones
- No asumir medidas, colores ni disponibilidad
- No usar frases tipo "Estimado/a cliente" o "Le informamos que..."

Nunca emitas juicios genericos de gusto como:
"queda bonito", "es lindo", "es precioso", "te va a encantar".

Las recomendaciones deben ser siempre condicionadas al contexto del cliente:
"Suele funcionar bien cuando..."
"En espacios como el tuyo..."
"Por lo que me comentas..."
"Para el uso que buscas..."

Si no tienes certeza, responde exactamente:
"Dejame confirmarlo con el equipo y te respondo al tiro"

Usa solo informacion confirmada. Puedes mejorar redaccion y trato, pero sin cambiar datos.`;function i7(){const[t,a]=j.useState(null),[s,o]=j.useState(""),[c,u]=j.useState(""),[d,m]=j.useState(!1),[p,g]=j.useState(!0),[y,x]=j.useState(!1),[b,N]=j.useState(!1),[S,C]=j.useState(""),[_,E]=j.useState(!1),[D,T]=j.useState(null),[A,w]=j.useState(!1),[O,M]=j.useState(!1),[q,H]=j.useState([]),[F,Q]=j.useState(!0),[Z,ne]=j.useState(""),[$,I]=j.useState("general"),[z,R]=j.useState(!1);j.useEffect(()=>{B(),U()},[]);const U=async()=>{Q(!0);try{const G=await Lk();H(G.rules||[])}catch(G){console.error("Error loading rules:",G),H([])}finally{Q(!1)}},L=async()=>{if(!(!Z.trim()||z)){R(!0);try{await Fv({rule:Z.trim(),category:$}),ne(""),I("general"),U()}catch(G){C(G.message)}finally{R(!1)}}},K=async G=>{try{await Hk(G),H(re=>re.filter(de=>de.id!==G))}catch(re){C(re.message)}},B=async()=>{g(!0),C("");try{const G=await Mk();a(G.config),o(G.config?.custom_instructions||""),u(G.config?.system_prompt||""),G.config?.system_prompt&&m(!0)}catch(G){C(G.message)}finally{g(!1)}},P=async()=>{x(!0),N(!1),C("");try{const G=await Ak({...t,custom_instructions:s,system_prompt:c||null});G.config&&(a(G.config),o(G.config.custom_instructions||""),u(G.config.system_prompt||"")),N(!0),setTimeout(()=>N(!1),3e3)}catch(G){C("Error al guardar: "+G.message)}finally{x(!1)}},ae=async()=>{w(!0),E(!0);try{const G=await kk();T(G)}catch(G){C(G.message)}finally{w(!1)}};return p?r.jsx("div",{className:"flex items-center justify-center py-20",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-8 text-white",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center",children:r.jsx(ni,{className:"w-8 h-8"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Instrucciones para la IA"}),r.jsx("p",{className:"text-blue-200 text-sm mt-1",children:"Escribe reglas, conocimiento y procedimientos que la IA debe seguir"})]})]})}),S&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm",children:S}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Prompt del sistema (cerebro general)"}),d?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>u(lb),className:"text-xs text-gray-500 hover:text-orange-600 font-medium flex items-center gap-1",children:[r.jsx(Ob,{className:"w-3.5 h-3.5"})," Restaurar default"]}),r.jsxs("button",{onClick:()=>{u(""),m(!1)},className:"text-xs text-gray-400 hover:text-red-500 font-medium flex items-center gap-1",children:[r.jsx(qn,{className:"w-3.5 h-3.5"})," Quitar"]})]}):r.jsxs("button",{onClick:()=>{m(!0),c||u(lb)},className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium flex items-center gap-1",children:[r.jsx(ou,{className:"w-3.5 h-3.5"})," Personalizar"]})]}),d?r.jsxs(r.Fragment,{children:[r.jsx("textarea",{value:c,onChange:G=>u(G.target.value),rows:12,className:"w-full px-4 py-3 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-y font-mono",placeholder:"Define la personalidad, tono y reglas base de la IA..."}),r.jsxs("p",{className:"mt-2 text-xs text-gray-400",children:["Este es el prompt base que define quien es la IA. Usa ",r.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"{{nombre}}"})," para inyectar el nombre del cliente."]})]}):r.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-sm text-gray-500",children:[r.jsx("p",{children:'Usando el prompt por defecto. Haz click en "Personalizar" para editarlo.'}),r.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Tip: Usa ",r.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"{{nombre}}"})," para inyectar el nombre del cliente automaticamente."]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Instrucciones adicionales"}),r.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Reglas especificas, conocimiento del negocio, procedimientos. Se agregan al prompt del sistema."}),r.jsx("textarea",{value:s,onChange:G=>o(G.target.value),rows:10,className:"w-full px-4 py-3 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-y font-mono",placeholder:`Ejemplos:
- Los modelos disponibles son: Venecia, Florencia, Roma, Milan
- Si preguntan por despacho: "Dentro de Santiago 3-5 dias habiles"
- Formas de pago: transferencia, tarjeta de credito, webpay
- Siempre ofrecer la opcion de hablar con un vendedor
- No dar informacion sobre competidores
- Horario de atencion: Lunes a Viernes 9:00 a 18:00`}),r.jsxs("div",{className:"flex items-center justify-between mt-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("button",{onClick:P,disabled:y,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-lg transition font-medium text-sm disabled:opacity-50",children:[r.jsx(c5,{className:"w-4 h-4"}),y?"Guardando...":"Guardar Todo"]}),b&&r.jsxs("span",{className:"text-green-600 text-sm font-medium flex items-center gap-1",children:[r.jsx(Et,{className:"w-4 h-4"})," Guardado"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("button",{onClick:ae,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-indigo-600 font-medium transition",children:[r.jsx(Uc,{className:"w-4 h-4"})," Ver Prompt"]}),r.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition font-medium text-sm",children:[r.jsx(zb,{className:"w-4 h-4"})," Probar IA"]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[r.jsx(is,{className:"w-4 h-4 text-purple-500"})," Reglas de Comportamiento"]}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Reglas que la IA debe seguir siempre. Se inyectan con prioridad alta en cada respuesta."})]}),r.jsxs("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-purple-50 text-purple-700",children:[q.length,"/30 reglas"]})]}),F?r.jsx("div",{className:"text-center py-6 text-gray-400 text-sm",children:"Cargando reglas..."}):q.length===0?r.jsxs("div",{className:"text-center py-6",children:[r.jsx(is,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-gray-400",children:"Sin reglas todavia"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:'Agrega reglas aqui o desde el Probador IA con "Corregir"'})]}):r.jsx("div",{className:"space-y-2 mb-4",children:q.map(G=>r.jsxs("div",{className:"flex items-start gap-3 bg-gray-50 rounded-lg p-3 group",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm text-gray-700",children:G.rule_text}),r.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[r.jsx("span",{className:`text-[9px] font-semibold px-1.5 py-0.5 rounded-full uppercase ${G.category==="tone"?"bg-blue-50 text-blue-600":G.category==="knowledge"?"bg-green-50 text-green-600":G.category==="sales"?"bg-amber-50 text-amber-600":G.category==="format"?"bg-indigo-50 text-indigo-600":G.category==="safety"?"bg-red-50 text-red-600":"bg-gray-100 text-gray-500"}`,children:G.category}),r.jsxs("span",{className:"text-[9px] text-gray-400",children:["via ",G.source==="correction"?"correccion":G.source==="admin"?"admin":G.source]})]})]}),r.jsx("button",{onClick:()=>K(G.id),className:"p-1.5 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition opacity-0 group-hover:opacity-100",title:"Eliminar regla",children:r.jsx(ai,{className:"w-3.5 h-3.5"})})]},G.id))}),r.jsxs("div",{className:"border-t border-gray-100 pt-4 mt-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",value:Z,onChange:G=>ne(G.target.value),onKeyDown:G=>G.key==="Enter"&&L(),placeholder:"Ej: Nunca recomendar modelos especificos sin preguntar primero",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500",maxLength:500}),r.jsxs("select",{value:$,onChange:G=>I(G.target.value),className:"px-2 py-2 border border-gray-300 rounded-lg text-xs text-gray-600",children:[r.jsx("option",{value:"general",children:"General"}),r.jsx("option",{value:"tone",children:"Tono"}),r.jsx("option",{value:"knowledge",children:"Conocimiento"}),r.jsx("option",{value:"sales",children:"Ventas"}),r.jsx("option",{value:"format",children:"Formato"}),r.jsx("option",{value:"safety",children:"Seguridad"})]}),r.jsxs("button",{onClick:L,disabled:z||!Z.trim()||q.length>=30,className:"flex items-center gap-1.5 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition disabled:opacity-50",children:[r.jsx(iu,{className:"w-3.5 h-3.5"}),z?"...":"Agregar"]})]}),Z.length>400&&r.jsxs("p",{className:"text-[10px] text-amber-600 mt-1",children:[500-Z.length," caracteres restantes"]})]})]}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-5",children:[r.jsxs("h3",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[r.jsx(Yr,{className:"w-5 h-5"})," Tips para mejores instrucciones"]}),r.jsxs("ul",{className:"space-y-2 text-sm text-blue-700",children:[r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),'Se especifico: "El despacho a Santiago demora 3-5 dias" es mejor que "informar plazos"']}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),"Incluye respuestas exactas para preguntas frecuentes"]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),'Los precios se manejan en la tab "Precios"  no los pongas aqui']}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),'Define el tono: "Responde como vendedor amigable, tutea al cliente"']}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),'Indica que NO hacer: "Nunca ofrezcas descuentos sin autorizacion"']})]})]}),_&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>E(!1),children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",onClick:G=>G.stopPropagation(),children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[r.jsxs("h2",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(Uc,{className:"w-5 h-5 text-indigo-500"})," Prompt Actual"]}),r.jsx("button",{onClick:()=>E(!1),className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-lg",children:r.jsx(qn,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"overflow-y-auto p-6 space-y-4",children:A?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-500"})}):D?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-wrap gap-3 text-sm",children:[r.jsxs("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 rounded-full font-medium",children:["Modelo: ",D.model]}),r.jsxs("span",{className:"px-3 py-1 bg-green-50 text-green-700 rounded-full font-medium",children:["Conocimiento: ",D.knowledgeCount," pares"]}),r.jsxs("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full font-medium",children:["Precios: ",D.priceCount," activos"]}),r.jsxs("span",{className:"px-3 py-1 bg-purple-50 text-purple-700 rounded-full font-medium",children:["Fidelidad: ",D.fidelityLevel]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mb-2",children:"System Prompt"}),r.jsx("pre",{className:"bg-gray-900 text-gray-100 rounded-xl p-4 text-sm overflow-x-auto whitespace-pre-wrap font-mono leading-relaxed",children:D.systemPrompt})]}),D.customInstructions&&r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[r.jsx("span",{className:"text-xs font-semibold text-blue-600 uppercase",children:"Tus instrucciones (incluidas arriba)"}),r.jsx("p",{className:"text-sm text-blue-800 mt-1 whitespace-pre-wrap",children:D.customInstructions})]})]}):r.jsx("p",{className:"text-gray-400 text-center py-8",children:"Error cargando prompt"})})]})}),r.jsx(Wk,{show:O,onClose:()=>M(!1)})]})}function o7(){const[t,a]=j.useState([]),[s,o]=j.useState(!0),[c,u]=j.useState(null),[d,m]=j.useState([]),[p,g]=j.useState(!1),[y,x]=j.useState(null),[b,N]=j.useState(""),[S,C]=j.useState(!1),[_,E]=j.useState(""),[D,T]=j.useState("");j.useEffect(()=>{A()},[]);const A=async()=>{o(!0),E("");try{const M=await Rk();a(M.conversations||[])}catch(M){E(M.message)}finally{o(!1)}},w=async M=>{u(M),g(!0),x(null),E("");try{const q=await Dk(M);m(q.messages||[])}catch(q){E(q.message)}finally{g(!1)}},O=async M=>{if(b.trim()){C(!0),E(""),T("");try{const q=await zk(c,M,b);T(`Correccion guardada: "${q.question?.slice(0,40)}..."  nueva respuesta aprobada`),x(null),N(""),setTimeout(()=>T(""),5e3),await w(c)}catch(q){E(q.message)}finally{C(!1)}}};return s?r.jsx("div",{className:"flex items-center justify-center py-20",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):c?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("button",{onClick:()=>{u(null),m([])},className:"flex items-center gap-2 text-sm text-gray-600 hover:text-indigo-600 font-medium transition",children:[r.jsx(rS,{className:"w-4 h-4"})," Volver a conversaciones"]}),_&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm",children:_}),D&&r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-green-700 text-sm flex items-center gap-2",children:[r.jsx(Et,{className:"w-4 h-4"})," ",D]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 text-sm",children:["Sesion #",c,"  ",d.length," mensajes"]}),p?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):r.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:d.map(M=>r.jsx("div",{className:`flex ${M.direction==="in"?"justify-start":"justify-end"}`,children:r.jsxs("div",{className:`max-w-[75%] rounded-2xl px-4 py-2.5 ${M.direction==="in"?"bg-gray-100 text-gray-800":M.is_ai_generated?"bg-purple-100 text-purple-900 border border-purple-200":"bg-indigo-600 text-white"}`,children:[M.direction==="out"&&M.is_ai_generated&&r.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wider opacity-70 block mb-1",children:"Bot IA"}),r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:M.text}),r.jsxs("div",{className:"flex items-center justify-between mt-1.5 gap-3",children:[r.jsx("span",{className:"text-[10px] opacity-60",children:new Date(M.created_at).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})}),M.direction==="out"&&M.is_ai_generated&&M.status!=="corrected"&&r.jsxs("button",{onClick:()=>{x(M.id),N("")},className:"text-[10px] font-semibold text-purple-700 hover:text-purple-900 flex items-center gap-0.5",children:[r.jsx(Db,{className:"w-3 h-3"})," Corregir"]}),M.status==="corrected"&&r.jsxs("span",{className:"text-[10px] font-semibold text-green-700 flex items-center gap-0.5",children:[r.jsx(Et,{className:"w-3 h-3"})," Corregido"]})]}),y===M.id&&r.jsxs("div",{className:"mt-3 pt-3 border-t border-purple-300",children:[r.jsx("label",{className:"block text-xs font-semibold text-purple-700 mb-1",children:"Respuesta correcta:"}),r.jsx("textarea",{value:b,onChange:q=>N(q.target.value),rows:3,className:"w-full px-3 py-2 border border-purple-300 rounded-lg text-sm text-gray-800 bg-white focus:ring-2 focus:ring-purple-500",placeholder:"Escribe la respuesta correcta que deberia dar el bot...",autoFocus:!0}),r.jsxs("div",{className:"flex gap-2 mt-2",children:[r.jsx("button",{onClick:()=>O(M.id),disabled:S||!b.trim(),className:"px-3 py-1.5 bg-purple-600 text-white rounded-lg text-xs font-medium disabled:opacity-50 hover:bg-purple-700",children:S?"Guardando...":"Guardar Correccion"}),r.jsx("button",{onClick:()=>x(null),className:"px-3 py-1.5 border border-purple-300 text-purple-700 rounded-lg text-xs hover:bg-purple-50",children:"Cancelar"})]})]})]})},M.id))})]})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-8 text-white",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center",children:r.jsx(qt,{className:"w-8 h-8"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Conversaciones del Bot"}),r.jsx("p",{className:"text-purple-200 text-sm mt-1",children:"Revisa y corrige las respuestas automaticas de la IA"})]})]})}),_&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm",children:_}),t.length===0?r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-12 text-center",children:[r.jsx(qt,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-400",children:"Aun no hay conversaciones donde el bot haya respondido"}),r.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Cuando la IA responda mensajes, apareceran aqui"})]}):r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Sesion"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Telefono"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Msgs IA"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Total"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Ultimo mensaje"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Fecha"}),r.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(M=>r.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>w(M.sessionId),children:[r.jsxs("td",{className:"px-4 py-3 text-sm font-medium text-gray-800",children:["#",M.sessionId]}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 font-mono",children:M.phone}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-purple-50 text-purple-700",children:[r.jsx(Ln,{className:"w-3 h-3"})," ",M.ai_message_count]})}),r.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-500",children:M.total_messages}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-[200px] truncate",children:M.last_message}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:M.last_message_at?si(new Date(M.last_message_at),{addSuffix:!0,locale:os}):"-"}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(tm,{className:"w-4 h-4 text-gray-400"})})]},M.sessionId))})]})})]})}function l7(){const[t,a]=j.useState("brain"),[s,o]=j.useState(null);return j.useEffect(()=>{wk().then(c=>o(c.stats)).catch(c=>console.error("Error loading learning stats:",c))},[]),r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Cerebro IA - Aprendizaje"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Sistema de conocimiento adquirido por la IA"})]}),r.jsx("div",{className:"flex gap-1 mb-6 bg-gray-100 rounded-xl p-1 w-fit",children:Kk.map(c=>{const u=c.icon;return r.jsxs("button",{onClick:()=>a(c.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition ${t===c.id?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[r.jsx(u,{className:"w-4 h-4"}),c.label]},c.id)})}),t==="brain"&&r.jsx(n7,{}),t==="instructions"&&r.jsx(i7,{}),t==="bot-conversations"&&r.jsx(o7,{}),t==="dashboard"&&r.jsx(a7,{stats:s}),t==="pairs"&&r.jsx(s7,{}),t==="prices"&&r.jsx(r7,{})]})}function c7({children:t}){return At(s=>s.isAuthenticated)?t:r.jsx($c,{to:"/login",replace:!0})}function pa({children:t}){return At(s=>s.agent)?.role!=="supervisor"?r.jsx($c,{to:"/dashboard",replace:!0}):t}function u7(){return r.jsxs(dN,{children:[r.jsx(_t,{path:"/login",element:r.jsx(A5,{})}),r.jsxs(_t,{path:"/",element:r.jsx(c7,{children:r.jsx(T5,{})}),children:[r.jsx(_t,{index:!0,element:r.jsx($c,{to:"/dashboard",replace:!0})}),r.jsx(_t,{path:"dashboard",element:r.jsx(N3,{})}),r.jsx(_t,{path:"conversations",element:r.jsx(__,{})}),r.jsx(_t,{path:"agents",element:r.jsx(pa,{children:r.jsx(bk,{})})}),r.jsx(_t,{path:"departments",element:r.jsx(pa,{children:r.jsx(vk,{})})}),r.jsx(_t,{path:"flows",element:r.jsx(pa,{children:r.jsx(B_,{})})}),r.jsx(_t,{path:"flows/builder/:id?",element:r.jsx(pa,{children:r.jsx(tk,{})})}),r.jsx(_t,{path:"logs",element:r.jsx(pa,{children:r.jsx(rk,{})})}),r.jsx(_t,{path:"leads",element:r.jsx(pa,{children:r.jsx(dk,{})})}),r.jsx(_t,{path:"analytics",element:r.jsx(pa,{children:r.jsx(xk,{})})}),r.jsx(_t,{path:"monitor",element:r.jsx(pa,{children:r.jsx(yk,{})})}),r.jsx(_t,{path:"learning",element:r.jsx(pa,{children:r.jsx(l7,{})})})]}),r.jsx(_t,{path:"*",element:r.jsx($c,{to:"/dashboard",replace:!0})})]})}uj.createRoot(document.getElementById("root")).render(r.jsx(zr.StrictMode,{children:r.jsx(BN,{children:r.jsx(u7,{})})}));
