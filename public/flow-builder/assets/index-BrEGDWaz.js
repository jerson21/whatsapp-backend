(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(c){if(c.ep)return;c.ep=!0;const u=s(c);fetch(c.href,u)}})();function Vh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vf={exports:{}},eo={};var hx;function ej(){if(hx)return eo;hx=1;var t=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(o,c,u){var d=null;if(u!==void 0&&(d=""+u),c.key!==void 0&&(d=""+c.key),"key"in c){u={};for(var m in c)m!=="key"&&(u[m]=c[m])}else u=c;return c=u.ref,{$$typeof:t,type:o,key:d,ref:c!==void 0?c:null,props:u}}return eo.Fragment=a,eo.jsx=s,eo.jsxs=s,eo}var mx;function tj(){return mx||(mx=1,Vf.exports=ej()),Vf.exports}var r=tj(),Yf={exports:{}},je={};var px;function nj(){if(px)return je;px=1;var t=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),b=Symbol.iterator;function j(B){return B===null||typeof B!="object"?null:(B=b&&B[b]||B["@@iterator"],typeof B=="function"?B:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,_={};function E(B,P,ne){this.props=B,this.context=P,this.refs=_,this.updater=ne||S}E.prototype.isReactComponent={},E.prototype.setState=function(B,P){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,P,"setState")},E.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function R(){}R.prototype=E.prototype;function T(B,P,ne){this.props=B,this.context=P,this.refs=_,this.updater=ne||S}var A=T.prototype=new R;A.constructor=T,C(A,E.prototype),A.isPureReactComponent=!0;var w=Array.isArray;function D(){}var M={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function H(B,P,ne){var se=ne.ref;return{$$typeof:t,type:B,key:P,ref:se!==void 0?se:null,props:ne}}function Q(B,P){return H(B.type,P,B.props)}function I(B){return typeof B=="object"&&B!==null&&B.$$typeof===t}function Z(B){var P={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ne){return P[ne]})}var te=/\/+/g;function $(B,P){return typeof B=="object"&&B!==null&&B.key!=null?Z(""+B.key):P.toString(36)}function G(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(D,D):(B.status="pending",B.then(function(P){B.status==="pending"&&(B.status="fulfilled",B.value=P)},function(P){B.status==="pending"&&(B.status="rejected",B.reason=P)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function O(B,P,ne,se,re){var de=typeof B;(de==="undefined"||de==="boolean")&&(B=null);var ue=!1;if(B===null)ue=!0;else switch(de){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(B.$$typeof){case t:case a:ue=!0;break;case y:return ue=B._init,O(ue(B._payload),P,ne,se,re)}}if(ue)return re=re(B),ue=se===""?"."+$(B,0):se,w(re)?(ne="",ue!=null&&(ne=ue.replace(te,"$&/")+"/"),O(re,P,ne,"",function(he){return he})):re!=null&&(I(re)&&(re=Q(re,ne+(re.key==null||B&&B.key===re.key?"":(""+re.key).replace(te,"$&/")+"/")+ue)),P.push(re)),1;ue=0;var V=se===""?".":se+":";if(w(B))for(var ce=0;ce<B.length;ce++)se=B[ce],de=V+$(se,ce),ue+=O(se,P,ne,de,re);else if(ce=j(B),typeof ce=="function")for(B=ce.call(B),ce=0;!(se=B.next()).done;)se=se.value,de=V+$(se,ce++),ue+=O(se,P,ne,de,re);else if(de==="object"){if(typeof B.then=="function")return O(G(B),P,ne,se,re);throw P=String(B),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return ue}function z(B,P,ne){if(B==null)return B;var se=[],re=0;return O(B,se,"","",function(de){return P.call(ne,de,re++)}),se}function U(B){if(B._status===-1){var P=B._result;P=P(),P.then(function(ne){(B._status===0||B._status===-1)&&(B._status=1,B._result=ne)},function(ne){(B._status===0||B._status===-1)&&(B._status=2,B._result=ne)}),B._status===-1&&(B._status=0,B._result=P)}if(B._status===1)return B._result.default;throw B._result}var L=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},W={map:z,forEach:function(B,P,ne){z(B,function(){P.apply(this,arguments)},ne)},count:function(B){var P=0;return z(B,function(){P++}),P},toArray:function(B){return z(B,function(P){return P})||[]},only:function(B){if(!I(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return je.Activity=x,je.Children=W,je.Component=E,je.Fragment=s,je.Profiler=c,je.PureComponent=T,je.StrictMode=o,je.Suspense=p,je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,je.__COMPILER_RUNTIME={__proto__:null,c:function(B){return M.H.useMemoCache(B)}},je.cache=function(B){return function(){return B.apply(null,arguments)}},je.cacheSignal=function(){return null},je.cloneElement=function(B,P,ne){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var se=C({},B.props),re=B.key;if(P!=null)for(de in P.key!==void 0&&(re=""+P.key),P)!q.call(P,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&P.ref===void 0||(se[de]=P[de]);var de=arguments.length-2;if(de===1)se.children=ne;else if(1<de){for(var ue=Array(de),V=0;V<de;V++)ue[V]=arguments[V+2];se.children=ue}return H(B.type,re,se)},je.createContext=function(B){return B={$$typeof:d,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:u,_context:B},B},je.createElement=function(B,P,ne){var se,re={},de=null;if(P!=null)for(se in P.key!==void 0&&(de=""+P.key),P)q.call(P,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(re[se]=P[se]);var ue=arguments.length-2;if(ue===1)re.children=ne;else if(1<ue){for(var V=Array(ue),ce=0;ce<ue;ce++)V[ce]=arguments[ce+2];re.children=V}if(B&&B.defaultProps)for(se in ue=B.defaultProps,ue)re[se]===void 0&&(re[se]=ue[se]);return H(B,de,re)},je.createRef=function(){return{current:null}},je.forwardRef=function(B){return{$$typeof:m,render:B}},je.isValidElement=I,je.lazy=function(B){return{$$typeof:y,_payload:{_status:-1,_result:B},_init:U}},je.memo=function(B,P){return{$$typeof:g,type:B,compare:P===void 0?null:P}},je.startTransition=function(B){var P=M.T,ne={};M.T=ne;try{var se=B(),re=M.S;re!==null&&re(ne,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(D,L)}catch(de){L(de)}finally{P!==null&&ne.types!==null&&(P.types=ne.types),M.T=P}},je.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},je.use=function(B){return M.H.use(B)},je.useActionState=function(B,P,ne){return M.H.useActionState(B,P,ne)},je.useCallback=function(B,P){return M.H.useCallback(B,P)},je.useContext=function(B){return M.H.useContext(B)},je.useDebugValue=function(){},je.useDeferredValue=function(B,P){return M.H.useDeferredValue(B,P)},je.useEffect=function(B,P){return M.H.useEffect(B,P)},je.useEffectEvent=function(B){return M.H.useEffectEvent(B)},je.useId=function(){return M.H.useId()},je.useImperativeHandle=function(B,P,ne){return M.H.useImperativeHandle(B,P,ne)},je.useInsertionEffect=function(B,P){return M.H.useInsertionEffect(B,P)},je.useLayoutEffect=function(B,P){return M.H.useLayoutEffect(B,P)},je.useMemo=function(B,P){return M.H.useMemo(B,P)},je.useOptimistic=function(B,P){return M.H.useOptimistic(B,P)},je.useReducer=function(B,P,ne){return M.H.useReducer(B,P,ne)},je.useRef=function(B){return M.H.useRef(B)},je.useState=function(B){return M.H.useState(B)},je.useSyncExternalStore=function(B,P,ne){return M.H.useSyncExternalStore(B,P,ne)},je.useTransition=function(){return M.H.useTransition()},je.version="19.2.3",je}var gx;function _o(){return gx||(gx=1,Yf.exports=nj()),Yf.exports}var N=_o();const zr=Vh(N);var Pf={exports:{}},to={},If={exports:{}},Xf={};var xx;function aj(){return xx||(xx=1,(function(t){function a(O,z){var U=O.length;O.push(z);e:for(;0<U;){var L=U-1>>>1,W=O[L];if(0<c(W,z))O[L]=z,O[U]=W,U=L;else break e}}function s(O){return O.length===0?null:O[0]}function o(O){if(O.length===0)return null;var z=O[0],U=O.pop();if(U!==z){O[0]=U;e:for(var L=0,W=O.length,B=W>>>1;L<B;){var P=2*(L+1)-1,ne=O[P],se=P+1,re=O[se];if(0>c(ne,U))se<W&&0>c(re,ne)?(O[L]=re,O[se]=U,L=se):(O[L]=ne,O[P]=U,L=P);else if(se<W&&0>c(re,U))O[L]=re,O[se]=U,L=se;else break e}}return z}function c(O,z){var U=O.sortIndex-z.sortIndex;return U!==0?U:O.id-z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;t.unstable_now=function(){return u.now()}}else{var d=Date,m=d.now();t.unstable_now=function(){return d.now()-m}}var p=[],g=[],y=1,x=null,b=3,j=!1,S=!1,C=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function A(O){for(var z=s(g);z!==null;){if(z.callback===null)o(g);else if(z.startTime<=O)o(g),z.sortIndex=z.expirationTime,a(p,z);else break;z=s(g)}}function w(O){if(C=!1,A(O),!S)if(s(p)!==null)S=!0,D||(D=!0,Z());else{var z=s(g);z!==null&&G(w,z.startTime-O)}}var D=!1,M=-1,q=5,H=-1;function Q(){return _?!0:!(t.unstable_now()-H<q)}function I(){if(_=!1,D){var O=t.unstable_now();H=O;var z=!0;try{e:{S=!1,C&&(C=!1,R(M),M=-1),j=!0;var U=b;try{t:{for(A(O),x=s(p);x!==null&&!(x.expirationTime>O&&Q());){var L=x.callback;if(typeof L=="function"){x.callback=null,b=x.priorityLevel;var W=L(x.expirationTime<=O);if(O=t.unstable_now(),typeof W=="function"){x.callback=W,A(O),z=!0;break t}x===s(p)&&o(p),A(O)}else o(p);x=s(p)}if(x!==null)z=!0;else{var B=s(g);B!==null&&G(w,B.startTime-O),z=!1}}break e}finally{x=null,b=U,j=!1}z=void 0}}finally{z?Z():D=!1}}}var Z;if(typeof T=="function")Z=function(){T(I)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,$=te.port2;te.port1.onmessage=I,Z=function(){$.postMessage(null)}}else Z=function(){E(I,0)};function G(O,z){M=E(function(){O(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(O){switch(b){case 1:case 2:case 3:var z=3;break;default:z=b}var U=b;b=z;try{return O()}finally{b=U}},t.unstable_requestPaint=function(){_=!0},t.unstable_runWithPriority=function(O,z){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var U=b;b=O;try{return z()}finally{b=U}},t.unstable_scheduleCallback=function(O,z,U){var L=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?L+U:L):U=L,O){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=U+W,O={id:y++,callback:z,priorityLevel:O,startTime:U,expirationTime:W,sortIndex:-1},U>L?(O.sortIndex=U,a(g,O),s(p)===null&&O===s(g)&&(C?(R(M),M=-1):C=!0,G(w,U-L))):(O.sortIndex=W,a(p,O),S||j||(S=!0,D||(D=!0,Z()))),O},t.unstable_shouldYield=Q,t.unstable_wrapCallback=function(O){var z=b;return function(){var U=b;b=z;try{return O.apply(this,arguments)}finally{b=U}}}})(Xf)),Xf}var yx;function sj(){return yx||(yx=1,If.exports=aj()),If.exports}var Gf={exports:{}},St={};var bx;function rj(){if(bx)return St;bx=1;var t=_o();function a(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)g+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var o={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},c=Symbol.for("react.portal");function u(p,g,y){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:x==null?null:""+x,children:p,containerInfo:g,implementation:y}}var d=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return St.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,St.createPortal=function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(a(299));return u(p,g,null,y)},St.flushSync=function(p){var g=d.T,y=o.p;try{if(d.T=null,o.p=2,p)return p()}finally{d.T=g,o.p=y,o.d.f()}},St.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,o.d.C(p,g))},St.prefetchDNS=function(p){typeof p=="string"&&o.d.D(p)},St.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var y=g.as,x=m(y,g.crossOrigin),b=typeof g.integrity=="string"?g.integrity:void 0,j=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;y==="style"?o.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:b,fetchPriority:j}):y==="script"&&o.d.X(p,{crossOrigin:x,integrity:b,fetchPriority:j,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},St.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var y=m(g.as,g.crossOrigin);o.d.M(p,{crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&o.d.M(p)},St.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var y=g.as,x=m(y,g.crossOrigin);o.d.L(p,y,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},St.preloadModule=function(p,g){if(typeof p=="string")if(g){var y=m(g.as,g.crossOrigin);o.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else o.d.m(p)},St.requestFormReset=function(p){o.d.r(p)},St.unstable_batchedUpdates=function(p,g){return p(g)},St.useFormState=function(p,g,y){return d.H.useFormState(p,g,y)},St.useFormStatus=function(){return d.H.useHostTransitionStatus()},St.version="19.2.3",St}var vx;function cb(){if(vx)return Gf.exports;vx=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(a){console.error(a)}}return t(),Gf.exports=rj(),Gf.exports}var wx;function ij(){if(wx)return to;wx=1;var t=sj(),a=_o(),s=cb();function o(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function d(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function m(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function p(e){if(u(e)!==e)throw Error(o(188))}function g(e){var n=e.alternate;if(!n){if(n=u(e),n===null)throw Error(o(188));return n!==e?null:e}for(var i=e,l=n;;){var f=i.return;if(f===null)break;var h=f.alternate;if(h===null){if(l=f.return,l!==null){i=l;continue}break}if(f.child===h.child){for(h=f.child;h;){if(h===i)return p(f),e;if(h===l)return p(f),n;h=h.sibling}throw Error(o(188))}if(i.return!==l.return)i=f,l=h;else{for(var v=!1,k=f.child;k;){if(k===i){v=!0,i=f,l=h;break}if(k===l){v=!0,l=f,i=h;break}k=k.sibling}if(!v){for(k=h.child;k;){if(k===i){v=!0,i=h,l=f;break}if(k===l){v=!0,l=h,i=f;break}k=k.sibling}if(!v)throw Error(o(189))}}if(i.alternate!==l)throw Error(o(190))}if(i.tag!==3)throw Error(o(188));return i.stateNode.current===i?e:n}function y(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=y(e),n!==null)return n;e=e.sibling}return null}var x=Object.assign,b=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),T=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function Z(e){return e===null||typeof e!="object"?null:(e=I&&e[I]||e["@@iterator"],typeof e=="function"?e:null)}var te=Symbol.for("react.client.reference");function $(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===te?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case C:return"Fragment";case E:return"Profiler";case _:return"StrictMode";case w:return"Suspense";case D:return"SuspenseList";case H:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case S:return"Portal";case T:return e.displayName||"Context";case R:return(e._context.displayName||"Context")+".Consumer";case A:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case M:return n=e.displayName||null,n!==null?n:$(e.type)||"Memo";case q:n=e._payload,e=e._init;try{return $(e(n))}catch{}}return null}var G=Array.isArray,O=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},L=[],W=-1;function B(e){return{current:e}}function P(e){0>W||(e.current=L[W],L[W]=null,W--)}function ne(e,n){W++,L[W]=e.current,e.current=n}var se=B(null),re=B(null),de=B(null),ue=B(null);function V(e,n){switch(ne(de,n),ne(re,e),ne(se,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Bg(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Bg(n),e=Lg(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}P(se),ne(se,e)}function ce(){P(se),P(re),P(de)}function he(e){e.memoizedState!==null&&ne(ue,e);var n=se.current,i=Lg(n,e.type);n!==i&&(ne(re,e),ne(se,i))}function ve(e){re.current===e&&(P(se),P(re)),ue.current===e&&(P(ue),Zi._currentValue=U)}var ge,be;function Se(e){if(ge===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);ge=n&&n[1]||"",be=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ge+e+be}var Ae=!1;function Ee(e,n){if(!e||Ae)return"";Ae=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(n){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(ae){var ee=ae}Reflect.construct(e,[],le)}else{try{le.call()}catch(ae){ee=ae}e.call(le.prototype)}}else{try{throw Error()}catch(ae){ee=ae}(le=e())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(ae){if(ae&&ee&&typeof ae.stack=="string")return[ae.stack,ee.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=l.DetermineComponentFrameRoot(),v=h[0],k=h[1];if(v&&k){var Y=v.split(`
`),J=k.split(`
`);for(f=l=0;l<Y.length&&!Y[l].includes("DetermineComponentFrameRoot");)l++;for(;f<J.length&&!J[f].includes("DetermineComponentFrameRoot");)f++;if(l===Y.length||f===J.length)for(l=Y.length-1,f=J.length-1;1<=l&&0<=f&&Y[l]!==J[f];)f--;for(;1<=l&&0<=f;l--,f--)if(Y[l]!==J[f]){if(l!==1||f!==1)do if(l--,f--,0>f||Y[l]!==J[f]){var ie=`
`+Y[l].replace(" at new "," at ");return e.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",e.displayName)),ie}while(1<=l&&0<=f);break}}}finally{Ae=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?Se(i):""}function $e(e,n){switch(e.tag){case 26:case 27:case 5:return Se(e.type);case 16:return Se("Lazy");case 13:return e.child!==n&&n!==null?Se("Suspense Fallback"):Se("Suspense");case 19:return Se("SuspenseList");case 0:case 15:return Ee(e.type,!1);case 11:return Ee(e.type.render,!1);case 1:return Ee(e.type,!0);case 31:return Se("Activity");default:return""}}function ze(e){try{var n="",i=null;do n+=$e(e,i),i=e,e=e.return;while(e);return n}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var yt=Object.prototype.hasOwnProperty,pt=t.unstable_scheduleCallback,hn=t.unstable_cancelCallback,En=t.unstable_shouldYield,Cn=t.unstable_requestPaint,at=t.unstable_now,Pn=t.unstable_getCurrentPriorityLevel,mn=t.unstable_ImmediatePriority,Jt=t.unstable_UserBlockingPriority,In=t.unstable_NormalPriority,pn=t.unstable_LowPriority,Xn=t.unstable_IdlePriority,ls=t.log,ii=t.unstable_setDisableYieldValue,cs=null,Ct=null;function Tn(e){if(typeof ls=="function"&&ii(e),Ct&&typeof Ct.setStrictMode=="function")try{Ct.setStrictMode(cs,e)}catch{}}var Tt=Math.clz32?Math.clz32:Mu,Cu=Math.log,Tu=Math.LN2;function Mu(e){return e>>>=0,e===0?32:31-(Cu(e)/Tu|0)|0}var Ps=256,Is=262144,Xs=4194304;function Gn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Gs(e,n,i){var l=e.pendingLanes;if(l===0)return 0;var f=0,h=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var k=l&134217727;return k!==0?(l=k&~h,l!==0?f=Gn(l):(v&=k,v!==0?f=Gn(v):i||(i=k&~e,i!==0&&(f=Gn(i))))):(k=l&~h,k!==0?f=Gn(k):v!==0?f=Gn(v):i||(i=l&~e,i!==0&&(f=Gn(i)))),f===0?0:n!==0&&n!==f&&(n&h)===0&&(h=f&-f,i=n&-n,h>=i||h===32&&(i&4194048)!==0)?n:f}function us(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function Au(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uo(){var e=Xs;return Xs<<=1,(Xs&62914560)===0&&(Xs=4194304),e}function oi(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function ds(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ku(e,n,i,l,f,h){var v=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var k=e.entanglements,Y=e.expirationTimes,J=e.hiddenUpdates;for(i=v&~i;0<i;){var ie=31-Tt(i),le=1<<ie;k[ie]=0,Y[ie]=-1;var ee=J[ie];if(ee!==null)for(J[ie]=null,ie=0;ie<ee.length;ie++){var ae=ee[ie];ae!==null&&(ae.lane&=-536870913)}i&=~le}l!==0&&Vo(e,l,0),h!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=h&~(v&~n))}function Vo(e,n,i){e.pendingLanes|=n,e.suspendedLanes&=~n;var l=31-Tt(n);e.entangledLanes|=n,e.entanglements[l]=e.entanglements[l]|1073741824|i&261930}function Yo(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var l=31-Tt(i),f=1<<l;f&n|e[l]&n&&(e[l]|=n),i&=~f}}function Po(e,n){var i=n&-n;return i=(i&42)!==0?1:li(i),(i&(e.suspendedLanes|n))!==0?0:i}function li(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ci(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Io(){var e=z.p;return e!==0?e:(e=window.event,e===void 0?32:ix(e.type))}function Xo(e,n){var i=z.p;try{return z.p=e,n()}finally{z.p=i}}var Mn=Math.random().toString(36).slice(2),dt="__reactFiber$"+Mn,Nt="__reactProps$"+Mn,Qn="__reactContainer$"+Mn,Qs="__reactEvents$"+Mn,Go="__reactListeners$"+Mn,Ru="__reactHandles$"+Mn,Qo="__reactResources$"+Mn,fs="__reactMarker$"+Mn;function ui(e){delete e[dt],delete e[Nt],delete e[Qs],delete e[Go],delete e[Ru]}function Sa(e){var n=e[dt];if(n)return n;for(var i=e.parentNode;i;){if(n=i[Qn]||i[dt]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=Pg(e);e!==null;){if(i=e[dt])return i;e=Pg(e)}return n}e=i,i=e.parentNode}return null}function _a(e){if(e=e[dt]||e[Qn]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Ea(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(o(33))}function Ca(e){var n=e[Qo];return n||(n=e[Qo]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function st(e){e[fs]=!0}var Fo=new Set,Zo={};function Fn(e,n){Ta(e,n),Ta(e+"Capture",n)}function Ta(e,n){for(Zo[e]=n,e=0;e<n.length;e++)Fo.add(n[e])}var zu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),di={},Wo={};function Du(e){return yt.call(Wo,e)?!0:yt.call(di,e)?!1:zu.test(e)?Wo[e]=!0:(di[e]=!0,!1)}function Fs(e,n,i){if(Du(n))if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var l=n.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+i)}}function Zs(e,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+i)}}function gn(e,n,i,l){if(l===null)e.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(n,i,""+l)}}function kt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ko(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Ou(e,n,i){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,h=l.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return f.call(this)},set:function(v){i=""+v,h.call(this,v)}}),Object.defineProperty(e,n,{enumerable:l.enumerable}),{getValue:function(){return i},setValue:function(v){i=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Ws(e){if(!e._valueTracker){var n=Ko(e)?"checked":"value";e._valueTracker=Ou(e,n,""+e[n])}}function Jo(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),l="";return e&&(l=Ko(e)?e.checked?"true":"false":e.value),e=l,e!==i?(n.setValue(e),!0):!1}function hs(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Bu=/[\n"\\]/g;function Rt(e){return e.replace(Bu,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function ms(e,n,i,l,f,h,v,k){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+kt(n)):e.value!==""+kt(n)&&(e.value=""+kt(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?fi(e,v,kt(n)):i!=null?fi(e,v,kt(i)):l!=null&&e.removeAttribute("value"),f==null&&h!=null&&(e.defaultChecked=!!h),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?e.name=""+kt(k):e.removeAttribute("name")}function el(e,n,i,l,f,h,v,k){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),n!=null||i!=null){if(!(h!=="submit"&&h!=="reset"||n!=null)){Ws(e);return}i=i!=null?""+kt(i):"",n=n!=null?""+kt(n):i,k||n===e.value||(e.value=n),e.defaultValue=n}l=l??f,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=k?e.checked:!!l,e.defaultChecked=!!l,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),Ws(e)}function fi(e,n,i){n==="number"&&hs(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function Zn(e,n,i,l){if(e=e.options,n){n={};for(var f=0;f<i.length;f++)n["$"+i[f]]=!0;for(i=0;i<e.length;i++)f=n.hasOwnProperty("$"+e[i].value),e[i].selected!==f&&(e[i].selected=f),f&&l&&(e[i].defaultSelected=!0)}else{for(i=""+kt(i),n=null,f=0;f<e.length;f++){if(e[f].value===i){e[f].selected=!0,l&&(e[f].defaultSelected=!0);return}n!==null||e[f].disabled||(n=e[f])}n!==null&&(n.selected=!0)}}function km(e,n,i){if(n!=null&&(n=""+kt(n),n!==e.value&&(e.value=n),i==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=i!=null?""+kt(i):""}function Rm(e,n,i,l){if(n==null){if(l!=null){if(i!=null)throw Error(o(92));if(G(l)){if(1<l.length)throw Error(o(93));l=l[0]}i=l}i==null&&(i=""),n=i}i=kt(n),e.defaultValue=i,l=e.textContent,l===i&&l!==""&&l!==null&&(e.value=l),Ws(e)}function Ks(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var Fv=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zm(e,n,i){var l=n.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?l?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":l?e.setProperty(n,i):typeof i!="number"||i===0||Fv.has(n)?n==="float"?e.cssFloat=i:e[n]=(""+i).trim():e[n]=i+"px"}function Dm(e,n,i){if(n!=null&&typeof n!="object")throw Error(o(62));if(e=e.style,i!=null){for(var l in i)!i.hasOwnProperty(l)||n!=null&&n.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var f in n)l=n[f],n.hasOwnProperty(f)&&i[f]!==l&&zm(e,f,l)}else for(var h in n)n.hasOwnProperty(h)&&zm(e,h,n[h])}function Lu(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zv=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Wv=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function tl(e){return Wv.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Wn(){}var Hu=null;function $u(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Js=null,er=null;function Om(e){var n=_a(e);if(n&&(e=n.stateNode)){var i=e[Nt]||null;e:switch(e=n.stateNode,n.type){case"input":if(ms(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+Rt(""+n)+'"][type="radio"]'),n=0;n<i.length;n++){var l=i[n];if(l!==e&&l.form===e.form){var f=l[Nt]||null;if(!f)throw Error(o(90));ms(l,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<i.length;n++)l=i[n],l.form===e.form&&Jo(l)}break e;case"textarea":km(e,i.value,i.defaultValue);break e;case"select":n=i.value,n!=null&&Zn(e,!!i.multiple,n,!1)}}}var qu=!1;function Bm(e,n,i){if(qu)return e(n,i);qu=!0;try{var l=e(n);return l}finally{if(qu=!1,(Js!==null||er!==null)&&(Vl(),Js&&(n=Js,e=er,er=Js=null,Om(n),e)))for(n=0;n<e.length;n++)Om(e[n])}}function hi(e,n){var i=e.stateNode;if(i===null)return null;var l=i[Nt]||null;if(l===null)return null;i=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(o(231,n,typeof i));return i}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uu=!1;if(Kn)try{var mi={};Object.defineProperty(mi,"passive",{get:function(){Uu=!0}}),window.addEventListener("test",mi,mi),window.removeEventListener("test",mi,mi)}catch{Uu=!1}var Ma=null,Vu=null,nl=null;function Lm(){if(nl)return nl;var e,n=Vu,i=n.length,l,f="value"in Ma?Ma.value:Ma.textContent,h=f.length;for(e=0;e<i&&n[e]===f[e];e++);var v=i-e;for(l=1;l<=v&&n[i-l]===f[h-l];l++);return nl=f.slice(e,1<l?1-l:void 0)}function al(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function sl(){return!0}function Hm(){return!1}function zt(e){function n(i,l,f,h,v){this._reactName=i,this._targetInst=f,this.type=l,this.nativeEvent=h,this.target=v,this.currentTarget=null;for(var k in e)e.hasOwnProperty(k)&&(i=e[k],this[k]=i?i(h):h[k]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?sl:Hm,this.isPropagationStopped=Hm,this}return x(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=sl)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=sl)},persist:function(){},isPersistent:sl}),n}var ps={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rl=zt(ps),pi=x({},ps,{view:0,detail:0}),Kv=zt(pi),Yu,Pu,gi,il=x({},pi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gi&&(gi&&e.type==="mousemove"?(Yu=e.screenX-gi.screenX,Pu=e.screenY-gi.screenY):Pu=Yu=0,gi=e),Yu)},movementY:function(e){return"movementY"in e?e.movementY:Pu}}),$m=zt(il),Jv=x({},il,{dataTransfer:0}),e2=zt(Jv),t2=x({},pi,{relatedTarget:0}),Iu=zt(t2),n2=x({},ps,{animationName:0,elapsedTime:0,pseudoElement:0}),a2=zt(n2),s2=x({},ps,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),r2=zt(s2),i2=x({},ps,{data:0}),qm=zt(i2),o2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},c2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u2(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=c2[e])?!!n[e]:!1}function Xu(){return u2}var d2=x({},pi,{key:function(e){if(e.key){var n=o2[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=al(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?l2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xu,charCode:function(e){return e.type==="keypress"?al(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?al(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),f2=zt(d2),h2=x({},il,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Um=zt(h2),m2=x({},pi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xu}),p2=zt(m2),g2=x({},ps,{propertyName:0,elapsedTime:0,pseudoElement:0}),x2=zt(g2),y2=x({},il,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),b2=zt(y2),v2=x({},ps,{newState:0,oldState:0}),w2=zt(v2),j2=[9,13,27,32],Gu=Kn&&"CompositionEvent"in window,xi=null;Kn&&"documentMode"in document&&(xi=document.documentMode);var N2=Kn&&"TextEvent"in window&&!xi,Vm=Kn&&(!Gu||xi&&8<xi&&11>=xi),Ym=" ",Pm=!1;function Im(e,n){switch(e){case"keyup":return j2.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var tr=!1;function S2(e,n){switch(e){case"compositionend":return Xm(n);case"keypress":return n.which!==32?null:(Pm=!0,Ym);case"textInput":return e=n.data,e===Ym&&Pm?null:e;default:return null}}function _2(e,n){if(tr)return e==="compositionend"||!Gu&&Im(e,n)?(e=Lm(),nl=Vu=Ma=null,tr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Vm&&n.locale!=="ko"?null:n.data;default:return null}}var E2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gm(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!E2[e.type]:n==="textarea"}function Qm(e,n,i,l){Js?er?er.push(l):er=[l]:Js=l,n=Fl(n,"onChange"),0<n.length&&(i=new rl("onChange","change",null,i,l),e.push({event:i,listeners:n}))}var yi=null,bi=null;function C2(e){Ag(e,0)}function ol(e){var n=Ea(e);if(Jo(n))return e}function Fm(e,n){if(e==="change")return n}var Zm=!1;if(Kn){var Qu;if(Kn){var Fu="oninput"in document;if(!Fu){var Wm=document.createElement("div");Wm.setAttribute("oninput","return;"),Fu=typeof Wm.oninput=="function"}Qu=Fu}else Qu=!1;Zm=Qu&&(!document.documentMode||9<document.documentMode)}function Km(){yi&&(yi.detachEvent("onpropertychange",Jm),bi=yi=null)}function Jm(e){if(e.propertyName==="value"&&ol(bi)){var n=[];Qm(n,bi,e,$u(e)),Bm(C2,n)}}function T2(e,n,i){e==="focusin"?(Km(),yi=n,bi=i,yi.attachEvent("onpropertychange",Jm)):e==="focusout"&&Km()}function M2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ol(bi)}function A2(e,n){if(e==="click")return ol(n)}function k2(e,n){if(e==="input"||e==="change")return ol(n)}function R2(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Ut=typeof Object.is=="function"?Object.is:R2;function vi(e,n){if(Ut(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),l=Object.keys(n);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var f=i[l];if(!yt.call(n,f)||!Ut(e[f],n[f]))return!1}return!0}function ep(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tp(e,n){var i=ep(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=n&&l>=n)return{node:i,offset:n-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ep(i)}}function np(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?np(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function ap(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=hs(e.document);n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=hs(e.document)}return n}function Zu(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var z2=Kn&&"documentMode"in document&&11>=document.documentMode,nr=null,Wu=null,wi=null,Ku=!1;function sp(e,n,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Ku||nr==null||nr!==hs(l)||(l=nr,"selectionStart"in l&&Zu(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),wi&&vi(wi,l)||(wi=l,l=Fl(Wu,"onSelect"),0<l.length&&(n=new rl("onSelect","select",null,n,i),e.push({event:n,listeners:l}),n.target=nr)))}function gs(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var ar={animationend:gs("Animation","AnimationEnd"),animationiteration:gs("Animation","AnimationIteration"),animationstart:gs("Animation","AnimationStart"),transitionrun:gs("Transition","TransitionRun"),transitionstart:gs("Transition","TransitionStart"),transitioncancel:gs("Transition","TransitionCancel"),transitionend:gs("Transition","TransitionEnd")},Ju={},rp={};Kn&&(rp=document.createElement("div").style,"AnimationEvent"in window||(delete ar.animationend.animation,delete ar.animationiteration.animation,delete ar.animationstart.animation),"TransitionEvent"in window||delete ar.transitionend.transition);function xs(e){if(Ju[e])return Ju[e];if(!ar[e])return e;var n=ar[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in rp)return Ju[e]=n[i];return e}var ip=xs("animationend"),op=xs("animationiteration"),lp=xs("animationstart"),D2=xs("transitionrun"),O2=xs("transitionstart"),B2=xs("transitioncancel"),cp=xs("transitionend"),up=new Map,ed="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ed.push("scrollEnd");function xn(e,n){up.set(e,n),Fn(n,[e])}var ll=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},en=[],sr=0,td=0;function cl(){for(var e=sr,n=td=sr=0;n<e;){var i=en[n];en[n++]=null;var l=en[n];en[n++]=null;var f=en[n];en[n++]=null;var h=en[n];if(en[n++]=null,l!==null&&f!==null){var v=l.pending;v===null?f.next=f:(f.next=v.next,v.next=f),l.pending=f}h!==0&&dp(i,f,h)}}function ul(e,n,i,l){en[sr++]=e,en[sr++]=n,en[sr++]=i,en[sr++]=l,td|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function nd(e,n,i,l){return ul(e,n,i,l),dl(e)}function ys(e,n){return ul(e,null,null,n),dl(e)}function dp(e,n,i){e.lanes|=i;var l=e.alternate;l!==null&&(l.lanes|=i);for(var f=!1,h=e.return;h!==null;)h.childLanes|=i,l=h.alternate,l!==null&&(l.childLanes|=i),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(f=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,f&&n!==null&&(f=31-Tt(i),e=h.hiddenUpdates,l=e[f],l===null?e[f]=[n]:l.push(n),n.lane=i|536870912),h):null}function dl(e){if(50<Yi)throw Yi=0,ff=null,Error(o(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var rr={};function L2(e,n,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vt(e,n,i,l){return new L2(e,n,i,l)}function ad(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Jn(e,n){var i=e.alternate;return i===null?(i=Vt(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function fp(e,n){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,n=i.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function fl(e,n,i,l,f,h){var v=0;if(l=e,typeof e=="function")ad(e)&&(v=1);else if(typeof e=="string")v=Vw(e,i,se.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case H:return e=Vt(31,i,n,f),e.elementType=H,e.lanes=h,e;case C:return bs(i.children,f,h,n);case _:v=8,f|=24;break;case E:return e=Vt(12,i,n,f|2),e.elementType=E,e.lanes=h,e;case w:return e=Vt(13,i,n,f),e.elementType=w,e.lanes=h,e;case D:return e=Vt(19,i,n,f),e.elementType=D,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case T:v=10;break e;case R:v=9;break e;case A:v=11;break e;case M:v=14;break e;case q:v=16,l=null;break e}v=29,i=Error(o(130,e===null?"null":typeof e,"")),l=null}return n=Vt(v,i,n,f),n.elementType=e,n.type=l,n.lanes=h,n}function bs(e,n,i,l){return e=Vt(7,e,l,n),e.lanes=i,e}function sd(e,n,i){return e=Vt(6,e,null,n),e.lanes=i,e}function hp(e){var n=Vt(18,null,null,0);return n.stateNode=e,n}function rd(e,n,i){return n=Vt(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var mp=new WeakMap;function tn(e,n){if(typeof e=="object"&&e!==null){var i=mp.get(e);return i!==void 0?i:(n={value:e,source:n,stack:ze(n)},mp.set(e,n),n)}return{value:e,source:n,stack:ze(n)}}var ir=[],or=0,hl=null,ji=0,nn=[],an=0,Aa=null,An=1,kn="";function ea(e,n){ir[or++]=ji,ir[or++]=hl,hl=e,ji=n}function pp(e,n,i){nn[an++]=An,nn[an++]=kn,nn[an++]=Aa,Aa=e;var l=An;e=kn;var f=32-Tt(l)-1;l&=~(1<<f),i+=1;var h=32-Tt(n)+f;if(30<h){var v=f-f%5;h=(l&(1<<v)-1).toString(32),l>>=v,f-=v,An=1<<32-Tt(n)+f|i<<f|l,kn=h+e}else An=1<<h|i<<f|l,kn=e}function id(e){e.return!==null&&(ea(e,1),pp(e,1,0))}function od(e){for(;e===hl;)hl=ir[--or],ir[or]=null,ji=ir[--or],ir[or]=null;for(;e===Aa;)Aa=nn[--an],nn[an]=null,kn=nn[--an],nn[an]=null,An=nn[--an],nn[an]=null}function gp(e,n){nn[an++]=An,nn[an++]=kn,nn[an++]=Aa,An=n.id,kn=n.overflow,Aa=e}var bt=null,Ge=null,De=!1,ka=null,sn=!1,ld=Error(o(519));function Ra(e){var n=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ni(tn(n,e)),ld}function xp(e){var n=e.stateNode,i=e.type,l=e.memoizedProps;switch(n[dt]=e,n[Nt]=l,i){case"dialog":Me("cancel",n),Me("close",n);break;case"iframe":case"object":case"embed":Me("load",n);break;case"video":case"audio":for(i=0;i<Ii.length;i++)Me(Ii[i],n);break;case"source":Me("error",n);break;case"img":case"image":case"link":Me("error",n),Me("load",n);break;case"details":Me("toggle",n);break;case"input":Me("invalid",n),el(n,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Me("invalid",n);break;case"textarea":Me("invalid",n),Rm(n,l.value,l.defaultValue,l.children)}i=l.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||n.textContent===""+i||l.suppressHydrationWarning===!0||Dg(n.textContent,i)?(l.popover!=null&&(Me("beforetoggle",n),Me("toggle",n)),l.onScroll!=null&&Me("scroll",n),l.onScrollEnd!=null&&Me("scrollend",n),l.onClick!=null&&(n.onclick=Wn),n=!0):n=!1,n||Ra(e,!0)}function yp(e){for(bt=e.return;bt;)switch(bt.tag){case 5:case 31:case 13:sn=!1;return;case 27:case 3:sn=!0;return;default:bt=bt.return}}function lr(e){if(e!==bt)return!1;if(!De)return yp(e),De=!0,!1;var n=e.tag,i;if((i=n!==3&&n!==27)&&((i=n===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||Cf(e.type,e.memoizedProps)),i=!i),i&&Ge&&Ra(e),yp(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Ge=Yg(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));Ge=Yg(e)}else n===27?(n=Ge,Xa(e.type)?(e=Rf,Rf=null,Ge=e):Ge=n):Ge=bt?on(e.stateNode.nextSibling):null;return!0}function vs(){Ge=bt=null,De=!1}function cd(){var e=ka;return e!==null&&(Lt===null?Lt=e:Lt.push.apply(Lt,e),ka=null),e}function Ni(e){ka===null?ka=[e]:ka.push(e)}var ud=B(null),ws=null,ta=null;function za(e,n,i){ne(ud,n._currentValue),n._currentValue=i}function na(e){e._currentValue=ud.current,P(ud)}function dd(e,n,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===i)break;e=e.return}}function fd(e,n,i,l){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var h=f.dependencies;if(h!==null){var v=f.child;h=h.firstContext;e:for(;h!==null;){var k=h;h=f;for(var Y=0;Y<n.length;Y++)if(k.context===n[Y]){h.lanes|=i,k=h.alternate,k!==null&&(k.lanes|=i),dd(h.return,i,e),l||(v=null);break e}h=k.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(o(341));v.lanes|=i,h=v.alternate,h!==null&&(h.lanes|=i),dd(v,i,e),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===e){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function cr(e,n,i,l){e=null;for(var f=n,h=!1;f!==null;){if(!h){if((f.flags&524288)!==0)h=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(o(387));if(v=v.memoizedProps,v!==null){var k=f.type;Ut(f.pendingProps.value,v.value)||(e!==null?e.push(k):e=[k])}}else if(f===ue.current){if(v=f.alternate,v===null)throw Error(o(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(Zi):e=[Zi])}f=f.return}e!==null&&fd(n,e,i,l),n.flags|=262144}function ml(e){for(e=e.firstContext;e!==null;){if(!Ut(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function js(e){ws=e,ta=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function vt(e){return bp(ws,e)}function pl(e,n){return ws===null&&js(e),bp(e,n)}function bp(e,n){var i=n._currentValue;if(n={context:n,memoizedValue:i,next:null},ta===null){if(e===null)throw Error(o(308));ta=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else ta=ta.next=n;return i}var H2=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(i,l){e.push(l)}};this.abort=function(){n.aborted=!0,e.forEach(function(i){return i()})}},$2=t.unstable_scheduleCallback,q2=t.unstable_NormalPriority,rt={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hd(){return{controller:new H2,data:new Map,refCount:0}}function Si(e){e.refCount--,e.refCount===0&&$2(q2,function(){e.controller.abort()})}var _i=null,md=0,ur=0,dr=null;function U2(e,n){if(_i===null){var i=_i=[];md=0,ur=yf(),dr={status:"pending",value:void 0,then:function(l){i.push(l)}}}return md++,n.then(vp,vp),n}function vp(){if(--md===0&&_i!==null){dr!==null&&(dr.status="fulfilled");var e=_i;_i=null,ur=0,dr=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function V2(e,n){var i=[],l={status:"pending",value:null,reason:null,then:function(f){i.push(f)}};return e.then(function(){l.status="fulfilled",l.value=n;for(var f=0;f<i.length;f++)(0,i[f])(n)},function(f){for(l.status="rejected",l.reason=f,f=0;f<i.length;f++)(0,i[f])(void 0)}),l}var wp=O.S;O.S=function(e,n){sg=at(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&U2(e,n),wp!==null&&wp(e,n)};var Ns=B(null);function pd(){var e=Ns.current;return e!==null?e:Xe.pooledCache}function gl(e,n){n===null?ne(Ns,Ns.current):ne(Ns,n.pool)}function jp(){var e=pd();return e===null?null:{parent:rt._currentValue,pool:e}}var fr=Error(o(460)),gd=Error(o(474)),xl=Error(o(542)),yl={then:function(){}};function Np(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Sp(e,n,i){switch(i=e[i],i===void 0?e.push(n):i!==n&&(n.then(Wn,Wn),n=i),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Ep(e),e;default:if(typeof n.status=="string")n.then(Wn,Wn);else{if(e=Xe,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=n,e.status="pending",e.then(function(l){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=l}},function(l){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=l}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Ep(e),e}throw _s=n,fr}}function Ss(e){try{var n=e._init;return n(e._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(_s=i,fr):i}}var _s=null;function _p(){if(_s===null)throw Error(o(459));var e=_s;return _s=null,e}function Ep(e){if(e===fr||e===xl)throw Error(o(483))}var hr=null,Ei=0;function bl(e){var n=Ei;return Ei+=1,hr===null&&(hr=[]),Sp(hr,e,n)}function Ci(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function vl(e,n){throw n.$$typeof===b?Error(o(525)):(e=Object.prototype.toString.call(n),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Cp(e){function n(F,X){if(e){var K=F.deletions;K===null?(F.deletions=[X],F.flags|=16):K.push(X)}}function i(F,X){if(!e)return null;for(;X!==null;)n(F,X),X=X.sibling;return null}function l(F){for(var X=new Map;F!==null;)F.key!==null?X.set(F.key,F):X.set(F.index,F),F=F.sibling;return X}function f(F,X){return F=Jn(F,X),F.index=0,F.sibling=null,F}function h(F,X,K){return F.index=K,e?(K=F.alternate,K!==null?(K=K.index,K<X?(F.flags|=67108866,X):K):(F.flags|=67108866,X)):(F.flags|=1048576,X)}function v(F){return e&&F.alternate===null&&(F.flags|=67108866),F}function k(F,X,K,oe){return X===null||X.tag!==6?(X=sd(K,F.mode,oe),X.return=F,X):(X=f(X,K),X.return=F,X)}function Y(F,X,K,oe){var ye=K.type;return ye===C?ie(F,X,K.props.children,oe,K.key):X!==null&&(X.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===q&&Ss(ye)===X.type)?(X=f(X,K.props),Ci(X,K),X.return=F,X):(X=fl(K.type,K.key,K.props,null,F.mode,oe),Ci(X,K),X.return=F,X)}function J(F,X,K,oe){return X===null||X.tag!==4||X.stateNode.containerInfo!==K.containerInfo||X.stateNode.implementation!==K.implementation?(X=rd(K,F.mode,oe),X.return=F,X):(X=f(X,K.children||[]),X.return=F,X)}function ie(F,X,K,oe,ye){return X===null||X.tag!==7?(X=bs(K,F.mode,oe,ye),X.return=F,X):(X=f(X,K),X.return=F,X)}function le(F,X,K){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return X=sd(""+X,F.mode,K),X.return=F,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case j:return K=fl(X.type,X.key,X.props,null,F.mode,K),Ci(K,X),K.return=F,K;case S:return X=rd(X,F.mode,K),X.return=F,X;case q:return X=Ss(X),le(F,X,K)}if(G(X)||Z(X))return X=bs(X,F.mode,K,null),X.return=F,X;if(typeof X.then=="function")return le(F,bl(X),K);if(X.$$typeof===T)return le(F,pl(F,X),K);vl(F,X)}return null}function ee(F,X,K,oe){var ye=X!==null?X.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return ye!==null?null:k(F,X,""+K,oe);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case j:return K.key===ye?Y(F,X,K,oe):null;case S:return K.key===ye?J(F,X,K,oe):null;case q:return K=Ss(K),ee(F,X,K,oe)}if(G(K)||Z(K))return ye!==null?null:ie(F,X,K,oe,null);if(typeof K.then=="function")return ee(F,X,bl(K),oe);if(K.$$typeof===T)return ee(F,X,pl(F,K),oe);vl(F,K)}return null}function ae(F,X,K,oe,ye){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return F=F.get(K)||null,k(X,F,""+oe,ye);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case j:return F=F.get(oe.key===null?K:oe.key)||null,Y(X,F,oe,ye);case S:return F=F.get(oe.key===null?K:oe.key)||null,J(X,F,oe,ye);case q:return oe=Ss(oe),ae(F,X,K,oe,ye)}if(G(oe)||Z(oe))return F=F.get(K)||null,ie(X,F,oe,ye,null);if(typeof oe.then=="function")return ae(F,X,K,bl(oe),ye);if(oe.$$typeof===T)return ae(F,X,K,pl(X,oe),ye);vl(X,oe)}return null}function fe(F,X,K,oe){for(var ye=null,Be=null,me=X,_e=X=0,Re=null;me!==null&&_e<K.length;_e++){me.index>_e?(Re=me,me=null):Re=me.sibling;var Le=ee(F,me,K[_e],oe);if(Le===null){me===null&&(me=Re);break}e&&me&&Le.alternate===null&&n(F,me),X=h(Le,X,_e),Be===null?ye=Le:Be.sibling=Le,Be=Le,me=Re}if(_e===K.length)return i(F,me),De&&ea(F,_e),ye;if(me===null){for(;_e<K.length;_e++)me=le(F,K[_e],oe),me!==null&&(X=h(me,X,_e),Be===null?ye=me:Be.sibling=me,Be=me);return De&&ea(F,_e),ye}for(me=l(me);_e<K.length;_e++)Re=ae(me,F,_e,K[_e],oe),Re!==null&&(e&&Re.alternate!==null&&me.delete(Re.key===null?_e:Re.key),X=h(Re,X,_e),Be===null?ye=Re:Be.sibling=Re,Be=Re);return e&&me.forEach(function(Wa){return n(F,Wa)}),De&&ea(F,_e),ye}function we(F,X,K,oe){if(K==null)throw Error(o(151));for(var ye=null,Be=null,me=X,_e=X=0,Re=null,Le=K.next();me!==null&&!Le.done;_e++,Le=K.next()){me.index>_e?(Re=me,me=null):Re=me.sibling;var Wa=ee(F,me,Le.value,oe);if(Wa===null){me===null&&(me=Re);break}e&&me&&Wa.alternate===null&&n(F,me),X=h(Wa,X,_e),Be===null?ye=Wa:Be.sibling=Wa,Be=Wa,me=Re}if(Le.done)return i(F,me),De&&ea(F,_e),ye;if(me===null){for(;!Le.done;_e++,Le=K.next())Le=le(F,Le.value,oe),Le!==null&&(X=h(Le,X,_e),Be===null?ye=Le:Be.sibling=Le,Be=Le);return De&&ea(F,_e),ye}for(me=l(me);!Le.done;_e++,Le=K.next())Le=ae(me,F,_e,Le.value,oe),Le!==null&&(e&&Le.alternate!==null&&me.delete(Le.key===null?_e:Le.key),X=h(Le,X,_e),Be===null?ye=Le:Be.sibling=Le,Be=Le);return e&&me.forEach(function(Jw){return n(F,Jw)}),De&&ea(F,_e),ye}function Ie(F,X,K,oe){if(typeof K=="object"&&K!==null&&K.type===C&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case j:e:{for(var ye=K.key;X!==null;){if(X.key===ye){if(ye=K.type,ye===C){if(X.tag===7){i(F,X.sibling),oe=f(X,K.props.children),oe.return=F,F=oe;break e}}else if(X.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===q&&Ss(ye)===X.type){i(F,X.sibling),oe=f(X,K.props),Ci(oe,K),oe.return=F,F=oe;break e}i(F,X);break}else n(F,X);X=X.sibling}K.type===C?(oe=bs(K.props.children,F.mode,oe,K.key),oe.return=F,F=oe):(oe=fl(K.type,K.key,K.props,null,F.mode,oe),Ci(oe,K),oe.return=F,F=oe)}return v(F);case S:e:{for(ye=K.key;X!==null;){if(X.key===ye)if(X.tag===4&&X.stateNode.containerInfo===K.containerInfo&&X.stateNode.implementation===K.implementation){i(F,X.sibling),oe=f(X,K.children||[]),oe.return=F,F=oe;break e}else{i(F,X);break}else n(F,X);X=X.sibling}oe=rd(K,F.mode,oe),oe.return=F,F=oe}return v(F);case q:return K=Ss(K),Ie(F,X,K,oe)}if(G(K))return fe(F,X,K,oe);if(Z(K)){if(ye=Z(K),typeof ye!="function")throw Error(o(150));return K=ye.call(K),we(F,X,K,oe)}if(typeof K.then=="function")return Ie(F,X,bl(K),oe);if(K.$$typeof===T)return Ie(F,X,pl(F,K),oe);vl(F,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,X!==null&&X.tag===6?(i(F,X.sibling),oe=f(X,K),oe.return=F,F=oe):(i(F,X),oe=sd(K,F.mode,oe),oe.return=F,F=oe),v(F)):i(F,X)}return function(F,X,K,oe){try{Ei=0;var ye=Ie(F,X,K,oe);return hr=null,ye}catch(me){if(me===fr||me===xl)throw me;var Be=Vt(29,me,null,F.mode);return Be.lanes=oe,Be.return=F,Be}}}var Es=Cp(!0),Tp=Cp(!1),Da=!1;function xd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yd(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Oa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ba(e,n,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(He&2)!==0){var f=l.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),l.pending=n,n=dl(e),dp(e,null,i),n}return ul(e,l,n,i),dl(e)}function Ti(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194048)!==0)){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Yo(e,i)}}function bd(e,n){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var f=null,h=null;if(i=i.firstBaseUpdate,i!==null){do{var v={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};h===null?f=h=v:h=h.next=v,i=i.next}while(i!==null);h===null?f=h=n:h=h.next=n}else f=h=n;i={baseState:l.baseState,firstBaseUpdate:f,lastBaseUpdate:h,shared:l.shared,callbacks:l.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}var vd=!1;function Mi(){if(vd){var e=dr;if(e!==null)throw e}}function Ai(e,n,i,l){vd=!1;var f=e.updateQueue;Da=!1;var h=f.firstBaseUpdate,v=f.lastBaseUpdate,k=f.shared.pending;if(k!==null){f.shared.pending=null;var Y=k,J=Y.next;Y.next=null,v===null?h=J:v.next=J,v=Y;var ie=e.alternate;ie!==null&&(ie=ie.updateQueue,k=ie.lastBaseUpdate,k!==v&&(k===null?ie.firstBaseUpdate=J:k.next=J,ie.lastBaseUpdate=Y))}if(h!==null){var le=f.baseState;v=0,ie=J=Y=null,k=h;do{var ee=k.lane&-536870913,ae=ee!==k.lane;if(ae?(ke&ee)===ee:(l&ee)===ee){ee!==0&&ee===ur&&(vd=!0),ie!==null&&(ie=ie.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var fe=e,we=k;ee=n;var Ie=i;switch(we.tag){case 1:if(fe=we.payload,typeof fe=="function"){le=fe.call(Ie,le,ee);break e}le=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=we.payload,ee=typeof fe=="function"?fe.call(Ie,le,ee):fe,ee==null)break e;le=x({},le,ee);break e;case 2:Da=!0}}ee=k.callback,ee!==null&&(e.flags|=64,ae&&(e.flags|=8192),ae=f.callbacks,ae===null?f.callbacks=[ee]:ae.push(ee))}else ae={lane:ee,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ie===null?(J=ie=ae,Y=le):ie=ie.next=ae,v|=ee;if(k=k.next,k===null){if(k=f.shared.pending,k===null)break;ae=k,k=ae.next,ae.next=null,f.lastBaseUpdate=ae,f.shared.pending=null}}while(!0);ie===null&&(Y=le),f.baseState=Y,f.firstBaseUpdate=J,f.lastBaseUpdate=ie,h===null&&(f.shared.lanes=0),Ua|=v,e.lanes=v,e.memoizedState=le}}function Mp(e,n){if(typeof e!="function")throw Error(o(191,e));e.call(n)}function Ap(e,n){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)Mp(i[e],n)}var mr=B(null),wl=B(0);function kp(e,n){e=da,ne(wl,e),ne(mr,n),da=e|n.baseLanes}function wd(){ne(wl,da),ne(mr,mr.current)}function jd(){da=wl.current,P(mr),P(wl)}var Yt=B(null),rn=null;function La(e){var n=e.alternate;ne(tt,tt.current&1),ne(Yt,e),rn===null&&(n===null||mr.current!==null||n.memoizedState!==null)&&(rn=e)}function Nd(e){ne(tt,tt.current),ne(Yt,e),rn===null&&(rn=e)}function Rp(e){e.tag===22?(ne(tt,tt.current),ne(Yt,e),rn===null&&(rn=e)):Ha()}function Ha(){ne(tt,tt.current),ne(Yt,Yt.current)}function Pt(e){P(Yt),rn===e&&(rn=null),P(tt)}var tt=B(0);function jl(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||Af(i)||kf(i)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var aa=0,Ne=null,Ye=null,it=null,Nl=!1,pr=!1,Cs=!1,Sl=0,ki=0,gr=null,Y2=0;function Je(){throw Error(o(321))}function Sd(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!Ut(e[i],n[i]))return!1;return!0}function _d(e,n,i,l,f,h){return aa=h,Ne=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,O.H=e===null||e.memoizedState===null?p0:qd,Cs=!1,h=i(l,f),Cs=!1,pr&&(h=Dp(n,i,l,f)),zp(e),h}function zp(e){O.H=Di;var n=Ye!==null&&Ye.next!==null;if(aa=0,it=Ye=Ne=null,Nl=!1,ki=0,gr=null,n)throw Error(o(300));e===null||ot||(e=e.dependencies,e!==null&&ml(e)&&(ot=!0))}function Dp(e,n,i,l){Ne=e;var f=0;do{if(pr&&(gr=null),ki=0,pr=!1,25<=f)throw Error(o(301));if(f+=1,it=Ye=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}O.H=g0,h=n(i,l)}while(pr);return h}function P2(){var e=O.H,n=e.useState()[0];return n=typeof n.then=="function"?Ri(n):n,e=e.useState()[0],(Ye!==null?Ye.memoizedState:null)!==e&&(Ne.flags|=1024),n}function Ed(){var e=Sl!==0;return Sl=0,e}function Cd(e,n,i){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~i}function Td(e){if(Nl){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Nl=!1}aa=0,it=Ye=Ne=null,pr=!1,ki=Sl=0,gr=null}function Mt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?Ne.memoizedState=it=e:it=it.next=e,it}function nt(){if(Ye===null){var e=Ne.alternate;e=e!==null?e.memoizedState:null}else e=Ye.next;var n=it===null?Ne.memoizedState:it.next;if(n!==null)it=n,Ye=e;else{if(e===null)throw Ne.alternate===null?Error(o(467)):Error(o(310));Ye=e,e={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},it===null?Ne.memoizedState=it=e:it=it.next=e}return it}function _l(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ri(e){var n=ki;return ki+=1,gr===null&&(gr=[]),e=Sp(gr,e,n),n=Ne,(it===null?n.memoizedState:it.next)===null&&(n=n.alternate,O.H=n===null||n.memoizedState===null?p0:qd),e}function El(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ri(e);if(e.$$typeof===T)return vt(e)}throw Error(o(438,String(e)))}function Md(e){var n=null,i=Ne.updateQueue;if(i!==null&&(n=i.memoCache),n==null){var l=Ne.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(n={data:l.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),i===null&&(i=_l(),Ne.updateQueue=i),i.memoCache=n,i=n.data[n.index],i===void 0)for(i=n.data[n.index]=Array(e),l=0;l<e;l++)i[l]=Q;return n.index++,i}function sa(e,n){return typeof n=="function"?n(e):n}function Cl(e){var n=nt();return Ad(n,Ye,e)}function Ad(e,n,i){var l=e.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=i;var f=e.baseQueue,h=l.pending;if(h!==null){if(f!==null){var v=f.next;f.next=h.next,h.next=v}n.baseQueue=f=h,l.pending=null}if(h=e.baseState,f===null)e.memoizedState=h;else{n=f.next;var k=v=null,Y=null,J=n,ie=!1;do{var le=J.lane&-536870913;if(le!==J.lane?(ke&le)===le:(aa&le)===le){var ee=J.revertLane;if(ee===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),le===ur&&(ie=!0);else if((aa&ee)===ee){J=J.next,ee===ur&&(ie=!0);continue}else le={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},Y===null?(k=Y=le,v=h):Y=Y.next=le,Ne.lanes|=ee,Ua|=ee;le=J.action,Cs&&i(h,le),h=J.hasEagerState?J.eagerState:i(h,le)}else ee={lane:le,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},Y===null?(k=Y=ee,v=h):Y=Y.next=ee,Ne.lanes|=le,Ua|=le;J=J.next}while(J!==null&&J!==n);if(Y===null?v=h:Y.next=k,!Ut(h,e.memoizedState)&&(ot=!0,ie&&(i=dr,i!==null)))throw i;e.memoizedState=h,e.baseState=v,e.baseQueue=Y,l.lastRenderedState=h}return f===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function kd(e){var n=nt(),i=n.queue;if(i===null)throw Error(o(311));i.lastRenderedReducer=e;var l=i.dispatch,f=i.pending,h=n.memoizedState;if(f!==null){i.pending=null;var v=f=f.next;do h=e(h,v.action),v=v.next;while(v!==f);Ut(h,n.memoizedState)||(ot=!0),n.memoizedState=h,n.baseQueue===null&&(n.baseState=h),i.lastRenderedState=h}return[h,l]}function Op(e,n,i){var l=Ne,f=nt(),h=De;if(h){if(i===void 0)throw Error(o(407));i=i()}else i=n();var v=!Ut((Ye||f).memoizedState,i);if(v&&(f.memoizedState=i,ot=!0),f=f.queue,Dd(Hp.bind(null,l,f,e),[e]),f.getSnapshot!==n||v||it!==null&&it.memoizedState.tag&1){if(l.flags|=2048,xr(9,{destroy:void 0},Lp.bind(null,l,f,i,n),null),Xe===null)throw Error(o(349));h||(aa&127)!==0||Bp(l,n,i)}return i}function Bp(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=Ne.updateQueue,n===null?(n=_l(),Ne.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function Lp(e,n,i,l){n.value=i,n.getSnapshot=l,$p(n)&&qp(e)}function Hp(e,n,i){return i(function(){$p(n)&&qp(e)})}function $p(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!Ut(e,i)}catch{return!0}}function qp(e){var n=ys(e,2);n!==null&&Ht(n,e,2)}function Rd(e){var n=Mt();if(typeof e=="function"){var i=e;if(e=i(),Cs){Tn(!0);try{i()}finally{Tn(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:e},n}function Up(e,n,i,l){return e.baseState=i,Ad(e,Ye,typeof l=="function"?l:sa)}function I2(e,n,i,l,f){if(Al(e))throw Error(o(485));if(e=n.action,e!==null){var h={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){h.listeners.push(v)}};O.T!==null?i(!0):h.isTransition=!1,l(h),i=n.pending,i===null?(h.next=n.pending=h,Vp(n,h)):(h.next=i.next,n.pending=i.next=h)}}function Vp(e,n){var i=n.action,l=n.payload,f=e.state;if(n.isTransition){var h=O.T,v={};O.T=v;try{var k=i(f,l),Y=O.S;Y!==null&&Y(v,k),Yp(e,n,k)}catch(J){zd(e,n,J)}finally{h!==null&&v.types!==null&&(h.types=v.types),O.T=h}}else try{h=i(f,l),Yp(e,n,h)}catch(J){zd(e,n,J)}}function Yp(e,n,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(l){Pp(e,n,l)},function(l){return zd(e,n,l)}):Pp(e,n,i)}function Pp(e,n,i){n.status="fulfilled",n.value=i,Ip(n),e.state=i,n=e.pending,n!==null&&(i=n.next,i===n?e.pending=null:(i=i.next,n.next=i,Vp(e,i)))}function zd(e,n,i){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do n.status="rejected",n.reason=i,Ip(n),n=n.next;while(n!==l)}e.action=null}function Ip(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Xp(e,n){return n}function Gp(e,n){if(De){var i=Xe.formState;if(i!==null){e:{var l=Ne;if(De){if(Ge){t:{for(var f=Ge,h=sn;f.nodeType!==8;){if(!h){f=null;break t}if(f=on(f.nextSibling),f===null){f=null;break t}}h=f.data,f=h==="F!"||h==="F"?f:null}if(f){Ge=on(f.nextSibling),l=f.data==="F!";break e}}Ra(l)}l=!1}l&&(n=i[0])}}return i=Mt(),i.memoizedState=i.baseState=n,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xp,lastRenderedState:n},i.queue=l,i=f0.bind(null,Ne,l),l.dispatch=i,l=Rd(!1),h=$d.bind(null,Ne,!1,l.queue),l=Mt(),f={state:n,dispatch:null,action:e,pending:null},l.queue=f,i=I2.bind(null,Ne,f,h,i),f.dispatch=i,l.memoizedState=e,[n,i,!1]}function Qp(e){var n=nt();return Fp(n,Ye,e)}function Fp(e,n,i){if(n=Ad(e,n,Xp)[0],e=Cl(sa)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var l=Ri(n)}catch(v){throw v===fr?xl:v}else l=n;n=nt();var f=n.queue,h=f.dispatch;return i!==n.memoizedState&&(Ne.flags|=2048,xr(9,{destroy:void 0},X2.bind(null,f,i),null)),[l,h,e]}function X2(e,n){e.action=n}function Zp(e){var n=nt(),i=Ye;if(i!==null)return Fp(n,i,e);nt(),n=n.memoizedState,i=nt();var l=i.queue.dispatch;return i.memoizedState=e,[n,l,!1]}function xr(e,n,i,l){return e={tag:e,create:i,deps:l,inst:n,next:null},n=Ne.updateQueue,n===null&&(n=_l(),Ne.updateQueue=n),i=n.lastEffect,i===null?n.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,n.lastEffect=e),e}function Wp(){return nt().memoizedState}function Tl(e,n,i,l){var f=Mt();Ne.flags|=e,f.memoizedState=xr(1|n,{destroy:void 0},i,l===void 0?null:l)}function Ml(e,n,i,l){var f=nt();l=l===void 0?null:l;var h=f.memoizedState.inst;Ye!==null&&l!==null&&Sd(l,Ye.memoizedState.deps)?f.memoizedState=xr(n,h,i,l):(Ne.flags|=e,f.memoizedState=xr(1|n,h,i,l))}function Kp(e,n){Tl(8390656,8,e,n)}function Dd(e,n){Ml(2048,8,e,n)}function G2(e){Ne.flags|=4;var n=Ne.updateQueue;if(n===null)n=_l(),Ne.updateQueue=n,n.events=[e];else{var i=n.events;i===null?n.events=[e]:i.push(e)}}function Jp(e){var n=nt().memoizedState;return G2({ref:n,nextImpl:e}),function(){if((He&2)!==0)throw Error(o(440));return n.impl.apply(void 0,arguments)}}function e0(e,n){return Ml(4,2,e,n)}function t0(e,n){return Ml(4,4,e,n)}function n0(e,n){if(typeof n=="function"){e=e();var i=n(e);return function(){typeof i=="function"?i():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function a0(e,n,i){i=i!=null?i.concat([e]):null,Ml(4,4,n0.bind(null,n,e),i)}function Od(){}function s0(e,n){var i=nt();n=n===void 0?null:n;var l=i.memoizedState;return n!==null&&Sd(n,l[1])?l[0]:(i.memoizedState=[e,n],e)}function r0(e,n){var i=nt();n=n===void 0?null:n;var l=i.memoizedState;if(n!==null&&Sd(n,l[1]))return l[0];if(l=e(),Cs){Tn(!0);try{e()}finally{Tn(!1)}}return i.memoizedState=[l,n],l}function Bd(e,n,i){return i===void 0||(aa&1073741824)!==0&&(ke&261930)===0?e.memoizedState=n:(e.memoizedState=i,e=ig(),Ne.lanes|=e,Ua|=e,i)}function i0(e,n,i,l){return Ut(i,n)?i:mr.current!==null?(e=Bd(e,i,l),Ut(e,n)||(ot=!0),e):(aa&42)===0||(aa&1073741824)!==0&&(ke&261930)===0?(ot=!0,e.memoizedState=i):(e=ig(),Ne.lanes|=e,Ua|=e,n)}function o0(e,n,i,l,f){var h=z.p;z.p=h!==0&&8>h?h:8;var v=O.T,k={};O.T=k,$d(e,!1,n,i);try{var Y=f(),J=O.S;if(J!==null&&J(k,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ie=V2(Y,l);zi(e,n,ie,Gt(e))}else zi(e,n,l,Gt(e))}catch(le){zi(e,n,{then:function(){},status:"rejected",reason:le},Gt())}finally{z.p=h,v!==null&&k.types!==null&&(v.types=k.types),O.T=v}}function Q2(){}function Ld(e,n,i,l){if(e.tag!==5)throw Error(o(476));var f=l0(e).queue;o0(e,f,n,U,i===null?Q2:function(){return c0(e),i(l)})}function l0(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:U},next:null};var i={};return n.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:i},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function c0(e){var n=l0(e);n.next===null&&(n=e.alternate.memoizedState),zi(e,n.next.queue,{},Gt())}function Hd(){return vt(Zi)}function u0(){return nt().memoizedState}function d0(){return nt().memoizedState}function F2(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var i=Gt();e=Oa(i);var l=Ba(n,e,i);l!==null&&(Ht(l,n,i),Ti(l,n,i)),n={cache:hd()},e.payload=n;return}n=n.return}}function Z2(e,n,i){var l=Gt();i={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Al(e)?h0(n,i):(i=nd(e,n,i,l),i!==null&&(Ht(i,e,l),m0(i,n,l)))}function f0(e,n,i){var l=Gt();zi(e,n,i,l)}function zi(e,n,i,l){var f={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(Al(e))h0(n,f);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=n.lastRenderedReducer,h!==null))try{var v=n.lastRenderedState,k=h(v,i);if(f.hasEagerState=!0,f.eagerState=k,Ut(k,v))return ul(e,n,f,0),Xe===null&&cl(),!1}catch{}if(i=nd(e,n,f,l),i!==null)return Ht(i,e,l),m0(i,n,l),!0}return!1}function $d(e,n,i,l){if(l={lane:2,revertLane:yf(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Al(e)){if(n)throw Error(o(479))}else n=nd(e,i,l,2),n!==null&&Ht(n,e,2)}function Al(e){var n=e.alternate;return e===Ne||n!==null&&n===Ne}function h0(e,n){pr=Nl=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function m0(e,n,i){if((i&4194048)!==0){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Yo(e,i)}}var Di={readContext:vt,use:El,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je};Di.useEffectEvent=Je;var p0={readContext:vt,use:El,useCallback:function(e,n){return Mt().memoizedState=[e,n===void 0?null:n],e},useContext:vt,useEffect:Kp,useImperativeHandle:function(e,n,i){i=i!=null?i.concat([e]):null,Tl(4194308,4,n0.bind(null,n,e),i)},useLayoutEffect:function(e,n){return Tl(4194308,4,e,n)},useInsertionEffect:function(e,n){Tl(4,2,e,n)},useMemo:function(e,n){var i=Mt();n=n===void 0?null:n;var l=e();if(Cs){Tn(!0);try{e()}finally{Tn(!1)}}return i.memoizedState=[l,n],l},useReducer:function(e,n,i){var l=Mt();if(i!==void 0){var f=i(n);if(Cs){Tn(!0);try{i(n)}finally{Tn(!1)}}}else f=n;return l.memoizedState=l.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},l.queue=e,e=e.dispatch=Z2.bind(null,Ne,e),[l.memoizedState,e]},useRef:function(e){var n=Mt();return e={current:e},n.memoizedState=e},useState:function(e){e=Rd(e);var n=e.queue,i=f0.bind(null,Ne,n);return n.dispatch=i,[e.memoizedState,i]},useDebugValue:Od,useDeferredValue:function(e,n){var i=Mt();return Bd(i,e,n)},useTransition:function(){var e=Rd(!1);return e=o0.bind(null,Ne,e.queue,!0,!1),Mt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,i){var l=Ne,f=Mt();if(De){if(i===void 0)throw Error(o(407));i=i()}else{if(i=n(),Xe===null)throw Error(o(349));(ke&127)!==0||Bp(l,n,i)}f.memoizedState=i;var h={value:i,getSnapshot:n};return f.queue=h,Kp(Hp.bind(null,l,h,e),[e]),l.flags|=2048,xr(9,{destroy:void 0},Lp.bind(null,l,h,i,n),null),i},useId:function(){var e=Mt(),n=Xe.identifierPrefix;if(De){var i=kn,l=An;i=(l&~(1<<32-Tt(l)-1)).toString(32)+i,n="_"+n+"R_"+i,i=Sl++,0<i&&(n+="H"+i.toString(32)),n+="_"}else i=Y2++,n="_"+n+"r_"+i.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:Hd,useFormState:Gp,useActionState:Gp,useOptimistic:function(e){var n=Mt();n.memoizedState=n.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=i,n=$d.bind(null,Ne,!0,i),i.dispatch=n,[e,n]},useMemoCache:Md,useCacheRefresh:function(){return Mt().memoizedState=F2.bind(null,Ne)},useEffectEvent:function(e){var n=Mt(),i={impl:e};return n.memoizedState=i,function(){if((He&2)!==0)throw Error(o(440));return i.impl.apply(void 0,arguments)}}},qd={readContext:vt,use:El,useCallback:s0,useContext:vt,useEffect:Dd,useImperativeHandle:a0,useInsertionEffect:e0,useLayoutEffect:t0,useMemo:r0,useReducer:Cl,useRef:Wp,useState:function(){return Cl(sa)},useDebugValue:Od,useDeferredValue:function(e,n){var i=nt();return i0(i,Ye.memoizedState,e,n)},useTransition:function(){var e=Cl(sa)[0],n=nt().memoizedState;return[typeof e=="boolean"?e:Ri(e),n]},useSyncExternalStore:Op,useId:u0,useHostTransitionStatus:Hd,useFormState:Qp,useActionState:Qp,useOptimistic:function(e,n){var i=nt();return Up(i,Ye,e,n)},useMemoCache:Md,useCacheRefresh:d0};qd.useEffectEvent=Jp;var g0={readContext:vt,use:El,useCallback:s0,useContext:vt,useEffect:Dd,useImperativeHandle:a0,useInsertionEffect:e0,useLayoutEffect:t0,useMemo:r0,useReducer:kd,useRef:Wp,useState:function(){return kd(sa)},useDebugValue:Od,useDeferredValue:function(e,n){var i=nt();return Ye===null?Bd(i,e,n):i0(i,Ye.memoizedState,e,n)},useTransition:function(){var e=kd(sa)[0],n=nt().memoizedState;return[typeof e=="boolean"?e:Ri(e),n]},useSyncExternalStore:Op,useId:u0,useHostTransitionStatus:Hd,useFormState:Zp,useActionState:Zp,useOptimistic:function(e,n){var i=nt();return Ye!==null?Up(i,Ye,e,n):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:Md,useCacheRefresh:d0};g0.useEffectEvent=Jp;function Ud(e,n,i,l){n=e.memoizedState,i=i(l,n),i=i==null?n:x({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Vd={enqueueSetState:function(e,n,i){e=e._reactInternals;var l=Gt(),f=Oa(l);f.payload=n,i!=null&&(f.callback=i),n=Ba(e,f,l),n!==null&&(Ht(n,e,l),Ti(n,e,l))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var l=Gt(),f=Oa(l);f.tag=1,f.payload=n,i!=null&&(f.callback=i),n=Ba(e,f,l),n!==null&&(Ht(n,e,l),Ti(n,e,l))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=Gt(),l=Oa(i);l.tag=2,n!=null&&(l.callback=n),n=Ba(e,l,i),n!==null&&(Ht(n,e,i),Ti(n,e,i))}};function x0(e,n,i,l,f,h,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,h,v):n.prototype&&n.prototype.isPureReactComponent?!vi(i,l)||!vi(f,h):!0}function y0(e,n,i,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,l),n.state!==e&&Vd.enqueueReplaceState(n,n.state,null)}function Ts(e,n){var i=n;if("ref"in n){i={};for(var l in n)l!=="ref"&&(i[l]=n[l])}if(e=e.defaultProps){i===n&&(i=x({},i));for(var f in e)i[f]===void 0&&(i[f]=e[f])}return i}function b0(e){ll(e)}function v0(e){console.error(e)}function w0(e){ll(e)}function kl(e,n){try{var i=e.onUncaughtError;i(n.value,{componentStack:n.stack})}catch(l){setTimeout(function(){throw l})}}function j0(e,n,i){try{var l=e.onCaughtError;l(i.value,{componentStack:i.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Yd(e,n,i){return i=Oa(i),i.tag=3,i.payload={element:null},i.callback=function(){kl(e,n)},i}function N0(e){return e=Oa(e),e.tag=3,e}function S0(e,n,i,l){var f=i.type.getDerivedStateFromError;if(typeof f=="function"){var h=l.value;e.payload=function(){return f(h)},e.callback=function(){j0(n,i,l)}}var v=i.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){j0(n,i,l),typeof f!="function"&&(Va===null?Va=new Set([this]):Va.add(this));var k=l.stack;this.componentDidCatch(l.value,{componentStack:k!==null?k:""})})}function W2(e,n,i,l,f){if(i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(n=i.alternate,n!==null&&cr(n,i,f,!0),i=Yt.current,i!==null){switch(i.tag){case 31:case 13:return rn===null?Yl():i.alternate===null&&et===0&&(et=3),i.flags&=-257,i.flags|=65536,i.lanes=f,l===yl?i.flags|=16384:(n=i.updateQueue,n===null?i.updateQueue=new Set([l]):n.add(l),pf(e,l,f)),!1;case 22:return i.flags|=65536,l===yl?i.flags|=16384:(n=i.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([l])},i.updateQueue=n):(i=n.retryQueue,i===null?n.retryQueue=new Set([l]):i.add(l)),pf(e,l,f)),!1}throw Error(o(435,i.tag))}return pf(e,l,f),Yl(),!1}if(De)return n=Yt.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,l!==ld&&(e=Error(o(422),{cause:l}),Ni(tn(e,i)))):(l!==ld&&(n=Error(o(423),{cause:l}),Ni(tn(n,i))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,l=tn(l,i),f=Yd(e.stateNode,l,f),bd(e,f),et!==4&&(et=2)),!1;var h=Error(o(520),{cause:l});if(h=tn(h,i),Vi===null?Vi=[h]:Vi.push(h),et!==4&&(et=2),n===null)return!0;l=tn(l,i),i=n;do{switch(i.tag){case 3:return i.flags|=65536,e=f&-f,i.lanes|=e,e=Yd(i.stateNode,l,e),bd(i,e),!1;case 1:if(n=i.type,h=i.stateNode,(i.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(Va===null||!Va.has(h))))return i.flags|=65536,f&=-f,i.lanes|=f,f=N0(f),S0(f,e,i,l),bd(i,f),!1}i=i.return}while(i!==null);return!1}var Pd=Error(o(461)),ot=!1;function wt(e,n,i,l){n.child=e===null?Tp(n,null,i,l):Es(n,e.child,i,l)}function _0(e,n,i,l,f){i=i.render;var h=n.ref;if("ref"in l){var v={};for(var k in l)k!=="ref"&&(v[k]=l[k])}else v=l;return js(n),l=_d(e,n,i,v,h,f),k=Ed(),e!==null&&!ot?(Cd(e,n,f),ra(e,n,f)):(De&&k&&id(n),n.flags|=1,wt(e,n,l,f),n.child)}function E0(e,n,i,l,f){if(e===null){var h=i.type;return typeof h=="function"&&!ad(h)&&h.defaultProps===void 0&&i.compare===null?(n.tag=15,n.type=h,C0(e,n,h,l,f)):(e=fl(i.type,null,l,n,n.mode,f),e.ref=n.ref,e.return=n,n.child=e)}if(h=e.child,!Kd(e,f)){var v=h.memoizedProps;if(i=i.compare,i=i!==null?i:vi,i(v,l)&&e.ref===n.ref)return ra(e,n,f)}return n.flags|=1,e=Jn(h,l),e.ref=n.ref,e.return=n,n.child=e}function C0(e,n,i,l,f){if(e!==null){var h=e.memoizedProps;if(vi(h,l)&&e.ref===n.ref)if(ot=!1,n.pendingProps=l=h,Kd(e,f))(e.flags&131072)!==0&&(ot=!0);else return n.lanes=e.lanes,ra(e,n,f)}return Id(e,n,i,l,f)}function T0(e,n,i,l){var f=l.children,h=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((n.flags&128)!==0){if(h=h!==null?h.baseLanes|i:i,e!==null){for(l=n.child=e.child,f=0;l!==null;)f=f|l.lanes|l.childLanes,l=l.sibling;l=f&~h}else l=0,n.child=null;return M0(e,n,h,i,l)}if((i&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&gl(n,h!==null?h.cachePool:null),h!==null?kp(n,h):wd(),Rp(n);else return l=n.lanes=536870912,M0(e,n,h!==null?h.baseLanes|i:i,i,l)}else h!==null?(gl(n,h.cachePool),kp(n,h),Ha(),n.memoizedState=null):(e!==null&&gl(n,null),wd(),Ha());return wt(e,n,f,i),n.child}function Oi(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function M0(e,n,i,l,f){var h=pd();return h=h===null?null:{parent:rt._currentValue,pool:h},n.memoizedState={baseLanes:i,cachePool:h},e!==null&&gl(n,null),wd(),Rp(n),e!==null&&cr(e,n,l,!0),n.childLanes=f,null}function Rl(e,n){return n=Dl({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function A0(e,n,i){return Es(n,e.child,null,i),e=Rl(n,n.pendingProps),e.flags|=2,Pt(n),n.memoizedState=null,e}function K2(e,n,i){var l=n.pendingProps,f=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(De){if(l.mode==="hidden")return e=Rl(n,l),n.lanes=536870912,Oi(null,e);if(Nd(n),(e=Ge)?(e=Vg(e,sn),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Aa!==null?{id:An,overflow:kn}:null,retryLane:536870912,hydrationErrors:null},i=hp(e),i.return=n,n.child=i,bt=n,Ge=null)):e=null,e===null)throw Ra(n);return n.lanes=536870912,null}return Rl(n,l)}var h=e.memoizedState;if(h!==null){var v=h.dehydrated;if(Nd(n),f)if(n.flags&256)n.flags&=-257,n=A0(e,n,i);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(o(558));else if(ot||cr(e,n,i,!1),f=(i&e.childLanes)!==0,ot||f){if(l=Xe,l!==null&&(v=Po(l,i),v!==0&&v!==h.retryLane))throw h.retryLane=v,ys(e,v),Ht(l,e,v),Pd;Yl(),n=A0(e,n,i)}else e=h.treeContext,Ge=on(v.nextSibling),bt=n,De=!0,ka=null,sn=!1,e!==null&&gp(n,e),n=Rl(n,l),n.flags|=4096;return n}return e=Jn(e.child,{mode:l.mode,children:l.children}),e.ref=n.ref,n.child=e,e.return=n,e}function zl(e,n){var i=n.ref;if(i===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(o(284));(e===null||e.ref!==i)&&(n.flags|=4194816)}}function Id(e,n,i,l,f){return js(n),i=_d(e,n,i,l,void 0,f),l=Ed(),e!==null&&!ot?(Cd(e,n,f),ra(e,n,f)):(De&&l&&id(n),n.flags|=1,wt(e,n,i,f),n.child)}function k0(e,n,i,l,f,h){return js(n),n.updateQueue=null,i=Dp(n,l,i,f),zp(e),l=Ed(),e!==null&&!ot?(Cd(e,n,h),ra(e,n,h)):(De&&l&&id(n),n.flags|=1,wt(e,n,i,h),n.child)}function R0(e,n,i,l,f){if(js(n),n.stateNode===null){var h=rr,v=i.contextType;typeof v=="object"&&v!==null&&(h=vt(v)),h=new i(l,h),n.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Vd,n.stateNode=h,h._reactInternals=n,h=n.stateNode,h.props=l,h.state=n.memoizedState,h.refs={},xd(n),v=i.contextType,h.context=typeof v=="object"&&v!==null?vt(v):rr,h.state=n.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(Ud(n,i,v,l),h.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(v=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),v!==h.state&&Vd.enqueueReplaceState(h,h.state,null),Ai(n,l,h,f),Mi(),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308),l=!0}else if(e===null){h=n.stateNode;var k=n.memoizedProps,Y=Ts(i,k);h.props=Y;var J=h.context,ie=i.contextType;v=rr,typeof ie=="object"&&ie!==null&&(v=vt(ie));var le=i.getDerivedStateFromProps;ie=typeof le=="function"||typeof h.getSnapshotBeforeUpdate=="function",k=n.pendingProps!==k,ie||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(k||J!==v)&&y0(n,h,l,v),Da=!1;var ee=n.memoizedState;h.state=ee,Ai(n,l,h,f),Mi(),J=n.memoizedState,k||ee!==J||Da?(typeof le=="function"&&(Ud(n,i,le,l),J=n.memoizedState),(Y=Da||x0(n,i,Y,l,ee,J,v))?(ie||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(n.flags|=4194308)):(typeof h.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=J),h.props=l,h.state=J,h.context=v,l=Y):(typeof h.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{h=n.stateNode,yd(e,n),v=n.memoizedProps,ie=Ts(i,v),h.props=ie,le=n.pendingProps,ee=h.context,J=i.contextType,Y=rr,typeof J=="object"&&J!==null&&(Y=vt(J)),k=i.getDerivedStateFromProps,(J=typeof k=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(v!==le||ee!==Y)&&y0(n,h,l,Y),Da=!1,ee=n.memoizedState,h.state=ee,Ai(n,l,h,f),Mi();var ae=n.memoizedState;v!==le||ee!==ae||Da||e!==null&&e.dependencies!==null&&ml(e.dependencies)?(typeof k=="function"&&(Ud(n,i,k,l),ae=n.memoizedState),(ie=Da||x0(n,i,ie,l,ee,ae,Y)||e!==null&&e.dependencies!==null&&ml(e.dependencies))?(J||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(l,ae,Y),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(l,ae,Y)),typeof h.componentDidUpdate=="function"&&(n.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof h.componentDidUpdate!="function"||v===e.memoizedProps&&ee===e.memoizedState||(n.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&ee===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=ae),h.props=l,h.state=ae,h.context=Y,l=ie):(typeof h.componentDidUpdate!="function"||v===e.memoizedProps&&ee===e.memoizedState||(n.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&ee===e.memoizedState||(n.flags|=1024),l=!1)}return h=l,zl(e,n),l=(n.flags&128)!==0,h||l?(h=n.stateNode,i=l&&typeof i.getDerivedStateFromError!="function"?null:h.render(),n.flags|=1,e!==null&&l?(n.child=Es(n,e.child,null,f),n.child=Es(n,null,i,f)):wt(e,n,i,f),n.memoizedState=h.state,e=n.child):e=ra(e,n,f),e}function z0(e,n,i,l){return vs(),n.flags|=256,wt(e,n,i,l),n.child}var Xd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Gd(e){return{baseLanes:e,cachePool:jp()}}function Qd(e,n,i){return e=e!==null?e.childLanes&~i:0,n&&(e|=Xt),e}function D0(e,n,i){var l=n.pendingProps,f=!1,h=(n.flags&128)!==0,v;if((v=h)||(v=e!==null&&e.memoizedState===null?!1:(tt.current&2)!==0),v&&(f=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(De){if(f?La(n):Ha(),(e=Ge)?(e=Vg(e,sn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Aa!==null?{id:An,overflow:kn}:null,retryLane:536870912,hydrationErrors:null},i=hp(e),i.return=n,n.child=i,bt=n,Ge=null)):e=null,e===null)throw Ra(n);return kf(e)?n.lanes=32:n.lanes=536870912,null}var k=l.children;return l=l.fallback,f?(Ha(),f=n.mode,k=Dl({mode:"hidden",children:k},f),l=bs(l,f,i,null),k.return=n,l.return=n,k.sibling=l,n.child=k,l=n.child,l.memoizedState=Gd(i),l.childLanes=Qd(e,v,i),n.memoizedState=Xd,Oi(null,l)):(La(n),Fd(n,k))}var Y=e.memoizedState;if(Y!==null&&(k=Y.dehydrated,k!==null)){if(h)n.flags&256?(La(n),n.flags&=-257,n=Zd(e,n,i)):n.memoizedState!==null?(Ha(),n.child=e.child,n.flags|=128,n=null):(Ha(),k=l.fallback,f=n.mode,l=Dl({mode:"visible",children:l.children},f),k=bs(k,f,i,null),k.flags|=2,l.return=n,k.return=n,l.sibling=k,n.child=l,Es(n,e.child,null,i),l=n.child,l.memoizedState=Gd(i),l.childLanes=Qd(e,v,i),n.memoizedState=Xd,n=Oi(null,l));else if(La(n),kf(k)){if(v=k.nextSibling&&k.nextSibling.dataset,v)var J=v.dgst;v=J,l=Error(o(419)),l.stack="",l.digest=v,Ni({value:l,source:null,stack:null}),n=Zd(e,n,i)}else if(ot||cr(e,n,i,!1),v=(i&e.childLanes)!==0,ot||v){if(v=Xe,v!==null&&(l=Po(v,i),l!==0&&l!==Y.retryLane))throw Y.retryLane=l,ys(e,l),Ht(v,e,l),Pd;Af(k)||Yl(),n=Zd(e,n,i)}else Af(k)?(n.flags|=192,n.child=e.child,n=null):(e=Y.treeContext,Ge=on(k.nextSibling),bt=n,De=!0,ka=null,sn=!1,e!==null&&gp(n,e),n=Fd(n,l.children),n.flags|=4096);return n}return f?(Ha(),k=l.fallback,f=n.mode,Y=e.child,J=Y.sibling,l=Jn(Y,{mode:"hidden",children:l.children}),l.subtreeFlags=Y.subtreeFlags&65011712,J!==null?k=Jn(J,k):(k=bs(k,f,i,null),k.flags|=2),k.return=n,l.return=n,l.sibling=k,n.child=l,Oi(null,l),l=n.child,k=e.child.memoizedState,k===null?k=Gd(i):(f=k.cachePool,f!==null?(Y=rt._currentValue,f=f.parent!==Y?{parent:Y,pool:Y}:f):f=jp(),k={baseLanes:k.baseLanes|i,cachePool:f}),l.memoizedState=k,l.childLanes=Qd(e,v,i),n.memoizedState=Xd,Oi(e.child,l)):(La(n),i=e.child,e=i.sibling,i=Jn(i,{mode:"visible",children:l.children}),i.return=n,i.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=i,n.memoizedState=null,i)}function Fd(e,n){return n=Dl({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function Dl(e,n){return e=Vt(22,e,null,n),e.lanes=0,e}function Zd(e,n,i){return Es(n,e.child,null,i),e=Fd(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function O0(e,n,i){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),dd(e.return,n,i)}function Wd(e,n,i,l,f,h){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:f,treeForkCount:h}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=l,v.tail=i,v.tailMode=f,v.treeForkCount=h)}function B0(e,n,i){var l=n.pendingProps,f=l.revealOrder,h=l.tail;l=l.children;var v=tt.current,k=(v&2)!==0;if(k?(v=v&1|2,n.flags|=128):v&=1,ne(tt,v),wt(e,n,l,i),l=De?ji:0,!k&&e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&O0(e,i,n);else if(e.tag===19)O0(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(i=n.child,f=null;i!==null;)e=i.alternate,e!==null&&jl(e)===null&&(f=i),i=i.sibling;i=f,i===null?(f=n.child,n.child=null):(f=i.sibling,i.sibling=null),Wd(n,!1,f,i,h,l);break;case"backwards":case"unstable_legacy-backwards":for(i=null,f=n.child,n.child=null;f!==null;){if(e=f.alternate,e!==null&&jl(e)===null){n.child=f;break}e=f.sibling,f.sibling=i,i=f,f=e}Wd(n,!0,i,null,h,l);break;case"together":Wd(n,!1,null,null,void 0,l);break;default:n.memoizedState=null}return n.child}function ra(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),Ua|=n.lanes,(i&n.childLanes)===0)if(e!==null){if(cr(e,n,i,!1),(i&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(o(153));if(n.child!==null){for(e=n.child,i=Jn(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=Jn(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function Kd(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&ml(e)))}function J2(e,n,i){switch(n.tag){case 3:V(n,n.stateNode.containerInfo),za(n,rt,e.memoizedState.cache),vs();break;case 27:case 5:he(n);break;case 4:V(n,n.stateNode.containerInfo);break;case 10:za(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Nd(n),null;break;case 13:var l=n.memoizedState;if(l!==null)return l.dehydrated!==null?(La(n),n.flags|=128,null):(i&n.child.childLanes)!==0?D0(e,n,i):(La(n),e=ra(e,n,i),e!==null?e.sibling:null);La(n);break;case 19:var f=(e.flags&128)!==0;if(l=(i&n.childLanes)!==0,l||(cr(e,n,i,!1),l=(i&n.childLanes)!==0),f){if(l)return B0(e,n,i);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ne(tt,tt.current),l)break;return null;case 22:return n.lanes=0,T0(e,n,i,n.pendingProps);case 24:za(n,rt,e.memoizedState.cache)}return ra(e,n,i)}function L0(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps)ot=!0;else{if(!Kd(e,i)&&(n.flags&128)===0)return ot=!1,J2(e,n,i);ot=(e.flags&131072)!==0}else ot=!1,De&&(n.flags&1048576)!==0&&pp(n,ji,n.index);switch(n.lanes=0,n.tag){case 16:e:{var l=n.pendingProps;if(e=Ss(n.elementType),n.type=e,typeof e=="function")ad(e)?(l=Ts(e,l),n.tag=1,n=R0(null,n,e,l,i)):(n.tag=0,n=Id(null,n,e,l,i));else{if(e!=null){var f=e.$$typeof;if(f===A){n.tag=11,n=_0(null,n,e,l,i);break e}else if(f===M){n.tag=14,n=E0(null,n,e,l,i);break e}}throw n=$(e)||e,Error(o(306,n,""))}}return n;case 0:return Id(e,n,n.type,n.pendingProps,i);case 1:return l=n.type,f=Ts(l,n.pendingProps),R0(e,n,l,f,i);case 3:e:{if(V(n,n.stateNode.containerInfo),e===null)throw Error(o(387));l=n.pendingProps;var h=n.memoizedState;f=h.element,yd(e,n),Ai(n,l,null,i);var v=n.memoizedState;if(l=v.cache,za(n,rt,l),l!==h.cache&&fd(n,[rt],i,!0),Mi(),l=v.element,h.isDehydrated)if(h={element:l,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=h,n.memoizedState=h,n.flags&256){n=z0(e,n,l,i);break e}else if(l!==f){f=tn(Error(o(424)),n),Ni(f),n=z0(e,n,l,i);break e}else for(e=n.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Ge=on(e.firstChild),bt=n,De=!0,ka=null,sn=!0,i=Tp(n,null,l,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(vs(),l===f){n=ra(e,n,i);break e}wt(e,n,l,i)}n=n.child}return n;case 26:return zl(e,n),e===null?(i=Qg(n.type,null,n.pendingProps,null))?n.memoizedState=i:De||(i=n.type,e=n.pendingProps,l=Zl(de.current).createElement(i),l[dt]=n,l[Nt]=e,jt(l,i,e),st(l),n.stateNode=l):n.memoizedState=Qg(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return he(n),e===null&&De&&(l=n.stateNode=Ig(n.type,n.pendingProps,de.current),bt=n,sn=!0,f=Ge,Xa(n.type)?(Rf=f,Ge=on(l.firstChild)):Ge=f),wt(e,n,n.pendingProps.children,i),zl(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&De&&((f=l=Ge)&&(l=Mw(l,n.type,n.pendingProps,sn),l!==null?(n.stateNode=l,bt=n,Ge=on(l.firstChild),sn=!1,f=!0):f=!1),f||Ra(n)),he(n),f=n.type,h=n.pendingProps,v=e!==null?e.memoizedProps:null,l=h.children,Cf(f,h)?l=null:v!==null&&Cf(f,v)&&(n.flags|=32),n.memoizedState!==null&&(f=_d(e,n,P2,null,null,i),Zi._currentValue=f),zl(e,n),wt(e,n,l,i),n.child;case 6:return e===null&&De&&((e=i=Ge)&&(i=Aw(i,n.pendingProps,sn),i!==null?(n.stateNode=i,bt=n,Ge=null,e=!0):e=!1),e||Ra(n)),null;case 13:return D0(e,n,i);case 4:return V(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Es(n,null,l,i):wt(e,n,l,i),n.child;case 11:return _0(e,n,n.type,n.pendingProps,i);case 7:return wt(e,n,n.pendingProps,i),n.child;case 8:return wt(e,n,n.pendingProps.children,i),n.child;case 12:return wt(e,n,n.pendingProps.children,i),n.child;case 10:return l=n.pendingProps,za(n,n.type,l.value),wt(e,n,l.children,i),n.child;case 9:return f=n.type._context,l=n.pendingProps.children,js(n),f=vt(f),l=l(f),n.flags|=1,wt(e,n,l,i),n.child;case 14:return E0(e,n,n.type,n.pendingProps,i);case 15:return C0(e,n,n.type,n.pendingProps,i);case 19:return B0(e,n,i);case 31:return K2(e,n,i);case 22:return T0(e,n,i,n.pendingProps);case 24:return js(n),l=vt(rt),e===null?(f=pd(),f===null&&(f=Xe,h=hd(),f.pooledCache=h,h.refCount++,h!==null&&(f.pooledCacheLanes|=i),f=h),n.memoizedState={parent:l,cache:f},xd(n),za(n,rt,f)):((e.lanes&i)!==0&&(yd(e,n),Ai(n,null,null,i),Mi()),f=e.memoizedState,h=n.memoizedState,f.parent!==l?(f={parent:l,cache:l},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),za(n,rt,l)):(l=h.cache,za(n,rt,l),l!==f.cache&&fd(n,[rt],i,!0))),wt(e,n,n.pendingProps.children,i),n.child;case 29:throw n.pendingProps}throw Error(o(156,n.tag))}function ia(e){e.flags|=4}function Jd(e,n,i,l,f){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(ug())e.flags|=8192;else throw _s=yl,gd}else e.flags&=-16777217}function H0(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Jg(n))if(ug())e.flags|=8192;else throw _s=yl,gd}function Ol(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Uo():536870912,e.lanes|=n,wr|=n)}function Bi(e,n){if(!De)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Qe(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(n)for(var f=e.child;f!==null;)i|=f.lanes|f.childLanes,l|=f.subtreeFlags&65011712,l|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)i|=f.lanes|f.childLanes,l|=f.subtreeFlags,l|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=l,e.childLanes=i,n}function ew(e,n,i){var l=n.pendingProps;switch(od(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qe(n),null;case 1:return Qe(n),null;case 3:return i=n.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),na(rt),ce(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(lr(n)?ia(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,cd())),Qe(n),null;case 26:var f=n.type,h=n.memoizedState;return e===null?(ia(n),h!==null?(Qe(n),H0(n,h)):(Qe(n),Jd(n,f,null,l,i))):h?h!==e.memoizedState?(ia(n),Qe(n),H0(n,h)):(Qe(n),n.flags&=-16777217):(e=e.memoizedProps,e!==l&&ia(n),Qe(n),Jd(n,f,e,l,i)),null;case 27:if(ve(n),i=de.current,f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&ia(n);else{if(!l){if(n.stateNode===null)throw Error(o(166));return Qe(n),null}e=se.current,lr(n)?xp(n):(e=Ig(f,l,i),n.stateNode=e,ia(n))}return Qe(n),null;case 5:if(ve(n),f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&ia(n);else{if(!l){if(n.stateNode===null)throw Error(o(166));return Qe(n),null}if(h=se.current,lr(n))xp(n);else{var v=Zl(de.current);switch(h){case 1:h=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:h=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":h=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":h=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":h=v.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof l.is=="string"?v.createElement("select",{is:l.is}):v.createElement("select"),l.multiple?h.multiple=!0:l.size&&(h.size=l.size);break;default:h=typeof l.is=="string"?v.createElement(f,{is:l.is}):v.createElement(f)}}h[dt]=n,h[Nt]=l;e:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)h.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break e;for(;v.sibling===null;){if(v.return===null||v.return===n)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=h;e:switch(jt(h,f,l),f){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&ia(n)}}return Qe(n),Jd(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,i),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==l&&ia(n);else{if(typeof l!="string"&&n.stateNode===null)throw Error(o(166));if(e=de.current,lr(n)){if(e=n.stateNode,i=n.memoizedProps,l=null,f=bt,f!==null)switch(f.tag){case 27:case 5:l=f.memoizedProps}e[dt]=n,e=!!(e.nodeValue===i||l!==null&&l.suppressHydrationWarning===!0||Dg(e.nodeValue,i)),e||Ra(n,!0)}else e=Zl(e).createTextNode(l),e[dt]=n,n.stateNode=e}return Qe(n),null;case 31:if(i=n.memoizedState,e===null||e.memoizedState!==null){if(l=lr(n),i!==null){if(e===null){if(!l)throw Error(o(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[dt]=n}else vs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Qe(n),e=!1}else i=cd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),e=!0;if(!e)return n.flags&256?(Pt(n),n):(Pt(n),null);if((n.flags&128)!==0)throw Error(o(558))}return Qe(n),null;case 13:if(l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=lr(n),l!==null&&l.dehydrated!==null){if(e===null){if(!f)throw Error(o(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));f[dt]=n}else vs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Qe(n),f=!1}else f=cd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return n.flags&256?(Pt(n),n):(Pt(n),null)}return Pt(n),(n.flags&128)!==0?(n.lanes=i,n):(i=l!==null,e=e!==null&&e.memoizedState!==null,i&&(l=n.child,f=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(f=l.alternate.memoizedState.cachePool.pool),h=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(h=l.memoizedState.cachePool.pool),h!==f&&(l.flags|=2048)),i!==e&&i&&(n.child.flags|=8192),Ol(n,n.updateQueue),Qe(n),null);case 4:return ce(),e===null&&jf(n.stateNode.containerInfo),Qe(n),null;case 10:return na(n.type),Qe(n),null;case 19:if(P(tt),l=n.memoizedState,l===null)return Qe(n),null;if(f=(n.flags&128)!==0,h=l.rendering,h===null)if(f)Bi(l,!1);else{if(et!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(h=jl(e),h!==null){for(n.flags|=128,Bi(l,!1),e=h.updateQueue,n.updateQueue=e,Ol(n,e),n.subtreeFlags=0,e=i,i=n.child;i!==null;)fp(i,e),i=i.sibling;return ne(tt,tt.current&1|2),De&&ea(n,l.treeForkCount),n.child}e=e.sibling}l.tail!==null&&at()>ql&&(n.flags|=128,f=!0,Bi(l,!1),n.lanes=4194304)}else{if(!f)if(e=jl(h),e!==null){if(n.flags|=128,f=!0,e=e.updateQueue,n.updateQueue=e,Ol(n,e),Bi(l,!0),l.tail===null&&l.tailMode==="hidden"&&!h.alternate&&!De)return Qe(n),null}else 2*at()-l.renderingStartTime>ql&&i!==536870912&&(n.flags|=128,f=!0,Bi(l,!1),n.lanes=4194304);l.isBackwards?(h.sibling=n.child,n.child=h):(e=l.last,e!==null?e.sibling=h:n.child=h,l.last=h)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=at(),e.sibling=null,i=tt.current,ne(tt,f?i&1|2:i&1),De&&ea(n,l.treeForkCount),e):(Qe(n),null);case 22:case 23:return Pt(n),jd(),l=n.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(n.flags|=8192):l&&(n.flags|=8192),l?(i&536870912)!==0&&(n.flags&128)===0&&(Qe(n),n.subtreeFlags&6&&(n.flags|=8192)):Qe(n),i=n.updateQueue,i!==null&&Ol(n,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),l=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),l!==i&&(n.flags|=2048),e!==null&&P(Ns),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),n.memoizedState.cache!==i&&(n.flags|=2048),na(rt),Qe(n),null;case 25:return null;case 30:return null}throw Error(o(156,n.tag))}function tw(e,n){switch(od(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return na(rt),ce(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return ve(n),null;case 31:if(n.memoizedState!==null){if(Pt(n),n.alternate===null)throw Error(o(340));vs()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(Pt(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(o(340));vs()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return P(tt),null;case 4:return ce(),null;case 10:return na(n.type),null;case 22:case 23:return Pt(n),jd(),e!==null&&P(Ns),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return na(rt),null;case 25:return null;default:return null}}function $0(e,n){switch(od(n),n.tag){case 3:na(rt),ce();break;case 26:case 27:case 5:ve(n);break;case 4:ce();break;case 31:n.memoizedState!==null&&Pt(n);break;case 13:Pt(n);break;case 19:P(tt);break;case 10:na(n.type);break;case 22:case 23:Pt(n),jd(),e!==null&&P(Ns);break;case 24:na(rt)}}function Li(e,n){try{var i=n.updateQueue,l=i!==null?i.lastEffect:null;if(l!==null){var f=l.next;i=f;do{if((i.tag&e)===e){l=void 0;var h=i.create,v=i.inst;l=h(),v.destroy=l}i=i.next}while(i!==f)}}catch(k){Ue(n,n.return,k)}}function $a(e,n,i){try{var l=n.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var h=f.next;l=h;do{if((l.tag&e)===e){var v=l.inst,k=v.destroy;if(k!==void 0){v.destroy=void 0,f=n;var Y=i,J=k;try{J()}catch(ie){Ue(f,Y,ie)}}}l=l.next}while(l!==h)}}catch(ie){Ue(n,n.return,ie)}}function q0(e){var n=e.updateQueue;if(n!==null){var i=e.stateNode;try{Ap(n,i)}catch(l){Ue(e,e.return,l)}}}function U0(e,n,i){i.props=Ts(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(l){Ue(e,n,l)}}function Hi(e,n){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof i=="function"?e.refCleanup=i(l):i.current=l}}catch(f){Ue(e,n,f)}}function Rn(e,n){var i=e.ref,l=e.refCleanup;if(i!==null)if(typeof l=="function")try{l()}catch(f){Ue(e,n,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(f){Ue(e,n,f)}else i.current=null}function V0(e){var n=e.type,i=e.memoizedProps,l=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":i.autoFocus&&l.focus();break e;case"img":i.src?l.src=i.src:i.srcSet&&(l.srcset=i.srcSet)}}catch(f){Ue(e,e.return,f)}}function ef(e,n,i){try{var l=e.stateNode;Nw(l,e.type,i,n),l[Nt]=n}catch(f){Ue(e,e.return,f)}}function Y0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Xa(e.type)||e.tag===4}function tf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Y0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Xa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function nf(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,n):(n=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,n.appendChild(e),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=Wn));else if(l!==4&&(l===27&&Xa(e.type)&&(i=e.stateNode,n=null),e=e.child,e!==null))for(nf(e,n,i),e=e.sibling;e!==null;)nf(e,n,i),e=e.sibling}function Bl(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(l!==4&&(l===27&&Xa(e.type)&&(i=e.stateNode),e=e.child,e!==null))for(Bl(e,n,i),e=e.sibling;e!==null;)Bl(e,n,i),e=e.sibling}function P0(e){var n=e.stateNode,i=e.memoizedProps;try{for(var l=e.type,f=n.attributes;f.length;)n.removeAttributeNode(f[0]);jt(n,l,i),n[dt]=e,n[Nt]=i}catch(h){Ue(e,e.return,h)}}var oa=!1,lt=!1,af=!1,I0=typeof WeakSet=="function"?WeakSet:Set,gt=null;function nw(e,n){if(e=e.containerInfo,_f=ac,e=ap(e),Zu(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var f=l.anchorOffset,h=l.focusNode;l=l.focusOffset;try{i.nodeType,h.nodeType}catch{i=null;break e}var v=0,k=-1,Y=-1,J=0,ie=0,le=e,ee=null;t:for(;;){for(var ae;le!==i||f!==0&&le.nodeType!==3||(k=v+f),le!==h||l!==0&&le.nodeType!==3||(Y=v+l),le.nodeType===3&&(v+=le.nodeValue.length),(ae=le.firstChild)!==null;)ee=le,le=ae;for(;;){if(le===e)break t;if(ee===i&&++J===f&&(k=v),ee===h&&++ie===l&&(Y=v),(ae=le.nextSibling)!==null)break;le=ee,ee=le.parentNode}le=ae}i=k===-1||Y===-1?null:{start:k,end:Y}}else i=null}i=i||{start:0,end:0}}else i=null;for(Ef={focusedElem:e,selectionRange:i},ac=!1,gt=n;gt!==null;)if(n=gt,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,gt=e;else for(;gt!==null;){switch(n=gt,h=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(i=0;i<e.length;i++)f=e[i],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,i=n,f=h.memoizedProps,h=h.memoizedState,l=i.stateNode;try{var fe=Ts(i.type,f);e=l.getSnapshotBeforeUpdate(fe,h),l.__reactInternalSnapshotBeforeUpdate=e}catch(we){Ue(i,i.return,we)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,i=e.nodeType,i===9)Mf(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Mf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=n.sibling,e!==null){e.return=n.return,gt=e;break}gt=n.return}}function X0(e,n,i){var l=i.flags;switch(i.tag){case 0:case 11:case 15:ca(e,i),l&4&&Li(5,i);break;case 1:if(ca(e,i),l&4)if(e=i.stateNode,n===null)try{e.componentDidMount()}catch(v){Ue(i,i.return,v)}else{var f=Ts(i.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(f,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Ue(i,i.return,v)}}l&64&&q0(i),l&512&&Hi(i,i.return);break;case 3:if(ca(e,i),l&64&&(e=i.updateQueue,e!==null)){if(n=null,i.child!==null)switch(i.child.tag){case 27:case 5:n=i.child.stateNode;break;case 1:n=i.child.stateNode}try{Ap(e,n)}catch(v){Ue(i,i.return,v)}}break;case 27:n===null&&l&4&&P0(i);case 26:case 5:ca(e,i),n===null&&l&4&&V0(i),l&512&&Hi(i,i.return);break;case 12:ca(e,i);break;case 31:ca(e,i),l&4&&F0(e,i);break;case 13:ca(e,i),l&4&&Z0(e,i),l&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=dw.bind(null,i),kw(e,i))));break;case 22:if(l=i.memoizedState!==null||oa,!l){n=n!==null&&n.memoizedState!==null||lt,f=oa;var h=lt;oa=l,(lt=n)&&!h?ua(e,i,(i.subtreeFlags&8772)!==0):ca(e,i),oa=f,lt=h}break;case 30:break;default:ca(e,i)}}function G0(e){var n=e.alternate;n!==null&&(e.alternate=null,G0(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&ui(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Fe=null,Dt=!1;function la(e,n,i){for(i=i.child;i!==null;)Q0(e,n,i),i=i.sibling}function Q0(e,n,i){if(Ct&&typeof Ct.onCommitFiberUnmount=="function")try{Ct.onCommitFiberUnmount(cs,i)}catch{}switch(i.tag){case 26:lt||Rn(i,n),la(e,n,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:lt||Rn(i,n);var l=Fe,f=Dt;Xa(i.type)&&(Fe=i.stateNode,Dt=!1),la(e,n,i),Gi(i.stateNode),Fe=l,Dt=f;break;case 5:lt||Rn(i,n);case 6:if(l=Fe,f=Dt,Fe=null,la(e,n,i),Fe=l,Dt=f,Fe!==null)if(Dt)try{(Fe.nodeType===9?Fe.body:Fe.nodeName==="HTML"?Fe.ownerDocument.body:Fe).removeChild(i.stateNode)}catch(h){Ue(i,n,h)}else try{Fe.removeChild(i.stateNode)}catch(h){Ue(i,n,h)}break;case 18:Fe!==null&&(Dt?(e=Fe,qg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),Mr(e)):qg(Fe,i.stateNode));break;case 4:l=Fe,f=Dt,Fe=i.stateNode.containerInfo,Dt=!0,la(e,n,i),Fe=l,Dt=f;break;case 0:case 11:case 14:case 15:$a(2,i,n),lt||$a(4,i,n),la(e,n,i);break;case 1:lt||(Rn(i,n),l=i.stateNode,typeof l.componentWillUnmount=="function"&&U0(i,n,l)),la(e,n,i);break;case 21:la(e,n,i);break;case 22:lt=(l=lt)||i.memoizedState!==null,la(e,n,i),lt=l;break;default:la(e,n,i)}}function F0(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Mr(e)}catch(i){Ue(n,n.return,i)}}}function Z0(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Mr(e)}catch(i){Ue(n,n.return,i)}}function aw(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new I0),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new I0),n;default:throw Error(o(435,e.tag))}}function Ll(e,n){var i=aw(e);n.forEach(function(l){if(!i.has(l)){i.add(l);var f=fw.bind(null,e,l);l.then(f,f)}})}function Ot(e,n){var i=n.deletions;if(i!==null)for(var l=0;l<i.length;l++){var f=i[l],h=e,v=n,k=v;e:for(;k!==null;){switch(k.tag){case 27:if(Xa(k.type)){Fe=k.stateNode,Dt=!1;break e}break;case 5:Fe=k.stateNode,Dt=!1;break e;case 3:case 4:Fe=k.stateNode.containerInfo,Dt=!0;break e}k=k.return}if(Fe===null)throw Error(o(160));Q0(h,v,f),Fe=null,Dt=!1,h=f.alternate,h!==null&&(h.return=null),f.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)W0(n,e),n=n.sibling}var yn=null;function W0(e,n){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ot(n,e),Bt(e),l&4&&($a(3,e,e.return),Li(3,e),$a(5,e,e.return));break;case 1:Ot(n,e),Bt(e),l&512&&(lt||i===null||Rn(i,i.return)),l&64&&oa&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?l:i.concat(l))));break;case 26:var f=yn;if(Ot(n,e),Bt(e),l&512&&(lt||i===null||Rn(i,i.return)),l&4){var h=i!==null?i.memoizedState:null;if(l=e.memoizedState,i===null)if(l===null)if(e.stateNode===null){e:{l=e.type,i=e.memoizedProps,f=f.ownerDocument||f;t:switch(l){case"title":h=f.getElementsByTagName("title")[0],(!h||h[fs]||h[dt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=f.createElement(l),f.head.insertBefore(h,f.querySelector("head > title"))),jt(h,l,i),h[dt]=e,st(h),l=h;break e;case"link":var v=Wg("link","href",f).get(l+(i.href||""));if(v){for(var k=0;k<v.length;k++)if(h=v[k],h.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&h.getAttribute("rel")===(i.rel==null?null:i.rel)&&h.getAttribute("title")===(i.title==null?null:i.title)&&h.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){v.splice(k,1);break t}}h=f.createElement(l),jt(h,l,i),f.head.appendChild(h);break;case"meta":if(v=Wg("meta","content",f).get(l+(i.content||""))){for(k=0;k<v.length;k++)if(h=v[k],h.getAttribute("content")===(i.content==null?null:""+i.content)&&h.getAttribute("name")===(i.name==null?null:i.name)&&h.getAttribute("property")===(i.property==null?null:i.property)&&h.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&h.getAttribute("charset")===(i.charSet==null?null:i.charSet)){v.splice(k,1);break t}}h=f.createElement(l),jt(h,l,i),f.head.appendChild(h);break;default:throw Error(o(468,l))}h[dt]=e,st(h),l=h}e.stateNode=l}else Kg(f,e.type,e.stateNode);else e.stateNode=Zg(f,l,e.memoizedProps);else h!==l?(h===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):h.count--,l===null?Kg(f,e.type,e.stateNode):Zg(f,l,e.memoizedProps)):l===null&&e.stateNode!==null&&ef(e,e.memoizedProps,i.memoizedProps)}break;case 27:Ot(n,e),Bt(e),l&512&&(lt||i===null||Rn(i,i.return)),i!==null&&l&4&&ef(e,e.memoizedProps,i.memoizedProps);break;case 5:if(Ot(n,e),Bt(e),l&512&&(lt||i===null||Rn(i,i.return)),e.flags&32){f=e.stateNode;try{Ks(f,"")}catch(fe){Ue(e,e.return,fe)}}l&4&&e.stateNode!=null&&(f=e.memoizedProps,ef(e,f,i!==null?i.memoizedProps:f)),l&1024&&(af=!0);break;case 6:if(Ot(n,e),Bt(e),l&4){if(e.stateNode===null)throw Error(o(162));l=e.memoizedProps,i=e.stateNode;try{i.nodeValue=l}catch(fe){Ue(e,e.return,fe)}}break;case 3:if(Jl=null,f=yn,yn=Wl(n.containerInfo),Ot(n,e),yn=f,Bt(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{Mr(n.containerInfo)}catch(fe){Ue(e,e.return,fe)}af&&(af=!1,K0(e));break;case 4:l=yn,yn=Wl(e.stateNode.containerInfo),Ot(n,e),Bt(e),yn=l;break;case 12:Ot(n,e),Bt(e);break;case 31:Ot(n,e),Bt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ll(e,l)));break;case 13:Ot(n,e),Bt(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&($l=at()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ll(e,l)));break;case 22:f=e.memoizedState!==null;var Y=i!==null&&i.memoizedState!==null,J=oa,ie=lt;if(oa=J||f,lt=ie||Y,Ot(n,e),lt=ie,oa=J,Bt(e),l&8192)e:for(n=e.stateNode,n._visibility=f?n._visibility&-2:n._visibility|1,f&&(i===null||Y||oa||lt||Ms(e)),i=null,n=e;;){if(n.tag===5||n.tag===26){if(i===null){Y=i=n;try{if(h=Y.stateNode,f)v=h.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{k=Y.stateNode;var le=Y.memoizedProps.style,ee=le!=null&&le.hasOwnProperty("display")?le.display:null;k.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(fe){Ue(Y,Y.return,fe)}}}else if(n.tag===6){if(i===null){Y=n;try{Y.stateNode.nodeValue=f?"":Y.memoizedProps}catch(fe){Ue(Y,Y.return,fe)}}}else if(n.tag===18){if(i===null){Y=n;try{var ae=Y.stateNode;f?Ug(ae,!0):Ug(Y.stateNode,!1)}catch(fe){Ue(Y,Y.return,fe)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;i===n&&(i=null),n=n.return}i===n&&(i=null),n.sibling.return=n.return,n=n.sibling}l&4&&(l=e.updateQueue,l!==null&&(i=l.retryQueue,i!==null&&(l.retryQueue=null,Ll(e,i))));break;case 19:Ot(n,e),Bt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ll(e,l)));break;case 30:break;case 21:break;default:Ot(n,e),Bt(e)}}function Bt(e){var n=e.flags;if(n&2){try{for(var i,l=e.return;l!==null;){if(Y0(l)){i=l;break}l=l.return}if(i==null)throw Error(o(160));switch(i.tag){case 27:var f=i.stateNode,h=tf(e);Bl(e,h,f);break;case 5:var v=i.stateNode;i.flags&32&&(Ks(v,""),i.flags&=-33);var k=tf(e);Bl(e,k,v);break;case 3:case 4:var Y=i.stateNode.containerInfo,J=tf(e);nf(e,J,Y);break;default:throw Error(o(161))}}catch(ie){Ue(e,e.return,ie)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function K0(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;K0(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function ca(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)X0(e,n.alternate,n),n=n.sibling}function Ms(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:$a(4,n,n.return),Ms(n);break;case 1:Rn(n,n.return);var i=n.stateNode;typeof i.componentWillUnmount=="function"&&U0(n,n.return,i),Ms(n);break;case 27:Gi(n.stateNode);case 26:case 5:Rn(n,n.return),Ms(n);break;case 22:n.memoizedState===null&&Ms(n);break;case 30:Ms(n);break;default:Ms(n)}e=e.sibling}}function ua(e,n,i){for(i=i&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var l=n.alternate,f=e,h=n,v=h.flags;switch(h.tag){case 0:case 11:case 15:ua(f,h,i),Li(4,h);break;case 1:if(ua(f,h,i),l=h,f=l.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(J){Ue(l,l.return,J)}if(l=h,f=l.updateQueue,f!==null){var k=l.stateNode;try{var Y=f.shared.hiddenCallbacks;if(Y!==null)for(f.shared.hiddenCallbacks=null,f=0;f<Y.length;f++)Mp(Y[f],k)}catch(J){Ue(l,l.return,J)}}i&&v&64&&q0(h),Hi(h,h.return);break;case 27:P0(h);case 26:case 5:ua(f,h,i),i&&l===null&&v&4&&V0(h),Hi(h,h.return);break;case 12:ua(f,h,i);break;case 31:ua(f,h,i),i&&v&4&&F0(f,h);break;case 13:ua(f,h,i),i&&v&4&&Z0(f,h);break;case 22:h.memoizedState===null&&ua(f,h,i),Hi(h,h.return);break;case 30:break;default:ua(f,h,i)}n=n.sibling}}function sf(e,n){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&Si(i))}function rf(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Si(e))}function bn(e,n,i,l){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)J0(e,n,i,l),n=n.sibling}function J0(e,n,i,l){var f=n.flags;switch(n.tag){case 0:case 11:case 15:bn(e,n,i,l),f&2048&&Li(9,n);break;case 1:bn(e,n,i,l);break;case 3:bn(e,n,i,l),f&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Si(e)));break;case 12:if(f&2048){bn(e,n,i,l),e=n.stateNode;try{var h=n.memoizedProps,v=h.id,k=h.onPostCommit;typeof k=="function"&&k(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(Y){Ue(n,n.return,Y)}}else bn(e,n,i,l);break;case 31:bn(e,n,i,l);break;case 13:bn(e,n,i,l);break;case 23:break;case 22:h=n.stateNode,v=n.alternate,n.memoizedState!==null?h._visibility&2?bn(e,n,i,l):$i(e,n):h._visibility&2?bn(e,n,i,l):(h._visibility|=2,yr(e,n,i,l,(n.subtreeFlags&10256)!==0||!1)),f&2048&&sf(v,n);break;case 24:bn(e,n,i,l),f&2048&&rf(n.alternate,n);break;default:bn(e,n,i,l)}}function yr(e,n,i,l,f){for(f=f&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var h=e,v=n,k=i,Y=l,J=v.flags;switch(v.tag){case 0:case 11:case 15:yr(h,v,k,Y,f),Li(8,v);break;case 23:break;case 22:var ie=v.stateNode;v.memoizedState!==null?ie._visibility&2?yr(h,v,k,Y,f):$i(h,v):(ie._visibility|=2,yr(h,v,k,Y,f)),f&&J&2048&&sf(v.alternate,v);break;case 24:yr(h,v,k,Y,f),f&&J&2048&&rf(v.alternate,v);break;default:yr(h,v,k,Y,f)}n=n.sibling}}function $i(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var i=e,l=n,f=l.flags;switch(l.tag){case 22:$i(i,l),f&2048&&sf(l.alternate,l);break;case 24:$i(i,l),f&2048&&rf(l.alternate,l);break;default:$i(i,l)}n=n.sibling}}var qi=8192;function br(e,n,i){if(e.subtreeFlags&qi)for(e=e.child;e!==null;)eg(e,n,i),e=e.sibling}function eg(e,n,i){switch(e.tag){case 26:br(e,n,i),e.flags&qi&&e.memoizedState!==null&&Yw(i,yn,e.memoizedState,e.memoizedProps);break;case 5:br(e,n,i);break;case 3:case 4:var l=yn;yn=Wl(e.stateNode.containerInfo),br(e,n,i),yn=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=qi,qi=16777216,br(e,n,i),qi=l):br(e,n,i));break;default:br(e,n,i)}}function tg(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Ui(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];gt=l,ag(l,e)}tg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ng(e),e=e.sibling}function ng(e){switch(e.tag){case 0:case 11:case 15:Ui(e),e.flags&2048&&$a(9,e,e.return);break;case 3:Ui(e);break;case 12:Ui(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,Hl(e)):Ui(e);break;default:Ui(e)}}function Hl(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];gt=l,ag(l,e)}tg(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:$a(8,n,n.return),Hl(n);break;case 22:i=n.stateNode,i._visibility&2&&(i._visibility&=-3,Hl(n));break;default:Hl(n)}e=e.sibling}}function ag(e,n){for(;gt!==null;){var i=gt;switch(i.tag){case 0:case 11:case 15:$a(8,i,n);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var l=i.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Si(i.memoizedState.cache)}if(l=i.child,l!==null)l.return=i,gt=l;else e:for(i=e;gt!==null;){l=gt;var f=l.sibling,h=l.return;if(G0(l),l===i){gt=null;break e}if(f!==null){f.return=h,gt=f;break e}gt=h}}}var sw={getCacheForType:function(e){var n=vt(rt),i=n.data.get(e);return i===void 0&&(i=e(),n.data.set(e,i)),i},cacheSignal:function(){return vt(rt).controller.signal}},rw=typeof WeakMap=="function"?WeakMap:Map,He=0,Xe=null,Te=null,ke=0,qe=0,It=null,qa=!1,vr=!1,of=!1,da=0,et=0,Ua=0,As=0,lf=0,Xt=0,wr=0,Vi=null,Lt=null,cf=!1,$l=0,sg=0,ql=1/0,Ul=null,Va=null,ft=0,Ya=null,jr=null,fa=0,uf=0,df=null,rg=null,Yi=0,ff=null;function Gt(){return(He&2)!==0&&ke!==0?ke&-ke:O.T!==null?yf():Io()}function ig(){if(Xt===0)if((ke&536870912)===0||De){var e=Is;Is<<=1,(Is&3932160)===0&&(Is=262144),Xt=e}else Xt=536870912;return e=Yt.current,e!==null&&(e.flags|=32),Xt}function Ht(e,n,i){(e===Xe&&(qe===2||qe===9)||e.cancelPendingCommit!==null)&&(Nr(e,0),Pa(e,ke,Xt,!1)),ds(e,i),((He&2)===0||e!==Xe)&&(e===Xe&&((He&2)===0&&(As|=i),et===4&&Pa(e,ke,Xt,!1)),zn(e))}function og(e,n,i){if((He&6)!==0)throw Error(o(327));var l=!i&&(n&127)===0&&(n&e.expiredLanes)===0||us(e,n),f=l?lw(e,n):mf(e,n,!0),h=l;do{if(f===0){vr&&!l&&Pa(e,n,0,!1);break}else{if(i=e.current.alternate,h&&!iw(i)){f=mf(e,n,!1),h=!1;continue}if(f===2){if(h=n,e.errorRecoveryDisabledLanes&h)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;e:{var k=e;f=Vi;var Y=k.current.memoizedState.isDehydrated;if(Y&&(Nr(k,v).flags|=256),v=mf(k,v,!1),v!==2){if(of&&!Y){k.errorRecoveryDisabledLanes|=h,As|=h,f=4;break e}h=Lt,Lt=f,h!==null&&(Lt===null?Lt=h:Lt.push.apply(Lt,h))}f=v}if(h=!1,f!==2)continue}}if(f===1){Nr(e,0),Pa(e,n,0,!0);break}e:{switch(l=e,h=f,h){case 0:case 1:throw Error(o(345));case 4:if((n&4194048)!==n)break;case 6:Pa(l,n,Xt,!qa);break e;case 2:Lt=null;break;case 3:case 5:break;default:throw Error(o(329))}if((n&62914560)===n&&(f=$l+300-at(),10<f)){if(Pa(l,n,Xt,!qa),Gs(l,0,!0)!==0)break e;fa=n,l.timeoutHandle=Hg(lg.bind(null,l,i,Lt,Ul,cf,n,Xt,As,wr,qa,h,"Throttled",-0,0),f);break e}lg(l,i,Lt,Ul,cf,n,Xt,As,wr,qa,h,null,-0,0)}}break}while(!0);zn(e)}function lg(e,n,i,l,f,h,v,k,Y,J,ie,le,ee,ae){if(e.timeoutHandle=-1,le=n.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Wn},eg(n,h,le);var fe=(h&62914560)===h?$l-at():(h&4194048)===h?sg-at():0;if(fe=Pw(le,fe),fe!==null){fa=h,e.cancelPendingCommit=fe(gg.bind(null,e,n,h,i,l,f,v,k,Y,ie,le,null,ee,ae)),Pa(e,h,v,!J);return}}gg(e,n,h,i,l,f,v,k,Y)}function iw(e){for(var n=e;;){var i=n.tag;if((i===0||i===11||i===15)&&n.flags&16384&&(i=n.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var l=0;l<i.length;l++){var f=i[l],h=f.getSnapshot;f=f.value;try{if(!Ut(h(),f))return!1}catch{return!1}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Pa(e,n,i,l){n&=~lf,n&=~As,e.suspendedLanes|=n,e.pingedLanes&=~n,l&&(e.warmLanes|=n),l=e.expirationTimes;for(var f=n;0<f;){var h=31-Tt(f),v=1<<h;l[h]=-1,f&=~v}i!==0&&Vo(e,i,n)}function Vl(){return(He&6)===0?(Pi(0),!1):!0}function hf(){if(Te!==null){if(qe===0)var e=Te.return;else e=Te,ta=ws=null,Td(e),hr=null,Ei=0,e=Te;for(;e!==null;)$0(e.alternate,e),e=e.return;Te=null}}function Nr(e,n){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,Ew(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),fa=0,hf(),Xe=e,Te=i=Jn(e.current,null),ke=n,qe=0,It=null,qa=!1,vr=us(e,n),of=!1,wr=Xt=lf=As=Ua=et=0,Lt=Vi=null,cf=!1,(n&8)!==0&&(n|=n&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=n;0<l;){var f=31-Tt(l),h=1<<f;n|=e[f],l&=~h}return da=n,cl(),i}function cg(e,n){Ne=null,O.H=Di,n===fr||n===xl?(n=_p(),qe=3):n===gd?(n=_p(),qe=4):qe=n===Pd?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,It=n,Te===null&&(et=1,kl(e,tn(n,e.current)))}function ug(){var e=Yt.current;return e===null?!0:(ke&4194048)===ke?rn===null:(ke&62914560)===ke||(ke&536870912)!==0?e===rn:!1}function dg(){var e=O.H;return O.H=Di,e===null?Di:e}function fg(){var e=O.A;return O.A=sw,e}function Yl(){et=4,qa||(ke&4194048)!==ke&&Yt.current!==null||(vr=!0),(Ua&134217727)===0&&(As&134217727)===0||Xe===null||Pa(Xe,ke,Xt,!1)}function mf(e,n,i){var l=He;He|=2;var f=dg(),h=fg();(Xe!==e||ke!==n)&&(Ul=null,Nr(e,n)),n=!1;var v=et;e:do try{if(qe!==0&&Te!==null){var k=Te,Y=It;switch(qe){case 8:hf(),v=6;break e;case 3:case 2:case 9:case 6:Yt.current===null&&(n=!0);var J=qe;if(qe=0,It=null,Sr(e,k,Y,J),i&&vr){v=0;break e}break;default:J=qe,qe=0,It=null,Sr(e,k,Y,J)}}ow(),v=et;break}catch(ie){cg(e,ie)}while(!0);return n&&e.shellSuspendCounter++,ta=ws=null,He=l,O.H=f,O.A=h,Te===null&&(Xe=null,ke=0,cl()),v}function ow(){for(;Te!==null;)hg(Te)}function lw(e,n){var i=He;He|=2;var l=dg(),f=fg();Xe!==e||ke!==n?(Ul=null,ql=at()+500,Nr(e,n)):vr=us(e,n);e:do try{if(qe!==0&&Te!==null){n=Te;var h=It;t:switch(qe){case 1:qe=0,It=null,Sr(e,n,h,1);break;case 2:case 9:if(Np(h)){qe=0,It=null,mg(n);break}n=function(){qe!==2&&qe!==9||Xe!==e||(qe=7),zn(e)},h.then(n,n);break e;case 3:qe=7;break e;case 4:qe=5;break e;case 7:Np(h)?(qe=0,It=null,mg(n)):(qe=0,It=null,Sr(e,n,h,7));break;case 5:var v=null;switch(Te.tag){case 26:v=Te.memoizedState;case 5:case 27:var k=Te;if(v?Jg(v):k.stateNode.complete){qe=0,It=null;var Y=k.sibling;if(Y!==null)Te=Y;else{var J=k.return;J!==null?(Te=J,Pl(J)):Te=null}break t}}qe=0,It=null,Sr(e,n,h,5);break;case 6:qe=0,It=null,Sr(e,n,h,6);break;case 8:hf(),et=6;break e;default:throw Error(o(462))}}cw();break}catch(ie){cg(e,ie)}while(!0);return ta=ws=null,O.H=l,O.A=f,He=i,Te!==null?0:(Xe=null,ke=0,cl(),et)}function cw(){for(;Te!==null&&!En();)hg(Te)}function hg(e){var n=L0(e.alternate,e,da);e.memoizedProps=e.pendingProps,n===null?Pl(e):Te=n}function mg(e){var n=e,i=n.alternate;switch(n.tag){case 15:case 0:n=k0(i,n,n.pendingProps,n.type,void 0,ke);break;case 11:n=k0(i,n,n.pendingProps,n.type.render,n.ref,ke);break;case 5:Td(n);default:$0(i,n),n=Te=fp(n,da),n=L0(i,n,da)}e.memoizedProps=e.pendingProps,n===null?Pl(e):Te=n}function Sr(e,n,i,l){ta=ws=null,Td(n),hr=null,Ei=0;var f=n.return;try{if(W2(e,f,n,i,ke)){et=1,kl(e,tn(i,e.current)),Te=null;return}}catch(h){if(f!==null)throw Te=f,h;et=1,kl(e,tn(i,e.current)),Te=null;return}n.flags&32768?(De||l===1?e=!0:vr||(ke&536870912)!==0?e=!1:(qa=e=!0,(l===2||l===9||l===3||l===6)&&(l=Yt.current,l!==null&&l.tag===13&&(l.flags|=16384))),pg(n,e)):Pl(n)}function Pl(e){var n=e;do{if((n.flags&32768)!==0){pg(n,qa);return}e=n.return;var i=ew(n.alternate,n,da);if(i!==null){Te=i;return}if(n=n.sibling,n!==null){Te=n;return}Te=n=e}while(n!==null);et===0&&(et=5)}function pg(e,n){do{var i=tw(e.alternate,e);if(i!==null){i.flags&=32767,Te=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!n&&(e=e.sibling,e!==null)){Te=e;return}Te=e=i}while(e!==null);et=6,Te=null}function gg(e,n,i,l,f,h,v,k,Y){e.cancelPendingCommit=null;do Il();while(ft!==0);if((He&6)!==0)throw Error(o(327));if(n!==null){if(n===e.current)throw Error(o(177));if(h=n.lanes|n.childLanes,h|=td,ku(e,i,h,v,k,Y),e===Xe&&(Te=Xe=null,ke=0),jr=n,Ya=e,fa=i,uf=h,df=f,rg=l,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,hw(In,function(){return wg(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||l){l=O.T,O.T=null,f=z.p,z.p=2,v=He,He|=4;try{nw(e,n,i)}finally{He=v,z.p=f,O.T=l}}ft=1,xg(),yg(),bg()}}function xg(){if(ft===1){ft=0;var e=Ya,n=jr,i=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||i){i=O.T,O.T=null;var l=z.p;z.p=2;var f=He;He|=4;try{W0(n,e);var h=Ef,v=ap(e.containerInfo),k=h.focusedElem,Y=h.selectionRange;if(v!==k&&k&&k.ownerDocument&&np(k.ownerDocument.documentElement,k)){if(Y!==null&&Zu(k)){var J=Y.start,ie=Y.end;if(ie===void 0&&(ie=J),"selectionStart"in k)k.selectionStart=J,k.selectionEnd=Math.min(ie,k.value.length);else{var le=k.ownerDocument||document,ee=le&&le.defaultView||window;if(ee.getSelection){var ae=ee.getSelection(),fe=k.textContent.length,we=Math.min(Y.start,fe),Ie=Y.end===void 0?we:Math.min(Y.end,fe);!ae.extend&&we>Ie&&(v=Ie,Ie=we,we=v);var F=tp(k,we),X=tp(k,Ie);if(F&&X&&(ae.rangeCount!==1||ae.anchorNode!==F.node||ae.anchorOffset!==F.offset||ae.focusNode!==X.node||ae.focusOffset!==X.offset)){var K=le.createRange();K.setStart(F.node,F.offset),ae.removeAllRanges(),we>Ie?(ae.addRange(K),ae.extend(X.node,X.offset)):(K.setEnd(X.node,X.offset),ae.addRange(K))}}}}for(le=[],ae=k;ae=ae.parentNode;)ae.nodeType===1&&le.push({element:ae,left:ae.scrollLeft,top:ae.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<le.length;k++){var oe=le[k];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}ac=!!_f,Ef=_f=null}finally{He=f,z.p=l,O.T=i}}e.current=n,ft=2}}function yg(){if(ft===2){ft=0;var e=Ya,n=jr,i=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||i){i=O.T,O.T=null;var l=z.p;z.p=2;var f=He;He|=4;try{X0(e,n.alternate,n)}finally{He=f,z.p=l,O.T=i}}ft=3}}function bg(){if(ft===4||ft===3){ft=0,Cn();var e=Ya,n=jr,i=fa,l=rg;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?ft=5:(ft=0,jr=Ya=null,vg(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(Va=null),ci(i),n=n.stateNode,Ct&&typeof Ct.onCommitFiberRoot=="function")try{Ct.onCommitFiberRoot(cs,n,void 0,(n.current.flags&128)===128)}catch{}if(l!==null){n=O.T,f=z.p,z.p=2,O.T=null;try{for(var h=e.onRecoverableError,v=0;v<l.length;v++){var k=l[v];h(k.value,{componentStack:k.stack})}}finally{O.T=n,z.p=f}}(fa&3)!==0&&Il(),zn(e),f=e.pendingLanes,(i&261930)!==0&&(f&42)!==0?e===ff?Yi++:(Yi=0,ff=e):Yi=0,Pi(0)}}function vg(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Si(n)))}function Il(){return xg(),yg(),bg(),wg()}function wg(){if(ft!==5)return!1;var e=Ya,n=uf;uf=0;var i=ci(fa),l=O.T,f=z.p;try{z.p=32>i?32:i,O.T=null,i=df,df=null;var h=Ya,v=fa;if(ft=0,jr=Ya=null,fa=0,(He&6)!==0)throw Error(o(331));var k=He;if(He|=4,ng(h.current),J0(h,h.current,v,i),He=k,Pi(0,!1),Ct&&typeof Ct.onPostCommitFiberRoot=="function")try{Ct.onPostCommitFiberRoot(cs,h)}catch{}return!0}finally{z.p=f,O.T=l,vg(e,n)}}function jg(e,n,i){n=tn(i,n),n=Yd(e.stateNode,n,2),e=Ba(e,n,2),e!==null&&(ds(e,2),zn(e))}function Ue(e,n,i){if(e.tag===3)jg(e,e,i);else for(;n!==null;){if(n.tag===3){jg(n,e,i);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Va===null||!Va.has(l))){e=tn(i,e),i=N0(2),l=Ba(n,i,2),l!==null&&(S0(i,l,n,e),ds(l,2),zn(l));break}}n=n.return}}function pf(e,n,i){var l=e.pingCache;if(l===null){l=e.pingCache=new rw;var f=new Set;l.set(n,f)}else f=l.get(n),f===void 0&&(f=new Set,l.set(n,f));f.has(i)||(of=!0,f.add(i),e=uw.bind(null,e,n,i),n.then(e,e))}function uw(e,n,i){var l=e.pingCache;l!==null&&l.delete(n),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,Xe===e&&(ke&i)===i&&(et===4||et===3&&(ke&62914560)===ke&&300>at()-$l?(He&2)===0&&Nr(e,0):lf|=i,wr===ke&&(wr=0)),zn(e)}function Ng(e,n){n===0&&(n=Uo()),e=ys(e,n),e!==null&&(ds(e,n),zn(e))}function dw(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),Ng(e,i)}function fw(e,n){var i=0;switch(e.tag){case 31:case 13:var l=e.stateNode,f=e.memoizedState;f!==null&&(i=f.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(o(314))}l!==null&&l.delete(n),Ng(e,i)}function hw(e,n){return pt(e,n)}var Xl=null,_r=null,gf=!1,Gl=!1,xf=!1,Ia=0;function zn(e){e!==_r&&e.next===null&&(_r===null?Xl=_r=e:_r=_r.next=e),Gl=!0,gf||(gf=!0,pw())}function Pi(e,n){if(!xf&&Gl){xf=!0;do for(var i=!1,l=Xl;l!==null;){if(e!==0){var f=l.pendingLanes;if(f===0)var h=0;else{var v=l.suspendedLanes,k=l.pingedLanes;h=(1<<31-Tt(42|e)+1)-1,h&=f&~(v&~k),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(i=!0,Cg(l,h))}else h=ke,h=Gs(l,l===Xe?h:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(h&3)===0||us(l,h)||(i=!0,Cg(l,h));l=l.next}while(i);xf=!1}}function mw(){Sg()}function Sg(){Gl=gf=!1;var e=0;Ia!==0&&_w()&&(e=Ia);for(var n=at(),i=null,l=Xl;l!==null;){var f=l.next,h=_g(l,n);h===0?(l.next=null,i===null?Xl=f:i.next=f,f===null&&(_r=i)):(i=l,(e!==0||(h&3)!==0)&&(Gl=!0)),l=f}ft!==0&&ft!==5||Pi(e),Ia!==0&&(Ia=0)}function _g(e,n){for(var i=e.suspendedLanes,l=e.pingedLanes,f=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var v=31-Tt(h),k=1<<v,Y=f[v];Y===-1?((k&i)===0||(k&l)!==0)&&(f[v]=Au(k,n)):Y<=n&&(e.expiredLanes|=k),h&=~k}if(n=Xe,i=ke,i=Gs(e,e===n?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,i===0||e===n&&(qe===2||qe===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&hn(l),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||us(e,i)){if(n=i&-i,n===e.callbackPriority)return n;switch(l!==null&&hn(l),ci(i)){case 2:case 8:i=Jt;break;case 32:i=In;break;case 268435456:i=Xn;break;default:i=In}return l=Eg.bind(null,e),i=pt(i,l),e.callbackPriority=n,e.callbackNode=i,n}return l!==null&&l!==null&&hn(l),e.callbackPriority=2,e.callbackNode=null,2}function Eg(e,n){if(ft!==0&&ft!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(Il()&&e.callbackNode!==i)return null;var l=ke;return l=Gs(e,e===Xe?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(og(e,l,n),_g(e,at()),e.callbackNode!=null&&e.callbackNode===i?Eg.bind(null,e):null)}function Cg(e,n){if(Il())return null;og(e,n,!0)}function pw(){Cw(function(){(He&6)!==0?pt(mn,mw):Sg()})}function yf(){if(Ia===0){var e=ur;e===0&&(e=Ps,Ps<<=1,(Ps&261888)===0&&(Ps=256)),Ia=e}return Ia}function Tg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:tl(""+e)}function Mg(e,n){var i=n.ownerDocument.createElement("input");return i.name=n.name,i.value=n.value,e.id&&i.setAttribute("form",e.id),n.parentNode.insertBefore(i,n),e=new FormData(e),i.parentNode.removeChild(i),e}function gw(e,n,i,l,f){if(n==="submit"&&i&&i.stateNode===f){var h=Tg((f[Nt]||null).action),v=l.submitter;v&&(n=(n=v[Nt]||null)?Tg(n.formAction):v.getAttribute("formAction"),n!==null&&(h=n,v=null));var k=new rl("action","action",null,l,f);e.push({event:k,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Ia!==0){var Y=v?Mg(f,v):new FormData(f);Ld(i,{pending:!0,data:Y,method:f.method,action:h},null,Y)}}else typeof h=="function"&&(k.preventDefault(),Y=v?Mg(f,v):new FormData(f),Ld(i,{pending:!0,data:Y,method:f.method,action:h},h,Y))},currentTarget:f}]})}}for(var bf=0;bf<ed.length;bf++){var vf=ed[bf],xw=vf.toLowerCase(),yw=vf[0].toUpperCase()+vf.slice(1);xn(xw,"on"+yw)}xn(ip,"onAnimationEnd"),xn(op,"onAnimationIteration"),xn(lp,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(D2,"onTransitionRun"),xn(O2,"onTransitionStart"),xn(B2,"onTransitionCancel"),xn(cp,"onTransitionEnd"),Ta("onMouseEnter",["mouseout","mouseover"]),Ta("onMouseLeave",["mouseout","mouseover"]),Ta("onPointerEnter",["pointerout","pointerover"]),Ta("onPointerLeave",["pointerout","pointerover"]),Fn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ii="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ii));function Ag(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],f=l.event;l=l.listeners;e:{var h=void 0;if(n)for(var v=l.length-1;0<=v;v--){var k=l[v],Y=k.instance,J=k.currentTarget;if(k=k.listener,Y!==h&&f.isPropagationStopped())break e;h=k,f.currentTarget=J;try{h(f)}catch(ie){ll(ie)}f.currentTarget=null,h=Y}else for(v=0;v<l.length;v++){if(k=l[v],Y=k.instance,J=k.currentTarget,k=k.listener,Y!==h&&f.isPropagationStopped())break e;h=k,f.currentTarget=J;try{h(f)}catch(ie){ll(ie)}f.currentTarget=null,h=Y}}}}function Me(e,n){var i=n[Qs];i===void 0&&(i=n[Qs]=new Set);var l=e+"__bubble";i.has(l)||(kg(n,e,2,!1),i.add(l))}function wf(e,n,i){var l=0;n&&(l|=4),kg(i,e,l,n)}var Ql="_reactListening"+Math.random().toString(36).slice(2);function jf(e){if(!e[Ql]){e[Ql]=!0,Fo.forEach(function(i){i!=="selectionchange"&&(bw.has(i)||wf(i,!1,e),wf(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Ql]||(n[Ql]=!0,wf("selectionchange",!1,n))}}function kg(e,n,i,l){switch(ix(n)){case 2:var f=Gw;break;case 8:f=Qw;break;default:f=Lf}i=f.bind(null,n,i,e),f=void 0,!Uu||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),l?f!==void 0?e.addEventListener(n,i,{capture:!0,passive:f}):e.addEventListener(n,i,!0):f!==void 0?e.addEventListener(n,i,{passive:f}):e.addEventListener(n,i,!1)}function Nf(e,n,i,l,f){var h=l;if((n&1)===0&&(n&2)===0&&l!==null)e:for(;;){if(l===null)return;var v=l.tag;if(v===3||v===4){var k=l.stateNode.containerInfo;if(k===f)break;if(v===4)for(v=l.return;v!==null;){var Y=v.tag;if((Y===3||Y===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;k!==null;){if(v=Sa(k),v===null)return;if(Y=v.tag,Y===5||Y===6||Y===26||Y===27){l=h=v;continue e}k=k.parentNode}}l=l.return}Bm(function(){var J=h,ie=$u(i),le=[];e:{var ee=up.get(e);if(ee!==void 0){var ae=rl,fe=e;switch(e){case"keypress":if(al(i)===0)break e;case"keydown":case"keyup":ae=f2;break;case"focusin":fe="focus",ae=Iu;break;case"focusout":fe="blur",ae=Iu;break;case"beforeblur":case"afterblur":ae=Iu;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=$m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=e2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=p2;break;case ip:case op:case lp:ae=a2;break;case cp:ae=x2;break;case"scroll":case"scrollend":ae=Kv;break;case"wheel":ae=b2;break;case"copy":case"cut":case"paste":ae=r2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=Um;break;case"toggle":case"beforetoggle":ae=w2}var we=(n&4)!==0,Ie=!we&&(e==="scroll"||e==="scrollend"),F=we?ee!==null?ee+"Capture":null:ee;we=[];for(var X=J,K;X!==null;){var oe=X;if(K=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||K===null||F===null||(oe=hi(X,F),oe!=null&&we.push(Xi(X,oe,K))),Ie)break;X=X.return}0<we.length&&(ee=new ae(ee,fe,null,i,ie),le.push({event:ee,listeners:we}))}}if((n&7)===0){e:{if(ee=e==="mouseover"||e==="pointerover",ae=e==="mouseout"||e==="pointerout",ee&&i!==Hu&&(fe=i.relatedTarget||i.fromElement)&&(Sa(fe)||fe[Qn]))break e;if((ae||ee)&&(ee=ie.window===ie?ie:(ee=ie.ownerDocument)?ee.defaultView||ee.parentWindow:window,ae?(fe=i.relatedTarget||i.toElement,ae=J,fe=fe?Sa(fe):null,fe!==null&&(Ie=u(fe),we=fe.tag,fe!==Ie||we!==5&&we!==27&&we!==6)&&(fe=null)):(ae=null,fe=J),ae!==fe)){if(we=$m,oe="onMouseLeave",F="onMouseEnter",X="mouse",(e==="pointerout"||e==="pointerover")&&(we=Um,oe="onPointerLeave",F="onPointerEnter",X="pointer"),Ie=ae==null?ee:Ea(ae),K=fe==null?ee:Ea(fe),ee=new we(oe,X+"leave",ae,i,ie),ee.target=Ie,ee.relatedTarget=K,oe=null,Sa(ie)===J&&(we=new we(F,X+"enter",fe,i,ie),we.target=K,we.relatedTarget=Ie,oe=we),Ie=oe,ae&&fe)t:{for(we=vw,F=ae,X=fe,K=0,oe=F;oe;oe=we(oe))K++;oe=0;for(var ye=X;ye;ye=we(ye))oe++;for(;0<K-oe;)F=we(F),K--;for(;0<oe-K;)X=we(X),oe--;for(;K--;){if(F===X||X!==null&&F===X.alternate){we=F;break t}F=we(F),X=we(X)}we=null}else we=null;ae!==null&&Rg(le,ee,ae,we,!1),fe!==null&&Ie!==null&&Rg(le,Ie,fe,we,!0)}}e:{if(ee=J?Ea(J):window,ae=ee.nodeName&&ee.nodeName.toLowerCase(),ae==="select"||ae==="input"&&ee.type==="file")var Be=Fm;else if(Gm(ee))if(Zm)Be=k2;else{Be=M2;var me=T2}else ae=ee.nodeName,!ae||ae.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?J&&Lu(J.elementType)&&(Be=Fm):Be=A2;if(Be&&(Be=Be(e,J))){Qm(le,Be,i,ie);break e}me&&me(e,ee,J),e==="focusout"&&J&&ee.type==="number"&&J.memoizedProps.value!=null&&fi(ee,"number",ee.value)}switch(me=J?Ea(J):window,e){case"focusin":(Gm(me)||me.contentEditable==="true")&&(nr=me,Wu=J,wi=null);break;case"focusout":wi=Wu=nr=null;break;case"mousedown":Ku=!0;break;case"contextmenu":case"mouseup":case"dragend":Ku=!1,sp(le,i,ie);break;case"selectionchange":if(z2)break;case"keydown":case"keyup":sp(le,i,ie)}var _e;if(Gu)e:{switch(e){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else tr?Im(e,i)&&(Re="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Re="onCompositionStart");Re&&(Vm&&i.locale!=="ko"&&(tr||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&tr&&(_e=Lm()):(Ma=ie,Vu="value"in Ma?Ma.value:Ma.textContent,tr=!0)),me=Fl(J,Re),0<me.length&&(Re=new qm(Re,e,null,i,ie),le.push({event:Re,listeners:me}),_e?Re.data=_e:(_e=Xm(i),_e!==null&&(Re.data=_e)))),(_e=N2?S2(e,i):_2(e,i))&&(Re=Fl(J,"onBeforeInput"),0<Re.length&&(me=new qm("onBeforeInput","beforeinput",null,i,ie),le.push({event:me,listeners:Re}),me.data=_e)),gw(le,e,J,i,ie)}Ag(le,n)})}function Xi(e,n,i){return{instance:e,listener:n,currentTarget:i}}function Fl(e,n){for(var i=n+"Capture",l=[];e!==null;){var f=e,h=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||h===null||(f=hi(e,i),f!=null&&l.unshift(Xi(e,f,h)),f=hi(e,n),f!=null&&l.push(Xi(e,f,h))),e.tag===3)return l;e=e.return}return[]}function vw(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Rg(e,n,i,l,f){for(var h=n._reactName,v=[];i!==null&&i!==l;){var k=i,Y=k.alternate,J=k.stateNode;if(k=k.tag,Y!==null&&Y===l)break;k!==5&&k!==26&&k!==27||J===null||(Y=J,f?(J=hi(i,h),J!=null&&v.unshift(Xi(i,J,Y))):f||(J=hi(i,h),J!=null&&v.push(Xi(i,J,Y)))),i=i.return}v.length!==0&&e.push({event:n,listeners:v})}var ww=/\r\n?/g,jw=/\u0000|\uFFFD/g;function zg(e){return(typeof e=="string"?e:""+e).replace(ww,`
`).replace(jw,"")}function Dg(e,n){return n=zg(n),zg(e)===n}function Pe(e,n,i,l,f,h){switch(i){case"children":typeof l=="string"?n==="body"||n==="textarea"&&l===""||Ks(e,l):(typeof l=="number"||typeof l=="bigint")&&n!=="body"&&Ks(e,""+l);break;case"className":Zs(e,"class",l);break;case"tabIndex":Zs(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Zs(e,i,l);break;case"style":Dm(e,l,h);break;case"data":if(n!=="object"){Zs(e,"data",l);break}case"src":case"href":if(l===""&&(n!=="a"||i!=="href")){e.removeAttribute(i);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=tl(""+l),e.setAttribute(i,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(i==="formAction"?(n!=="input"&&Pe(e,n,"name",f.name,f,null),Pe(e,n,"formEncType",f.formEncType,f,null),Pe(e,n,"formMethod",f.formMethod,f,null),Pe(e,n,"formTarget",f.formTarget,f,null)):(Pe(e,n,"encType",f.encType,f,null),Pe(e,n,"method",f.method,f,null),Pe(e,n,"target",f.target,f,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=tl(""+l),e.setAttribute(i,l);break;case"onClick":l!=null&&(e.onclick=Wn);break;case"onScroll":l!=null&&Me("scroll",e);break;case"onScrollEnd":l!=null&&Me("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(i=l.__html,i!=null){if(f.children!=null)throw Error(o(60));e.innerHTML=i}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}i=tl(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""+l):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":l===!0?e.setAttribute(i,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,l):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(i,l):e.removeAttribute(i);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(i):e.setAttribute(i,l);break;case"popover":Me("beforetoggle",e),Me("toggle",e),Fs(e,"popover",l);break;case"xlinkActuate":gn(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":gn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":gn(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":gn(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":gn(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":gn(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":gn(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":gn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":gn(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Fs(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=Zv.get(i)||i,Fs(e,i,l))}}function Sf(e,n,i,l,f,h){switch(i){case"style":Dm(e,l,h);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(i=l.__html,i!=null){if(f.children!=null)throw Error(o(60));e.innerHTML=i}}break;case"children":typeof l=="string"?Ks(e,l):(typeof l=="number"||typeof l=="bigint")&&Ks(e,""+l);break;case"onScroll":l!=null&&Me("scroll",e);break;case"onScrollEnd":l!=null&&Me("scrollend",e);break;case"onClick":l!=null&&(e.onclick=Wn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zo.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(f=i.endsWith("Capture"),n=i.slice(2,f?i.length-7:void 0),h=e[Nt]||null,h=h!=null?h[i]:null,typeof h=="function"&&e.removeEventListener(n,h,f),typeof l=="function")){typeof h!="function"&&h!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(n,l,f);break e}i in e?e[i]=l:l===!0?e.setAttribute(i,""):Fs(e,i,l)}}}function jt(e,n,i){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Me("error",e),Me("load",e);var l=!1,f=!1,h;for(h in i)if(i.hasOwnProperty(h)){var v=i[h];if(v!=null)switch(h){case"src":l=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,n));default:Pe(e,n,h,v,i,null)}}f&&Pe(e,n,"srcSet",i.srcSet,i,null),l&&Pe(e,n,"src",i.src,i,null);return;case"input":Me("invalid",e);var k=h=v=f=null,Y=null,J=null;for(l in i)if(i.hasOwnProperty(l)){var ie=i[l];if(ie!=null)switch(l){case"name":f=ie;break;case"type":v=ie;break;case"checked":Y=ie;break;case"defaultChecked":J=ie;break;case"value":h=ie;break;case"defaultValue":k=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(o(137,n));break;default:Pe(e,n,l,ie,i,null)}}el(e,h,k,Y,J,v,f,!1);return;case"select":Me("invalid",e),l=v=h=null;for(f in i)if(i.hasOwnProperty(f)&&(k=i[f],k!=null))switch(f){case"value":h=k;break;case"defaultValue":v=k;break;case"multiple":l=k;default:Pe(e,n,f,k,i,null)}n=h,i=v,e.multiple=!!l,n!=null?Zn(e,!!l,n,!1):i!=null&&Zn(e,!!l,i,!0);return;case"textarea":Me("invalid",e),h=f=l=null;for(v in i)if(i.hasOwnProperty(v)&&(k=i[v],k!=null))switch(v){case"value":l=k;break;case"defaultValue":f=k;break;case"children":h=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(o(91));break;default:Pe(e,n,v,k,i,null)}Rm(e,l,f,h);return;case"option":for(Y in i)i.hasOwnProperty(Y)&&(l=i[Y],l!=null)&&(Y==="selected"?e.selected=l&&typeof l!="function"&&typeof l!="symbol":Pe(e,n,Y,l,i,null));return;case"dialog":Me("beforetoggle",e),Me("toggle",e),Me("cancel",e),Me("close",e);break;case"iframe":case"object":Me("load",e);break;case"video":case"audio":for(l=0;l<Ii.length;l++)Me(Ii[l],e);break;case"image":Me("error",e),Me("load",e);break;case"details":Me("toggle",e);break;case"embed":case"source":case"link":Me("error",e),Me("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in i)if(i.hasOwnProperty(J)&&(l=i[J],l!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,n));default:Pe(e,n,J,l,i,null)}return;default:if(Lu(n)){for(ie in i)i.hasOwnProperty(ie)&&(l=i[ie],l!==void 0&&Sf(e,n,ie,l,i,void 0));return}}for(k in i)i.hasOwnProperty(k)&&(l=i[k],l!=null&&Pe(e,n,k,l,i,null))}function Nw(e,n,i,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,h=null,v=null,k=null,Y=null,J=null,ie=null;for(ae in i){var le=i[ae];if(i.hasOwnProperty(ae)&&le!=null)switch(ae){case"checked":break;case"value":break;case"defaultValue":Y=le;default:l.hasOwnProperty(ae)||Pe(e,n,ae,null,l,le)}}for(var ee in l){var ae=l[ee];if(le=i[ee],l.hasOwnProperty(ee)&&(ae!=null||le!=null))switch(ee){case"type":h=ae;break;case"name":f=ae;break;case"checked":J=ae;break;case"defaultChecked":ie=ae;break;case"value":v=ae;break;case"defaultValue":k=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(o(137,n));break;default:ae!==le&&Pe(e,n,ee,ae,l,le)}}ms(e,v,k,Y,J,ie,h,f);return;case"select":ae=v=k=ee=null;for(h in i)if(Y=i[h],i.hasOwnProperty(h)&&Y!=null)switch(h){case"value":break;case"multiple":ae=Y;default:l.hasOwnProperty(h)||Pe(e,n,h,null,l,Y)}for(f in l)if(h=l[f],Y=i[f],l.hasOwnProperty(f)&&(h!=null||Y!=null))switch(f){case"value":ee=h;break;case"defaultValue":k=h;break;case"multiple":v=h;default:h!==Y&&Pe(e,n,f,h,l,Y)}n=k,i=v,l=ae,ee!=null?Zn(e,!!i,ee,!1):!!l!=!!i&&(n!=null?Zn(e,!!i,n,!0):Zn(e,!!i,i?[]:"",!1));return;case"textarea":ae=ee=null;for(k in i)if(f=i[k],i.hasOwnProperty(k)&&f!=null&&!l.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Pe(e,n,k,null,l,f)}for(v in l)if(f=l[v],h=i[v],l.hasOwnProperty(v)&&(f!=null||h!=null))switch(v){case"value":ee=f;break;case"defaultValue":ae=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(o(91));break;default:f!==h&&Pe(e,n,v,f,l,h)}km(e,ee,ae);return;case"option":for(var fe in i)ee=i[fe],i.hasOwnProperty(fe)&&ee!=null&&!l.hasOwnProperty(fe)&&(fe==="selected"?e.selected=!1:Pe(e,n,fe,null,l,ee));for(Y in l)ee=l[Y],ae=i[Y],l.hasOwnProperty(Y)&&ee!==ae&&(ee!=null||ae!=null)&&(Y==="selected"?e.selected=ee&&typeof ee!="function"&&typeof ee!="symbol":Pe(e,n,Y,ee,l,ae));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var we in i)ee=i[we],i.hasOwnProperty(we)&&ee!=null&&!l.hasOwnProperty(we)&&Pe(e,n,we,null,l,ee);for(J in l)if(ee=l[J],ae=i[J],l.hasOwnProperty(J)&&ee!==ae&&(ee!=null||ae!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(o(137,n));break;default:Pe(e,n,J,ee,l,ae)}return;default:if(Lu(n)){for(var Ie in i)ee=i[Ie],i.hasOwnProperty(Ie)&&ee!==void 0&&!l.hasOwnProperty(Ie)&&Sf(e,n,Ie,void 0,l,ee);for(ie in l)ee=l[ie],ae=i[ie],!l.hasOwnProperty(ie)||ee===ae||ee===void 0&&ae===void 0||Sf(e,n,ie,ee,l,ae);return}}for(var F in i)ee=i[F],i.hasOwnProperty(F)&&ee!=null&&!l.hasOwnProperty(F)&&Pe(e,n,F,null,l,ee);for(le in l)ee=l[le],ae=i[le],!l.hasOwnProperty(le)||ee===ae||ee==null&&ae==null||Pe(e,n,le,ee,l,ae)}function Og(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Sw(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,i=performance.getEntriesByType("resource"),l=0;l<i.length;l++){var f=i[l],h=f.transferSize,v=f.initiatorType,k=f.duration;if(h&&k&&Og(v)){for(v=0,k=f.responseEnd,l+=1;l<i.length;l++){var Y=i[l],J=Y.startTime;if(J>k)break;var ie=Y.transferSize,le=Y.initiatorType;ie&&Og(le)&&(Y=Y.responseEnd,v+=ie*(Y<k?1:(k-J)/(Y-J)))}if(--l,n+=8*(h+v)/(f.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var _f=null,Ef=null;function Zl(e){return e.nodeType===9?e:e.ownerDocument}function Bg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Lg(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Cf(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Tf=null;function _w(){var e=window.event;return e&&e.type==="popstate"?e===Tf?!1:(Tf=e,!0):(Tf=null,!1)}var Hg=typeof setTimeout=="function"?setTimeout:void 0,Ew=typeof clearTimeout=="function"?clearTimeout:void 0,$g=typeof Promise=="function"?Promise:void 0,Cw=typeof queueMicrotask=="function"?queueMicrotask:typeof $g<"u"?function(e){return $g.resolve(null).then(e).catch(Tw)}:Hg;function Tw(e){setTimeout(function(){throw e})}function Xa(e){return e==="head"}function qg(e,n){var i=n,l=0;do{var f=i.nextSibling;if(e.removeChild(i),f&&f.nodeType===8)if(i=f.data,i==="/$"||i==="/&"){if(l===0){e.removeChild(f),Mr(n);return}l--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")l++;else if(i==="html")Gi(e.ownerDocument.documentElement);else if(i==="head"){i=e.ownerDocument.head,Gi(i);for(var h=i.firstChild;h;){var v=h.nextSibling,k=h.nodeName;h[fs]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&h.rel.toLowerCase()==="stylesheet"||i.removeChild(h),h=v}}else i==="body"&&Gi(e.ownerDocument.body);i=f}while(i);Mr(n)}function Ug(e,n){var i=e;e=0;do{var l=i.nextSibling;if(i.nodeType===1?n?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(n?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),l&&l.nodeType===8)if(i=l.data,i==="/$"){if(e===0)break;e--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||e++;i=l}while(i)}function Mf(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var i=n;switch(n=n.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Mf(i),ui(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function Mw(e,n,i,l){for(;e.nodeType===1;){var f=i;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[fs])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var h=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=on(e.nextSibling),e===null)break}return null}function Aw(e,n,i){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=on(e.nextSibling),e===null))return null;return e}function Vg(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=on(e.nextSibling),e===null))return null;return e}function Af(e){return e.data==="$?"||e.data==="$~"}function kf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function kw(e,n){var i=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||i.readyState!=="loading")n();else{var l=function(){n(),i.removeEventListener("DOMContentLoaded",l)};i.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function on(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Rf=null;function Yg(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"||i==="/&"){if(n===0)return on(e.nextSibling);n--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||n++}e=e.nextSibling}return null}function Pg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(n===0)return e;n--}else i!=="/$"&&i!=="/&"||n++}e=e.previousSibling}return null}function Ig(e,n,i){switch(n=Zl(i),e){case"html":if(e=n.documentElement,!e)throw Error(o(452));return e;case"head":if(e=n.head,!e)throw Error(o(453));return e;case"body":if(e=n.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function Gi(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);ui(e)}var ln=new Map,Xg=new Set;function Wl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ha=z.d;z.d={f:Rw,r:zw,D:Dw,C:Ow,L:Bw,m:Lw,X:$w,S:Hw,M:qw};function Rw(){var e=ha.f(),n=Vl();return e||n}function zw(e){var n=_a(e);n!==null&&n.tag===5&&n.type==="form"?c0(n):ha.r(e)}var Er=typeof document>"u"?null:document;function Gg(e,n,i){var l=Er;if(l&&typeof n=="string"&&n){var f=Rt(n);f='link[rel="'+e+'"][href="'+f+'"]',typeof i=="string"&&(f+='[crossorigin="'+i+'"]'),Xg.has(f)||(Xg.add(f),e={rel:e,crossOrigin:i,href:n},l.querySelector(f)===null&&(n=l.createElement("link"),jt(n,"link",e),st(n),l.head.appendChild(n)))}}function Dw(e){ha.D(e),Gg("dns-prefetch",e,null)}function Ow(e,n){ha.C(e,n),Gg("preconnect",e,n)}function Bw(e,n,i){ha.L(e,n,i);var l=Er;if(l&&e&&n){var f='link[rel="preload"][as="'+Rt(n)+'"]';n==="image"&&i&&i.imageSrcSet?(f+='[imagesrcset="'+Rt(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(f+='[imagesizes="'+Rt(i.imageSizes)+'"]')):f+='[href="'+Rt(e)+'"]';var h=f;switch(n){case"style":h=Cr(e);break;case"script":h=Tr(e)}ln.has(h)||(e=x({rel:"preload",href:n==="image"&&i&&i.imageSrcSet?void 0:e,as:n},i),ln.set(h,e),l.querySelector(f)!==null||n==="style"&&l.querySelector(Qi(h))||n==="script"&&l.querySelector(Fi(h))||(n=l.createElement("link"),jt(n,"link",e),st(n),l.head.appendChild(n)))}}function Lw(e,n){ha.m(e,n);var i=Er;if(i&&e){var l=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+Rt(l)+'"][href="'+Rt(e)+'"]',h=f;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Tr(e)}if(!ln.has(h)&&(e=x({rel:"modulepreload",href:e},n),ln.set(h,e),i.querySelector(f)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Fi(h)))return}l=i.createElement("link"),jt(l,"link",e),st(l),i.head.appendChild(l)}}}function Hw(e,n,i){ha.S(e,n,i);var l=Er;if(l&&e){var f=Ca(l).hoistableStyles,h=Cr(e);n=n||"default";var v=f.get(h);if(!v){var k={loading:0,preload:null};if(v=l.querySelector(Qi(h)))k.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":n},i),(i=ln.get(h))&&zf(e,i);var Y=v=l.createElement("link");st(Y),jt(Y,"link",e),Y._p=new Promise(function(J,ie){Y.onload=J,Y.onerror=ie}),Y.addEventListener("load",function(){k.loading|=1}),Y.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Kl(v,n,l)}v={type:"stylesheet",instance:v,count:1,state:k},f.set(h,v)}}}function $w(e,n){ha.X(e,n);var i=Er;if(i&&e){var l=Ca(i).hoistableScripts,f=Tr(e),h=l.get(f);h||(h=i.querySelector(Fi(f)),h||(e=x({src:e,async:!0},n),(n=ln.get(f))&&Df(e,n),h=i.createElement("script"),st(h),jt(h,"link",e),i.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},l.set(f,h))}}function qw(e,n){ha.M(e,n);var i=Er;if(i&&e){var l=Ca(i).hoistableScripts,f=Tr(e),h=l.get(f);h||(h=i.querySelector(Fi(f)),h||(e=x({src:e,async:!0,type:"module"},n),(n=ln.get(f))&&Df(e,n),h=i.createElement("script"),st(h),jt(h,"link",e),i.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},l.set(f,h))}}function Qg(e,n,i,l){var f=(f=de.current)?Wl(f):null;if(!f)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(n=Cr(i.href),i=Ca(f).hoistableStyles,l=i.get(n),l||(l={type:"style",instance:null,count:0,state:null},i.set(n,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=Cr(i.href);var h=Ca(f).hoistableStyles,v=h.get(e);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,v),(h=f.querySelector(Qi(e)))&&!h._p&&(v.instance=h,v.state.loading=5),ln.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},ln.set(e,i),h||Uw(f,e,i,v.state))),n&&l===null)throw Error(o(528,""));return v}if(n&&l!==null)throw Error(o(529,""));return null;case"script":return n=i.async,i=i.src,typeof i=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Tr(i),i=Ca(f).hoistableScripts,l=i.get(n),l||(l={type:"script",instance:null,count:0,state:null},i.set(n,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Cr(e){return'href="'+Rt(e)+'"'}function Qi(e){return'link[rel="stylesheet"]['+e+"]"}function Fg(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function Uw(e,n,i,l){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?l.loading=1:(n=e.createElement("link"),l.preload=n,n.addEventListener("load",function(){return l.loading|=1}),n.addEventListener("error",function(){return l.loading|=2}),jt(n,"link",i),st(n),e.head.appendChild(n))}function Tr(e){return'[src="'+Rt(e)+'"]'}function Fi(e){return"script[async]"+e}function Zg(e,n,i){if(n.count++,n.instance===null)switch(n.type){case"style":var l=e.querySelector('style[data-href~="'+Rt(i.href)+'"]');if(l)return n.instance=l,st(l),l;var f=x({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),st(l),jt(l,"style",f),Kl(l,i.precedence,e),n.instance=l;case"stylesheet":f=Cr(i.href);var h=e.querySelector(Qi(f));if(h)return n.state.loading|=4,n.instance=h,st(h),h;l=Fg(i),(f=ln.get(f))&&zf(l,f),h=(e.ownerDocument||e).createElement("link"),st(h);var v=h;return v._p=new Promise(function(k,Y){v.onload=k,v.onerror=Y}),jt(h,"link",l),n.state.loading|=4,Kl(h,i.precedence,e),n.instance=h;case"script":return h=Tr(i.src),(f=e.querySelector(Fi(h)))?(n.instance=f,st(f),f):(l=i,(f=ln.get(h))&&(l=x({},i),Df(l,f)),e=e.ownerDocument||e,f=e.createElement("script"),st(f),jt(f,"link",l),e.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(o(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(l=n.instance,n.state.loading|=4,Kl(l,i.precedence,e));return n.instance}function Kl(e,n,i){for(var l=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=l.length?l[l.length-1]:null,h=f,v=0;v<l.length;v++){var k=l[v];if(k.dataset.precedence===n)h=k;else if(h!==f)break}h?h.parentNode.insertBefore(e,h.nextSibling):(n=i.nodeType===9?i.head:i,n.insertBefore(e,n.firstChild))}function zf(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Df(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Jl=null;function Wg(e,n,i){if(Jl===null){var l=new Map,f=Jl=new Map;f.set(i,l)}else f=Jl,l=f.get(i),l||(l=new Map,f.set(i,l));if(l.has(e))return l;for(l.set(e,null),i=i.getElementsByTagName(e),f=0;f<i.length;f++){var h=i[f];if(!(h[fs]||h[dt]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var v=h.getAttribute(n)||"";v=e+v;var k=l.get(v);k?k.push(h):l.set(v,[h])}}return l}function Kg(e,n,i){e=e.ownerDocument||e,e.head.insertBefore(i,n==="title"?e.querySelector("head > title"):null)}function Vw(e,n,i){if(i===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(e=n.disabled,typeof n.precedence=="string"&&e==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Jg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Yw(e,n,i,l){if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var f=Cr(l.href),h=n.querySelector(Qi(f));if(h){n=h._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=ec.bind(e),n.then(e,e)),i.state.loading|=4,i.instance=h,st(h);return}h=n.ownerDocument||n,l=Fg(l),(f=ln.get(f))&&zf(l,f),h=h.createElement("link"),st(h);var v=h;v._p=new Promise(function(k,Y){v.onload=k,v.onerror=Y}),jt(h,"link",l),i.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(i,n),(n=i.state.preload)&&(i.state.loading&3)===0&&(e.count++,i=ec.bind(e),n.addEventListener("load",i),n.addEventListener("error",i))}}var Of=0;function Pw(e,n){return e.stylesheets&&e.count===0&&nc(e,e.stylesheets),0<e.count||0<e.imgCount?function(i){var l=setTimeout(function(){if(e.stylesheets&&nc(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+n);0<e.imgBytes&&Of===0&&(Of=62500*Sw());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&nc(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>Of?50:800)+n);return e.unsuspend=i,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(f)}}:null}function ec(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)nc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var tc=null;function nc(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,tc=new Map,n.forEach(Iw,e),tc=null,ec.call(e))}function Iw(e,n){if(!(n.state.loading&4)){var i=tc.get(e);if(i)var l=i.get(null);else{i=new Map,tc.set(e,i);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<f.length;h++){var v=f[h];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(i.set(v.dataset.precedence,v),l=v)}l&&i.set(null,l)}f=n.instance,v=f.getAttribute("data-precedence"),h=i.get(v)||l,h===l&&i.set(null,f),i.set(v,f),this.count++,l=ec.bind(this),f.addEventListener("load",l),f.addEventListener("error",l),h?h.parentNode.insertBefore(f,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),n.state.loading|=4}}var Zi={$$typeof:T,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function Xw(e,n,i,l,f,h,v,k,Y){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=oi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oi(0),this.hiddenUpdates=oi(null),this.identifierPrefix=l,this.onUncaughtError=f,this.onCaughtError=h,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function ex(e,n,i,l,f,h,v,k,Y,J,ie,le){return e=new Xw(e,n,i,v,Y,J,ie,le,k),n=1,h===!0&&(n|=24),h=Vt(3,null,null,n),e.current=h,h.stateNode=e,n=hd(),n.refCount++,e.pooledCache=n,n.refCount++,h.memoizedState={element:l,isDehydrated:i,cache:n},xd(h),e}function tx(e){return e?(e=rr,e):rr}function nx(e,n,i,l,f,h){f=tx(f),l.context===null?l.context=f:l.pendingContext=f,l=Oa(n),l.payload={element:i},h=h===void 0?null:h,h!==null&&(l.callback=h),i=Ba(e,l,n),i!==null&&(Ht(i,e,n),Ti(i,e,n))}function ax(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function Bf(e,n){ax(e,n),(e=e.alternate)&&ax(e,n)}function sx(e){if(e.tag===13||e.tag===31){var n=ys(e,67108864);n!==null&&Ht(n,e,67108864),Bf(e,67108864)}}function rx(e){if(e.tag===13||e.tag===31){var n=Gt();n=li(n);var i=ys(e,n);i!==null&&Ht(i,e,n),Bf(e,n)}}var ac=!0;function Gw(e,n,i,l){var f=O.T;O.T=null;var h=z.p;try{z.p=2,Lf(e,n,i,l)}finally{z.p=h,O.T=f}}function Qw(e,n,i,l){var f=O.T;O.T=null;var h=z.p;try{z.p=8,Lf(e,n,i,l)}finally{z.p=h,O.T=f}}function Lf(e,n,i,l){if(ac){var f=Hf(l);if(f===null)Nf(e,n,l,sc,i),ox(e,l);else if(Zw(f,e,n,i,l))l.stopPropagation();else if(ox(e,l),n&4&&-1<Fw.indexOf(e)){for(;f!==null;){var h=_a(f);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var v=Gn(h.pendingLanes);if(v!==0){var k=h;for(k.pendingLanes|=2,k.entangledLanes|=2;v;){var Y=1<<31-Tt(v);k.entanglements[1]|=Y,v&=~Y}zn(h),(He&6)===0&&(ql=at()+500,Pi(0))}}break;case 31:case 13:k=ys(h,2),k!==null&&Ht(k,h,2),Vl(),Bf(h,2)}if(h=Hf(l),h===null&&Nf(e,n,l,sc,i),h===f)break;f=h}f!==null&&l.stopPropagation()}else Nf(e,n,l,null,i)}}function Hf(e){return e=$u(e),$f(e)}var sc=null;function $f(e){if(sc=null,e=Sa(e),e!==null){var n=u(e);if(n===null)e=null;else{var i=n.tag;if(i===13){if(e=d(n),e!==null)return e;e=null}else if(i===31){if(e=m(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return sc=e,null}function ix(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pn()){case mn:return 2;case Jt:return 8;case In:case pn:return 32;case Xn:return 268435456;default:return 32}default:return 32}}var qf=!1,Ga=null,Qa=null,Fa=null,Wi=new Map,Ki=new Map,Za=[],Fw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ox(e,n){switch(e){case"focusin":case"focusout":Ga=null;break;case"dragenter":case"dragleave":Qa=null;break;case"mouseover":case"mouseout":Fa=null;break;case"pointerover":case"pointerout":Wi.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ki.delete(n.pointerId)}}function Ji(e,n,i,l,f,h){return e===null||e.nativeEvent!==h?(e={blockedOn:n,domEventName:i,eventSystemFlags:l,nativeEvent:h,targetContainers:[f]},n!==null&&(n=_a(n),n!==null&&sx(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),e)}function Zw(e,n,i,l,f){switch(n){case"focusin":return Ga=Ji(Ga,e,n,i,l,f),!0;case"dragenter":return Qa=Ji(Qa,e,n,i,l,f),!0;case"mouseover":return Fa=Ji(Fa,e,n,i,l,f),!0;case"pointerover":var h=f.pointerId;return Wi.set(h,Ji(Wi.get(h)||null,e,n,i,l,f)),!0;case"gotpointercapture":return h=f.pointerId,Ki.set(h,Ji(Ki.get(h)||null,e,n,i,l,f)),!0}return!1}function lx(e){var n=Sa(e.target);if(n!==null){var i=u(n);if(i!==null){if(n=i.tag,n===13){if(n=d(i),n!==null){e.blockedOn=n,Xo(e.priority,function(){rx(i)});return}}else if(n===31){if(n=m(i),n!==null){e.blockedOn=n,Xo(e.priority,function(){rx(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function rc(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=Hf(e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);Hu=l,i.target.dispatchEvent(l),Hu=null}else return n=_a(i),n!==null&&sx(n),e.blockedOn=i,!1;n.shift()}return!0}function cx(e,n,i){rc(e)&&i.delete(n)}function Ww(){qf=!1,Ga!==null&&rc(Ga)&&(Ga=null),Qa!==null&&rc(Qa)&&(Qa=null),Fa!==null&&rc(Fa)&&(Fa=null),Wi.forEach(cx),Ki.forEach(cx)}function ic(e,n){e.blockedOn===n&&(e.blockedOn=null,qf||(qf=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Ww)))}var oc=null;function ux(e){oc!==e&&(oc=e,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){oc===e&&(oc=null);for(var n=0;n<e.length;n+=3){var i=e[n],l=e[n+1],f=e[n+2];if(typeof l!="function"){if($f(l||i)===null)continue;break}var h=_a(i);h!==null&&(e.splice(n,3),n-=3,Ld(h,{pending:!0,data:f,method:i.method,action:l},l,f))}}))}function Mr(e){function n(Y){return ic(Y,e)}Ga!==null&&ic(Ga,e),Qa!==null&&ic(Qa,e),Fa!==null&&ic(Fa,e),Wi.forEach(n),Ki.forEach(n);for(var i=0;i<Za.length;i++){var l=Za[i];l.blockedOn===e&&(l.blockedOn=null)}for(;0<Za.length&&(i=Za[0],i.blockedOn===null);)lx(i),i.blockedOn===null&&Za.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(l=0;l<i.length;l+=3){var f=i[l],h=i[l+1],v=f[Nt]||null;if(typeof h=="function")v||ux(i);else if(v){var k=null;if(h&&h.hasAttribute("formAction")){if(f=h,v=h[Nt]||null)k=v.formAction;else if($f(f)!==null)continue}else k=v.action;typeof k=="function"?i[l+1]=k:(i.splice(l,3),l-=3),ux(i)}}}function dx(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function n(){f!==null&&(f(),f=null),l||setTimeout(i,20)}function i(){if(!l&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(i,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),f!==null&&(f(),f=null)}}}function Uf(e){this._internalRoot=e}lc.prototype.render=Uf.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(o(409));var i=n.current,l=Gt();nx(i,l,e,n,null,null)},lc.prototype.unmount=Uf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;nx(e.current,2,null,e,null,null),Vl(),n[Qn]=null}};function lc(e){this._internalRoot=e}lc.prototype.unstable_scheduleHydration=function(e){if(e){var n=Io();e={blockedOn:null,target:e,priority:n};for(var i=0;i<Za.length&&n!==0&&n<Za[i].priority;i++);Za.splice(i,0,e),i===0&&lx(e)}};var fx=a.version;if(fx!=="19.2.3")throw Error(o(527,fx,"19.2.3"));z.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=g(n),e=e!==null?y(e):null,e=e===null?null:e.stateNode,e};var Kw={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cc.isDisabled&&cc.supportsFiber)try{cs=cc.inject(Kw),Ct=cc}catch{}}return to.createRoot=function(e,n){if(!c(e))throw Error(o(299));var i=!1,l="",f=b0,h=v0,v=w0;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(h=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=ex(e,1,!1,null,null,i,l,null,f,h,v,dx),e[Qn]=n.current,jf(e),new Uf(n)},to.hydrateRoot=function(e,n,i){if(!c(e))throw Error(o(299));var l=!1,f="",h=b0,v=v0,k=w0,Y=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(h=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError),i.formState!==void 0&&(Y=i.formState)),n=ex(e,1,!0,n,i??null,l,f,Y,h,v,k,dx),n.context=tx(null),i=n.current,l=Gt(),l=li(l),f=Oa(l),f.callback=null,Ba(i,f,l),i=l,n.current.lanes=i,ds(n,i),zn(n),e[Qn]=n.current,jf(e),new lc(n)},to.version="19.2.3",to}var jx;function oj(){if(jx)return Pf.exports;jx=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(a){console.error(a)}}return t(),Pf.exports=ij(),Pf.exports}var lj=oj();const cj=Vh(lj);var Nx="popstate";function uj(t={}){function a(o,c){let{pathname:u,search:d,hash:m}=o.location;return xh("",{pathname:u,search:d,hash:m},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function s(o,c){return typeof c=="string"?c:mo(c)}return fj(a,s,null,t)}function Ze(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function Ft(t,a){if(!t){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function dj(){return Math.random().toString(36).substring(2,10)}function Sx(t,a){return{usr:t.state,key:t.key,idx:a}}function xh(t,a,s=null,o){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof a=="string"?Kr(a):a,state:s,key:a&&a.key||o||dj()}}function mo({pathname:t="/",search:a="",hash:s=""}){return a&&a!=="?"&&(t+=a.charAt(0)==="?"?a:"?"+a),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Kr(t){let a={};if(t){let s=t.indexOf("#");s>=0&&(a.hash=t.substring(s),t=t.substring(0,s));let o=t.indexOf("?");o>=0&&(a.search=t.substring(o),t=t.substring(0,o)),t&&(a.pathname=t)}return a}function fj(t,a,s,o={}){let{window:c=document.defaultView,v5Compat:u=!1}=o,d=c.history,m="POP",p=null,g=y();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function y(){return(d.state||{idx:null}).idx}function x(){m="POP";let _=y(),E=_==null?null:_-g;g=_,p&&p({action:m,location:C.location,delta:E})}function b(_,E){m="PUSH";let R=xh(C.location,_,E);g=y()+1;let T=Sx(R,g),A=C.createHref(R);try{d.pushState(T,"",A)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;c.location.assign(A)}u&&p&&p({action:m,location:C.location,delta:1})}function j(_,E){m="REPLACE";let R=xh(C.location,_,E);g=y();let T=Sx(R,g),A=C.createHref(R);d.replaceState(T,"",A),u&&p&&p({action:m,location:C.location,delta:0})}function S(_){return hj(_)}let C={get action(){return m},get location(){return t(c,d)},listen(_){if(p)throw new Error("A history only accepts one active listener");return c.addEventListener(Nx,x),p=_,()=>{c.removeEventListener(Nx,x),p=null}},createHref(_){return a(c,_)},createURL:S,encodeLocation(_){let E=S(_);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:b,replace:j,go(_){return d.go(_)}};return C}function hj(t,a=!1){let s="http://localhost";typeof window<"u"&&(s=window.location.origin!=="null"?window.location.origin:window.location.href),Ze(s,"No window.location.(origin|href) available to create URL");let o=typeof t=="string"?t:mo(t);return o=o.replace(/ $/,"%20"),!a&&o.startsWith("//")&&(o=s+o),new URL(o,s)}function ub(t,a,s="/"){return mj(t,a,s,!1)}function mj(t,a,s,o){let c=typeof a=="string"?Kr(a):a,u=ya(c.pathname||"/",s);if(u==null)return null;let d=db(t);pj(d);let m=null;for(let p=0;m==null&&p<d.length;++p){let g=Ej(u);m=Sj(d[p],g,o)}return m}function db(t,a=[],s=[],o="",c=!1){let u=(d,m,p=c,g)=>{let y={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:m,route:d};if(y.relativePath.startsWith("/")){if(!y.relativePath.startsWith(o)&&p)return;Ze(y.relativePath.startsWith(o),`Absolute route path "${y.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),y.relativePath=y.relativePath.slice(o.length)}let x=xa([o,y.relativePath]),b=s.concat(y);d.children&&d.children.length>0&&(Ze(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),db(d.children,a,b,x,p)),!(d.path==null&&!d.index)&&a.push({path:x,score:jj(x,d.index),routesMeta:b})};return t.forEach((d,m)=>{if(d.path===""||!d.path?.includes("?"))u(d,m);else for(let p of fb(d.path))u(d,m,!0,p)}),a}function fb(t){let a=t.split("/");if(a.length===0)return[];let[s,...o]=a,c=s.endsWith("?"),u=s.replace(/\?$/,"");if(o.length===0)return c?[u,""]:[u];let d=fb(o.join("/")),m=[];return m.push(...d.map(p=>p===""?u:[u,p].join("/"))),c&&m.push(...d),m.map(p=>t.startsWith("/")&&p===""?"/":p)}function pj(t){t.sort((a,s)=>a.score!==s.score?s.score-a.score:Nj(a.routesMeta.map(o=>o.childrenIndex),s.routesMeta.map(o=>o.childrenIndex)))}var gj=/^:[\w-]+$/,xj=3,yj=2,bj=1,vj=10,wj=-2,_x=t=>t==="*";function jj(t,a){let s=t.split("/"),o=s.length;return s.some(_x)&&(o+=wj),a&&(o+=yj),s.filter(c=>!_x(c)).reduce((c,u)=>c+(gj.test(u)?xj:u===""?bj:vj),o)}function Nj(t,a){return t.length===a.length&&t.slice(0,-1).every((o,c)=>o===a[c])?t[t.length-1]-a[a.length-1]:0}function Sj(t,a,s=!1){let{routesMeta:o}=t,c={},u="/",d=[];for(let m=0;m<o.length;++m){let p=o[m],g=m===o.length-1,y=u==="/"?a:a.slice(u.length)||"/",x=Hc({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},y),b=p.route;if(!x&&g&&s&&!o[o.length-1].route.index&&(x=Hc({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},y)),!x)return null;Object.assign(c,x.params),d.push({params:c,pathname:xa([u,x.pathname]),pathnameBase:Aj(xa([u,x.pathnameBase])),route:b}),x.pathnameBase!=="/"&&(u=xa([u,x.pathnameBase]))}return d}function Hc(t,a){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,o]=_j(t.path,t.caseSensitive,t.end),c=a.match(s);if(!c)return null;let u=c[0],d=u.replace(/(.)\/+$/,"$1"),m=c.slice(1);return{params:o.reduce((g,{paramName:y,isOptional:x},b)=>{if(y==="*"){let S=m[b]||"";d=u.slice(0,u.length-S.length).replace(/(.)\/+$/,"$1")}const j=m[b];return x&&!j?g[y]=void 0:g[y]=(j||"").replace(/%2F/g,"/"),g},{}),pathname:u,pathnameBase:d,pattern:t}}function _j(t,a=!1,s=!0){Ft(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let o=[],c="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,m,p)=>(o.push({paramName:m,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(o.push({paramName:"*"}),c+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?c+="\\/*$":t!==""&&t!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,a?void 0:"i"),o]}function Ej(t){try{return t.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return Ft(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${a}).`),t}}function ya(t,a){if(a==="/")return t;if(!t.toLowerCase().startsWith(a.toLowerCase()))return null;let s=a.endsWith("/")?a.length-1:a.length,o=t.charAt(s);return o&&o!=="/"?null:t.slice(s)||"/"}var hb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cj=t=>hb.test(t);function Tj(t,a="/"){let{pathname:s,search:o="",hash:c=""}=typeof t=="string"?Kr(t):t,u;if(s)if(Cj(s))u=s;else{if(s.includes("//")){let d=s;s=s.replace(/\/\/+/g,"/"),Ft(!1,`Pathnames cannot have embedded double slashes - normalizing ${d} -> ${s}`)}s.startsWith("/")?u=Ex(s.substring(1),"/"):u=Ex(s,a)}else u=a;return{pathname:u,search:kj(o),hash:Rj(c)}}function Ex(t,a){let s=a.replace(/\/+$/,"").split("/");return t.split("/").forEach(c=>{c===".."?s.length>1&&s.pop():c!=="."&&s.push(c)}),s.length>1?s.join("/"):"/"}function Qf(t,a,s,o){return`Cannot include a '${t}' character in a manually specified \`to.${a}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Mj(t){return t.filter((a,s)=>s===0||a.route.path&&a.route.path.length>0)}function Yh(t){let a=Mj(t);return a.map((s,o)=>o===a.length-1?s.pathname:s.pathnameBase)}function Ph(t,a,s,o=!1){let c;typeof t=="string"?c=Kr(t):(c={...t},Ze(!c.pathname||!c.pathname.includes("?"),Qf("?","pathname","search",c)),Ze(!c.pathname||!c.pathname.includes("#"),Qf("#","pathname","hash",c)),Ze(!c.search||!c.search.includes("#"),Qf("#","search","hash",c)));let u=t===""||c.pathname==="",d=u?"/":c.pathname,m;if(d==null)m=s;else{let x=a.length-1;if(!o&&d.startsWith("..")){let b=d.split("/");for(;b[0]==="..";)b.shift(),x-=1;c.pathname=b.join("/")}m=x>=0?a[x]:"/"}let p=Tj(c,m),g=d&&d!=="/"&&d.endsWith("/"),y=(u||d===".")&&s.endsWith("/");return!p.pathname.endsWith("/")&&(g||y)&&(p.pathname+="/"),p}var xa=t=>t.join("/").replace(/\/\/+/g,"/"),Aj=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),kj=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Rj=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,zj=class{constructor(t,a,s,o=!1){this.status=t,this.statusText=a||"",this.internal=o,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}};function Dj(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function Oj(t){return t.map(a=>a.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var mb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function pb(t,a){let s=t;if(typeof s!="string"||!hb.test(s))return{absoluteURL:void 0,isExternal:!1,to:s};let o=s,c=!1;if(mb)try{let u=new URL(window.location.href),d=s.startsWith("//")?new URL(u.protocol+s):new URL(s),m=ya(d.pathname,a);d.origin===u.origin&&m!=null?s=m+d.search+d.hash:c=!0}catch{Ft(!1,`<Link to="${s}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:o,isExternal:c,to:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var gb=["POST","PUT","PATCH","DELETE"];new Set(gb);var Bj=["GET",...gb];new Set(Bj);var Jr=N.createContext(null);Jr.displayName="DataRouter";var au=N.createContext(null);au.displayName="DataRouterState";var Lj=N.createContext(!1),xb=N.createContext({isTransitioning:!1});xb.displayName="ViewTransition";var Hj=N.createContext(new Map);Hj.displayName="Fetchers";var $j=N.createContext(null);$j.displayName="Await";var Wt=N.createContext(null);Wt.displayName="Navigation";var Eo=N.createContext(null);Eo.displayName="Location";var dn=N.createContext({outlet:null,matches:[],isDataRoute:!1});dn.displayName="Route";var Ih=N.createContext(null);Ih.displayName="RouteError";var yb="REACT_ROUTER_ERROR",qj="REDIRECT",Uj="ROUTE_ERROR_RESPONSE";function Vj(t){if(t.startsWith(`${yb}:${qj}:{`))try{let a=JSON.parse(t.slice(28));if(typeof a=="object"&&a&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.location=="string"&&typeof a.reloadDocument=="boolean"&&typeof a.replace=="boolean")return a}catch{}}function Yj(t){if(t.startsWith(`${yb}:${Uj}:{`))try{let a=JSON.parse(t.slice(40));if(typeof a=="object"&&a&&typeof a.status=="number"&&typeof a.statusText=="string")return new zj(a.status,a.statusText,a.data)}catch{}}function Pj(t,{relative:a}={}){Ze(ei(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:o}=N.useContext(Wt),{hash:c,pathname:u,search:d}=Co(t,{relative:a}),m=u;return s!=="/"&&(m=u==="/"?s:xa([s,u])),o.createHref({pathname:m,search:d,hash:c})}function ei(){return N.useContext(Eo)!=null}function wa(){return Ze(ei(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(Eo).location}var bb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function vb(t){N.useContext(Wt).static||N.useLayoutEffect(t)}function Ys(){let{isDataRoute:t}=N.useContext(dn);return t?iN():Ij()}function Ij(){Ze(ei(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(Jr),{basename:a,navigator:s}=N.useContext(Wt),{matches:o}=N.useContext(dn),{pathname:c}=wa(),u=JSON.stringify(Yh(o)),d=N.useRef(!1);return vb(()=>{d.current=!0}),N.useCallback((p,g={})=>{if(Ft(d.current,bb),!d.current)return;if(typeof p=="number"){s.go(p);return}let y=Ph(p,JSON.parse(u),c,g.relative==="path");t==null&&a!=="/"&&(y.pathname=y.pathname==="/"?a:xa([a,y.pathname])),(g.replace?s.replace:s.push)(y,g.state,g)},[a,s,u,c,t])}var Xj=N.createContext(null);function Gj(t){let a=N.useContext(dn).outlet;return N.useMemo(()=>a&&N.createElement(Xj.Provider,{value:t},a),[a,t])}function Qj(){let{matches:t}=N.useContext(dn),a=t[t.length-1];return a?a.params:{}}function Co(t,{relative:a}={}){let{matches:s}=N.useContext(dn),{pathname:o}=wa(),c=JSON.stringify(Yh(s));return N.useMemo(()=>Ph(t,JSON.parse(c),o,a==="path"),[t,c,o,a])}function Fj(t,a){return wb(t,a)}function wb(t,a,s,o,c){Ze(ei(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=N.useContext(Wt),{matches:d}=N.useContext(dn),m=d[d.length-1],p=m?m.params:{},g=m?m.pathname:"/",y=m?m.pathnameBase:"/",x=m&&m.route;{let R=x&&x.path||"";Nb(g,!x||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let b=wa(),j;if(a){let R=typeof a=="string"?Kr(a):a;Ze(y==="/"||R.pathname?.startsWith(y),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${y}" but pathname "${R.pathname}" was given in the \`location\` prop.`),j=R}else j=b;let S=j.pathname||"/",C=S;if(y!=="/"){let R=y.replace(/^\//,"").split("/");C="/"+S.replace(/^\//,"").split("/").slice(R.length).join("/")}let _=ub(t,{pathname:C});Ft(x||_!=null,`No routes matched location "${j.pathname}${j.search}${j.hash}" `),Ft(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${j.pathname}${j.search}${j.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=eN(_&&_.map(R=>Object.assign({},R,{params:Object.assign({},p,R.params),pathname:xa([y,u.encodeLocation?u.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?y:xa([y,u.encodeLocation?u.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),d,s,o,c);return a&&E?N.createElement(Eo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...j},navigationType:"POP"}},E):E}function Zj(){let t=rN(),a=Dj(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,o="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:o},u={padding:"2px 4px",backgroundColor:o},d=null;return console.error("Error handled by React Router default ErrorBoundary:",t),d=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:u},"ErrorBoundary")," or"," ",N.createElement("code",{style:u},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},a),s?N.createElement("pre",{style:c},s):null,d)}var Wj=N.createElement(Zj,null),jb=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,a){return a.location!==t.location||a.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:a.error,location:a.location,revalidation:t.revalidation||a.revalidation}}componentDidCatch(t,a){this.props.onError?this.props.onError(t,a):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const s=Yj(t.digest);s&&(t=s)}let a=t!==void 0?N.createElement(dn.Provider,{value:this.props.routeContext},N.createElement(Ih.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?N.createElement(Kj,{error:t},a):a}};jb.contextType=Lj;var Ff=new WeakMap;function Kj({children:t,error:a}){let{basename:s}=N.useContext(Wt);if(typeof a=="object"&&a&&"digest"in a&&typeof a.digest=="string"){let o=Vj(a.digest);if(o){let c=Ff.get(a);if(c)throw c;let u=pb(o.location,s);if(mb&&!Ff.get(a))if(u.isExternal||o.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:o.replace}));throw Ff.set(a,d),d}return N.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return t}function Jj({routeContext:t,match:a,children:s}){let o=N.useContext(Jr);return o&&o.static&&o.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=a.route.id),N.createElement(dn.Provider,{value:t},s)}function eN(t,a=[],s=null,o=null,c=null){if(t==null){if(!s)return null;if(s.errors)t=s.matches;else if(a.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let u=t,d=s?.errors;if(d!=null){let y=u.findIndex(x=>x.route.id&&d?.[x.route.id]!==void 0);Ze(y>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,y+1))}let m=!1,p=-1;if(s)for(let y=0;y<u.length;y++){let x=u[y];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=y),x.route.id){let{loaderData:b,errors:j}=s,S=x.route.loader&&!b.hasOwnProperty(x.route.id)&&(!j||j[x.route.id]===void 0);if(x.route.lazy||S){m=!0,p>=0?u=u.slice(0,p+1):u=[u[0]];break}}}let g=s&&o?(y,x)=>{o(y,{location:s.location,params:s.matches?.[0]?.params??{},unstable_pattern:Oj(s.matches),errorInfo:x})}:void 0;return u.reduceRight((y,x,b)=>{let j,S=!1,C=null,_=null;s&&(j=d&&x.route.id?d[x.route.id]:void 0,C=x.route.errorElement||Wj,m&&(p<0&&b===0?(Nb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,_=null):p===b&&(S=!0,_=x.route.hydrateFallbackElement||null)));let E=a.concat(u.slice(0,b+1)),R=()=>{let T;return j?T=C:S?T=_:x.route.Component?T=N.createElement(x.route.Component,null):x.route.element?T=x.route.element:T=y,N.createElement(Jj,{match:x,routeContext:{outlet:y,matches:E,isDataRoute:s!=null},children:T})};return s&&(x.route.ErrorBoundary||x.route.errorElement||b===0)?N.createElement(jb,{location:s.location,revalidation:s.revalidation,component:C,error:j,children:R(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:g}):R()},null)}function Xh(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tN(t){let a=N.useContext(Jr);return Ze(a,Xh(t)),a}function nN(t){let a=N.useContext(au);return Ze(a,Xh(t)),a}function aN(t){let a=N.useContext(dn);return Ze(a,Xh(t)),a}function Gh(t){let a=aN(t),s=a.matches[a.matches.length-1];return Ze(s.route.id,`${t} can only be used on routes that contain a unique "id"`),s.route.id}function sN(){return Gh("useRouteId")}function rN(){let t=N.useContext(Ih),a=nN("useRouteError"),s=Gh("useRouteError");return t!==void 0?t:a.errors?.[s]}function iN(){let{router:t}=tN("useNavigate"),a=Gh("useNavigate"),s=N.useRef(!1);return vb(()=>{s.current=!0}),N.useCallback(async(c,u={})=>{Ft(s.current,bb),s.current&&(typeof c=="number"?await t.navigate(c):await t.navigate(c,{fromRouteId:a,...u}))},[t,a])}var Cx={};function Nb(t,a,s){!a&&!Cx[t]&&(Cx[t]=!0,Ft(!1,s))}N.memo(oN);function oN({routes:t,future:a,state:s,onError:o}){return wb(t,void 0,s,o,a)}function $c({to:t,replace:a,state:s,relative:o}){Ze(ei(),"<Navigate> may be used only in the context of a <Router> component.");let{static:c}=N.useContext(Wt);Ft(!c,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=N.useContext(dn),{pathname:d}=wa(),m=Ys(),p=Ph(t,Yh(u),d,o==="path"),g=JSON.stringify(p);return N.useEffect(()=>{m(JSON.parse(g),{replace:a,state:s,relative:o})},[m,g,o,a,s]),null}function lN(t){return Gj(t.context)}function _t(t){Ze(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function cN({basename:t="/",children:a=null,location:s,navigationType:o="POP",navigator:c,static:u=!1,unstable_useTransitions:d}){Ze(!ei(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=t.replace(/^\/*/,"/"),p=N.useMemo(()=>({basename:m,navigator:c,static:u,unstable_useTransitions:d,future:{}}),[m,c,u,d]);typeof s=="string"&&(s=Kr(s));let{pathname:g="/",search:y="",hash:x="",state:b=null,key:j="default"}=s,S=N.useMemo(()=>{let C=ya(g,m);return C==null?null:{location:{pathname:C,search:y,hash:x,state:b,key:j},navigationType:o}},[m,g,y,x,b,j,o]);return Ft(S!=null,`<Router basename="${m}"> is not able to match the URL "${g}${y}${x}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:N.createElement(Wt.Provider,{value:p},N.createElement(Eo.Provider,{children:a,value:S}))}function uN({children:t,location:a}){return Fj(yh(t),a)}function yh(t,a=[]){let s=[];return N.Children.forEach(t,(o,c)=>{if(!N.isValidElement(o))return;let u=[...a,c];if(o.type===N.Fragment){s.push.apply(s,yh(o.props.children,u));return}Ze(o.type===_t,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ze(!o.props.index||!o.props.children,"An index route cannot have child routes.");let d={id:o.props.id||u.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,middleware:o.props.middleware,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=yh(o.props.children,u)),s.push(d)}),s}var Ec="get",Cc="application/x-www-form-urlencoded";function su(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function dN(t){return su(t)&&t.tagName.toLowerCase()==="button"}function fN(t){return su(t)&&t.tagName.toLowerCase()==="form"}function hN(t){return su(t)&&t.tagName.toLowerCase()==="input"}function mN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function pN(t,a){return t.button===0&&(!a||a==="_self")&&!mN(t)}function bh(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((a,s)=>{let o=t[s];return a.concat(Array.isArray(o)?o.map(c=>[s,c]):[[s,o]])},[]))}function gN(t,a){let s=bh(t);return a&&a.forEach((o,c)=>{s.has(c)||a.getAll(c).forEach(u=>{s.append(c,u)})}),s}var uc=null;function xN(){if(uc===null)try{new FormData(document.createElement("form"),0),uc=!1}catch{uc=!0}return uc}var yN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Zf(t){return t!=null&&!yN.has(t)?(Ft(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cc}"`),null):t}function bN(t,a){let s,o,c,u,d;if(fN(t)){let m=t.getAttribute("action");o=m?ya(m,a):null,s=t.getAttribute("method")||Ec,c=Zf(t.getAttribute("enctype"))||Cc,u=new FormData(t)}else if(dN(t)||hN(t)&&(t.type==="submit"||t.type==="image")){let m=t.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||m.getAttribute("action");if(o=p?ya(p,a):null,s=t.getAttribute("formmethod")||m.getAttribute("method")||Ec,c=Zf(t.getAttribute("formenctype"))||Zf(m.getAttribute("enctype"))||Cc,u=new FormData(m,t),!xN()){let{name:g,type:y,value:x}=t;if(y==="image"){let b=g?`${g}.`:"";u.append(`${b}x`,"0"),u.append(`${b}y`,"0")}else g&&u.append(g,x)}}else{if(su(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=Ec,o=null,c=Cc,d=t}return u&&c==="text/plain"&&(d=u,u=void 0),{action:o,method:s.toLowerCase(),encType:c,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Qh(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function vN(t,a,s,o){let c=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s?c.pathname.endsWith("/")?c.pathname=`${c.pathname}_.${o}`:c.pathname=`${c.pathname}.${o}`:c.pathname==="/"?c.pathname=`_root.${o}`:a&&ya(c.pathname,a)==="/"?c.pathname=`${a.replace(/\/$/,"")}/_root.${o}`:c.pathname=`${c.pathname.replace(/\/$/,"")}.${o}`,c}async function wN(t,a){if(t.id in a)return a[t.id];try{let s=await import(t.module);return a[t.id]=s,s}catch(s){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function NN(t,a,s){let o=await Promise.all(t.map(async c=>{let u=a.routes[c.route.id];if(u){let d=await wN(u,s);return d.links?d.links():[]}return[]}));return CN(o.flat(1).filter(jN).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function Tx(t,a,s,o,c,u){let d=(p,g)=>s[g]?p.route.id!==s[g].route.id:!0,m=(p,g)=>s[g].pathname!==p.pathname||s[g].route.path?.endsWith("*")&&s[g].params["*"]!==p.params["*"];return u==="assets"?a.filter((p,g)=>d(p,g)||m(p,g)):u==="data"?a.filter((p,g)=>{let y=o.routes[p.route.id];if(!y||!y.hasLoader)return!1;if(d(p,g)||m(p,g))return!0;if(p.route.shouldRevalidate){let x=p.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:s[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function SN(t,a,{includeHydrateFallback:s}={}){return _N(t.map(o=>{let c=a.routes[o.route.id];if(!c)return[];let u=[c.module];return c.clientActionModule&&(u=u.concat(c.clientActionModule)),c.clientLoaderModule&&(u=u.concat(c.clientLoaderModule)),s&&c.hydrateFallbackModule&&(u=u.concat(c.hydrateFallbackModule)),c.imports&&(u=u.concat(c.imports)),u}).flat(1))}function _N(t){return[...new Set(t)]}function EN(t){let a={},s=Object.keys(t).sort();for(let o of s)a[o]=t[o];return a}function CN(t,a){let s=new Set;return new Set(a),t.reduce((o,c)=>{let u=JSON.stringify(EN(c));return s.has(u)||(s.add(u),o.push({key:u,link:c})),o},[])}function Sb(){let t=N.useContext(Jr);return Qh(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function TN(){let t=N.useContext(au);return Qh(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Fh=N.createContext(void 0);Fh.displayName="FrameworkContext";function _b(){let t=N.useContext(Fh);return Qh(t,"You must render this element inside a <HydratedRouter> element"),t}function MN(t,a){let s=N.useContext(Fh),[o,c]=N.useState(!1),[u,d]=N.useState(!1),{onFocus:m,onBlur:p,onMouseEnter:g,onMouseLeave:y,onTouchStart:x}=a,b=N.useRef(null);N.useEffect(()=>{if(t==="render"&&d(!0),t==="viewport"){let C=E=>{E.forEach(R=>{d(R.isIntersecting)})},_=new IntersectionObserver(C,{threshold:.5});return b.current&&_.observe(b.current),()=>{_.disconnect()}}},[t]),N.useEffect(()=>{if(o){let C=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(C)}}},[o]);let j=()=>{c(!0)},S=()=>{c(!1),d(!1)};return s?t!=="intent"?[u,b,{}]:[u,b,{onFocus:no(m,j),onBlur:no(p,S),onMouseEnter:no(g,j),onMouseLeave:no(y,S),onTouchStart:no(x,j)}]:[!1,b,{}]}function no(t,a){return s=>{t&&t(s),s.defaultPrevented||a(s)}}function AN({page:t,...a}){let{router:s}=Sb(),o=N.useMemo(()=>ub(s.routes,t,s.basename),[s.routes,t,s.basename]);return o?N.createElement(RN,{page:t,matches:o,...a}):null}function kN(t){let{manifest:a,routeModules:s}=_b(),[o,c]=N.useState([]);return N.useEffect(()=>{let u=!1;return NN(t,a,s).then(d=>{u||c(d)}),()=>{u=!0}},[t,a,s]),o}function RN({page:t,matches:a,...s}){let o=wa(),{future:c,manifest:u,routeModules:d}=_b(),{basename:m}=Sb(),{loaderData:p,matches:g}=TN(),y=N.useMemo(()=>Tx(t,a,g,u,o,"data"),[t,a,g,u,o]),x=N.useMemo(()=>Tx(t,a,g,u,o,"assets"),[t,a,g,u,o]),b=N.useMemo(()=>{if(t===o.pathname+o.search+o.hash)return[];let C=new Set,_=!1;if(a.forEach(R=>{let T=u.routes[R.route.id];!T||!T.hasLoader||(!y.some(A=>A.route.id===R.route.id)&&R.route.id in p&&d[R.route.id]?.shouldRevalidate||T.hasClientLoader?_=!0:C.add(R.route.id))}),C.size===0)return[];let E=vN(t,m,c.unstable_trailingSlashAwareDataRequests,"data");return _&&C.size>0&&E.searchParams.set("_routes",a.filter(R=>C.has(R.route.id)).map(R=>R.route.id).join(",")),[E.pathname+E.search]},[m,c.unstable_trailingSlashAwareDataRequests,p,o,u,y,a,t,d]),j=N.useMemo(()=>SN(x,u),[x,u]),S=kN(x);return N.createElement(N.Fragment,null,b.map(C=>N.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...s})),j.map(C=>N.createElement("link",{key:C,rel:"modulepreload",href:C,...s})),S.map(({key:C,link:_})=>N.createElement("link",{key:C,nonce:s.nonce,..._})))}function zN(...t){return a=>{t.forEach(s=>{typeof s=="function"?s(a):s!=null&&(s.current=a)})}}var DN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{DN&&(window.__reactRouterVersion="7.12.0")}catch{}function ON({basename:t,children:a,unstable_useTransitions:s,window:o}){let c=N.useRef();c.current==null&&(c.current=uj({window:o,v5Compat:!0}));let u=c.current,[d,m]=N.useState({action:u.action,location:u.location}),p=N.useCallback(g=>{s===!1?m(g):N.startTransition(()=>m(g))},[s]);return N.useLayoutEffect(()=>u.listen(p),[u,p]),N.createElement(cN,{basename:t,children:a,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:s})}var Eb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ds=N.forwardRef(function({onClick:a,discover:s="render",prefetch:o="none",relative:c,reloadDocument:u,replace:d,state:m,target:p,to:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:b,...j},S){let{basename:C,unstable_useTransitions:_}=N.useContext(Wt),E=typeof g=="string"&&Eb.test(g),R=pb(g,C);g=R.to;let T=Pj(g,{relative:c}),[A,w,D]=MN(o,j),M=HN(g,{replace:d,state:m,target:p,preventScrollReset:y,relative:c,viewTransition:x,unstable_defaultShouldRevalidate:b,unstable_useTransitions:_});function q(Q){a&&a(Q),Q.defaultPrevented||M(Q)}let H=N.createElement("a",{...j,...D,href:R.absoluteURL||T,onClick:R.isExternal||u?a:q,ref:zN(S,w),target:p,"data-discover":!E&&s==="render"?"true":void 0});return A&&!E?N.createElement(N.Fragment,null,H,N.createElement(AN,{page:T})):H});Ds.displayName="Link";var Cb=N.forwardRef(function({"aria-current":a="page",caseSensitive:s=!1,className:o="",end:c=!1,style:u,to:d,viewTransition:m,children:p,...g},y){let x=Co(d,{relative:g.relative}),b=wa(),j=N.useContext(au),{navigator:S,basename:C}=N.useContext(Wt),_=j!=null&&PN(x)&&m===!0,E=S.encodeLocation?S.encodeLocation(x).pathname:x.pathname,R=b.pathname,T=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;s||(R=R.toLowerCase(),T=T?T.toLowerCase():null,E=E.toLowerCase()),T&&C&&(T=ya(T,C)||T);const A=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let w=R===E||!c&&R.startsWith(E)&&R.charAt(A)==="/",D=T!=null&&(T===E||!c&&T.startsWith(E)&&T.charAt(E.length)==="/"),M={isActive:w,isPending:D,isTransitioning:_},q=w?a:void 0,H;typeof o=="function"?H=o(M):H=[o,w?"active":null,D?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let Q=typeof u=="function"?u(M):u;return N.createElement(Ds,{...g,"aria-current":q,className:H,ref:y,style:Q,to:d,viewTransition:m},typeof p=="function"?p(M):p)});Cb.displayName="NavLink";var BN=N.forwardRef(({discover:t="render",fetcherKey:a,navigate:s,reloadDocument:o,replace:c,state:u,method:d=Ec,action:m,onSubmit:p,relative:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:b,...j},S)=>{let{unstable_useTransitions:C}=N.useContext(Wt),_=VN(),E=YN(m,{relative:g}),R=d.toLowerCase()==="get"?"get":"post",T=typeof m=="string"&&Eb.test(m),A=w=>{if(p&&p(w),w.defaultPrevented)return;w.preventDefault();let D=w.nativeEvent.submitter,M=D?.getAttribute("formmethod")||d,q=()=>_(D||w.currentTarget,{fetcherKey:a,method:M,navigate:s,replace:c,state:u,relative:g,preventScrollReset:y,viewTransition:x,unstable_defaultShouldRevalidate:b});C&&s!==!1?N.startTransition(()=>q()):q()};return N.createElement("form",{ref:S,method:R,action:E,onSubmit:o?p:A,...j,"data-discover":!T&&t==="render"?"true":void 0})});BN.displayName="Form";function LN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Tb(t){let a=N.useContext(Jr);return Ze(a,LN(t)),a}function HN(t,{target:a,replace:s,state:o,preventScrollReset:c,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:m,unstable_useTransitions:p}={}){let g=Ys(),y=wa(),x=Co(t,{relative:u});return N.useCallback(b=>{if(pN(b,a)){b.preventDefault();let j=s!==void 0?s:mo(y)===mo(x),S=()=>g(t,{replace:j,state:o,preventScrollReset:c,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:m});p?N.startTransition(()=>S()):S()}},[y,g,x,s,o,a,t,c,u,d,m,p])}function $N(t){Ft(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let a=N.useRef(bh(t)),s=N.useRef(!1),o=wa(),c=N.useMemo(()=>gN(o.search,s.current?null:a.current),[o.search]),u=Ys(),d=N.useCallback((m,p)=>{const g=bh(typeof m=="function"?m(new URLSearchParams(c)):m);s.current=!0,u("?"+g,p)},[u,c]);return[c,d]}var qN=0,UN=()=>`__${String(++qN)}__`;function VN(){let{router:t}=Tb("useSubmit"),{basename:a}=N.useContext(Wt),s=sN(),o=t.fetch,c=t.navigate;return N.useCallback(async(u,d={})=>{let{action:m,method:p,encType:g,formData:y,body:x}=bN(u,a);if(d.navigate===!1){let b=d.fetcherKey||UN();await o(b,s,d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:y,body:x,formMethod:d.method||p,formEncType:d.encType||g,flushSync:d.flushSync})}else await c(d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:y,body:x,formMethod:d.method||p,formEncType:d.encType||g,replace:d.replace,state:d.state,fromRouteId:s,flushSync:d.flushSync,viewTransition:d.viewTransition})},[o,c,a,s])}function YN(t,{relative:a}={}){let{basename:s}=N.useContext(Wt),o=N.useContext(dn);Ze(o,"useFormAction must be used inside a RouteContext");let[c]=o.matches.slice(-1),u={...Co(t||".",{relative:a})},d=wa();if(t==null){u.search=d.search;let m=new URLSearchParams(u.search),p=m.getAll("index");if(p.some(y=>y==="")){m.delete("index"),p.filter(x=>x).forEach(x=>m.append("index",x));let y=m.toString();u.search=y?`?${y}`:""}}return(!t||t===".")&&c.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),s!=="/"&&(u.pathname=u.pathname==="/"?s:xa([s,u.pathname])),mo(u)}function PN(t,{relative:a}={}){let s=N.useContext(xb);Ze(s!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=Tb("useViewTransitionState"),c=Co(t,{relative:a});if(!s.isTransitioning)return!1;let u=ya(s.currentLocation.pathname,o)||s.currentLocation.pathname,d=ya(s.nextLocation.pathname,o)||s.nextLocation.pathname;return Hc(c.pathname,d)!=null||Hc(c.pathname,u)!=null}cb();const Mx=t=>{let a;const s=new Set,o=(g,y)=>{const x=typeof g=="function"?g(a):g;if(!Object.is(x,a)){const b=a;a=y??(typeof x!="object"||x===null)?x:Object.assign({},a,x),s.forEach(j=>j(a,b))}},c=()=>a,m={setState:o,getState:c,getInitialState:()=>p,subscribe:g=>(s.add(g),()=>s.delete(g))},p=a=t(o,c,m);return m},IN=(t=>t?Mx(t):Mx),XN=t=>t;function GN(t,a=XN){const s=zr.useSyncExternalStore(t.subscribe,zr.useCallback(()=>a(t.getState()),[t,a]),zr.useCallback(()=>a(t.getInitialState()),[t,a]));return zr.useDebugValue(s),s}const Ax=t=>{const a=IN(t),s=o=>GN(a,o);return Object.assign(s,a),s},Mb=(t=>t?Ax(t):Ax);function QN(t,a){let s;try{s=t()}catch{return}return{getItem:c=>{var u;const d=p=>p===null?null:JSON.parse(p,void 0),m=(u=s.getItem(c))!=null?u:null;return m instanceof Promise?m.then(d):d(m)},setItem:(c,u)=>s.setItem(c,JSON.stringify(u,void 0)),removeItem:c=>s.removeItem(c)}}const vh=t=>a=>{try{const s=t(a);return s instanceof Promise?s:{then(o){return vh(o)(s)},catch(o){return this}}}catch(s){return{then(o){return this},catch(o){return vh(o)(s)}}}},FN=(t,a)=>(s,o,c)=>{let u={storage:QN(()=>localStorage),partialize:_=>_,version:0,merge:(_,E)=>({...E,..._}),...a},d=!1,m=0;const p=new Set,g=new Set;let y=u.storage;if(!y)return t((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${u.name}', the given storage is currently unavailable.`),s(..._)},o,c);const x=()=>{const _=u.partialize({...o()});return y.setItem(u.name,{state:_,version:u.version})},b=c.setState;c.setState=(_,E)=>(b(_,E),x());const j=t((..._)=>(s(..._),x()),o,c);c.getInitialState=()=>j;let S;const C=()=>{var _,E;if(!y)return;const R=++m;d=!1,p.forEach(A=>{var w;return A((w=o())!=null?w:j)});const T=((E=u.onRehydrateStorage)==null?void 0:E.call(u,(_=o())!=null?_:j))||void 0;return vh(y.getItem.bind(y))(u.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==u.version){if(u.migrate){const w=u.migrate(A.state,A.version);return w instanceof Promise?w.then(D=>[!0,D]):[!0,w]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var w;if(R!==m)return;const[D,M]=A;if(S=u.merge(M,(w=o())!=null?w:j),s(S,!0),D)return x()}).then(()=>{R===m&&(T?.(S,void 0),S=o(),d=!0,g.forEach(A=>A(S)))}).catch(A=>{R===m&&T?.(void 0,A)})};return c.persist={setOptions:_=>{u={...u,..._},_.storage&&(y=_.storage)},clearStorage:()=>{y?.removeItem(u.name)},getOptions:()=>u,rehydrate:()=>C(),hasHydrated:()=>d,onHydrate:_=>(p.add(_),()=>{p.delete(_)}),onFinishHydration:_=>(g.add(_),()=>{g.delete(_)})},u.skipHydration||C(),S||j},ZN=FN,At=Mb(ZN(t=>({user:null,agent:null,token:null,basicToken:null,isAuthenticated:!1,login:(a,s,o)=>{t({user:a,agent:a,token:s,basicToken:o,isAuthenticated:!0})},logout:()=>{t({user:null,agent:null,token:null,basicToken:null,isAuthenticated:!1})}}),{name:"auth-storage"}));const WN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),KN=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,s,o)=>o?o.toUpperCase():s.toLowerCase()),kx=t=>{const a=KN(t);return a.charAt(0).toUpperCase()+a.slice(1)},Ab=(...t)=>t.filter((a,s,o)=>!!a&&a.trim()!==""&&o.indexOf(a)===s).join(" ").trim(),JN=t=>{for(const a in t)if(a.startsWith("aria-")||a==="role"||a==="title")return!0};var eS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const tS=N.forwardRef(({color:t="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:c="",children:u,iconNode:d,...m},p)=>N.createElement("svg",{ref:p,...eS,width:a,height:a,stroke:t,strokeWidth:o?Number(s)*24/Number(a):s,className:Ab("lucide",c),...!u&&!JN(m)&&{"aria-hidden":"true"},...m},[...d.map(([g,y])=>N.createElement(g,y)),...Array.isArray(u)?u:[u]]));const pe=(t,a)=>{const s=N.forwardRef(({className:o,...c},u)=>N.createElement(tS,{ref:u,iconNode:a,className:Ab(`lucide-${WN(kx(t))}`,`lucide-${t}`,o),...c}));return s.displayName=kx(t),s};const nS=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],ns=pe("activity",nS);const aS=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],sS=pe("arrow-left",aS);const rS=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Zh=pe("arrow-right-left",rS);const iS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],oS=pe("arrow-right",iS);const lS=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],rs=pe("book-open",lS);const cS=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Wh=pe("bot",cS);const uS=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Ln=pe("brain",uS);const dS=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],$r=pe("building-2",dS);const fS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Kh=pe("chart-column",fS);const hS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Et=pe("check",hS);const mS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],pS=pe("chevron-down",mS);const gS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],xS=pe("chevron-left",gS);const yS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],To=pe("chevron-right",yS);const bS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],vS=pe("circle-alert",bS);const wS=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qc=pe("circle-check-big",wS);const jS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Jh=pe("circle-x",jS);const NS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qr=pe("clock",NS);const SS=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Uc=pe("code",SS);const _S=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ur=pe("dollar-sign",_S);const ES=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],CS=pe("download",ES);const TS=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],MS=pe("eye-off",TS);const AS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],em=pe("eye",AS);const kS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ti=pe("file-text",kS);const RS=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],tm=pe("funnel",RS);const zS=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],nm=pe("git-branch",zS);const DS=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],OS=pe("heart",DS);const BS=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],LS=pe("image",BS);const HS=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],kb=pe("inbox",HS);const $S=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],qS=pe("key",$S);const US=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],VS=pe("layout-dashboard",US);const YS=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],PS=pe("loader-circle",YS);const IS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],XS=pe("log-out",IS);const GS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],QS=pe("map-pin",GS);const FS=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],qt=pe("message-square",FS);const ZS=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],WS=pe("mic",ZS);const KS=[["path",{d:"M5 12h14",key:"1ays0h"}]],Rb=pe("minus",KS);const JS=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],zb=pe("pen-line",JS);const e4=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ru=pe("phone",e4);const t4=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Db=pe("play",t4);const n4=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],am=pe("plus",n4);const a4=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],s4=pe("radio",a4);const r4=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],os=pe("refresh-cw",r4);const i4=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ob=pe("rotate-ccw",i4);const o4=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],l4=pe("save",o4);const c4=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],sm=pe("search",c4);const u4=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],rm=pe("send",u4);const d4=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ni=pe("shield",d4);const f4=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Vr=pe("sparkles",f4);const h4=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],iu=pe("square-pen",h4);const m4=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],p4=pe("tag",m4);const g4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ou=pe("target",g4);const x4=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Mo=pe("trash-2",x4);const y4=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Vc=pe("trending-up",y4);const b4=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],oo=pe("triangle-alert",b4);const v4=[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],w4=pe("user-cog",v4);const j4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Yr=pe("user-plus",j4);const N4=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Bs=pe("user",N4);const S4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],lu=pe("users",S4);const _4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],qn=pe("x",_4);const E4=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Ao=pe("zap",E4);function C4(){const t=Ys(),{agent:a,logout:s}=At(),o=a?.role==="supervisor",c=[{to:"/dashboard",icon:VS,label:"Dashboard"},{to:"/conversations",icon:qt,label:"Conversaciones"},...o?[{to:"/agents",icon:w4,label:"Agentes"},{to:"/departments",icon:$r,label:"Departamentos"},{to:"/flows",icon:nm,label:"Flujos"},{to:"/logs",icon:ns,label:"Logs"},{to:"/leads",icon:lu,label:"Leads"},{to:"/analytics",icon:Kh,label:"Analytics"},{to:"/monitor",icon:s4,label:"Monitor"},{to:"/learning",icon:Ln,label:"Cerebro IA"}]:[]],u=()=>{s(),t("/login")},d=o?"Supervisor":"Agente";return r.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[r.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[r.jsxs("div",{className:"h-16 flex items-center gap-3 px-6 border-b border-gray-200",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-xl flex items-center justify-center",children:r.jsx(Wh,{className:"w-6 h-6 text-white"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"font-bold text-gray-800",children:"Chat Platform"}),r.jsx("p",{className:"text-xs text-gray-400",children:"Respaldos Chile"})]})]}),r.jsx("nav",{className:"flex-1 p-4 space-y-1",children:c.map(({to:m,icon:p,label:g})=>r.jsxs(Cb,{to:m,className:({isActive:y})=>`flex items-center gap-3 px-4 py-3 rounded-lg transition ${y?"bg-indigo-50 text-indigo-600 font-medium":"text-gray-600 hover:bg-gray-100"}`,children:[r.jsx(p,{className:"w-5 h-5"}),r.jsx("span",{children:g})]},m))}),r.jsx("div",{className:"p-4 border-t border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:a?.avatarColor||"#6366f1"},children:r.jsx("span",{className:"text-white font-medium text-sm",children:a?.name?.[0]?.toUpperCase()||a?.username?.[0]?.toUpperCase()||"A"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-800 text-sm",children:a?.name||a?.username||"Admin"}),r.jsx("p",{className:"text-xs text-gray-400",children:d})]})]}),r.jsx("button",{onClick:u,className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition",title:"Cerrar sesion",children:r.jsx(XS,{className:"w-5 h-5"})})]})})]}),r.jsx("main",{className:"flex-1 overflow-auto",children:r.jsx(lN,{})})]})}async function T4(t,a){const s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})});if(!s.ok){const c=await s.json().catch(()=>({}));throw new Error(c.error||"Credenciales invlidas")}const o=await s.json();return{agent:o.agent,token:o.token,basicToken:o.basicToken}}function M4(){const[t,a]=N.useState(""),[s,o]=N.useState(""),[c,u]=N.useState(""),[d,m]=N.useState(!1),p=Ys(),g=At(x=>x.login),y=async x=>{x.preventDefault(),u(""),m(!0);try{const{agent:b,token:j,basicToken:S}=await T4(t,s);g(b,j,S),p("/dashboard")}catch(b){u(b.message||"Error al iniciar sesin")}finally{m(!1)}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-10",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"w-18 h-18 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-5 p-4",children:r.jsx("svg",{className:"w-11 h-11 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Chat Platform"}),r.jsx("p",{className:"text-gray-500 text-sm",children:"Ingresa tus credenciales para continuar"})]}),r.jsxs("form",{onSubmit:y,children:[c&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-3 rounded-xl text-sm mb-5 border border-red-200",children:c}),r.jsxs("div",{className:"mb-5",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Usuario"}),r.jsx("input",{type:"text",value:t,onChange:x=>a(x.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl text-base outline-none transition-colors focus:border-indigo-500",placeholder:"admin",required:!0})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),r.jsx("input",{type:"password",value:s,onChange:x=>o(x.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl text-base outline-none transition-colors focus:border-indigo-500",placeholder:"",required:!0})]}),r.jsx("button",{type:"submit",disabled:d,className:"w-full bg-gradient-to-r from-indigo-500 to-blue-600 hover:from-indigo-600 hover:to-blue-700 text-white font-semibold py-3.5 px-5 rounded-xl text-base transition-all shadow-lg shadow-indigo-500/30 disabled:opacity-60 disabled:cursor-not-allowed",children:d?"Ingresando...":"Ingresar"})]}),r.jsx("p",{className:"text-center text-gray-400 text-xs mt-8",children:"Respaldos Chile  2025"})]})})}const ko=()=>{const t=At.getState().token;return{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}}};async function Bb(t,a){const s=new URLSearchParams;t&&s.set("filter",t);const o=s.toString(),c=await fetch(`/api/chat/conversations${o?"?"+o:""}`,{headers:ko()});if(!c.ok)throw new Error("Error loading conversations");return c.json()}async function A4(t){const a=await fetch(`/api/chat/conversations/${encodeURIComponent(t)}`,{headers:ko()});if(!a.ok)throw new Error("Error loading conversation");return a.json()}async function k4(t,a){const s=await fetch("/api/chat/send",{method:"POST",headers:ko(),body:JSON.stringify({to:t,message:a})});if(!s.ok)throw new Error("Error sending message");return s.json()}async function Rx(t){const a=await fetch("/api/chat/mark-read",{method:"POST",headers:ko(),body:JSON.stringify({phone:t})});if(!a.ok)throw new Error("Error marking as read");return a.json()}async function R4(){const t=await fetch("/api/chatbot/stats",{headers:ko()});if(!t.ok)throw new Error("Error loading stats");return t.json()}function un({title:t,value:a,icon:s,color:o="green",subtitle:c}){const u={green:"bg-green-50 text-green-600",blue:"bg-blue-50 text-blue-600",yellow:"bg-yellow-50 text-yellow-600",purple:"bg-purple-50 text-purple-600",red:"bg-red-50 text-red-600"};return r.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500 font-medium",children:t}),r.jsx("p",{className:"text-3xl font-bold text-gray-800 mt-2",children:a}),c&&r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:c})]}),s&&r.jsx("div",{className:`p-3 rounded-xl ${u[o]}`,children:r.jsx(s,{className:"w-6 h-6"})})]})})}const Lb=6048e5,z4=864e5,dc=43200,zx=1440,Dx=Symbol.for("constructDateFrom");function ba(t,a){return typeof t=="function"?t(a):t&&typeof t=="object"&&Dx in t?t[Dx](a):t instanceof Date?new t.constructor(a):new Date(a)}function xt(t,a){return ba(a||t,t)}let D4={};function Ro(){return D4}function po(t,a){const s=Ro(),o=a?.weekStartsOn??a?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,c=xt(t,a?.in),u=c.getDay(),d=(u<o?7:0)+u-o;return c.setDate(c.getDate()-d),c.setHours(0,0,0,0),c}function Yc(t,a){return po(t,{...a,weekStartsOn:1})}function Hb(t,a){const s=xt(t,a?.in),o=s.getFullYear(),c=ba(s,0);c.setFullYear(o+1,0,4),c.setHours(0,0,0,0);const u=Yc(c),d=ba(s,0);d.setFullYear(o,0,4),d.setHours(0,0,0,0);const m=Yc(d);return s.getTime()>=u.getTime()?o+1:s.getTime()>=m.getTime()?o:o-1}function Pc(t){const a=xt(t),s=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()));return s.setUTCFullYear(a.getFullYear()),+t-+s}function cu(t,...a){const s=ba.bind(null,t||a.find(o=>typeof o=="object"));return a.map(s)}function Ox(t,a){const s=xt(t,a?.in);return s.setHours(0,0,0,0),s}function O4(t,a,s){const[o,c]=cu(s?.in,t,a),u=Ox(o),d=Ox(c),m=+u-Pc(u),p=+d-Pc(d);return Math.round((m-p)/z4)}function B4(t,a){const s=Hb(t,a),o=ba(t,0);return o.setFullYear(s,0,4),o.setHours(0,0,0,0),Yc(o)}function Tc(t,a){const s=+xt(t)-+xt(a);return s<0?-1:s>0?1:s}function L4(t){return ba(t,Date.now())}function H4(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function $4(t){return!(!H4(t)&&typeof t!="number"||isNaN(+xt(t)))}function q4(t,a,s){const[o,c]=cu(s?.in,t,a),u=o.getFullYear()-c.getFullYear(),d=o.getMonth()-c.getMonth();return u*12+d}function U4(t){return a=>{const o=(t?Math[t]:Math.trunc)(a);return o===0?0:o}}function V4(t,a){return+xt(t)-+xt(a)}function Y4(t,a){const s=xt(t,a?.in);return s.setHours(23,59,59,999),s}function P4(t,a){const s=xt(t,a?.in),o=s.getMonth();return s.setFullYear(s.getFullYear(),o+1,0),s.setHours(23,59,59,999),s}function I4(t,a){const s=xt(t,a?.in);return+Y4(s,a)==+P4(s,a)}function X4(t,a,s){const[o,c,u]=cu(s?.in,t,t,a),d=Tc(c,u),m=Math.abs(q4(c,u));if(m<1)return 0;c.getMonth()===1&&c.getDate()>27&&c.setDate(30),c.setMonth(c.getMonth()-d*m);let p=Tc(c,u)===-d;I4(o)&&m===1&&Tc(o,u)===1&&(p=!1);const g=d*(m-+p);return g===0?0:g}function G4(t,a,s){const o=V4(t,a)/1e3;return U4(s?.roundingMethod)(o)}function Q4(t,a){const s=xt(t,a?.in);return s.setFullYear(s.getFullYear(),0,1),s.setHours(0,0,0,0),s}const F4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Z4=(t,a,s)=>{let o;const c=F4[t];return typeof c=="string"?o=c:a===1?o=c.one:o=c.other.replace("{{count}}",a.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+o:o+" ago":o};function Br(t){return(a={})=>{const s=a.width?String(a.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const W4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},K4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},J4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},e5={date:Br({formats:W4,defaultWidth:"full"}),time:Br({formats:K4,defaultWidth:"full"}),dateTime:Br({formats:J4,defaultWidth:"full"})},t5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},n5=(t,a,s,o)=>t5[t];function On(t){return(a,s)=>{const o=s?.context?String(s.context):"standalone";let c;if(o==="formatting"&&t.formattingValues){const d=t.defaultFormattingWidth||t.defaultWidth,m=s?.width?String(s.width):d;c=t.formattingValues[m]||t.formattingValues[d]}else{const d=t.defaultWidth,m=s?.width?String(s.width):t.defaultWidth;c=t.values[m]||t.values[d]}const u=t.argumentCallback?t.argumentCallback(a):a;return c[u]}}const a5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},s5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},r5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},i5={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},o5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},l5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},c5=(t,a)=>{const s=Number(t),o=s%100;if(o>20||o<10)switch(o%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},u5={ordinalNumber:c5,era:On({values:a5,defaultWidth:"wide"}),quarter:On({values:s5,defaultWidth:"wide",argumentCallback:t=>t-1}),month:On({values:r5,defaultWidth:"wide"}),day:On({values:i5,defaultWidth:"wide"}),dayPeriod:On({values:o5,defaultWidth:"wide",formattingValues:l5,defaultFormattingWidth:"wide"})};function Bn(t){return(a,s={})=>{const o=s.width,c=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],u=a.match(c);if(!u)return null;const d=u[0],m=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth],p=Array.isArray(m)?f5(m,x=>x.test(d)):d5(m,x=>x.test(d));let g;g=t.valueCallback?t.valueCallback(p):p,g=s.valueCallback?s.valueCallback(g):g;const y=a.slice(d.length);return{value:g,rest:y}}}function d5(t,a){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&a(t[s]))return s}function f5(t,a){for(let s=0;s<t.length;s++)if(a(t[s]))return s}function $b(t){return(a,s={})=>{const o=a.match(t.matchPattern);if(!o)return null;const c=o[0],u=a.match(t.parsePattern);if(!u)return null;let d=t.valueCallback?t.valueCallback(u[0]):u[0];d=s.valueCallback?s.valueCallback(d):d;const m=a.slice(c.length);return{value:d,rest:m}}}const h5=/^(\d+)(th|st|nd|rd)?/i,m5=/\d+/i,p5={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},g5={any:[/^b/i,/^(a|c)/i]},x5={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},y5={any:[/1/i,/2/i,/3/i,/4/i]},b5={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},v5={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},w5={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},j5={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},N5={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},S5={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},_5={ordinalNumber:$b({matchPattern:h5,parsePattern:m5,valueCallback:t=>parseInt(t,10)}),era:Bn({matchPatterns:p5,defaultMatchWidth:"wide",parsePatterns:g5,defaultParseWidth:"any"}),quarter:Bn({matchPatterns:x5,defaultMatchWidth:"wide",parsePatterns:y5,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Bn({matchPatterns:b5,defaultMatchWidth:"wide",parsePatterns:v5,defaultParseWidth:"any"}),day:Bn({matchPatterns:w5,defaultMatchWidth:"wide",parsePatterns:j5,defaultParseWidth:"any"}),dayPeriod:Bn({matchPatterns:N5,defaultMatchWidth:"any",parsePatterns:S5,defaultParseWidth:"any"})},qb={code:"en-US",formatDistance:Z4,formatLong:e5,formatRelative:n5,localize:u5,match:_5,options:{weekStartsOn:0,firstWeekContainsDate:1}};function E5(t,a){const s=xt(t,a?.in);return O4(s,Q4(s))+1}function C5(t,a){const s=xt(t,a?.in),o=+Yc(s)-+B4(s);return Math.round(o/Lb)+1}function Ub(t,a){const s=xt(t,a?.in),o=s.getFullYear(),c=Ro(),u=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??c.firstWeekContainsDate??c.locale?.options?.firstWeekContainsDate??1,d=ba(a?.in||t,0);d.setFullYear(o+1,0,u),d.setHours(0,0,0,0);const m=po(d,a),p=ba(a?.in||t,0);p.setFullYear(o,0,u),p.setHours(0,0,0,0);const g=po(p,a);return+s>=+m?o+1:+s>=+g?o:o-1}function T5(t,a){const s=Ro(),o=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,c=Ub(t,a),u=ba(a?.in||t,0);return u.setFullYear(c,0,o),u.setHours(0,0,0,0),po(u,a)}function M5(t,a){const s=xt(t,a?.in),o=+po(s,a)-+T5(s,a);return Math.round(o/Lb)+1}function Ve(t,a){const s=t<0?"-":"",o=Math.abs(t).toString().padStart(a,"0");return s+o}const Ka={y(t,a){const s=t.getFullYear(),o=s>0?s:1-s;return Ve(a==="yy"?o%100:o,a.length)},M(t,a){const s=t.getMonth();return a==="M"?String(s+1):Ve(s+1,2)},d(t,a){return Ve(t.getDate(),a.length)},a(t,a){const s=t.getHours()/12>=1?"pm":"am";switch(a){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];default:return s==="am"?"a.m.":"p.m."}},h(t,a){return Ve(t.getHours()%12||12,a.length)},H(t,a){return Ve(t.getHours(),a.length)},m(t,a){return Ve(t.getMinutes(),a.length)},s(t,a){return Ve(t.getSeconds(),a.length)},S(t,a){const s=a.length,o=t.getMilliseconds(),c=Math.trunc(o*Math.pow(10,s-3));return Ve(c,a.length)}},Ar={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Bx={G:function(t,a,s){const o=t.getFullYear()>0?1:0;switch(a){case"G":case"GG":case"GGG":return s.era(o,{width:"abbreviated"});case"GGGGG":return s.era(o,{width:"narrow"});default:return s.era(o,{width:"wide"})}},y:function(t,a,s){if(a==="yo"){const o=t.getFullYear(),c=o>0?o:1-o;return s.ordinalNumber(c,{unit:"year"})}return Ka.y(t,a)},Y:function(t,a,s,o){const c=Ub(t,o),u=c>0?c:1-c;if(a==="YY"){const d=u%100;return Ve(d,2)}return a==="Yo"?s.ordinalNumber(u,{unit:"year"}):Ve(u,a.length)},R:function(t,a){const s=Hb(t);return Ve(s,a.length)},u:function(t,a){const s=t.getFullYear();return Ve(s,a.length)},Q:function(t,a,s){const o=Math.ceil((t.getMonth()+1)/3);switch(a){case"Q":return String(o);case"QQ":return Ve(o,2);case"Qo":return s.ordinalNumber(o,{unit:"quarter"});case"QQQ":return s.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(o,{width:"narrow",context:"formatting"});default:return s.quarter(o,{width:"wide",context:"formatting"})}},q:function(t,a,s){const o=Math.ceil((t.getMonth()+1)/3);switch(a){case"q":return String(o);case"qq":return Ve(o,2);case"qo":return s.ordinalNumber(o,{unit:"quarter"});case"qqq":return s.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(o,{width:"narrow",context:"standalone"});default:return s.quarter(o,{width:"wide",context:"standalone"})}},M:function(t,a,s){const o=t.getMonth();switch(a){case"M":case"MM":return Ka.M(t,a);case"Mo":return s.ordinalNumber(o+1,{unit:"month"});case"MMM":return s.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(o,{width:"narrow",context:"formatting"});default:return s.month(o,{width:"wide",context:"formatting"})}},L:function(t,a,s){const o=t.getMonth();switch(a){case"L":return String(o+1);case"LL":return Ve(o+1,2);case"Lo":return s.ordinalNumber(o+1,{unit:"month"});case"LLL":return s.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(o,{width:"narrow",context:"standalone"});default:return s.month(o,{width:"wide",context:"standalone"})}},w:function(t,a,s,o){const c=M5(t,o);return a==="wo"?s.ordinalNumber(c,{unit:"week"}):Ve(c,a.length)},I:function(t,a,s){const o=C5(t);return a==="Io"?s.ordinalNumber(o,{unit:"week"}):Ve(o,a.length)},d:function(t,a,s){return a==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):Ka.d(t,a)},D:function(t,a,s){const o=E5(t);return a==="Do"?s.ordinalNumber(o,{unit:"dayOfYear"}):Ve(o,a.length)},E:function(t,a,s){const o=t.getDay();switch(a){case"E":case"EE":case"EEE":return s.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(o,{width:"short",context:"formatting"});default:return s.day(o,{width:"wide",context:"formatting"})}},e:function(t,a,s,o){const c=t.getDay(),u=(c-o.weekStartsOn+8)%7||7;switch(a){case"e":return String(u);case"ee":return Ve(u,2);case"eo":return s.ordinalNumber(u,{unit:"day"});case"eee":return s.day(c,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(c,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(c,{width:"short",context:"formatting"});default:return s.day(c,{width:"wide",context:"formatting"})}},c:function(t,a,s,o){const c=t.getDay(),u=(c-o.weekStartsOn+8)%7||7;switch(a){case"c":return String(u);case"cc":return Ve(u,a.length);case"co":return s.ordinalNumber(u,{unit:"day"});case"ccc":return s.day(c,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(c,{width:"narrow",context:"standalone"});case"cccccc":return s.day(c,{width:"short",context:"standalone"});default:return s.day(c,{width:"wide",context:"standalone"})}},i:function(t,a,s){const o=t.getDay(),c=o===0?7:o;switch(a){case"i":return String(c);case"ii":return Ve(c,a.length);case"io":return s.ordinalNumber(c,{unit:"day"});case"iii":return s.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(o,{width:"short",context:"formatting"});default:return s.day(o,{width:"wide",context:"formatting"})}},a:function(t,a,s){const c=t.getHours()/12>=1?"pm":"am";switch(a){case"a":case"aa":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(c,{width:"narrow",context:"formatting"});default:return s.dayPeriod(c,{width:"wide",context:"formatting"})}},b:function(t,a,s){const o=t.getHours();let c;switch(o===12?c=Ar.noon:o===0?c=Ar.midnight:c=o/12>=1?"pm":"am",a){case"b":case"bb":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(c,{width:"narrow",context:"formatting"});default:return s.dayPeriod(c,{width:"wide",context:"formatting"})}},B:function(t,a,s){const o=t.getHours();let c;switch(o>=17?c=Ar.evening:o>=12?c=Ar.afternoon:o>=4?c=Ar.morning:c=Ar.night,a){case"B":case"BB":case"BBB":return s.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(c,{width:"narrow",context:"formatting"});default:return s.dayPeriod(c,{width:"wide",context:"formatting"})}},h:function(t,a,s){if(a==="ho"){let o=t.getHours()%12;return o===0&&(o=12),s.ordinalNumber(o,{unit:"hour"})}return Ka.h(t,a)},H:function(t,a,s){return a==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):Ka.H(t,a)},K:function(t,a,s){const o=t.getHours()%12;return a==="Ko"?s.ordinalNumber(o,{unit:"hour"}):Ve(o,a.length)},k:function(t,a,s){let o=t.getHours();return o===0&&(o=24),a==="ko"?s.ordinalNumber(o,{unit:"hour"}):Ve(o,a.length)},m:function(t,a,s){return a==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ka.m(t,a)},s:function(t,a,s){return a==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):Ka.s(t,a)},S:function(t,a){return Ka.S(t,a)},X:function(t,a,s){const o=t.getTimezoneOffset();if(o===0)return"Z";switch(a){case"X":return Hx(o);case"XXXX":case"XX":return Rs(o);default:return Rs(o,":")}},x:function(t,a,s){const o=t.getTimezoneOffset();switch(a){case"x":return Hx(o);case"xxxx":case"xx":return Rs(o);default:return Rs(o,":")}},O:function(t,a,s){const o=t.getTimezoneOffset();switch(a){case"O":case"OO":case"OOO":return"GMT"+Lx(o,":");default:return"GMT"+Rs(o,":")}},z:function(t,a,s){const o=t.getTimezoneOffset();switch(a){case"z":case"zz":case"zzz":return"GMT"+Lx(o,":");default:return"GMT"+Rs(o,":")}},t:function(t,a,s){const o=Math.trunc(+t/1e3);return Ve(o,a.length)},T:function(t,a,s){return Ve(+t,a.length)}};function Lx(t,a=""){const s=t>0?"-":"+",o=Math.abs(t),c=Math.trunc(o/60),u=o%60;return u===0?s+String(c):s+String(c)+a+Ve(u,2)}function Hx(t,a){return t%60===0?(t>0?"-":"+")+Ve(Math.abs(t)/60,2):Rs(t,a)}function Rs(t,a=""){const s=t>0?"-":"+",o=Math.abs(t),c=Ve(Math.trunc(o/60),2),u=Ve(o%60,2);return s+c+a+u}const $x=(t,a)=>{switch(t){case"P":return a.date({width:"short"});case"PP":return a.date({width:"medium"});case"PPP":return a.date({width:"long"});default:return a.date({width:"full"})}},Vb=(t,a)=>{switch(t){case"p":return a.time({width:"short"});case"pp":return a.time({width:"medium"});case"ppp":return a.time({width:"long"});default:return a.time({width:"full"})}},A5=(t,a)=>{const s=t.match(/(P+)(p+)?/)||[],o=s[1],c=s[2];if(!c)return $x(t,a);let u;switch(o){case"P":u=a.dateTime({width:"short"});break;case"PP":u=a.dateTime({width:"medium"});break;case"PPP":u=a.dateTime({width:"long"});break;default:u=a.dateTime({width:"full"});break}return u.replace("{{date}}",$x(o,a)).replace("{{time}}",Vb(c,a))},k5={p:Vb,P:A5},R5=/^D+$/,z5=/^Y+$/,D5=["D","DD","YY","YYYY"];function O5(t){return R5.test(t)}function B5(t){return z5.test(t)}function L5(t,a,s){const o=H5(t,a,s);if(console.warn(o),D5.includes(t))throw new RangeError(o)}function H5(t,a,s){const o=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${a}\`) for formatting ${o} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const $5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,q5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,U5=/^'([^]*?)'?$/,V5=/''/g,Y5=/[a-zA-Z]/;function uu(t,a,s){const o=Ro(),c=s?.locale??o.locale??qb,u=s?.firstWeekContainsDate??s?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,d=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0,m=xt(t,s?.in);if(!$4(m))throw new RangeError("Invalid time value");let p=a.match(q5).map(y=>{const x=y[0];if(x==="p"||x==="P"){const b=k5[x];return b(y,c.formatLong)}return y}).join("").match($5).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const x=y[0];if(x==="'")return{isToken:!1,value:P5(y)};if(Bx[x])return{isToken:!0,value:y};if(x.match(Y5))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:y}});c.localize.preprocessor&&(p=c.localize.preprocessor(m,p));const g={firstWeekContainsDate:u,weekStartsOn:d,locale:c};return p.map(y=>{if(!y.isToken)return y.value;const x=y.value;(!s?.useAdditionalWeekYearTokens&&B5(x)||!s?.useAdditionalDayOfYearTokens&&O5(x))&&L5(x,a,String(t));const b=Bx[x[0]];return b(m,x,c.localize,g)}).join("")}function P5(t){const a=t.match(U5);return a?a[1].replace(V5,"'"):t}function I5(t,a,s){const o=Ro(),c=s?.locale??o.locale??qb,u=2520,d=Tc(t,a);if(isNaN(d))throw new RangeError("Invalid time value");const m=Object.assign({},s,{addSuffix:s?.addSuffix,comparison:d}),[p,g]=cu(s?.in,...d>0?[a,t]:[t,a]),y=G4(g,p),x=(Pc(g)-Pc(p))/1e3,b=Math.round((y-x)/60);let j;if(b<2)return s?.includeSeconds?y<5?c.formatDistance("lessThanXSeconds",5,m):y<10?c.formatDistance("lessThanXSeconds",10,m):y<20?c.formatDistance("lessThanXSeconds",20,m):y<40?c.formatDistance("halfAMinute",0,m):y<60?c.formatDistance("lessThanXMinutes",1,m):c.formatDistance("xMinutes",1,m):b===0?c.formatDistance("lessThanXMinutes",1,m):c.formatDistance("xMinutes",b,m);if(b<45)return c.formatDistance("xMinutes",b,m);if(b<90)return c.formatDistance("aboutXHours",1,m);if(b<zx){const S=Math.round(b/60);return c.formatDistance("aboutXHours",S,m)}else{if(b<u)return c.formatDistance("xDays",1,m);if(b<dc){const S=Math.round(b/zx);return c.formatDistance("xDays",S,m)}else if(b<dc*2)return j=Math.round(b/dc),c.formatDistance("aboutXMonths",j,m)}if(j=X4(g,p),j<12){const S=Math.round(b/dc);return c.formatDistance("xMonths",S,m)}else{const S=j%12,C=Math.trunc(j/12);return S<3?c.formatDistance("aboutXYears",C,m):S<9?c.formatDistance("overXYears",C,m):c.formatDistance("almostXYears",C+1,m)}}function ai(t,a){return I5(t,L4(t),a)}const X5={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},G5=(t,a,s)=>{let o;const c=X5[t];return typeof c=="string"?o=c:a===1?o=c.one:o=c.other.replace("{{count}}",a.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"en "+o:"hace "+o:o},Q5={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},F5={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Z5={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},W5={date:Br({formats:Q5,defaultWidth:"full"}),time:Br({formats:F5,defaultWidth:"full"}),dateTime:Br({formats:Z5,defaultWidth:"full"})},K5={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},J5={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},e3=(t,a,s,o)=>a.getHours()!==1?J5[t]:K5[t],t3={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},n3={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},a3={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},s3={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},r3={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},i3={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},o3=(t,a)=>Number(t)+"",l3={ordinalNumber:o3,era:On({values:t3,defaultWidth:"wide"}),quarter:On({values:n3,defaultWidth:"wide",argumentCallback:t=>Number(t)-1}),month:On({values:a3,defaultWidth:"wide"}),day:On({values:s3,defaultWidth:"wide"}),dayPeriod:On({values:r3,defaultWidth:"wide",formattingValues:i3,defaultFormattingWidth:"wide"})},c3=/^(\d+)()?/i,u3=/\d+/i,d3={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},f3={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},h3={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},m3={any:[/1/i,/2/i,/3/i,/4/i]},p3={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},g3={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},x3={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},y3={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},b3={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},v3={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},w3={ordinalNumber:$b({matchPattern:c3,parsePattern:u3,valueCallback:function(t){return parseInt(t,10)}}),era:Bn({matchPatterns:d3,defaultMatchWidth:"wide",parsePatterns:f3,defaultParseWidth:"any"}),quarter:Bn({matchPatterns:h3,defaultMatchWidth:"wide",parsePatterns:m3,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Bn({matchPatterns:p3,defaultMatchWidth:"wide",parsePatterns:g3,defaultParseWidth:"any"}),day:Bn({matchPatterns:x3,defaultMatchWidth:"wide",parsePatterns:y3,defaultParseWidth:"any"}),dayPeriod:Bn({matchPatterns:b3,defaultMatchWidth:"any",parsePatterns:v3,defaultParseWidth:"any"})},is={code:"es",formatDistance:G5,formatLong:W5,formatRelative:e3,localize:l3,match:w3,options:{weekStartsOn:1,firstWeekContainsDate:1}};function j3(){const[t,a]=N.useState(null),[s,o]=N.useState([]),[c,u]=N.useState(!0);N.useEffect(()=>{d()},[]);const d=async()=>{try{const[p,g]=await Promise.all([R4(),Bb()]);a(p),o(g.conversations||[])}catch(p){console.error("Error loading dashboard:",p)}finally{u(!1)}};if(c)return r.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})});const m=s.slice(0,5);return r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Resumen de tu chatbot de WhatsApp"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[r.jsx(un,{title:"Conversaciones",value:s.length,icon:qt,color:"green",subtitle:"Total activas"}),r.jsx(un,{title:"Usuarios nicos",value:t?.unique_users||0,icon:lu,color:"blue",subtitle:"ltimos 30 das"}),r.jsx(un,{title:"Interacciones",value:t?.interactions||0,icon:Wh,color:"purple",subtitle:"Procesadas por el bot"}),r.jsx(un,{title:"Confianza",value:`${Math.round((t?.avg_confidence||0)*100)}%`,icon:qr,color:"yellow",subtitle:"Promedio clasificacin"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[r.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Conversaciones Recientes"}),r.jsxs(Ds,{to:"/conversations",className:"text-green-600 hover:text-green-700 text-sm font-medium flex items-center gap-1",children:["Ver todas ",r.jsx(oS,{className:"w-4 h-4"})]})]}),m.length===0?r.jsxs("div",{className:"p-12 text-center text-gray-400",children:[r.jsx(qt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"No hay conversaciones todava"})]}):r.jsx("div",{className:"divide-y divide-gray-100",children:m.map(p=>r.jsxs(Ds,{to:`/conversations?phone=${encodeURIComponent(p.phone)}`,className:"flex items-center gap-4 p-4 hover:bg-gray-50 transition",children:[r.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx("span",{className:"text-green-600 font-medium",children:p.contact_name?.[0]?.toUpperCase()||p.phone.slice(-2)})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium text-gray-800 truncate",children:p.contact_name||p.phone}),r.jsx("span",{className:"text-xs text-gray-400",children:p.last_message_time?ai(new Date(p.last_message_time),{addSuffix:!0,locale:is}):""})]}),r.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:p.last_message||"Sin mensajes"})]}),p.unread_count>0&&r.jsx("span",{className:"bg-green-500 text-white text-xs font-medium px-2 py-1 rounded-full",children:p.unread_count})]},p.phone))})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-8",children:[r.jsxs(Ds,{to:"/flows",className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white hover:from-green-600 hover:to-green-700 transition",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Editor de Flujos"}),r.jsx("p",{className:"text-green-100 text-sm",children:"Crea y edita flujos conversacionales de forma visual"})]}),r.jsxs(Ds,{to:"/conversations",className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white hover:from-blue-600 hover:to-blue-700 transition",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Ver Conversaciones"}),r.jsx("p",{className:"text-blue-100 text-sm",children:"Responde a tus clientes en tiempo real"})]})]})]})}const Un=Object.create(null);Un.open="0";Un.close="1";Un.ping="2";Un.pong="3";Un.message="4";Un.upgrade="5";Un.noop="6";const Mc=Object.create(null);Object.keys(Un).forEach(t=>{Mc[Un[t]]=t});const wh={type:"error",data:"parser error"},Yb=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Pb=typeof ArrayBuffer=="function",Ib=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,im=({type:t,data:a},s,o)=>Yb&&a instanceof Blob?s?o(a):qx(a,o):Pb&&(a instanceof ArrayBuffer||Ib(a))?s?o(a):qx(new Blob([a]),o):o(Un[t]+(a||"")),qx=(t,a)=>{const s=new FileReader;return s.onload=function(){const o=s.result.split(",")[1];a("b"+(o||""))},s.readAsDataURL(t)};function Ux(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Wf;function N3(t,a){if(Yb&&t.data instanceof Blob)return t.data.arrayBuffer().then(Ux).then(a);if(Pb&&(t.data instanceof ArrayBuffer||Ib(t.data)))return a(Ux(t.data));im(t,!1,s=>{Wf||(Wf=new TextEncoder),a(Wf.encode(s))})}const Vx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lo=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<Vx.length;t++)lo[Vx.charCodeAt(t)]=t;const S3=t=>{let a=t.length*.75,s=t.length,o,c=0,u,d,m,p;t[t.length-1]==="="&&(a--,t[t.length-2]==="="&&a--);const g=new ArrayBuffer(a),y=new Uint8Array(g);for(o=0;o<s;o+=4)u=lo[t.charCodeAt(o)],d=lo[t.charCodeAt(o+1)],m=lo[t.charCodeAt(o+2)],p=lo[t.charCodeAt(o+3)],y[c++]=u<<2|d>>4,y[c++]=(d&15)<<4|m>>2,y[c++]=(m&3)<<6|p&63;return g},_3=typeof ArrayBuffer=="function",om=(t,a)=>{if(typeof t!="string")return{type:"message",data:Xb(t,a)};const s=t.charAt(0);return s==="b"?{type:"message",data:E3(t.substring(1),a)}:Mc[s]?t.length>1?{type:Mc[s],data:t.substring(1)}:{type:Mc[s]}:wh},E3=(t,a)=>{if(_3){const s=S3(t);return Xb(s,a)}else return{base64:!0,data:t}},Xb=(t,a)=>a==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,Gb="",C3=(t,a)=>{const s=t.length,o=new Array(s);let c=0;t.forEach((u,d)=>{im(u,!1,m=>{o[d]=m,++c===s&&a(o.join(Gb))})})},T3=(t,a)=>{const s=t.split(Gb),o=[];for(let c=0;c<s.length;c++){const u=om(s[c],a);if(o.push(u),u.type==="error")break}return o};function M3(){return new TransformStream({transform(t,a){N3(t,s=>{const o=s.length;let c;if(o<126)c=new Uint8Array(1),new DataView(c.buffer).setUint8(0,o);else if(o<65536){c=new Uint8Array(3);const u=new DataView(c.buffer);u.setUint8(0,126),u.setUint16(1,o)}else{c=new Uint8Array(9);const u=new DataView(c.buffer);u.setUint8(0,127),u.setBigUint64(1,BigInt(o))}t.data&&typeof t.data!="string"&&(c[0]|=128),a.enqueue(c),a.enqueue(s)})}})}let Kf;function fc(t){return t.reduce((a,s)=>a+s.length,0)}function hc(t,a){if(t[0].length===a)return t.shift();const s=new Uint8Array(a);let o=0;for(let c=0;c<a;c++)s[c]=t[0][o++],o===t[0].length&&(t.shift(),o=0);return t.length&&o<t[0].length&&(t[0]=t[0].slice(o)),s}function A3(t,a){Kf||(Kf=new TextDecoder);const s=[];let o=0,c=-1,u=!1;return new TransformStream({transform(d,m){for(s.push(d);;){if(o===0){if(fc(s)<1)break;const p=hc(s,1);u=(p[0]&128)===128,c=p[0]&127,c<126?o=3:c===126?o=1:o=2}else if(o===1){if(fc(s)<2)break;const p=hc(s,2);c=new DataView(p.buffer,p.byteOffset,p.length).getUint16(0),o=3}else if(o===2){if(fc(s)<8)break;const p=hc(s,8),g=new DataView(p.buffer,p.byteOffset,p.length),y=g.getUint32(0);if(y>Math.pow(2,21)-1){m.enqueue(wh);break}c=y*Math.pow(2,32)+g.getUint32(4),o=3}else{if(fc(s)<c)break;const p=hc(s,c);m.enqueue(om(u?p:Kf.decode(p),a)),o=0}if(c===0||c>t){m.enqueue(wh);break}}}})}const Qb=4;function ct(t){if(t)return k3(t)}function k3(t){for(var a in ct.prototype)t[a]=ct.prototype[a];return t}ct.prototype.on=ct.prototype.addEventListener=function(t,a){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(a),this};ct.prototype.once=function(t,a){function s(){this.off(t,s),a.apply(this,arguments)}return s.fn=a,this.on(t,s),this};ct.prototype.off=ct.prototype.removeListener=ct.prototype.removeAllListeners=ct.prototype.removeEventListener=function(t,a){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+t];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var o,c=0;c<s.length;c++)if(o=s[c],o===a||o.fn===a){s.splice(c,1);break}return s.length===0&&delete this._callbacks["$"+t],this};ct.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var a=new Array(arguments.length-1),s=this._callbacks["$"+t],o=1;o<arguments.length;o++)a[o-1]=arguments[o];if(s){s=s.slice(0);for(var o=0,c=s.length;o<c;++o)s[o].apply(this,a)}return this};ct.prototype.emitReserved=ct.prototype.emit;ct.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};ct.prototype.hasListeners=function(t){return!!this.listeners(t).length};const du=typeof Promise=="function"&&typeof Promise.resolve=="function"?a=>Promise.resolve().then(a):(a,s)=>s(a,0),cn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),R3="arraybuffer";function Fb(t,...a){return a.reduce((s,o)=>(t.hasOwnProperty(o)&&(s[o]=t[o]),s),{})}const z3=cn.setTimeout,D3=cn.clearTimeout;function fu(t,a){a.useNativeTimers?(t.setTimeoutFn=z3.bind(cn),t.clearTimeoutFn=D3.bind(cn)):(t.setTimeoutFn=cn.setTimeout.bind(cn),t.clearTimeoutFn=cn.clearTimeout.bind(cn))}const O3=1.33;function B3(t){return typeof t=="string"?L3(t):Math.ceil((t.byteLength||t.size)*O3)}function L3(t){let a=0,s=0;for(let o=0,c=t.length;o<c;o++)a=t.charCodeAt(o),a<128?s+=1:a<2048?s+=2:a<55296||a>=57344?s+=3:(o++,s+=4);return s}function Zb(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function H3(t){let a="";for(let s in t)t.hasOwnProperty(s)&&(a.length&&(a+="&"),a+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return a}function $3(t){let a={},s=t.split("&");for(let o=0,c=s.length;o<c;o++){let u=s[o].split("=");a[decodeURIComponent(u[0])]=decodeURIComponent(u[1])}return a}class q3 extends Error{constructor(a,s,o){super(a),this.description=s,this.context=o,this.type="TransportError"}}class lm extends ct{constructor(a){super(),this.writable=!1,fu(this,a),this.opts=a,this.query=a.query,this.socket=a.socket,this.supportsBinary=!a.forceBase64}onError(a,s,o){return super.emitReserved("error",new q3(a,s,o)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(a){this.readyState==="open"&&this.write(a)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(a){const s=om(a,this.socket.binaryType);this.onPacket(s)}onPacket(a){super.emitReserved("packet",a)}onClose(a){this.readyState="closed",super.emitReserved("close",a)}pause(a){}createUri(a,s={}){return a+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const a=this.opts.hostname;return a.indexOf(":")===-1?a:"["+a+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(a){const s=H3(a);return s.length?"?"+s:""}}class U3 extends lm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(a){this.readyState="pausing";const s=()=>{this.readyState="paused",a()};if(this._polling||!this.writable){let o=0;this._polling&&(o++,this.once("pollComplete",function(){--o||s()})),this.writable||(o++,this.once("drain",function(){--o||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(a){const s=o=>{if(this.readyState==="opening"&&o.type==="open"&&this.onOpen(),o.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(o)};T3(a,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const a=()=>{this.write([{type:"close"}])};this.readyState==="open"?a():this.once("open",a)}write(a){this.writable=!1,C3(a,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const a=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=Zb()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(a,s)}}let Wb=!1;try{Wb=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const V3=Wb;function Y3(){}class P3 extends U3{constructor(a){if(super(a),typeof location<"u"){const s=location.protocol==="https:";let o=location.port;o||(o=s?"443":"80"),this.xd=typeof location<"u"&&a.hostname!==location.hostname||o!==a.port}}doWrite(a,s){const o=this.request({method:"POST",data:a});o.on("success",s),o.on("error",(c,u)=>{this.onError("xhr post error",c,u)})}doPoll(){const a=this.request();a.on("data",this.onData.bind(this)),a.on("error",(s,o)=>{this.onError("xhr poll error",s,o)}),this.pollXhr=a}}class Hn extends ct{constructor(a,s,o){super(),this.createRequest=a,fu(this,o),this._opts=o,this._method=o.method||"GET",this._uri=s,this._data=o.data!==void 0?o.data:null,this._create()}_create(){var a;const s=Fb(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const o=this._xhr=this.createRequest(s);try{o.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){o.setDisableHeaderCheck&&o.setDisableHeaderCheck(!0);for(let c in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(c)&&o.setRequestHeader(c,this._opts.extraHeaders[c])}}catch{}if(this._method==="POST")try{o.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{o.setRequestHeader("Accept","*/*")}catch{}(a=this._opts.cookieJar)===null||a===void 0||a.addCookies(o),"withCredentials"in o&&(o.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(o.timeout=this._opts.requestTimeout),o.onreadystatechange=()=>{var c;o.readyState===3&&((c=this._opts.cookieJar)===null||c===void 0||c.parseCookies(o.getResponseHeader("set-cookie"))),o.readyState===4&&(o.status===200||o.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof o.status=="number"?o.status:0)},0))},o.send(this._data)}catch(c){this.setTimeoutFn(()=>{this._onError(c)},0);return}typeof document<"u"&&(this._index=Hn.requestsCount++,Hn.requests[this._index]=this)}_onError(a){this.emitReserved("error",a,this._xhr),this._cleanup(!0)}_cleanup(a){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Y3,a)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Hn.requests[this._index],this._xhr=null}}_onLoad(){const a=this._xhr.responseText;a!==null&&(this.emitReserved("data",a),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Hn.requestsCount=0;Hn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Yx);else if(typeof addEventListener=="function"){const t="onpagehide"in cn?"pagehide":"unload";addEventListener(t,Yx,!1)}}function Yx(){for(let t in Hn.requests)Hn.requests.hasOwnProperty(t)&&Hn.requests[t].abort()}const I3=(function(){const t=Kb({xdomain:!1});return t&&t.responseType!==null})();class X3 extends P3{constructor(a){super(a);const s=a&&a.forceBase64;this.supportsBinary=I3&&!s}request(a={}){return Object.assign(a,{xd:this.xd},this.opts),new Hn(Kb,this.uri(),a)}}function Kb(t){const a=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!a||V3))return new XMLHttpRequest}catch{}if(!a)try{return new cn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Jb=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class G3 extends lm{get name(){return"websocket"}doOpen(){const a=this.uri(),s=this.opts.protocols,o=Jb?{}:Fb(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(o.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(a,s,o)}catch(c){return this.emitReserved("error",c)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=a=>this.onClose({description:"websocket connection closed",context:a}),this.ws.onmessage=a=>this.onData(a.data),this.ws.onerror=a=>this.onError("websocket error",a)}write(a){this.writable=!1;for(let s=0;s<a.length;s++){const o=a[s],c=s===a.length-1;im(o,this.supportsBinary,u=>{try{this.doWrite(o,u)}catch{}c&&du(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const a=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=Zb()),this.supportsBinary||(s.b64=1),this.createUri(a,s)}}const Jf=cn.WebSocket||cn.MozWebSocket;class Q3 extends G3{createSocket(a,s,o){return Jb?new Jf(a,s,o):s?new Jf(a,s):new Jf(a)}doWrite(a,s){this.ws.send(s)}}class F3 extends lm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(a){return this.emitReserved("error",a)}this._transport.closed.then(()=>{this.onClose()}).catch(a=>{this.onError("webtransport error",a)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(a=>{const s=A3(Number.MAX_SAFE_INTEGER,this.socket.binaryType),o=a.readable.pipeThrough(s).getReader(),c=M3();c.readable.pipeTo(a.writable),this._writer=c.writable.getWriter();const u=()=>{o.read().then(({done:m,value:p})=>{m||(this.onPacket(p),u())}).catch(m=>{})};u();const d={type:"open"};this.query.sid&&(d.data=`{"sid":"${this.query.sid}"}`),this._writer.write(d).then(()=>this.onOpen())})})}write(a){this.writable=!1;for(let s=0;s<a.length;s++){const o=a[s],c=s===a.length-1;this._writer.write(o).then(()=>{c&&du(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var a;(a=this._transport)===null||a===void 0||a.close()}}const Z3={websocket:Q3,webtransport:F3,polling:X3},W3=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,K3=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function jh(t){if(t.length>8e3)throw"URI too long";const a=t,s=t.indexOf("["),o=t.indexOf("]");s!=-1&&o!=-1&&(t=t.substring(0,s)+t.substring(s,o).replace(/:/g,";")+t.substring(o,t.length));let c=W3.exec(t||""),u={},d=14;for(;d--;)u[K3[d]]=c[d]||"";return s!=-1&&o!=-1&&(u.source=a,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=J3(u,u.path),u.queryKey=e_(u,u.query),u}function J3(t,a){const s=/\/{2,9}/g,o=a.replace(s,"/").split("/");return(a.slice(0,1)=="/"||a.length===0)&&o.splice(0,1),a.slice(-1)=="/"&&o.splice(o.length-1,1),o}function e_(t,a){const s={};return a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(o,c,u){c&&(s[c]=u)}),s}const Nh=typeof addEventListener=="function"&&typeof removeEventListener=="function",Ac=[];Nh&&addEventListener("offline",()=>{Ac.forEach(t=>t())},!1);class as extends ct{constructor(a,s){if(super(),this.binaryType=R3,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,a&&typeof a=="object"&&(s=a,a=null),a){const o=jh(a);s.hostname=o.host,s.secure=o.protocol==="https"||o.protocol==="wss",s.port=o.port,o.query&&(s.query=o.query)}else s.host&&(s.hostname=jh(s.host).host);fu(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(o=>{const c=o.prototype.name;this.transports.push(c),this._transportsByName[c]=o}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=$3(this.opts.query)),Nh&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Ac.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(a){const s=Object.assign({},this.opts.query);s.EIO=Qb,s.transport=a,this.id&&(s.sid=this.id);const o=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[a]);return new this._transportsByName[a](o)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const a=this.opts.rememberUpgrade&&as.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(a);s.open(),this.setTransport(s)}setTransport(a){this.transport&&this.transport.removeAllListeners(),this.transport=a,a.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",as.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(a){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case"open":this.onHandshake(JSON.parse(a.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=a.data,this._onError(s);break;case"message":this.emitReserved("data",a.data),this.emitReserved("message",a.data);break}}onHandshake(a){this.emitReserved("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this._pingInterval=a.pingInterval,this._pingTimeout=a.pingTimeout,this._maxPayload=a.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const a=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+a,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},a),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const a=this._getWritablePackets();this.transport.send(a),this._prevBufferLen=a.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let o=0;o<this.writeBuffer.length;o++){const c=this.writeBuffer[o].data;if(c&&(s+=B3(c)),o>0&&s>this._maxPayload)return this.writeBuffer.slice(0,o);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const a=Date.now()>this._pingTimeoutTime;return a&&(this._pingTimeoutTime=0,du(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),a}write(a,s,o){return this._sendPacket("message",a,s,o),this}send(a,s,o){return this._sendPacket("message",a,s,o),this}_sendPacket(a,s,o,c){if(typeof s=="function"&&(c=s,s=void 0),typeof o=="function"&&(c=o,o=null),this.readyState==="closing"||this.readyState==="closed")return;o=o||{},o.compress=o.compress!==!1;const u={type:a,data:s,options:o};this.emitReserved("packetCreate",u),this.writeBuffer.push(u),c&&this.once("flush",c),this.flush()}close(){const a=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),a()},o=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?o():a()}):this.upgrading?o():a()),this}_onError(a){if(as.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",a),this._onClose("transport error",a)}_onClose(a,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Nh&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const o=Ac.indexOf(this._offlineEventListener);o!==-1&&Ac.splice(o,1)}this.readyState="closed",this.id=null,this.emitReserved("close",a,s),this.writeBuffer=[],this._prevBufferLen=0}}}as.protocol=Qb;class t_ extends as{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let a=0;a<this._upgrades.length;a++)this._probe(this._upgrades[a])}_probe(a){let s=this.createTransport(a),o=!1;as.priorWebsocketSuccess=!1;const c=()=>{o||(s.send([{type:"ping",data:"probe"}]),s.once("packet",x=>{if(!o)if(x.type==="pong"&&x.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;as.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{o||this.readyState!=="closed"&&(y(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const b=new Error("probe error");b.transport=s.name,this.emitReserved("upgradeError",b)}}))};function u(){o||(o=!0,y(),s.close(),s=null)}const d=x=>{const b=new Error("probe error: "+x);b.transport=s.name,u(),this.emitReserved("upgradeError",b)};function m(){d("transport closed")}function p(){d("socket closed")}function g(x){s&&x.name!==s.name&&u()}const y=()=>{s.removeListener("open",c),s.removeListener("error",d),s.removeListener("close",m),this.off("close",p),this.off("upgrading",g)};s.once("open",c),s.once("error",d),s.once("close",m),this.once("close",p),this.once("upgrading",g),this._upgrades.indexOf("webtransport")!==-1&&a!=="webtransport"?this.setTimeoutFn(()=>{o||s.open()},200):s.open()}onHandshake(a){this._upgrades=this._filterUpgrades(a.upgrades),super.onHandshake(a)}_filterUpgrades(a){const s=[];for(let o=0;o<a.length;o++)~this.transports.indexOf(a[o])&&s.push(a[o]);return s}}let n_=class extends t_{constructor(a,s={}){const o=typeof a=="object"?a:s;(!o.transports||o.transports&&typeof o.transports[0]=="string")&&(o.transports=(o.transports||["polling","websocket","webtransport"]).map(c=>Z3[c]).filter(c=>!!c)),super(a,o)}};function a_(t,a="",s){let o=t;s=s||typeof location<"u"&&location,t==null&&(t=s.protocol+"//"+s.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=s.protocol+t:t=s.host+t),/^(https?|wss?):\/\//.test(t)||(typeof s<"u"?t=s.protocol+"//"+t:t="https://"+t),o=jh(t)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";const u=o.host.indexOf(":")!==-1?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+u+":"+o.port+a,o.href=o.protocol+"://"+u+(s&&s.port===o.port?"":":"+o.port),o}const s_=typeof ArrayBuffer=="function",r_=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,e1=Object.prototype.toString,i_=typeof Blob=="function"||typeof Blob<"u"&&e1.call(Blob)==="[object BlobConstructor]",o_=typeof File=="function"||typeof File<"u"&&e1.call(File)==="[object FileConstructor]";function cm(t){return s_&&(t instanceof ArrayBuffer||r_(t))||i_&&t instanceof Blob||o_&&t instanceof File}function kc(t,a){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let s=0,o=t.length;s<o;s++)if(kc(t[s]))return!0;return!1}if(cm(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return kc(t.toJSON(),!0);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&kc(t[s]))return!0;return!1}function l_(t){const a=[],s=t.data,o=t;return o.data=Sh(s,a),o.attachments=a.length,{packet:o,buffers:a}}function Sh(t,a){if(!t)return t;if(cm(t)){const s={_placeholder:!0,num:a.length};return a.push(t),s}else if(Array.isArray(t)){const s=new Array(t.length);for(let o=0;o<t.length;o++)s[o]=Sh(t[o],a);return s}else if(typeof t=="object"&&!(t instanceof Date)){const s={};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=Sh(t[o],a));return s}return t}function c_(t,a){return t.data=_h(t.data,a),delete t.attachments,t}function _h(t,a){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<a.length)return a[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=_h(t[s],a);else if(typeof t=="object")for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=_h(t[s],a));return t}const t1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],u_=5;var Ce;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Ce||(Ce={}));class d_{constructor(a){this.replacer=a}encode(a){return(a.type===Ce.EVENT||a.type===Ce.ACK)&&kc(a)?this.encodeAsBinary({type:a.type===Ce.EVENT?Ce.BINARY_EVENT:Ce.BINARY_ACK,nsp:a.nsp,data:a.data,id:a.id}):[this.encodeAsString(a)]}encodeAsString(a){let s=""+a.type;return(a.type===Ce.BINARY_EVENT||a.type===Ce.BINARY_ACK)&&(s+=a.attachments+"-"),a.nsp&&a.nsp!=="/"&&(s+=a.nsp+","),a.id!=null&&(s+=a.id),a.data!=null&&(s+=JSON.stringify(a.data,this.replacer)),s}encodeAsBinary(a){const s=l_(a),o=this.encodeAsString(s.packet),c=s.buffers;return c.unshift(o),c}}class um extends ct{constructor(a){super(),this.reviver=a}add(a){let s;if(typeof a=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(a);const o=s.type===Ce.BINARY_EVENT;o||s.type===Ce.BINARY_ACK?(s.type=o?Ce.EVENT:Ce.ACK,this.reconstructor=new f_(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(cm(a)||a.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(a),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+a)}decodeString(a){let s=0;const o={type:Number(a.charAt(0))};if(Ce[o.type]===void 0)throw new Error("unknown packet type "+o.type);if(o.type===Ce.BINARY_EVENT||o.type===Ce.BINARY_ACK){const u=s+1;for(;a.charAt(++s)!=="-"&&s!=a.length;);const d=a.substring(u,s);if(d!=Number(d)||a.charAt(s)!=="-")throw new Error("Illegal attachments");o.attachments=Number(d)}if(a.charAt(s+1)==="/"){const u=s+1;for(;++s&&!(a.charAt(s)===","||s===a.length););o.nsp=a.substring(u,s)}else o.nsp="/";const c=a.charAt(s+1);if(c!==""&&Number(c)==c){const u=s+1;for(;++s;){const d=a.charAt(s);if(d==null||Number(d)!=d){--s;break}if(s===a.length)break}o.id=Number(a.substring(u,s+1))}if(a.charAt(++s)){const u=this.tryParse(a.substr(s));if(um.isPayloadValid(o.type,u))o.data=u;else throw new Error("invalid payload")}return o}tryParse(a){try{return JSON.parse(a,this.reviver)}catch{return!1}}static isPayloadValid(a,s){switch(a){case Ce.CONNECT:return Ic(s);case Ce.DISCONNECT:return s===void 0;case Ce.CONNECT_ERROR:return typeof s=="string"||Ic(s);case Ce.EVENT:case Ce.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&t1.indexOf(s[0])===-1);case Ce.ACK:case Ce.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class f_{constructor(a){this.packet=a,this.buffers=[],this.reconPack=a}takeBinaryData(a){if(this.buffers.push(a),this.buffers.length===this.reconPack.attachments){const s=c_(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function h_(t){return typeof t=="string"}const m_=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function p_(t){return t===void 0||m_(t)}function Ic(t){return Object.prototype.toString.call(t)==="[object Object]"}function g_(t,a){switch(t){case Ce.CONNECT:return a===void 0||Ic(a);case Ce.DISCONNECT:return a===void 0;case Ce.EVENT:return Array.isArray(a)&&(typeof a[0]=="number"||typeof a[0]=="string"&&t1.indexOf(a[0])===-1);case Ce.ACK:return Array.isArray(a);case Ce.CONNECT_ERROR:return typeof a=="string"||Ic(a);default:return!1}}function x_(t){return h_(t.nsp)&&p_(t.id)&&g_(t.type,t.data)}const y_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:um,Encoder:d_,get PacketType(){return Ce},isPacketValid:x_,protocol:u_},Symbol.toStringTag,{value:"Module"}));function vn(t,a,s){return t.on(a,s),function(){t.off(a,s)}}const b_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class n1 extends ct{constructor(a,s,o){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=a,this.nsp=s,o&&o.auth&&(this.auth=o.auth),this._opts=Object.assign({},o),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const a=this.io;this.subs=[vn(a,"open",this.onopen.bind(this)),vn(a,"packet",this.onpacket.bind(this)),vn(a,"error",this.onerror.bind(this)),vn(a,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...a){return a.unshift("message"),this.emit.apply(this,a),this}emit(a,...s){var o,c,u;if(b_.hasOwnProperty(a))throw new Error('"'+a.toString()+'" is a reserved event name');if(s.unshift(a),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const d={type:Ce.EVENT,data:s};if(d.options={},d.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const y=this.ids++,x=s.pop();this._registerAckCallback(y,x),d.id=y}const m=(c=(o=this.io.engine)===null||o===void 0?void 0:o.transport)===null||c===void 0?void 0:c.writable,p=this.connected&&!(!((u=this.io.engine)===null||u===void 0)&&u._hasPingExpired());return this.flags.volatile&&!m||(p?(this.notifyOutgoingListeners(d),this.packet(d)):this.sendBuffer.push(d)),this.flags={},this}_registerAckCallback(a,s){var o;const c=(o=this.flags.timeout)!==null&&o!==void 0?o:this._opts.ackTimeout;if(c===void 0){this.acks[a]=s;return}const u=this.io.setTimeoutFn(()=>{delete this.acks[a];for(let m=0;m<this.sendBuffer.length;m++)this.sendBuffer[m].id===a&&this.sendBuffer.splice(m,1);s.call(this,new Error("operation has timed out"))},c),d=(...m)=>{this.io.clearTimeoutFn(u),s.apply(this,m)};d.withError=!0,this.acks[a]=d}emitWithAck(a,...s){return new Promise((o,c)=>{const u=(d,m)=>d?c(d):o(m);u.withError=!0,s.push(u),this.emit(a,...s)})}_addToQueue(a){let s;typeof a[a.length-1]=="function"&&(s=a.pop());const o={id:this._queueSeq++,tryCount:0,pending:!1,args:a,flags:Object.assign({fromQueue:!0},this.flags)};a.push((c,...u)=>(this._queue[0],c!==null?o.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(c)):(this._queue.shift(),s&&s(null,...u)),o.pending=!1,this._drainQueue())),this._queue.push(o),this._drainQueue()}_drainQueue(a=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!a||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(a){a.nsp=this.nsp,this.io._packet(a)}onopen(){typeof this.auth=="function"?this.auth(a=>{this._sendConnectPacket(a)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(a){this.packet({type:Ce.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},a):a})}onerror(a){this.connected||this.emitReserved("connect_error",a)}onclose(a,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",a,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(a=>{if(!this.sendBuffer.some(o=>String(o.id)===a)){const o=this.acks[a];delete this.acks[a],o.withError&&o.call(this,new Error("socket has been disconnected"))}})}onpacket(a){if(a.nsp===this.nsp)switch(a.type){case Ce.CONNECT:a.data&&a.data.sid?this.onconnect(a.data.sid,a.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ce.EVENT:case Ce.BINARY_EVENT:this.onevent(a);break;case Ce.ACK:case Ce.BINARY_ACK:this.onack(a);break;case Ce.DISCONNECT:this.ondisconnect();break;case Ce.CONNECT_ERROR:this.destroy();const o=new Error(a.data.message);o.data=a.data.data,this.emitReserved("connect_error",o);break}}onevent(a){const s=a.data||[];a.id!=null&&s.push(this.ack(a.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(a){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const o of s)o.apply(this,a)}super.emit.apply(this,a),this._pid&&a.length&&typeof a[a.length-1]=="string"&&(this._lastOffset=a[a.length-1])}ack(a){const s=this;let o=!1;return function(...c){o||(o=!0,s.packet({type:Ce.ACK,id:a,data:c}))}}onack(a){const s=this.acks[a.id];typeof s=="function"&&(delete this.acks[a.id],s.withError&&a.data.unshift(null),s.apply(this,a.data))}onconnect(a,s){this.id=a,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(a=>this.emitEvent(a)),this.receiveBuffer=[],this.sendBuffer.forEach(a=>{this.notifyOutgoingListeners(a),this.packet(a)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(a=>a()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ce.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(a){return this.flags.compress=a,this}get volatile(){return this.flags.volatile=!0,this}timeout(a){return this.flags.timeout=a,this}onAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this}prependAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(a),this}offAny(a){if(!this._anyListeners)return this;if(a){const s=this._anyListeners;for(let o=0;o<s.length;o++)if(a===s[o])return s.splice(o,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(a),this}prependAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(a),this}offAnyOutgoing(a){if(!this._anyOutgoingListeners)return this;if(a){const s=this._anyOutgoingListeners;for(let o=0;o<s.length;o++)if(a===s[o])return s.splice(o,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(a){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const o of s)o.apply(this,a.data)}}}function si(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}si.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var a=Math.random(),s=Math.floor(a*this.jitter*t);t=(Math.floor(a*10)&1)==0?t-s:t+s}return Math.min(t,this.max)|0};si.prototype.reset=function(){this.attempts=0};si.prototype.setMin=function(t){this.ms=t};si.prototype.setMax=function(t){this.max=t};si.prototype.setJitter=function(t){this.jitter=t};class Eh extends ct{constructor(a,s){var o;super(),this.nsps={},this.subs=[],a&&typeof a=="object"&&(s=a,a=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,fu(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((o=s.randomizationFactor)!==null&&o!==void 0?o:.5),this.backoff=new si({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=a;const c=s.parser||y_;this.encoder=new c.Encoder,this.decoder=new c.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(a){return arguments.length?(this._reconnection=!!a,a||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(a){return a===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)}reconnectionDelay(a){var s;return a===void 0?this._reconnectionDelay:(this._reconnectionDelay=a,(s=this.backoff)===null||s===void 0||s.setMin(a),this)}randomizationFactor(a){var s;return a===void 0?this._randomizationFactor:(this._randomizationFactor=a,(s=this.backoff)===null||s===void 0||s.setJitter(a),this)}reconnectionDelayMax(a){var s;return a===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,(s=this.backoff)===null||s===void 0||s.setMax(a),this)}timeout(a){return arguments.length?(this._timeout=a,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(a){if(~this._readyState.indexOf("open"))return this;this.engine=new n_(this.uri,this.opts);const s=this.engine,o=this;this._readyState="opening",this.skipReconnect=!1;const c=vn(s,"open",function(){o.onopen(),a&&a()}),u=m=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",m),a?a(m):this.maybeReconnectOnOpen()},d=vn(s,"error",u);if(this._timeout!==!1){const m=this._timeout,p=this.setTimeoutFn(()=>{c(),u(new Error("timeout")),s.close()},m);this.opts.autoUnref&&p.unref(),this.subs.push(()=>{this.clearTimeoutFn(p)})}return this.subs.push(c),this.subs.push(d),this}connect(a){return this.open(a)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const a=this.engine;this.subs.push(vn(a,"ping",this.onping.bind(this)),vn(a,"data",this.ondata.bind(this)),vn(a,"error",this.onerror.bind(this)),vn(a,"close",this.onclose.bind(this)),vn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(a){try{this.decoder.add(a)}catch(s){this.onclose("parse error",s)}}ondecoded(a){du(()=>{this.emitReserved("packet",a)},this.setTimeoutFn)}onerror(a){this.emitReserved("error",a)}socket(a,s){let o=this.nsps[a];return o?this._autoConnect&&!o.active&&o.connect():(o=new n1(this,a,s),this.nsps[a]=o),o}_destroy(a){const s=Object.keys(this.nsps);for(const o of s)if(this.nsps[o].active)return;this._close()}_packet(a){const s=this.encoder.encode(a);for(let o=0;o<s.length;o++)this.engine.write(s[o],a.options)}cleanup(){this.subs.forEach(a=>a()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(a,s){var o;this.cleanup(),(o=this.engine)===null||o===void 0||o.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",a,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const a=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const o=this.setTimeoutFn(()=>{a.skipReconnect||(this.emitReserved("reconnect_attempt",a.backoff.attempts),!a.skipReconnect&&a.open(c=>{c?(a._reconnecting=!1,a.reconnect(),this.emitReserved("reconnect_error",c)):a.onreconnect()}))},s);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}}onreconnect(){const a=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",a)}}const ao={};function Rc(t,a){typeof t=="object"&&(a=t,t=void 0),a=a||{};const s=a_(t,a.path||"/socket.io"),o=s.source,c=s.id,u=s.path,d=ao[c]&&u in ao[c].nsps,m=a.forceNew||a["force new connection"]||a.multiplex===!1||d;let p;return m?p=new Eh(o,a):(ao[c]||(ao[c]=new Eh(o,a)),p=ao[c]),s.query&&!a.query&&(a.query=s.queryKey),p.socket(s.path,a)}Object.assign(Rc,{Manager:Eh,Socket:n1,io:Rc,connect:Rc});function v_(t){const[a,s]=N.useState(!1),o=N.useRef(null),c=At(u=>u.token);return N.useEffect(()=>{if(!c)return;const u=Rc(t,{path:"/socket.io/",auth:{dashboardToken:c},transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:2e3,reconnectionDelayMax:1e4,timeout:2e4});return u.on("connect",()=>{console.log(`Dashboard socket conectado a ${t}`),s(!0)}),u.on("disconnect",d=>{console.log(`Dashboard socket desconectado: ${d}`),s(!1)}),u.on("connect_error",d=>{console.error("Error de conexin Socket.IO:",d.message)}),o.current=u,()=>{u.disconnect(),o.current=null,s(!1)}},[t,c]),{socket:o.current,connected:a}}function w_({sessionId:t,currentAgentId:a,currentDepartmentId:s,onClose:o,onAssigned:c}){const[u,d]=N.useState([]),[m,p]=N.useState([]),[g,y]=N.useState(a||""),[x,b]=N.useState(s||""),[j,S]=N.useState(!1),[C,_]=N.useState(""),E=At(w=>w.token),R={"Content-Type":"application/json",...E?{Authorization:`Bearer ${E}`}:{}};N.useEffect(()=>{Promise.all([fetch("/api/agents",{headers:R}).then(w=>w.json()),fetch("/api/departments",{headers:R}).then(w=>w.json())]).then(([w,D])=>{d(w.agents||[]),p(D.departments||[])}).catch(()=>{})},[]);const T=async()=>{S(!0),_("");try{const w={sessionId:Number(t)};g&&(w.agentId=Number(g)),x&&(w.departmentId=Number(x));const M=await(await fetch("/api/chat/assign",{method:"POST",headers:R,body:JSON.stringify(w)})).json();if(!M.ok)throw new Error(M.error||"Error al asignar");c&&c(M),o()}catch(w){_(w.message)}finally{S(!1)}},A={};return u.filter(w=>w.status==="active").forEach(w=>{const D=w.department_name||"Sin departamento";A[D]||(A[D]=[]),A[D].push(w)}),r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o,children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6",onClick:w=>w.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between mb-5",children:[r.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[r.jsx(Yr,{className:"w-5 h-5 text-green-600"}),"Asignar Conversacin"]}),r.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:r.jsx(qn,{className:"w-5 h-5"})})]}),C&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4 border border-red-200",children:C}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx($r,{className:"w-4 h-4 inline mr-1"}),"Departamento"]}),r.jsxs("select",{value:x,onChange:w=>b(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none",children:[r.jsx("option",{value:"",children:"Sin asignar departamento"}),m.filter(w=>w.active).map(w=>r.jsx("option",{value:w.id,children:w.display_name||w.name},w.id))]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Yr,{className:"w-4 h-4 inline mr-1"}),"Agente"]}),r.jsxs("select",{value:g,onChange:w=>y(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none",children:[r.jsx("option",{value:"",children:"Sin asignar agente"}),Object.entries(A).map(([w,D])=>r.jsx("optgroup",{label:w,children:D.map(M=>r.jsxs("option",{value:M.id,children:[M.name," (",M.username,") - ",M.role]},M.id))},w))]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:o,className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition",children:"Cancelar"}),r.jsx("button",{onClick:T,disabled:j||!g&&!x,className:"flex-1 px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Asignando...":"Asignar"})]})]})})}function j_({sessionId:t,currentAgentId:a,currentDepartmentId:s,onClose:o,onTransferred:c}){const[u,d]=N.useState([]),[m,p]=N.useState([]),[g,y]=N.useState(""),[x,b]=N.useState(""),[j,S]=N.useState(""),[C,_]=N.useState(!1),[E,R]=N.useState(""),T=At(M=>M.token),A={"Content-Type":"application/json",...T?{Authorization:`Bearer ${T}`}:{}};N.useEffect(()=>{Promise.all([fetch("/api/agents",{headers:A}).then(M=>M.json()),fetch("/api/departments",{headers:A}).then(M=>M.json())]).then(([M,q])=>{d(M.agents||[]),p(q.departments||[])}).catch(()=>{})},[]);const w=async()=>{_(!0),R("");try{const M={sessionId:Number(t)};g&&(M.targetAgentId=Number(g)),x&&(M.targetDepartmentId=Number(x)),j&&(M.reason=j);const H=await(await fetch("/api/chat/transfer",{method:"POST",headers:A,body:JSON.stringify(M)})).json();if(!H.ok)throw new Error(H.error||"Error al transferir");c&&c(H),o()}catch(M){R(M.message)}finally{_(!1)}},D={};return u.filter(M=>M.status==="active"&&M.id!==a).forEach(M=>{const q=M.department_name||"Sin departamento";D[q]||(D[q]=[]),D[q].push(M)}),r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o,children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6",onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between mb-5",children:[r.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[r.jsx(Zh,{className:"w-5 h-5 text-blue-600"}),"Transferir Conversacin"]}),r.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:r.jsx(qn,{className:"w-5 h-5"})})]}),E&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4 border border-red-200",children:E}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx($r,{className:"w-4 h-4 inline mr-1"}),"Departamento destino"]}),r.jsxs("select",{value:x,onChange:M=>b(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[r.jsx("option",{value:"",children:"Mantener departamento actual"}),m.filter(M=>M.active).map(M=>r.jsx("option",{value:M.id,children:M.display_name||M.name},M.id))]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Yr,{className:"w-4 h-4 inline mr-1"}),"Agente destino"]}),r.jsxs("select",{value:g,onChange:M=>y(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[r.jsx("option",{value:"",children:"Sin asignar agente"}),Object.entries(D).map(([M,q])=>r.jsx("optgroup",{label:M,children:q.map(H=>r.jsxs("option",{value:H.id,children:[H.name," (",H.username,") - ",H.role]},H.id))},M))]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Razn (opcional)"}),r.jsx("input",{type:"text",value:j,onChange:M=>S(M.target.value),placeholder:"Ej: Cliente necesita soporte tcnico",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:o,className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition",children:"Cancelar"}),r.jsx("button",{onClick:w,disabled:C||!g&&!x,className:"flex-1 px-4 py-2.5 bg-blue-500 hover:bg-blue-600 text-white rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed",children:C?"Transfiriendo...":"Transferir"})]})]})})}function a1({className:t}){return r.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})}function s1({className:t}){return r.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"})})}function N_({className:t}){return r.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 0C5.373 0 0 4.974 0 11.111c0 3.498 1.744 6.614 4.469 8.654V24l4.088-2.242c1.092.3 2.246.464 3.443.464 6.627 0 12-4.974 12-11.111S18.627 0 12 0zm1.191 14.963l-3.055-3.26-5.963 3.26L10.732 8.2l3.131 3.26 5.887-3.26-6.559 6.763z"})})}function Px({channel:t}){return!t||t==="whatsapp"?r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-green-50 text-green-600 font-medium",title:"WhatsApp",children:[r.jsx(a1,{className:"w-2.5 h-2.5"}),"WA"]}):t==="instagram"?r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-pink-50 text-pink-600 font-medium",title:"Instagram",children:[r.jsx(s1,{className:"w-2.5 h-2.5"}),"IG"]}):t==="messenger"?r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-blue-50 text-blue-600 font-medium",title:"Messenger",children:[r.jsx(N_,{className:"w-2.5 h-2.5"}),"FB"]}):null}const Ix=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500","bg-orange-500","bg-red-400","bg-cyan-500","bg-emerald-500"];function Xx(t){let a=0;for(let s=0;s<t.length;s++)a=t.charCodeAt(s)+((a<<5)-a);return Ix[Math.abs(a)%Ix.length]}function Gx(t,a){if(t){const s=t.trim().split(/\s+/);return s.length>=2?(s[0][0]+s[s.length-1][0]).toUpperCase():t[0].toUpperCase()}return a.slice(-2)}const Qx=[{key:"mine",label:"Mis Chats",icon:Bs},{key:"department",label:"Departamento",icon:$r},{key:"unassigned",label:"Sin Asignar",icon:kb},{key:"all",label:"Todos",icon:tm}];function S_(){const[t,a]=$N(),[s,o]=N.useState([]),[c,u]=N.useState(t.get("phone")||null),[d,m]=N.useState([]),[p,g]=N.useState(""),[y,x]=N.useState(!0),[b,j]=N.useState(!1),[S,C]=N.useState(""),[_,E]=N.useState("all"),[R,T]=N.useState(!1),[A,w]=N.useState(!1),D=N.useRef(null),M=N.useRef(!0),q=At(V=>V.agent),H=q?.role==="supervisor",[Q,I]=N.useState(H?"all":"mine"),Z=N.useRef(Q);Z.current=Q;const te=s.find(V=>V.phone===c),$=N.useRef(c);$.current=c;const{socket:G,connected:O}=v_("/chat");N.useEffect(()=>{z();const V=setInterval(()=>{z()},3e4);return()=>{clearInterval(V)}},[Q]),N.useEffect(()=>{c&&(M.current=!0,U(c),a({phone:c}))},[c]),N.useEffect(()=>{if(G)return G.on("new_message",V=>{if(console.log("Nuevo mensaje via WebSocket:",V),V.phone&&V.phone===$.current){m(ce=>ce.find(ve=>ve.waMsgId===V.msgId||ve.id===V.dbId)?ce:[...ce,{id:V.dbId||Date.now(),direction:V.direction==="in"?"incoming":"outgoing",body:V.text,content:V.text,created_at:new Date(V.timestamp).toISOString(),status:V.status,waMsgId:V.msgId,is_bot:V.isAI||!1,mediaType:V.media?.type||null,mediaId:V.media?.id||V.mediaId||null,mediaMime:V.media?.mime||null,mediaCaption:V.media?.caption||null,mediaExtra:V.media?.extra||null,media:V.media}]),Rx(V.phone).then(()=>z());return}z()}),G.on("escalation",V=>{console.log("Escalamiento detectado:",V),z()}),G.on("message_status_update",V=>{console.log("Status actualizado:",V),m(ce=>ce.map(he=>he.waMsgId===V.msgId?{...he,status:V.status}:he))}),G.on("chat_assigned",V=>{console.log("Chat asignado:",V),z()}),G.on("chat_transferred",V=>{console.log("Chat transferido:",V),z()}),G.on("chat_unassigned",V=>{console.log("Chat liberado:",V),z()}),G.on("agent_status_change",V=>{console.log("Agent status change:",V)}),()=>{G.off("new_message"),G.off("escalation"),G.off("message_status_update"),G.off("chat_assigned"),G.off("chat_transferred"),G.off("chat_unassigned"),G.off("agent_status_change")}},[G]),N.useEffect(()=>{M.current?(D.current?.scrollIntoView({behavior:"instant"}),M.current=!1):D.current?.scrollIntoView({behavior:"smooth"})},[d]);const z=async V=>{try{const ce=V||Z.current,he=await Bb(ce);o(he.conversations||[])}catch(ce){console.error("Error loading conversations:",ce)}finally{x(!1)}},U=async V=>{try{const ce=await A4(V);m(ce.messages||[]),await Rx(V)}catch(ce){console.error("Error loading messages:",ce)}},L=V=>{g(V.target.value)},W=async()=>{if(!(!p.trim()||!c||b)){j(!0);try{await k4(c,p),g("")}catch(V){console.error("Error sending message:",V),alert("Error al enviar mensaje")}finally{j(!1)}}},B=V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),W())},P=async()=>{if(!re)return;const V=re.session_id||re.sessionId||re.id;if(!confirm(`Eliminar conversacin con ${re.contact_name||re.phone}? Se borrarn todos los mensajes.`))return;const ce=At.getState().token;try{const ve=await(await fetch(`/api/chat/conversations/${V}`,{method:"DELETE",headers:{"Content-Type":"application/json",...ce?{Authorization:`Bearer ${ce}`}:{}}})).json();ve.ok?(u(null),m([]),z()):alert(ve.error||"Error al eliminar")}catch(he){console.error("Error deleting conversation:",he),alert("Error al eliminar conversacin")}},ne=async()=>{if(!te)return;const V=At.getState().token;try{(await(await fetch("/api/chat/self-assign",{method:"POST",headers:{"Content-Type":"application/json",...V?{Authorization:`Bearer ${V}`}:{}},body:JSON.stringify({sessionId:te.session_id||te.sessionId||te.id})})).json()).ok&&z()}catch(ce){console.error("Error self-assigning:",ce)}},se=s.filter(V=>{const ce=(V.contact_name?.toLowerCase()||"").includes(S.toLowerCase())||V.phone.includes(S),he=V.channel||"whatsapp";return ce&&(_==="all"||he===_)}),re=s.find(V=>V.phone===c),de=H?Qx:Qx.filter(V=>V.key!=="all"),ue=V=>{const{mediaType:ce,mediaId:he,mediaExtra:ve,mediaMime:ge,media:be}=V,Se=ce||be?.type,Ae=he||be?.id,Ee=ge||be?.mime,$e=ve||be?.extra;if(!Se)return null;const ze=V.direction==="outgoing",pt=Ae&&(Ae.startsWith("http://")||Ae.startsWith("https://"))?Ae:`/api/chat/media/${Ae}`;switch(Se){case"image":return r.jsxs("div",{className:"mt-2 rounded-lg overflow-hidden max-w-xs",children:[r.jsx("img",{src:pt,alt:"Imagen",className:"w-full h-auto cursor-pointer hover:opacity-90",onClick:()=>window.open(pt,"_blank"),onError:pn=>{pn.target.style.display="none",pn.target.nextSibling.style.display="flex"}}),r.jsxs("div",{className:"hidden items-center gap-2 p-3 bg-gray-100 rounded-lg",children:[r.jsx(LS,{className:"w-5 h-5 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Imagen no disponible"})]})]});case"video":return r.jsx("div",{className:"mt-2 rounded-lg overflow-hidden max-w-xs",children:r.jsx("video",{src:pt,controls:!0,className:"w-full h-auto rounded-lg",preload:"metadata",children:"Tu navegador no soporta video"})});case"audio":return r.jsxs("div",{className:`mt-2 flex items-center gap-2 p-2 rounded-lg ${ze?"bg-green-600":"bg-gray-100"}`,children:[r.jsx(WS,{className:`w-5 h-5 ${ze?"text-white":"text-green-600"}`}),r.jsx("audio",{src:pt,controls:!0,className:"h-8 flex-1",preload:"metadata"})]});case"document":const hn=$e?.filename||"Documento";return r.jsxs("a",{href:pt,target:"_blank",rel:"noopener noreferrer",className:`mt-2 flex items-center gap-3 p-3 rounded-lg ${ze?"bg-green-600 hover:bg-green-700":"bg-gray-100 hover:bg-gray-200"} transition`,children:[r.jsx(ti,{className:`w-8 h-8 ${ze?"text-white":"text-blue-600"}`}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:`text-sm font-medium truncate ${ze?"text-white":"text-gray-800"}`,children:hn}),r.jsx("p",{className:`text-xs ${ze?"text-green-100":"text-gray-500"}`,children:Ee||"Documento"})]}),r.jsx(CS,{className:`w-5 h-5 ${ze?"text-white":"text-gray-500"}`})]});case"sticker":return r.jsx("div",{className:"mt-2",children:r.jsx("img",{src:pt,alt:"Sticker",className:"w-32 h-32 object-contain",onError:pn=>{pn.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24" fill="none" stroke="gray" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>'}})});case"location":const En=$e?.latitude,Cn=$e?.longitude,at=$e?.name,Pn=$e?.address,mn=`https://www.google.com/maps?q=${En},${Cn}`;return r.jsx("a",{href:mn,target:"_blank",rel:"noopener noreferrer",className:`mt-2 block p-3 rounded-lg ${ze?"bg-green-600 hover:bg-green-700":"bg-gray-100 hover:bg-gray-200"} transition`,children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:`p-2 rounded-full ${ze?"bg-green-500":"bg-red-100"}`,children:r.jsx(QS,{className:`w-5 h-5 ${ze?"text-white":"text-red-600"}`})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[at&&r.jsx("p",{className:`font-medium ${ze?"text-white":"text-gray-800"}`,children:at}),Pn&&r.jsx("p",{className:`text-sm ${ze?"text-green-100":"text-gray-600"}`,children:Pn}),r.jsxs("p",{className:`text-xs mt-1 ${ze?"text-green-200":"text-gray-500"}`,children:[En?.toFixed(6),", ",Cn?.toFixed(6)]})]})]})});case"contacts":const Jt=$e?.contacts||[];return r.jsxs("div",{className:`mt-2 p-3 rounded-lg ${ze?"bg-green-600":"bg-gray-100"}`,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(lu,{className:`w-5 h-5 ${ze?"text-white":"text-blue-600"}`}),r.jsx("span",{className:`font-medium ${ze?"text-white":"text-gray-800"}`,children:Jt.length===1?"Contacto compartido":`${Jt.length} contactos`})]}),Jt.map((pn,Xn)=>r.jsxs("div",{className:`p-2 rounded ${ze?"bg-green-500":"bg-white"} ${Xn>0?"mt-2":""}`,children:[r.jsx("p",{className:`font-medium ${ze?"text-white":"text-gray-800"}`,children:pn.name}),pn.phones?.map((ls,ii)=>r.jsxs("p",{className:`text-sm ${ze?"text-green-100":"text-gray-600"}`,children:[ls.phone," ",ls.type&&`(${ls.type})`]},ii))]},Xn))]});case"reaction":const In=$e?.emoji||V.body;return r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(OS,{className:`w-4 h-4 ${ze?"text-white":"text-pink-500"}`}),r.jsx("span",{className:"text-2xl",children:In})]});default:return null}};return y?r.jsx("div",{className:"h-full flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):r.jsxs("div",{className:"h-screen flex",children:[r.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:"Conversaciones"}),r.jsx("div",{className:`grid ${H?"grid-cols-4":"grid-cols-3"} gap-1 mb-3 bg-gray-100 p-1 rounded-xl`,children:de.map(V=>{const ce=V.icon;return r.jsxs("button",{onClick:()=>{I(V.key),Z.current=V.key,z(V.key)},className:`flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-semibold transition-all ${Q===V.key?"bg-white text-green-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[r.jsx(ce,{className:"w-3.5 h-3.5"}),V.label]},V.key)})}),r.jsx("div",{className:"flex gap-1 mb-3",children:[{key:"all",label:"Todos",icon:null,color:"gray"},{key:"whatsapp",label:"WhatsApp",icon:a1,color:"green"},{key:"instagram",label:"Instagram",icon:s1,color:"pink"}].map(V=>{const ce=V.icon,he=_===V.key;return r.jsxs("button",{onClick:()=>E(V.key),className:`flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-xs font-medium transition-all border ${he?V.key==="whatsapp"?"bg-green-50 text-green-700 border-green-200":V.key==="instagram"?"bg-pink-50 text-pink-700 border-pink-200":"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:[ce&&r.jsx(ce,{className:"w-3 h-3"}),V.label]},V.key)})}),r.jsxs("div",{className:"relative",children:[r.jsx(sm,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),r.jsx("input",{type:"text",value:S,onChange:V=>C(V.target.value),placeholder:"Buscar conversacin...",className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:se.length===0?r.jsxs("div",{className:"p-8 text-center text-gray-400",children:[r.jsx(qt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"No hay conversaciones"})]}):se.map(V=>r.jsxs("button",{onClick:()=>u(V.phone),className:`w-full flex items-center gap-3 p-4 border-b border-gray-100 hover:bg-gray-50 transition text-left ${c===V.phone?"bg-green-50":""}`,children:[r.jsx("div",{className:`w-12 h-12 ${Xx(V.contact_name||V.phone)} rounded-full flex items-center justify-center flex-shrink-0`,children:r.jsx("span",{className:"text-white font-semibold text-sm",children:Gx(V.contact_name,V.phone)})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium text-gray-800 truncate",children:V.contact_name||V.phone}),V.unread_count>0&&r.jsx("span",{className:"bg-green-500 text-white text-xs font-medium px-2 py-0.5 rounded-full",children:V.unread_count})]}),r.jsx("p",{className:"text-sm text-gray-500 truncate",children:V.last_message||"Sin mensajes"}),r.jsxs("div",{className:"flex items-center gap-1.5 mt-1 flex-wrap",children:[r.jsx(Px,{channel:V.channel}),V.department_name&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full font-medium",style:{backgroundColor:(V.department_color||"#6b7280")+"20",color:V.department_color||"#6b7280"},children:[r.jsx($r,{className:"w-2.5 h-2.5"}),V.department_name]}),V.agent_name&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-blue-50 text-blue-600 font-medium",children:[r.jsx(Bs,{className:"w-2.5 h-2.5"}),V.agent_name]}),!V.agent_name&&!V.department_name&&V.escalation_status==="ESCALATED"&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-yellow-50 text-yellow-600 font-medium",children:[r.jsx(kb,{className:"w-2.5 h-2.5"}),"Sin asignar"]}),r.jsx("span",{className:"text-xs text-gray-400",children:V.last_message_time?ai(new Date(V.last_message_time),{addSuffix:!0,locale:is}):""})]})]})]},V.phone))})]}),r.jsx("div",{className:"flex-1 flex flex-col bg-gray-50",children:c?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-white border-b border-gray-200 p-4 flex items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`w-10 h-10 ${Xx(re?.contact_name||c)} rounded-full flex items-center justify-center`,children:r.jsx("span",{className:"text-white font-semibold text-sm",children:Gx(re?.contact_name,c)})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-800",children:re?.contact_name||c}),r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[r.jsx(Px,{channel:re?.channel}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(ru,{className:"w-3 h-3"}),c]}),re?.department_name&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full font-medium",style:{backgroundColor:(re.department_color||"#6b7280")+"20",color:re.department_color||"#6b7280"},children:[r.jsx($r,{className:"w-2.5 h-2.5"}),re.department_name]}),re?.agent_name&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 rounded-full bg-blue-50 text-blue-600 font-medium",children:[r.jsx(Bs,{className:"w-2.5 h-2.5"}),re.agent_name]})]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[re&&q?.id>0&&(!re.assigned_agent_id||re.assigned_agent_id!==q.id)&&r.jsxs("button",{onClick:ne,className:"flex items-center gap-1.5 px-3 py-2 text-xs font-medium bg-green-50 text-green-700 hover:bg-green-100 rounded-lg border border-green-200 transition",title:"Tomar este chat",children:[r.jsx(Yr,{className:"w-4 h-4"}),"Tomar"]}),re&&r.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-1.5 px-3 py-2 text-xs font-medium bg-gray-50 text-gray-700 hover:bg-gray-100 rounded-lg border border-gray-200 transition",title:"Asignar chat",children:[r.jsx(Yr,{className:"w-4 h-4"}),"Asignar"]}),re&&r.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-1.5 px-3 py-2 text-xs font-medium bg-blue-50 text-blue-700 hover:bg-blue-100 rounded-lg border border-blue-200 transition",title:"Transferir chat",children:[r.jsx(Zh,{className:"w-4 h-4"}),"Transferir"]}),re&&H&&r.jsxs("button",{onClick:P,className:"flex items-center gap-1.5 px-3 py-2 text-xs font-medium bg-red-50 text-red-700 hover:bg-red-100 rounded-lg border border-red-200 transition",title:"Eliminar conversacin",children:[r.jsx(Mo,{className:"w-4 h-4"}),"Eliminar"]}),r.jsx("div",{className:"text-sm",children:O?r.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 bg-green-600 rounded-full"}),"Tiempo real"]}):r.jsxs("span",{className:"text-yellow-600 flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 bg-yellow-600 rounded-full"}),"Reconectando..."]})})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[d.map((V,ce)=>r.jsx("div",{className:`flex ${V.direction==="outgoing"?"justify-end":"justify-start"}`,children:r.jsxs("div",{className:`max-w-md px-4 py-2 rounded-2xl ${V.direction==="outgoing"?"bg-green-500 text-white rounded-br-md":"bg-white text-gray-800 rounded-bl-md shadow-sm"}`,children:[V.direction==="incoming"&&r.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400 mb-1",children:[r.jsx(Bs,{className:"w-3 h-3"}),"Cliente"]}),V.direction==="outgoing"&&V.is_bot&&r.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-100 mb-1",children:[r.jsx(Wh,{className:"w-3 h-3"}),"Bot"]}),ue(V),(V.body||V.content)&&(!V.mediaType||V.mediaType==="reaction")&&r.jsx("p",{className:"whitespace-pre-wrap",children:V.body||V.content}),V.mediaType&&V.mediaType!=="reaction"&&(V.mediaCaption||V.body)&&r.jsx("p",{className:"whitespace-pre-wrap mt-2 text-sm",children:V.mediaCaption||V.body}),r.jsxs("div",{className:`flex items-center gap-1 text-xs mt-1 ${V.direction==="outgoing"?"text-white opacity-90":"text-gray-400"}`,children:[r.jsx("span",{children:V.created_at?uu(new Date(V.created_at),"HH:mm",{locale:is}):""}),V.direction==="outgoing"&&r.jsxs("span",{className:"ml-1",children:[V.status==="sent"&&"",V.status==="delivered"&&"",V.status==="read"&&r.jsx("span",{className:"text-blue-400",children:""})]})]})]})},ce)),r.jsx("div",{ref:D})]}),r.jsx("div",{className:"bg-white border-t border-gray-200 p-4",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("input",{type:"text",value:p,onChange:L,onKeyPress:B,placeholder:"Escribe un mensaje...",className:"flex-1 px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none"}),r.jsxs("button",{onClick:W,disabled:!p.trim()||b,className:"bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[r.jsx(rm,{className:"w-5 h-5"}),b?"Enviando...":"Enviar"]})]})})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:r.jsxs("div",{className:"text-center",children:[r.jsx(qt,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),r.jsx("p",{className:"text-lg",children:"Selecciona una conversacin"})]})})}),R&&re&&r.jsx(w_,{sessionId:re.session_id||re.sessionId||re.id,currentAgentId:re.assigned_agent_id,currentDepartmentId:re.assigned_department_id,onClose:()=>T(!1),onAssigned:()=>z()}),A&&re&&r.jsx(j_,{sessionId:re.session_id||re.sessionId||re.id,currentAgentId:re.assigned_agent_id,currentDepartmentId:re.assigned_department_id,onClose:()=>w(!1),onTransferred:()=>z()})]})}const ja="/api/visual-flows-live";async function Kt(t,a){if(!t.ok){let s=a;try{const o=await t.json();o.error&&(s=o.error)}catch{}throw new Error(s)}return t.json()}async function r1(){const t=await fetch(ja);return Kt(t,"Error al cargar flujos")}async function Ch(t){const a=await fetch(`${ja}/${t}`);return Kt(a,"Flujo no encontrado")}async function __(t){const a=await fetch(ja,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return Kt(a,"Error al crear flujo")}async function E_(t,a){const s=await fetch(`${ja}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return Kt(s,"Error al actualizar flujo")}async function C_(t){const a=await fetch(`${ja}/${t}`,{method:"DELETE"});return Kt(a,"Error al eliminar flujo")}async function i1(t,a=!0){const s=await fetch(`${ja}/${t}/activate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:a})});return Kt(s,"Error al activar flujo")}async function T_(t,a){const s=await fetch(`${ja}/${t}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({new_name:a})});return Kt(s,"Error al duplicar flujo")}async function M_(){const t=await fetch(`${ja}/templates/list`);return Kt(t,"Error al cargar plantillas")}async function o1(t,a){const s=await fetch(`${ja}/templates/${t}/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a})});return Kt(s,"Error al crear desde plantilla")}async function A_(t={}){const a=new URLSearchParams;t.status&&a.append("status",t.status),t.category&&a.append("category",t.category),t.lang&&a.append("lang",t.lang),a.append("with","components"),a.append("limit","200");const s=await fetch(`/api/chat/templates?${a}`);return Kt(s,"Error al cargar plantillas de Meta")}async function k_({templateName:t,languageCode:a,phone:s,parameters:o=[],headerParams:c=[],buttonParams:u=[]}){const d=await fetch("/api/templates/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({templateName:t,languageCode:a,phone:s,parameters:o,headerParams:c,buttonParams:u})});return Kt(d,"Error al enviar plantilla de prueba")}async function R_(){const t=await fetch("/api/settings/visual-flows");return Kt(t,"Error al obtener estado de Visual Flows")}async function z_(t){const a=await fetch("/api/settings/visual-flows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:t})});return Kt(a,"Error al cambiar estado de Visual Flows")}const Fx="whatsapp_test_phone";function D_({template:t,onClose:a}){const[s,o]=N.useState(""),[c,u]=N.useState(!0),[d,m]=N.useState([]),[p,g]=N.useState([]),[y,x]=N.useState([]),[b,j]=N.useState(!1),[S,C]=N.useState(null);N.useEffect(()=>{const A=localStorage.getItem(Fx);A&&o(A)},[]),N.useEffect(()=>{if(!t?.components)return;const A=t.components.find(M=>M.type==="BODY"),w=t.components.find(M=>M.type==="HEADER"),D=t.components.filter(M=>M.type==="BUTTONS");if(A?.text){const M=A.text.match(/\{\{(\d+)\}\}/g)||[];m(M.map(()=>""))}if(w?.text){const M=w.text.match(/\{\{(\d+)\}\}/g)||[];g(M.map(()=>""))}if(D.length>0){const M=[];D.forEach(q=>{q.buttons&&q.buttons.forEach(H=>{H.type==="URL"&&H.url?.includes("{{")&&M.push("")})}),x(M)}},[t]);const _=async()=>{if(!s.trim()){C({ok:!1,error:"Ingresa un nmero de telfono"});return}j(!0),C(null);try{c&&localStorage.setItem(Fx,s);const A=await k_({templateName:t.name,languageCode:t.language,phone:s.trim(),parameters:d.filter(w=>w!==""),headerParams:p.filter(w=>w!==""),buttonParams:y.filter(w=>w!=="")});C(A)}catch(A){C({ok:!1,error:A.message})}finally{j(!1)}},E=()=>{if(!t?.components)return"";const A=t.components.find(D=>D.type==="BODY");if(!A?.text)return"";let w=A.text;return d.forEach((D,M)=>{w=w.replace(`{{${M+1}}}`,D||`[param ${M+1}]`)}),w},R={APPROVED:{bg:"#dcfce7",text:"#166534"},PENDING:{bg:"#fef3c7",text:"#92400e"},REJECTED:{bg:"#fee2e2",text:"#991b1b"}},T={MARKETING:{bg:"#dbeafe",text:"#1e40af"},UTILITY:{bg:"#f3e8ff",text:"#6b21a8"},AUTHENTICATION:{bg:"#fce7f3",text:"#9d174d"}};return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:"0 0 8px 0",fontSize:"20px"},children:"Probar Plantilla"}),r.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[r.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",background:R[t.status]?.bg||"#f3f4f6",color:R[t.status]?.text||"#374151"},children:t.status}),r.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",background:T[t.category]?.bg||"#f3f4f6",color:T[t.category]?.text||"#374151"},children:t.category}),r.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"12px",background:"#f3f4f6",color:"#374151"},children:t.language})]})]}),r.jsx("button",{onClick:a,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280"},children:""})]}),r.jsxs("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Nombre de la plantilla"}),r.jsx("div",{style:{fontFamily:"monospace",fontWeight:"500"},children:t.name})]}),r.jsxs("div",{style:{background:"#dcf8c6",padding:"12px",borderRadius:"8px",marginBottom:"16px",whiteSpace:"pre-wrap"},children:[r.jsx("div",{style:{fontSize:"12px",color:"#075e54",marginBottom:"4px"},children:"Vista previa"}),r.jsx("div",{style:{color:"#000"},children:E()||"(Sin contenido)"})]}),d.length>0&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Parmetros del mensaje"}),d.map((A,w)=>r.jsx("input",{type:"text",placeholder:`Parmetro {{${w+1}}}`,value:A,onChange:D=>{const M=[...d];M[w]=D.target.value,m(M)},style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",marginBottom:"8px",fontSize:"14px"}},`body-${w}`))]}),p.length>0&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Parmetros del encabezado"}),p.map((A,w)=>r.jsx("input",{type:"text",placeholder:`Header {{${w+1}}}`,value:A,onChange:D=>{const M=[...p];M[w]=D.target.value,g(M)},style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",marginBottom:"8px",fontSize:"14px"}},`header-${w}`))]}),y.length>0&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Parmetros de botn URL"}),y.map((A,w)=>r.jsx("input",{type:"text",placeholder:`Texto dinmico del botn ${w+1}`,value:A,onChange:D=>{const M=[...y];M[w]=D.target.value,x(M)},style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",marginBottom:"8px",fontSize:"14px"}},`btn-${w}`))]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Nmero de telfono destino"}),r.jsx("input",{type:"tel",placeholder:"56912345678",value:s,onChange:A=>o(A.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"}}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"8px",fontSize:"13px",color:"#6b7280",cursor:"pointer"},children:[r.jsx("input",{type:"checkbox",checked:c,onChange:A=>u(A.target.checked)}),"Recordar este nmero"]})]}),S&&r.jsx("div",{style:{padding:"12px",borderRadius:"8px",marginBottom:"16px",background:S.ok?"#dcfce7":"#fee2e2",color:S.ok?"#166534":"#991b1b"},children:S.ok?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontWeight:"500"},children:"Enviado correctamente"}),r.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:["Mensaje enviado a ",S.sentTo]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontWeight:"500"},children:"Error al enviar"}),r.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:S.error})]})}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{onClick:a,style:{padding:"10px 20px",border:"1px solid #d1d5db",borderRadius:"8px",background:"white",cursor:"pointer",fontSize:"14px"},children:"Cerrar"}),r.jsx("button",{onClick:_,disabled:b||t.status!=="APPROVED",style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:t.status==="APPROVED"?"#25d366":"#9ca3af",color:"white",cursor:t.status==="APPROVED"?"pointer":"not-allowed",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px"},children:b?"Enviando...":"Enviar Prueba"})]}),t.status!=="APPROVED"&&r.jsx("div",{style:{marginTop:"12px",padding:"8px",background:"#fef3c7",borderRadius:"6px",fontSize:"13px",color:"#92400e",textAlign:"center"},children:"Solo se pueden probar plantillas con estado APPROVED"})]})})}function O_(){const t=Ys(),[a,s]=N.useState("flows"),[o,c]=N.useState([]),[u,d]=N.useState([]),[m,p]=N.useState([]),[g,y]=N.useState(!1),[x,b]=N.useState({status:"",category:""}),[j,S]=N.useState(null),[C,_]=N.useState(!0),[E,R]=N.useState(null),[T,A]=N.useState(null),[w,D]=N.useState(!0),[M,q]=N.useState(!1);N.useEffect(()=>{I(),H()},[]),N.useEffect(()=>{a==="whatsapp"&&Z()},[a,x]);const H=async()=>{try{const L=await R_();D(L.enabled)}catch(L){console.error("Error loading visual flows status:",L)}},Q=async()=>{try{q(!0);const W=await z_(!w);D(W.enabled),te(W.enabled?"Modo automtico ACTIVADO":"Modo automtico DESACTIVADO",W.enabled?"success":"info")}catch(L){console.error("Error toggling visual flows:",L),te(`Error: ${L.message}`,"error")}finally{q(!1)}},I=async()=>{try{_(!0),R(null);const[L,W]=await Promise.all([r1(),M_()]);c(L.flows||[]),d(W.templates||[])}catch(L){console.error("Error loading flows:",L),R(L.message)}finally{_(!1)}},Z=async()=>{try{y(!0);const L={};x.status&&(L.status=x.status),x.category&&(L.category=x.category);const W=await A_(L);p(W.items||[])}catch(L){console.error("Error loading Meta templates:",L),te(`Error al cargar plantillas: ${L.message}`,"error")}finally{y(!1)}},te=(L,W="success")=>{A({message:L,type:W}),setTimeout(()=>A(null),4e3)},$=async(L,W)=>{try{const B=await o1(L,null);te(`Flujo "${W}" creado correctamente`,"success"),await I(),B.id&&t(`/flows/builder/${B.id}`)}catch(B){console.error("Error creating from template:",B),te(`Error al crear flujo: ${B.message}`,"error")}},G=async L=>{try{const W=!L.is_active;await i1(L.id,W),te(`Flujo "${L.name}" ${W?"activado":"desactivado"}`,"success"),await I()}catch(W){console.error("Error toggling flow:",W),te(`Error: ${W.message}`,"error")}},O=async L=>{try{await T_(L.id,`${L.name} (copia)`),te("Flujo duplicado correctamente","success"),await I()}catch(W){console.error("Error duplicating flow:",W),te(`Error al duplicar: ${W.message}`,"error")}},z=async L=>{if(confirm(`Ests seguro de eliminar el flujo "${L.name}"?`))try{await C_(L.id),te("Flujo eliminado correctamente","success"),await I()}catch(W){console.error("Error deleting flow:",W),te(`Error al eliminar: ${W.message}`,"error")}},U=L=>({sales:"bg-green-100 text-green-800",support:"bg-blue-100 text-blue-800",service:"bg-purple-100 text-purple-800",feedback:"bg-yellow-100 text-yellow-800",engagement:"bg-pink-100 text-pink-800"})[L]||"bg-gray-100 text-gray-800";return C?r.jsx("div",{className:"flex items-center justify-center h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Cargando flujos..."})]})}):E?r.jsx("div",{className:"p-8",children:r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-red-800 font-semibold mb-2",children:"Error al cargar flujos"}),r.jsx("p",{className:"text-red-600",children:E}),r.jsx("button",{onClick:I,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reintentar"})]})}):r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-6 flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Gestin de Flujos"}),r.jsx("p",{className:"text-gray-600",children:"Administra tus flujos conversacionales y crea nuevos desde plantillas predefinidas"})]}),r.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-lg border ${w?"bg-green-50 border-green-200":"bg-gray-50 border-gray-300"}`,children:[r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:`text-sm font-medium ${w?"text-green-800":"text-gray-600"}`,children:"Modo Automtico"}),r.jsx("p",{className:`text-xs ${w?"text-green-600":"text-gray-500"}`,children:w?"Bot respondiendo":"Bot pausado"})]}),r.jsx("button",{onClick:Q,disabled:M,className:`relative inline-flex h-7 w-14 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${w?"bg-green-500 focus:ring-green-500":"bg-gray-300 focus:ring-gray-500"} ${M?"opacity-50 cursor-wait":"cursor-pointer"}`,children:r.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow-md transition-transform ${w?"translate-x-8":"translate-x-1"}`})})]})]}),T&&r.jsx("div",{className:`mb-4 p-4 rounded-lg ${T.type==="success"?"bg-green-50 text-green-800 border border-green-200":T.type==="error"?"bg-red-50 text-red-800 border border-red-200":"bg-blue-50 text-blue-800 border border-blue-200"}`,children:T.message}),r.jsx("div",{className:"mb-6 border-b border-gray-200",children:r.jsxs("div",{className:"flex space-x-8",children:[r.jsxs("button",{onClick:()=>s("flows"),className:`pb-4 px-1 border-b-2 font-medium transition-colors ${a==="flows"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Mis Flujos (",o.length,")"]}),r.jsxs("button",{onClick:()=>s("templates"),className:`pb-4 px-1 border-b-2 font-medium transition-colors ${a==="templates"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Plantillas (",u.length,")"]}),r.jsxs("button",{onClick:()=>s("whatsapp"),className:`pb-4 px-1 border-b-2 font-medium transition-colors flex items-center gap-2 ${a==="whatsapp"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp Templates"]})]})}),a==="flows"&&r.jsx("div",{children:o.length===0?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[r.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tienes flujos creados"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Comienza creando un flujo desde una plantilla"}),r.jsx("div",{className:"mt-6",children:r.jsx("button",{onClick:()=>s("templates"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Ver Plantillas"})})]}):r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estadsticas"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ltima actualizacin"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(L=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[L.name,L.is_default&&r.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"Por defecto"})]}),L.description&&r.jsx("div",{className:"text-sm text-gray-500",children:L.description})]})})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("button",{onClick:()=>G(L),className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium cursor-pointer transition-colors ${L.is_active?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:L.is_active?"Activo":"Inactivo"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsxs("span",{children:["Ejecutado: ",L.times_triggered||0," veces"]}),r.jsxs("span",{children:["Completado: ",L.times_completed||0," veces"]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:L.updated_at?uu(new Date(L.updated_at),"dd MMM yyyy, HH:mm",{locale:is}):"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[r.jsx("button",{onClick:()=>t(`/flows/builder/${L.id}`),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),r.jsx("button",{onClick:()=>O(L),className:"text-gray-600 hover:text-gray-900",title:"Duplicar",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),r.jsx("button",{onClick:()=>z(L),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},L.id))})]})})}),a==="templates"&&r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(L=>r.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden border border-gray-200",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:L.name}),r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${U(L.category)}`,children:L.category})]}),r.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:L.description}),r.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-4",children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),r.jsxs("span",{children:[L.nodes_count," nodos"]})]}),L.features&&L.features.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:L.features.map(W=>r.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-50 text-purple-700 border border-purple-200",children:W},W))}),r.jsx("button",{onClick:()=>$(L.id,L.name),className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:"Crear desde esta plantilla"})]})},L.id))}),a==="whatsapp"&&r.jsxs("div",{children:[r.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),r.jsxs("select",{value:x.status,onChange:L=>b({...x,status:L.target.value}),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-green-500 focus:border-green-500",children:[r.jsx("option",{value:"",children:"Todos"}),r.jsx("option",{value:"APPROVED",children:"Aprobadas"}),r.jsx("option",{value:"PENDING",children:"Pendientes"}),r.jsx("option",{value:"REJECTED",children:"Rechazadas"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categora"}),r.jsxs("select",{value:x.category,onChange:L=>b({...x,category:L.target.value}),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-green-500 focus:border-green-500",children:[r.jsx("option",{value:"",children:"Todas"}),r.jsx("option",{value:"MARKETING",children:"Marketing"}),r.jsx("option",{value:"UTILITY",children:"Utilidad"}),r.jsx("option",{value:"AUTHENTICATION",children:"Autenticacin"})]})]}),r.jsx("div",{className:"flex-1"}),r.jsxs("div",{className:"text-sm text-gray-500",children:[m.length," plantillas encontradas"]})]}),g?r.jsxs("div",{className:"flex items-center justify-center py-12",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"}),r.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando plantillas de Meta..."})]}):m.length===0?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[r.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No se encontraron plantillas"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Ajusta los filtros o crea plantillas en Meta Business Suite"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((L,W)=>{const P=L.components?.find(re=>re.type==="BODY")?.text||"",ne={APPROVED:"bg-green-100 text-green-800",PENDING:"bg-yellow-100 text-yellow-800",REJECTED:"bg-red-100 text-red-800"},se={MARKETING:"bg-blue-100 text-blue-800",UTILITY:"bg-purple-100 text-purple-800",AUTHENTICATION:"bg-pink-100 text-pink-800"};return r.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden border border-gray-200",children:r.jsxs("div",{className:"p-5",children:[r.jsx("div",{className:"flex items-start justify-between mb-3",children:r.jsx("h3",{className:"text-base font-semibold text-gray-900 font-mono",children:L.name})}),r.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${ne[L.status]||"bg-gray-100 text-gray-800"}`,children:L.status}),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${se[L.category]||"bg-gray-100 text-gray-800"}`,children:L.category}),r.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:L.language})]}),r.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 max-h-32 overflow-y-auto",children:r.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:P.length>200?P.substring(0,200)+"...":P||"(Sin contenido)"})}),r.jsx("button",{onClick:()=>S(L),disabled:L.status!=="APPROVED",className:`w-full px-4 py-2 rounded-lg font-medium transition-colors ${L.status==="APPROVED"?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:L.status==="APPROVED"?"Probar Plantilla":"No disponible"})]})},`${L.name}-${L.language}-${W}`)})})]}),j&&r.jsx(D_,{template:j,onClose:()=>S(null)})]})}function ut(t){if(typeof t=="string"||typeof t=="number")return""+t;let a="";if(Array.isArray(t))for(let s=0,o;s<t.length;s++)(o=ut(t[s]))!==""&&(a+=(a&&" ")+o);else for(let s in t)t[s]&&(a+=(a&&" ")+s);return a}var B_={value:()=>{}};function hu(){for(var t=0,a=arguments.length,s={},o;t<a;++t){if(!(o=arguments[t]+"")||o in s||/[\s.]/.test(o))throw new Error("illegal type: "+o);s[o]=[]}return new zc(s)}function zc(t){this._=t}function L_(t,a){return t.trim().split(/^|\s+/).map(function(s){var o="",c=s.indexOf(".");if(c>=0&&(o=s.slice(c+1),s=s.slice(0,c)),s&&!a.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:o}})}zc.prototype=hu.prototype={constructor:zc,on:function(t,a){var s=this._,o=L_(t+"",s),c,u=-1,d=o.length;if(arguments.length<2){for(;++u<d;)if((c=(t=o[u]).type)&&(c=H_(s[c],t.name)))return c;return}if(a!=null&&typeof a!="function")throw new Error("invalid callback: "+a);for(;++u<d;)if(c=(t=o[u]).type)s[c]=Zx(s[c],t.name,a);else if(a==null)for(c in s)s[c]=Zx(s[c],t.name,null);return this},copy:function(){var t={},a=this._;for(var s in a)t[s]=a[s].slice();return new zc(t)},call:function(t,a){if((c=arguments.length-2)>0)for(var s=new Array(c),o=0,c,u;o<c;++o)s[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(u=this._[t],o=0,c=u.length;o<c;++o)u[o].value.apply(a,s)},apply:function(t,a,s){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var o=this._[t],c=0,u=o.length;c<u;++c)o[c].value.apply(a,s)}};function H_(t,a){for(var s=0,o=t.length,c;s<o;++s)if((c=t[s]).name===a)return c.value}function Zx(t,a,s){for(var o=0,c=t.length;o<c;++o)if(t[o].name===a){t[o]=B_,t=t.slice(0,o).concat(t.slice(o+1));break}return s!=null&&t.push({name:a,value:s}),t}var Th="http://www.w3.org/1999/xhtml";const Wx={svg:"http://www.w3.org/2000/svg",xhtml:Th,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function mu(t){var a=t+="",s=a.indexOf(":");return s>=0&&(a=t.slice(0,s))!=="xmlns"&&(t=t.slice(s+1)),Wx.hasOwnProperty(a)?{space:Wx[a],local:t}:t}function $_(t){return function(){var a=this.ownerDocument,s=this.namespaceURI;return s===Th&&a.documentElement.namespaceURI===Th?a.createElement(t):a.createElementNS(s,t)}}function q_(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function l1(t){var a=mu(t);return(a.local?q_:$_)(a)}function U_(){}function dm(t){return t==null?U_:function(){return this.querySelector(t)}}function V_(t){typeof t!="function"&&(t=dm(t));for(var a=this._groups,s=a.length,o=new Array(s),c=0;c<s;++c)for(var u=a[c],d=u.length,m=o[c]=new Array(d),p,g,y=0;y<d;++y)(p=u[y])&&(g=t.call(p,p.__data__,y,u))&&("__data__"in p&&(g.__data__=p.__data__),m[y]=g);return new Zt(o,this._parents)}function Y_(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function P_(){return[]}function c1(t){return t==null?P_:function(){return this.querySelectorAll(t)}}function I_(t){return function(){return Y_(t.apply(this,arguments))}}function X_(t){typeof t=="function"?t=I_(t):t=c1(t);for(var a=this._groups,s=a.length,o=[],c=[],u=0;u<s;++u)for(var d=a[u],m=d.length,p,g=0;g<m;++g)(p=d[g])&&(o.push(t.call(p,p.__data__,g,d)),c.push(p));return new Zt(o,c)}function u1(t){return function(){return this.matches(t)}}function d1(t){return function(a){return a.matches(t)}}var G_=Array.prototype.find;function Q_(t){return function(){return G_.call(this.children,t)}}function F_(){return this.firstElementChild}function Z_(t){return this.select(t==null?F_:Q_(typeof t=="function"?t:d1(t)))}var W_=Array.prototype.filter;function K_(){return Array.from(this.children)}function J_(t){return function(){return W_.call(this.children,t)}}function eE(t){return this.selectAll(t==null?K_:J_(typeof t=="function"?t:d1(t)))}function tE(t){typeof t!="function"&&(t=u1(t));for(var a=this._groups,s=a.length,o=new Array(s),c=0;c<s;++c)for(var u=a[c],d=u.length,m=o[c]=[],p,g=0;g<d;++g)(p=u[g])&&t.call(p,p.__data__,g,u)&&m.push(p);return new Zt(o,this._parents)}function f1(t){return new Array(t.length)}function nE(){return new Zt(this._enter||this._groups.map(f1),this._parents)}function Xc(t,a){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=a}Xc.prototype={constructor:Xc,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,a){return this._parent.insertBefore(t,a)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function aE(t){return function(){return t}}function sE(t,a,s,o,c,u){for(var d=0,m,p=a.length,g=u.length;d<g;++d)(m=a[d])?(m.__data__=u[d],o[d]=m):s[d]=new Xc(t,u[d]);for(;d<p;++d)(m=a[d])&&(c[d]=m)}function rE(t,a,s,o,c,u,d){var m,p,g=new Map,y=a.length,x=u.length,b=new Array(y),j;for(m=0;m<y;++m)(p=a[m])&&(b[m]=j=d.call(p,p.__data__,m,a)+"",g.has(j)?c[m]=p:g.set(j,p));for(m=0;m<x;++m)j=d.call(t,u[m],m,u)+"",(p=g.get(j))?(o[m]=p,p.__data__=u[m],g.delete(j)):s[m]=new Xc(t,u[m]);for(m=0;m<y;++m)(p=a[m])&&g.get(b[m])===p&&(c[m]=p)}function iE(t){return t.__data__}function oE(t,a){if(!arguments.length)return Array.from(this,iE);var s=a?rE:sE,o=this._parents,c=this._groups;typeof t!="function"&&(t=aE(t));for(var u=c.length,d=new Array(u),m=new Array(u),p=new Array(u),g=0;g<u;++g){var y=o[g],x=c[g],b=x.length,j=lE(t.call(y,y&&y.__data__,g,o)),S=j.length,C=m[g]=new Array(S),_=d[g]=new Array(S),E=p[g]=new Array(b);s(y,x,C,_,E,j,a);for(var R=0,T=0,A,w;R<S;++R)if(A=C[R]){for(R>=T&&(T=R+1);!(w=_[T])&&++T<S;);A._next=w||null}}return d=new Zt(d,o),d._enter=m,d._exit=p,d}function lE(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function cE(){return new Zt(this._exit||this._groups.map(f1),this._parents)}function uE(t,a,s){var o=this.enter(),c=this,u=this.exit();return typeof t=="function"?(o=t(o),o&&(o=o.selection())):o=o.append(t+""),a!=null&&(c=a(c),c&&(c=c.selection())),s==null?u.remove():s(u),o&&c?o.merge(c).order():c}function dE(t){for(var a=t.selection?t.selection():t,s=this._groups,o=a._groups,c=s.length,u=o.length,d=Math.min(c,u),m=new Array(c),p=0;p<d;++p)for(var g=s[p],y=o[p],x=g.length,b=m[p]=new Array(x),j,S=0;S<x;++S)(j=g[S]||y[S])&&(b[S]=j);for(;p<c;++p)m[p]=s[p];return new Zt(m,this._parents)}function fE(){for(var t=this._groups,a=-1,s=t.length;++a<s;)for(var o=t[a],c=o.length-1,u=o[c],d;--c>=0;)(d=o[c])&&(u&&d.compareDocumentPosition(u)^4&&u.parentNode.insertBefore(d,u),u=d);return this}function hE(t){t||(t=mE);function a(x,b){return x&&b?t(x.__data__,b.__data__):!x-!b}for(var s=this._groups,o=s.length,c=new Array(o),u=0;u<o;++u){for(var d=s[u],m=d.length,p=c[u]=new Array(m),g,y=0;y<m;++y)(g=d[y])&&(p[y]=g);p.sort(a)}return new Zt(c,this._parents).order()}function mE(t,a){return t<a?-1:t>a?1:t>=a?0:NaN}function pE(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function gE(){return Array.from(this)}function xE(){for(var t=this._groups,a=0,s=t.length;a<s;++a)for(var o=t[a],c=0,u=o.length;c<u;++c){var d=o[c];if(d)return d}return null}function yE(){let t=0;for(const a of this)++t;return t}function bE(){return!this.node()}function vE(t){for(var a=this._groups,s=0,o=a.length;s<o;++s)for(var c=a[s],u=0,d=c.length,m;u<d;++u)(m=c[u])&&t.call(m,m.__data__,u,c);return this}function wE(t){return function(){this.removeAttribute(t)}}function jE(t){return function(){this.removeAttributeNS(t.space,t.local)}}function NE(t,a){return function(){this.setAttribute(t,a)}}function SE(t,a){return function(){this.setAttributeNS(t.space,t.local,a)}}function _E(t,a){return function(){var s=a.apply(this,arguments);s==null?this.removeAttribute(t):this.setAttribute(t,s)}}function EE(t,a){return function(){var s=a.apply(this,arguments);s==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,s)}}function CE(t,a){var s=mu(t);if(arguments.length<2){var o=this.node();return s.local?o.getAttributeNS(s.space,s.local):o.getAttribute(s)}return this.each((a==null?s.local?jE:wE:typeof a=="function"?s.local?EE:_E:s.local?SE:NE)(s,a))}function h1(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function TE(t){return function(){this.style.removeProperty(t)}}function ME(t,a,s){return function(){this.style.setProperty(t,a,s)}}function AE(t,a,s){return function(){var o=a.apply(this,arguments);o==null?this.style.removeProperty(t):this.style.setProperty(t,o,s)}}function kE(t,a,s){return arguments.length>1?this.each((a==null?TE:typeof a=="function"?AE:ME)(t,a,s??"")):Pr(this.node(),t)}function Pr(t,a){return t.style.getPropertyValue(a)||h1(t).getComputedStyle(t,null).getPropertyValue(a)}function RE(t){return function(){delete this[t]}}function zE(t,a){return function(){this[t]=a}}function DE(t,a){return function(){var s=a.apply(this,arguments);s==null?delete this[t]:this[t]=s}}function OE(t,a){return arguments.length>1?this.each((a==null?RE:typeof a=="function"?DE:zE)(t,a)):this.node()[t]}function m1(t){return t.trim().split(/^|\s+/)}function fm(t){return t.classList||new p1(t)}function p1(t){this._node=t,this._names=m1(t.getAttribute("class")||"")}p1.prototype={add:function(t){var a=this._names.indexOf(t);a<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var a=this._names.indexOf(t);a>=0&&(this._names.splice(a,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function g1(t,a){for(var s=fm(t),o=-1,c=a.length;++o<c;)s.add(a[o])}function x1(t,a){for(var s=fm(t),o=-1,c=a.length;++o<c;)s.remove(a[o])}function BE(t){return function(){g1(this,t)}}function LE(t){return function(){x1(this,t)}}function HE(t,a){return function(){(a.apply(this,arguments)?g1:x1)(this,t)}}function $E(t,a){var s=m1(t+"");if(arguments.length<2){for(var o=fm(this.node()),c=-1,u=s.length;++c<u;)if(!o.contains(s[c]))return!1;return!0}return this.each((typeof a=="function"?HE:a?BE:LE)(s,a))}function qE(){this.textContent=""}function UE(t){return function(){this.textContent=t}}function VE(t){return function(){var a=t.apply(this,arguments);this.textContent=a??""}}function YE(t){return arguments.length?this.each(t==null?qE:(typeof t=="function"?VE:UE)(t)):this.node().textContent}function PE(){this.innerHTML=""}function IE(t){return function(){this.innerHTML=t}}function XE(t){return function(){var a=t.apply(this,arguments);this.innerHTML=a??""}}function GE(t){return arguments.length?this.each(t==null?PE:(typeof t=="function"?XE:IE)(t)):this.node().innerHTML}function QE(){this.nextSibling&&this.parentNode.appendChild(this)}function FE(){return this.each(QE)}function ZE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function WE(){return this.each(ZE)}function KE(t){var a=typeof t=="function"?t:l1(t);return this.select(function(){return this.appendChild(a.apply(this,arguments))})}function JE(){return null}function e6(t,a){var s=typeof t=="function"?t:l1(t),o=a==null?JE:typeof a=="function"?a:dm(a);return this.select(function(){return this.insertBefore(s.apply(this,arguments),o.apply(this,arguments)||null)})}function t6(){var t=this.parentNode;t&&t.removeChild(this)}function n6(){return this.each(t6)}function a6(){var t=this.cloneNode(!1),a=this.parentNode;return a?a.insertBefore(t,this.nextSibling):t}function s6(){var t=this.cloneNode(!0),a=this.parentNode;return a?a.insertBefore(t,this.nextSibling):t}function r6(t){return this.select(t?s6:a6)}function i6(t){return arguments.length?this.property("__data__",t):this.node().__data__}function o6(t){return function(a){t.call(this,a,this.__data__)}}function l6(t){return t.trim().split(/^|\s+/).map(function(a){var s="",o=a.indexOf(".");return o>=0&&(s=a.slice(o+1),a=a.slice(0,o)),{type:a,name:s}})}function c6(t){return function(){var a=this.__on;if(a){for(var s=0,o=-1,c=a.length,u;s<c;++s)u=a[s],(!t.type||u.type===t.type)&&u.name===t.name?this.removeEventListener(u.type,u.listener,u.options):a[++o]=u;++o?a.length=o:delete this.__on}}}function u6(t,a,s){return function(){var o=this.__on,c,u=o6(a);if(o){for(var d=0,m=o.length;d<m;++d)if((c=o[d]).type===t.type&&c.name===t.name){this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=u,c.options=s),c.value=a;return}}this.addEventListener(t.type,u,s),c={type:t.type,name:t.name,value:a,listener:u,options:s},o?o.push(c):this.__on=[c]}}function d6(t,a,s){var o=l6(t+""),c,u=o.length,d;if(arguments.length<2){var m=this.node().__on;if(m){for(var p=0,g=m.length,y;p<g;++p)for(c=0,y=m[p];c<u;++c)if((d=o[c]).type===y.type&&d.name===y.name)return y.value}return}for(m=a?u6:c6,c=0;c<u;++c)this.each(m(o[c],a,s));return this}function y1(t,a,s){var o=h1(t),c=o.CustomEvent;typeof c=="function"?c=new c(a,s):(c=o.document.createEvent("Event"),s?(c.initEvent(a,s.bubbles,s.cancelable),c.detail=s.detail):c.initEvent(a,!1,!1)),t.dispatchEvent(c)}function f6(t,a){return function(){return y1(this,t,a)}}function h6(t,a){return function(){return y1(this,t,a.apply(this,arguments))}}function m6(t,a){return this.each((typeof a=="function"?h6:f6)(t,a))}function*p6(){for(var t=this._groups,a=0,s=t.length;a<s;++a)for(var o=t[a],c=0,u=o.length,d;c<u;++c)(d=o[c])&&(yield d)}var b1=[null];function Zt(t,a){this._groups=t,this._parents=a}function zo(){return new Zt([[document.documentElement]],b1)}function g6(){return this}Zt.prototype=zo.prototype={constructor:Zt,select:V_,selectAll:X_,selectChild:Z_,selectChildren:eE,filter:tE,data:oE,enter:nE,exit:cE,join:uE,merge:dE,selection:g6,order:fE,sort:hE,call:pE,nodes:gE,node:xE,size:yE,empty:bE,each:vE,attr:CE,style:kE,property:OE,classed:$E,text:YE,html:GE,raise:FE,lower:WE,append:KE,insert:e6,remove:n6,clone:r6,datum:i6,on:d6,dispatch:m6,[Symbol.iterator]:p6};function Qt(t){return typeof t=="string"?new Zt([[document.querySelector(t)]],[document.documentElement]):new Zt([[t]],b1)}function x6(t){let a;for(;a=t.sourceEvent;)t=a;return t}function wn(t,a){if(t=x6(t),a===void 0&&(a=t.currentTarget),a){var s=a.ownerSVGElement||a;if(s.createSVGPoint){var o=s.createSVGPoint();return o.x=t.clientX,o.y=t.clientY,o=o.matrixTransform(a.getScreenCTM().inverse()),[o.x,o.y]}if(a.getBoundingClientRect){var c=a.getBoundingClientRect();return[t.clientX-c.left-a.clientLeft,t.clientY-c.top-a.clientTop]}}return[t.pageX,t.pageY]}const y6={passive:!1},go={capture:!0,passive:!1};function eh(t){t.stopImmediatePropagation()}function Lr(t){t.preventDefault(),t.stopImmediatePropagation()}function v1(t){var a=t.document.documentElement,s=Qt(t).on("dragstart.drag",Lr,go);"onselectstart"in a?s.on("selectstart.drag",Lr,go):(a.__noselect=a.style.MozUserSelect,a.style.MozUserSelect="none")}function w1(t,a){var s=t.document.documentElement,o=Qt(t).on("dragstart.drag",null);a&&(o.on("click.drag",Lr,go),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in s?o.on("selectstart.drag",null):(s.style.MozUserSelect=s.__noselect,delete s.__noselect)}const mc=t=>()=>t;function Mh(t,{sourceEvent:a,subject:s,target:o,identifier:c,active:u,x:d,y:m,dx:p,dy:g,dispatch:y}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:a,enumerable:!0,configurable:!0},subject:{value:s,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:c,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:d,enumerable:!0,configurable:!0},y:{value:m,enumerable:!0,configurable:!0},dx:{value:p,enumerable:!0,configurable:!0},dy:{value:g,enumerable:!0,configurable:!0},_:{value:y}})}Mh.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function b6(t){return!t.ctrlKey&&!t.button}function v6(){return this.parentNode}function w6(t,a){return a??{x:t.x,y:t.y}}function j6(){return navigator.maxTouchPoints||"ontouchstart"in this}function j1(){var t=b6,a=v6,s=w6,o=j6,c={},u=hu("start","drag","end"),d=0,m,p,g,y,x=0;function b(A){A.on("mousedown.drag",j).filter(o).on("touchstart.drag",_).on("touchmove.drag",E,y6).on("touchend.drag touchcancel.drag",R).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function j(A,w){if(!(y||!t.call(this,A,w))){var D=T(this,a.call(this,A,w),A,w,"mouse");D&&(Qt(A.view).on("mousemove.drag",S,go).on("mouseup.drag",C,go),v1(A.view),eh(A),g=!1,m=A.clientX,p=A.clientY,D("start",A))}}function S(A){if(Lr(A),!g){var w=A.clientX-m,D=A.clientY-p;g=w*w+D*D>x}c.mouse("drag",A)}function C(A){Qt(A.view).on("mousemove.drag mouseup.drag",null),w1(A.view,g),Lr(A),c.mouse("end",A)}function _(A,w){if(t.call(this,A,w)){var D=A.changedTouches,M=a.call(this,A,w),q=D.length,H,Q;for(H=0;H<q;++H)(Q=T(this,M,A,w,D[H].identifier,D[H]))&&(eh(A),Q("start",A,D[H]))}}function E(A){var w=A.changedTouches,D=w.length,M,q;for(M=0;M<D;++M)(q=c[w[M].identifier])&&(Lr(A),q("drag",A,w[M]))}function R(A){var w=A.changedTouches,D=w.length,M,q;for(y&&clearTimeout(y),y=setTimeout(function(){y=null},500),M=0;M<D;++M)(q=c[w[M].identifier])&&(eh(A),q("end",A,w[M]))}function T(A,w,D,M,q,H){var Q=u.copy(),I=wn(H||D,w),Z,te,$;if(($=s.call(A,new Mh("beforestart",{sourceEvent:D,target:b,identifier:q,active:d,x:I[0],y:I[1],dx:0,dy:0,dispatch:Q}),M))!=null)return Z=$.x-I[0]||0,te=$.y-I[1]||0,function G(O,z,U){var L=I,W;switch(O){case"start":c[q]=G,W=d++;break;case"end":delete c[q],--d;case"drag":I=wn(U||z,w),W=d;break}Q.call(O,A,new Mh(O,{sourceEvent:z,subject:$,target:b,identifier:q,active:W,x:I[0]+Z,y:I[1]+te,dx:I[0]-L[0],dy:I[1]-L[1],dispatch:Q}),M)}}return b.filter=function(A){return arguments.length?(t=typeof A=="function"?A:mc(!!A),b):t},b.container=function(A){return arguments.length?(a=typeof A=="function"?A:mc(A),b):a},b.subject=function(A){return arguments.length?(s=typeof A=="function"?A:mc(A),b):s},b.touchable=function(A){return arguments.length?(o=typeof A=="function"?A:mc(!!A),b):o},b.on=function(){var A=u.on.apply(u,arguments);return A===u?b:A},b.clickDistance=function(A){return arguments.length?(x=(A=+A)*A,b):Math.sqrt(x)},b}function hm(t,a,s){t.prototype=a.prototype=s,s.constructor=t}function N1(t,a){var s=Object.create(t.prototype);for(var o in a)s[o]=a[o];return s}function Do(){}var xo=.7,Gc=1/xo,Hr="\\s*([+-]?\\d+)\\s*",yo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",N6=/^#([0-9a-f]{3,8})$/,S6=new RegExp(`^rgb\\(${Hr},${Hr},${Hr}\\)$`),_6=new RegExp(`^rgb\\(${$n},${$n},${$n}\\)$`),E6=new RegExp(`^rgba\\(${Hr},${Hr},${Hr},${yo}\\)$`),C6=new RegExp(`^rgba\\(${$n},${$n},${$n},${yo}\\)$`),T6=new RegExp(`^hsl\\(${yo},${$n},${$n}\\)$`),M6=new RegExp(`^hsla\\(${yo},${$n},${$n},${yo}\\)$`),Kx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};hm(Do,$s,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Jx,formatHex:Jx,formatHex8:A6,formatHsl:k6,formatRgb:ey,toString:ey});function Jx(){return this.rgb().formatHex()}function A6(){return this.rgb().formatHex8()}function k6(){return S1(this).formatHsl()}function ey(){return this.rgb().formatRgb()}function $s(t){var a,s;return t=(t+"").trim().toLowerCase(),(a=N6.exec(t))?(s=a[1].length,a=parseInt(a[1],16),s===6?ty(a):s===3?new $t(a>>8&15|a>>4&240,a>>4&15|a&240,(a&15)<<4|a&15,1):s===8?pc(a>>24&255,a>>16&255,a>>8&255,(a&255)/255):s===4?pc(a>>12&15|a>>8&240,a>>8&15|a>>4&240,a>>4&15|a&240,((a&15)<<4|a&15)/255):null):(a=S6.exec(t))?new $t(a[1],a[2],a[3],1):(a=_6.exec(t))?new $t(a[1]*255/100,a[2]*255/100,a[3]*255/100,1):(a=E6.exec(t))?pc(a[1],a[2],a[3],a[4]):(a=C6.exec(t))?pc(a[1]*255/100,a[2]*255/100,a[3]*255/100,a[4]):(a=T6.exec(t))?sy(a[1],a[2]/100,a[3]/100,1):(a=M6.exec(t))?sy(a[1],a[2]/100,a[3]/100,a[4]):Kx.hasOwnProperty(t)?ty(Kx[t]):t==="transparent"?new $t(NaN,NaN,NaN,0):null}function ty(t){return new $t(t>>16&255,t>>8&255,t&255,1)}function pc(t,a,s,o){return o<=0&&(t=a=s=NaN),new $t(t,a,s,o)}function R6(t){return t instanceof Do||(t=$s(t)),t?(t=t.rgb(),new $t(t.r,t.g,t.b,t.opacity)):new $t}function Ah(t,a,s,o){return arguments.length===1?R6(t):new $t(t,a,s,o??1)}function $t(t,a,s,o){this.r=+t,this.g=+a,this.b=+s,this.opacity=+o}hm($t,Ah,N1(Do,{brighter(t){return t=t==null?Gc:Math.pow(Gc,t),new $t(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?xo:Math.pow(xo,t),new $t(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new $t(Ls(this.r),Ls(this.g),Ls(this.b),Qc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ny,formatHex:ny,formatHex8:z6,formatRgb:ay,toString:ay}));function ny(){return`#${Os(this.r)}${Os(this.g)}${Os(this.b)}`}function z6(){return`#${Os(this.r)}${Os(this.g)}${Os(this.b)}${Os((isNaN(this.opacity)?1:this.opacity)*255)}`}function ay(){const t=Qc(this.opacity);return`${t===1?"rgb(":"rgba("}${Ls(this.r)}, ${Ls(this.g)}, ${Ls(this.b)}${t===1?")":`, ${t})`}`}function Qc(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ls(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Os(t){return t=Ls(t),(t<16?"0":"")+t.toString(16)}function sy(t,a,s,o){return o<=0?t=a=s=NaN:s<=0||s>=1?t=a=NaN:a<=0&&(t=NaN),new jn(t,a,s,o)}function S1(t){if(t instanceof jn)return new jn(t.h,t.s,t.l,t.opacity);if(t instanceof Do||(t=$s(t)),!t)return new jn;if(t instanceof jn)return t;t=t.rgb();var a=t.r/255,s=t.g/255,o=t.b/255,c=Math.min(a,s,o),u=Math.max(a,s,o),d=NaN,m=u-c,p=(u+c)/2;return m?(a===u?d=(s-o)/m+(s<o)*6:s===u?d=(o-a)/m+2:d=(a-s)/m+4,m/=p<.5?u+c:2-u-c,d*=60):m=p>0&&p<1?0:d,new jn(d,m,p,t.opacity)}function D6(t,a,s,o){return arguments.length===1?S1(t):new jn(t,a,s,o??1)}function jn(t,a,s,o){this.h=+t,this.s=+a,this.l=+s,this.opacity=+o}hm(jn,D6,N1(Do,{brighter(t){return t=t==null?Gc:Math.pow(Gc,t),new jn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?xo:Math.pow(xo,t),new jn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,a=isNaN(t)||isNaN(this.s)?0:this.s,s=this.l,o=s+(s<.5?s:1-s)*a,c=2*s-o;return new $t(th(t>=240?t-240:t+120,c,o),th(t,c,o),th(t<120?t+240:t-120,c,o),this.opacity)},clamp(){return new jn(ry(this.h),gc(this.s),gc(this.l),Qc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qc(this.opacity);return`${t===1?"hsl(":"hsla("}${ry(this.h)}, ${gc(this.s)*100}%, ${gc(this.l)*100}%${t===1?")":`, ${t})`}`}}));function ry(t){return t=(t||0)%360,t<0?t+360:t}function gc(t){return Math.max(0,Math.min(1,t||0))}function th(t,a,s){return(t<60?a+(s-a)*t/60:t<180?s:t<240?a+(s-a)*(240-t)/60:a)*255}const mm=t=>()=>t;function O6(t,a){return function(s){return t+s*a}}function B6(t,a,s){return t=Math.pow(t,s),a=Math.pow(a,s)-t,s=1/s,function(o){return Math.pow(t+o*a,s)}}function L6(t){return(t=+t)==1?_1:function(a,s){return s-a?B6(a,s,t):mm(isNaN(a)?s:a)}}function _1(t,a){var s=a-t;return s?O6(t,s):mm(isNaN(t)?a:t)}const Fc=(function t(a){var s=L6(a);function o(c,u){var d=s((c=Ah(c)).r,(u=Ah(u)).r),m=s(c.g,u.g),p=s(c.b,u.b),g=_1(c.opacity,u.opacity);return function(y){return c.r=d(y),c.g=m(y),c.b=p(y),c.opacity=g(y),c+""}}return o.gamma=t,o})(1);function H6(t,a){a||(a=[]);var s=t?Math.min(a.length,t.length):0,o=a.slice(),c;return function(u){for(c=0;c<s;++c)o[c]=t[c]*(1-u)+a[c]*u;return o}}function $6(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function q6(t,a){var s=a?a.length:0,o=t?Math.min(s,t.length):0,c=new Array(o),u=new Array(s),d;for(d=0;d<o;++d)c[d]=fo(t[d],a[d]);for(;d<s;++d)u[d]=a[d];return function(m){for(d=0;d<o;++d)u[d]=c[d](m);return u}}function U6(t,a){var s=new Date;return t=+t,a=+a,function(o){return s.setTime(t*(1-o)+a*o),s}}function Dn(t,a){return t=+t,a=+a,function(s){return t*(1-s)+a*s}}function V6(t,a){var s={},o={},c;(t===null||typeof t!="object")&&(t={}),(a===null||typeof a!="object")&&(a={});for(c in a)c in t?s[c]=fo(t[c],a[c]):o[c]=a[c];return function(u){for(c in s)o[c]=s[c](u);return o}}var kh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nh=new RegExp(kh.source,"g");function Y6(t){return function(){return t}}function P6(t){return function(a){return t(a)+""}}function E1(t,a){var s=kh.lastIndex=nh.lastIndex=0,o,c,u,d=-1,m=[],p=[];for(t=t+"",a=a+"";(o=kh.exec(t))&&(c=nh.exec(a));)(u=c.index)>s&&(u=a.slice(s,u),m[d]?m[d]+=u:m[++d]=u),(o=o[0])===(c=c[0])?m[d]?m[d]+=c:m[++d]=c:(m[++d]=null,p.push({i:d,x:Dn(o,c)})),s=nh.lastIndex;return s<a.length&&(u=a.slice(s),m[d]?m[d]+=u:m[++d]=u),m.length<2?p[0]?P6(p[0].x):Y6(a):(a=p.length,function(g){for(var y=0,x;y<a;++y)m[(x=p[y]).i]=x.x(g);return m.join("")})}function fo(t,a){var s=typeof a,o;return a==null||s==="boolean"?mm(a):(s==="number"?Dn:s==="string"?(o=$s(a))?(a=o,Fc):E1:a instanceof $s?Fc:a instanceof Date?U6:$6(a)?H6:Array.isArray(a)?q6:typeof a.valueOf!="function"&&typeof a.toString!="function"||isNaN(a)?V6:Dn)(t,a)}var iy=180/Math.PI,Rh={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function C1(t,a,s,o,c,u){var d,m,p;return(d=Math.sqrt(t*t+a*a))&&(t/=d,a/=d),(p=t*s+a*o)&&(s-=t*p,o-=a*p),(m=Math.sqrt(s*s+o*o))&&(s/=m,o/=m,p/=m),t*o<a*s&&(t=-t,a=-a,p=-p,d=-d),{translateX:c,translateY:u,rotate:Math.atan2(a,t)*iy,skewX:Math.atan(p)*iy,scaleX:d,scaleY:m}}var xc;function I6(t){const a=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return a.isIdentity?Rh:C1(a.a,a.b,a.c,a.d,a.e,a.f)}function X6(t){return t==null||(xc||(xc=document.createElementNS("http://www.w3.org/2000/svg","g")),xc.setAttribute("transform",t),!(t=xc.transform.baseVal.consolidate()))?Rh:(t=t.matrix,C1(t.a,t.b,t.c,t.d,t.e,t.f))}function T1(t,a,s,o){function c(g){return g.length?g.pop()+" ":""}function u(g,y,x,b,j,S){if(g!==x||y!==b){var C=j.push("translate(",null,a,null,s);S.push({i:C-4,x:Dn(g,x)},{i:C-2,x:Dn(y,b)})}else(x||b)&&j.push("translate("+x+a+b+s)}function d(g,y,x,b){g!==y?(g-y>180?y+=360:y-g>180&&(g+=360),b.push({i:x.push(c(x)+"rotate(",null,o)-2,x:Dn(g,y)})):y&&x.push(c(x)+"rotate("+y+o)}function m(g,y,x,b){g!==y?b.push({i:x.push(c(x)+"skewX(",null,o)-2,x:Dn(g,y)}):y&&x.push(c(x)+"skewX("+y+o)}function p(g,y,x,b,j,S){if(g!==x||y!==b){var C=j.push(c(j)+"scale(",null,",",null,")");S.push({i:C-4,x:Dn(g,x)},{i:C-2,x:Dn(y,b)})}else(x!==1||b!==1)&&j.push(c(j)+"scale("+x+","+b+")")}return function(g,y){var x=[],b=[];return g=t(g),y=t(y),u(g.translateX,g.translateY,y.translateX,y.translateY,x,b),d(g.rotate,y.rotate,x,b),m(g.skewX,y.skewX,x,b),p(g.scaleX,g.scaleY,y.scaleX,y.scaleY,x,b),g=y=null,function(j){for(var S=-1,C=b.length,_;++S<C;)x[(_=b[S]).i]=_.x(j);return x.join("")}}}var G6=T1(I6,"px, ","px)","deg)"),Q6=T1(X6,", ",")",")"),F6=1e-12;function oy(t){return((t=Math.exp(t))+1/t)/2}function Z6(t){return((t=Math.exp(t))-1/t)/2}function W6(t){return((t=Math.exp(2*t))-1)/(t+1)}const Dc=(function t(a,s,o){function c(u,d){var m=u[0],p=u[1],g=u[2],y=d[0],x=d[1],b=d[2],j=y-m,S=x-p,C=j*j+S*S,_,E;if(C<F6)E=Math.log(b/g)/a,_=function(M){return[m+M*j,p+M*S,g*Math.exp(a*M*E)]};else{var R=Math.sqrt(C),T=(b*b-g*g+o*C)/(2*g*s*R),A=(b*b-g*g-o*C)/(2*b*s*R),w=Math.log(Math.sqrt(T*T+1)-T),D=Math.log(Math.sqrt(A*A+1)-A);E=(D-w)/a,_=function(M){var q=M*E,H=oy(w),Q=g/(s*R)*(H*W6(a*q+w)-Z6(w));return[m+Q*j,p+Q*S,g*H/oy(a*q+w)]}}return _.duration=E*1e3*a/Math.SQRT2,_}return c.rho=function(u){var d=Math.max(.001,+u),m=d*d,p=m*m;return t(d,m,p)},c})(Math.SQRT2,2,4);var Ir=0,co=0,so=0,M1=1e3,Zc,uo,Wc=0,qs=0,pu=0,bo=typeof performance=="object"&&performance.now?performance:Date,A1=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function pm(){return qs||(A1(K6),qs=bo.now()+pu)}function K6(){qs=0}function Kc(){this._call=this._time=this._next=null}Kc.prototype=k1.prototype={constructor:Kc,restart:function(t,a,s){if(typeof t!="function")throw new TypeError("callback is not a function");s=(s==null?pm():+s)+(a==null?0:+a),!this._next&&uo!==this&&(uo?uo._next=this:Zc=this,uo=this),this._call=t,this._time=s,zh()},stop:function(){this._call&&(this._call=null,this._time=1/0,zh())}};function k1(t,a,s){var o=new Kc;return o.restart(t,a,s),o}function J6(){pm(),++Ir;for(var t=Zc,a;t;)(a=qs-t._time)>=0&&t._call.call(void 0,a),t=t._next;--Ir}function ly(){qs=(Wc=bo.now())+pu,Ir=co=0;try{J6()}finally{Ir=0,tC(),qs=0}}function eC(){var t=bo.now(),a=t-Wc;a>M1&&(pu-=a,Wc=t)}function tC(){for(var t,a=Zc,s,o=1/0;a;)a._call?(o>a._time&&(o=a._time),t=a,a=a._next):(s=a._next,a._next=null,a=t?t._next=s:Zc=s);uo=t,zh(o)}function zh(t){if(!Ir){co&&(co=clearTimeout(co));var a=t-qs;a>24?(t<1/0&&(co=setTimeout(ly,t-bo.now()-pu)),so&&(so=clearInterval(so))):(so||(Wc=bo.now(),so=setInterval(eC,M1)),Ir=1,A1(ly))}}function cy(t,a,s){var o=new Kc;return a=a==null?0:+a,o.restart(c=>{o.stop(),t(c+a)},a,s),o}var nC=hu("start","end","cancel","interrupt"),aC=[],R1=0,uy=1,Dh=2,Oc=3,dy=4,Oh=5,Bc=6;function gu(t,a,s,o,c,u){var d=t.__transition;if(!d)t.__transition={};else if(s in d)return;sC(t,s,{name:a,index:o,group:c,on:nC,tween:aC,time:u.time,delay:u.delay,duration:u.duration,ease:u.ease,timer:null,state:R1})}function gm(t,a){var s=_n(t,a);if(s.state>R1)throw new Error("too late; already scheduled");return s}function Yn(t,a){var s=_n(t,a);if(s.state>Oc)throw new Error("too late; already running");return s}function _n(t,a){var s=t.__transition;if(!s||!(s=s[a]))throw new Error("transition not found");return s}function sC(t,a,s){var o=t.__transition,c;o[a]=s,s.timer=k1(u,0,s.time);function u(g){s.state=uy,s.timer.restart(d,s.delay,s.time),s.delay<=g&&d(g-s.delay)}function d(g){var y,x,b,j;if(s.state!==uy)return p();for(y in o)if(j=o[y],j.name===s.name){if(j.state===Oc)return cy(d);j.state===dy?(j.state=Bc,j.timer.stop(),j.on.call("interrupt",t,t.__data__,j.index,j.group),delete o[y]):+y<a&&(j.state=Bc,j.timer.stop(),j.on.call("cancel",t,t.__data__,j.index,j.group),delete o[y])}if(cy(function(){s.state===Oc&&(s.state=dy,s.timer.restart(m,s.delay,s.time),m(g))}),s.state=Dh,s.on.call("start",t,t.__data__,s.index,s.group),s.state===Dh){for(s.state=Oc,c=new Array(b=s.tween.length),y=0,x=-1;y<b;++y)(j=s.tween[y].value.call(t,t.__data__,s.index,s.group))&&(c[++x]=j);c.length=x+1}}function m(g){for(var y=g<s.duration?s.ease.call(null,g/s.duration):(s.timer.restart(p),s.state=Oh,1),x=-1,b=c.length;++x<b;)c[x].call(t,y);s.state===Oh&&(s.on.call("end",t,t.__data__,s.index,s.group),p())}function p(){s.state=Bc,s.timer.stop(),delete o[a];for(var g in o)return;delete t.__transition}}function Lc(t,a){var s=t.__transition,o,c,u=!0,d;if(s){a=a==null?null:a+"";for(d in s){if((o=s[d]).name!==a){u=!1;continue}c=o.state>Dh&&o.state<Oh,o.state=Bc,o.timer.stop(),o.on.call(c?"interrupt":"cancel",t,t.__data__,o.index,o.group),delete s[d]}u&&delete t.__transition}}function rC(t){return this.each(function(){Lc(this,t)})}function iC(t,a){var s,o;return function(){var c=Yn(this,t),u=c.tween;if(u!==s){o=s=u;for(var d=0,m=o.length;d<m;++d)if(o[d].name===a){o=o.slice(),o.splice(d,1);break}}c.tween=o}}function oC(t,a,s){var o,c;if(typeof s!="function")throw new Error;return function(){var u=Yn(this,t),d=u.tween;if(d!==o){c=(o=d).slice();for(var m={name:a,value:s},p=0,g=c.length;p<g;++p)if(c[p].name===a){c[p]=m;break}p===g&&c.push(m)}u.tween=c}}function lC(t,a){var s=this._id;if(t+="",arguments.length<2){for(var o=_n(this.node(),s).tween,c=0,u=o.length,d;c<u;++c)if((d=o[c]).name===t)return d.value;return null}return this.each((a==null?iC:oC)(s,t,a))}function xm(t,a,s){var o=t._id;return t.each(function(){var c=Yn(this,o);(c.value||(c.value={}))[a]=s.apply(this,arguments)}),function(c){return _n(c,o).value[a]}}function z1(t,a){var s;return(typeof a=="number"?Dn:a instanceof $s?Fc:(s=$s(a))?(a=s,Fc):E1)(t,a)}function cC(t){return function(){this.removeAttribute(t)}}function uC(t){return function(){this.removeAttributeNS(t.space,t.local)}}function dC(t,a,s){var o,c=s+"",u;return function(){var d=this.getAttribute(t);return d===c?null:d===o?u:u=a(o=d,s)}}function fC(t,a,s){var o,c=s+"",u;return function(){var d=this.getAttributeNS(t.space,t.local);return d===c?null:d===o?u:u=a(o=d,s)}}function hC(t,a,s){var o,c,u;return function(){var d,m=s(this),p;return m==null?void this.removeAttribute(t):(d=this.getAttribute(t),p=m+"",d===p?null:d===o&&p===c?u:(c=p,u=a(o=d,m)))}}function mC(t,a,s){var o,c,u;return function(){var d,m=s(this),p;return m==null?void this.removeAttributeNS(t.space,t.local):(d=this.getAttributeNS(t.space,t.local),p=m+"",d===p?null:d===o&&p===c?u:(c=p,u=a(o=d,m)))}}function pC(t,a){var s=mu(t),o=s==="transform"?Q6:z1;return this.attrTween(t,typeof a=="function"?(s.local?mC:hC)(s,o,xm(this,"attr."+t,a)):a==null?(s.local?uC:cC)(s):(s.local?fC:dC)(s,o,a))}function gC(t,a){return function(s){this.setAttribute(t,a.call(this,s))}}function xC(t,a){return function(s){this.setAttributeNS(t.space,t.local,a.call(this,s))}}function yC(t,a){var s,o;function c(){var u=a.apply(this,arguments);return u!==o&&(s=(o=u)&&xC(t,u)),s}return c._value=a,c}function bC(t,a){var s,o;function c(){var u=a.apply(this,arguments);return u!==o&&(s=(o=u)&&gC(t,u)),s}return c._value=a,c}function vC(t,a){var s="attr."+t;if(arguments.length<2)return(s=this.tween(s))&&s._value;if(a==null)return this.tween(s,null);if(typeof a!="function")throw new Error;var o=mu(t);return this.tween(s,(o.local?yC:bC)(o,a))}function wC(t,a){return function(){gm(this,t).delay=+a.apply(this,arguments)}}function jC(t,a){return a=+a,function(){gm(this,t).delay=a}}function NC(t){var a=this._id;return arguments.length?this.each((typeof t=="function"?wC:jC)(a,t)):_n(this.node(),a).delay}function SC(t,a){return function(){Yn(this,t).duration=+a.apply(this,arguments)}}function _C(t,a){return a=+a,function(){Yn(this,t).duration=a}}function EC(t){var a=this._id;return arguments.length?this.each((typeof t=="function"?SC:_C)(a,t)):_n(this.node(),a).duration}function CC(t,a){if(typeof a!="function")throw new Error;return function(){Yn(this,t).ease=a}}function TC(t){var a=this._id;return arguments.length?this.each(CC(a,t)):_n(this.node(),a).ease}function MC(t,a){return function(){var s=a.apply(this,arguments);if(typeof s!="function")throw new Error;Yn(this,t).ease=s}}function AC(t){if(typeof t!="function")throw new Error;return this.each(MC(this._id,t))}function kC(t){typeof t!="function"&&(t=u1(t));for(var a=this._groups,s=a.length,o=new Array(s),c=0;c<s;++c)for(var u=a[c],d=u.length,m=o[c]=[],p,g=0;g<d;++g)(p=u[g])&&t.call(p,p.__data__,g,u)&&m.push(p);return new va(o,this._parents,this._name,this._id)}function RC(t){if(t._id!==this._id)throw new Error;for(var a=this._groups,s=t._groups,o=a.length,c=s.length,u=Math.min(o,c),d=new Array(o),m=0;m<u;++m)for(var p=a[m],g=s[m],y=p.length,x=d[m]=new Array(y),b,j=0;j<y;++j)(b=p[j]||g[j])&&(x[j]=b);for(;m<o;++m)d[m]=a[m];return new va(d,this._parents,this._name,this._id)}function zC(t){return(t+"").trim().split(/^|\s+/).every(function(a){var s=a.indexOf(".");return s>=0&&(a=a.slice(0,s)),!a||a==="start"})}function DC(t,a,s){var o,c,u=zC(a)?gm:Yn;return function(){var d=u(this,t),m=d.on;m!==o&&(c=(o=m).copy()).on(a,s),d.on=c}}function OC(t,a){var s=this._id;return arguments.length<2?_n(this.node(),s).on.on(t):this.each(DC(s,t,a))}function BC(t){return function(){var a=this.parentNode;for(var s in this.__transition)if(+s!==t)return;a&&a.removeChild(this)}}function LC(){return this.on("end.remove",BC(this._id))}function HC(t){var a=this._name,s=this._id;typeof t!="function"&&(t=dm(t));for(var o=this._groups,c=o.length,u=new Array(c),d=0;d<c;++d)for(var m=o[d],p=m.length,g=u[d]=new Array(p),y,x,b=0;b<p;++b)(y=m[b])&&(x=t.call(y,y.__data__,b,m))&&("__data__"in y&&(x.__data__=y.__data__),g[b]=x,gu(g[b],a,s,b,g,_n(y,s)));return new va(u,this._parents,a,s)}function $C(t){var a=this._name,s=this._id;typeof t!="function"&&(t=c1(t));for(var o=this._groups,c=o.length,u=[],d=[],m=0;m<c;++m)for(var p=o[m],g=p.length,y,x=0;x<g;++x)if(y=p[x]){for(var b=t.call(y,y.__data__,x,p),j,S=_n(y,s),C=0,_=b.length;C<_;++C)(j=b[C])&&gu(j,a,s,C,b,S);u.push(b),d.push(y)}return new va(u,d,a,s)}var qC=zo.prototype.constructor;function UC(){return new qC(this._groups,this._parents)}function VC(t,a){var s,o,c;return function(){var u=Pr(this,t),d=(this.style.removeProperty(t),Pr(this,t));return u===d?null:u===s&&d===o?c:c=a(s=u,o=d)}}function D1(t){return function(){this.style.removeProperty(t)}}function YC(t,a,s){var o,c=s+"",u;return function(){var d=Pr(this,t);return d===c?null:d===o?u:u=a(o=d,s)}}function PC(t,a,s){var o,c,u;return function(){var d=Pr(this,t),m=s(this),p=m+"";return m==null&&(p=m=(this.style.removeProperty(t),Pr(this,t))),d===p?null:d===o&&p===c?u:(c=p,u=a(o=d,m))}}function IC(t,a){var s,o,c,u="style."+a,d="end."+u,m;return function(){var p=Yn(this,t),g=p.on,y=p.value[u]==null?m||(m=D1(a)):void 0;(g!==s||c!==y)&&(o=(s=g).copy()).on(d,c=y),p.on=o}}function XC(t,a,s){var o=(t+="")=="transform"?G6:z1;return a==null?this.styleTween(t,VC(t,o)).on("end.style."+t,D1(t)):typeof a=="function"?this.styleTween(t,PC(t,o,xm(this,"style."+t,a))).each(IC(this._id,t)):this.styleTween(t,YC(t,o,a),s).on("end.style."+t,null)}function GC(t,a,s){return function(o){this.style.setProperty(t,a.call(this,o),s)}}function QC(t,a,s){var o,c;function u(){var d=a.apply(this,arguments);return d!==c&&(o=(c=d)&&GC(t,d,s)),o}return u._value=a,u}function FC(t,a,s){var o="style."+(t+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(a==null)return this.tween(o,null);if(typeof a!="function")throw new Error;return this.tween(o,QC(t,a,s??""))}function ZC(t){return function(){this.textContent=t}}function WC(t){return function(){var a=t(this);this.textContent=a??""}}function KC(t){return this.tween("text",typeof t=="function"?WC(xm(this,"text",t)):ZC(t==null?"":t+""))}function JC(t){return function(a){this.textContent=t.call(this,a)}}function e8(t){var a,s;function o(){var c=t.apply(this,arguments);return c!==s&&(a=(s=c)&&JC(c)),a}return o._value=t,o}function t8(t){var a="text";if(arguments.length<1)return(a=this.tween(a))&&a._value;if(t==null)return this.tween(a,null);if(typeof t!="function")throw new Error;return this.tween(a,e8(t))}function n8(){for(var t=this._name,a=this._id,s=O1(),o=this._groups,c=o.length,u=0;u<c;++u)for(var d=o[u],m=d.length,p,g=0;g<m;++g)if(p=d[g]){var y=_n(p,a);gu(p,t,s,g,d,{time:y.time+y.delay+y.duration,delay:0,duration:y.duration,ease:y.ease})}return new va(o,this._parents,t,s)}function a8(){var t,a,s=this,o=s._id,c=s.size();return new Promise(function(u,d){var m={value:d},p={value:function(){--c===0&&u()}};s.each(function(){var g=Yn(this,o),y=g.on;y!==t&&(a=(t=y).copy(),a._.cancel.push(m),a._.interrupt.push(m),a._.end.push(p)),g.on=a}),c===0&&u()})}var s8=0;function va(t,a,s,o){this._groups=t,this._parents=a,this._name=s,this._id=o}function O1(){return++s8}var ma=zo.prototype;va.prototype={constructor:va,select:HC,selectAll:$C,selectChild:ma.selectChild,selectChildren:ma.selectChildren,filter:kC,merge:RC,selection:UC,transition:n8,call:ma.call,nodes:ma.nodes,node:ma.node,size:ma.size,empty:ma.empty,each:ma.each,on:OC,attr:pC,attrTween:vC,style:XC,styleTween:FC,text:KC,textTween:t8,remove:LC,tween:lC,delay:NC,duration:EC,ease:TC,easeVarying:AC,end:a8,[Symbol.iterator]:ma[Symbol.iterator]};function r8(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var i8={time:null,delay:0,duration:250,ease:r8};function o8(t,a){for(var s;!(s=t.__transition)||!(s=s[a]);)if(!(t=t.parentNode))throw new Error(`transition ${a} not found`);return s}function l8(t){var a,s;t instanceof va?(a=t._id,t=t._name):(a=O1(),(s=i8).time=pm(),t=t==null?null:t+"");for(var o=this._groups,c=o.length,u=0;u<c;++u)for(var d=o[u],m=d.length,p,g=0;g<m;++g)(p=d[g])&&gu(p,t,a,g,d,s||o8(p,a));return new va(o,this._parents,t,a)}zo.prototype.interrupt=rC;zo.prototype.transition=l8;const yc=t=>()=>t;function c8(t,{sourceEvent:a,target:s,transform:o,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:a,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:c}})}function ga(t,a,s){this.k=t,this.x=a,this.y=s}ga.prototype={constructor:ga,scale:function(t){return t===1?this:new ga(this.k*t,this.x,this.y)},translate:function(t,a){return t===0&a===0?this:new ga(this.k,this.x+this.k*t,this.y+this.k*a)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var xu=new ga(1,0,0);B1.prototype=ga.prototype;function B1(t){for(;!t.__zoom;)if(!(t=t.parentNode))return xu;return t.__zoom}function ah(t){t.stopImmediatePropagation()}function ro(t){t.preventDefault(),t.stopImmediatePropagation()}function u8(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function d8(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function fy(){return this.__zoom||xu}function f8(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function h8(){return navigator.maxTouchPoints||"ontouchstart"in this}function m8(t,a,s){var o=t.invertX(a[0][0])-s[0][0],c=t.invertX(a[1][0])-s[1][0],u=t.invertY(a[0][1])-s[0][1],d=t.invertY(a[1][1])-s[1][1];return t.translate(c>o?(o+c)/2:Math.min(0,o)||Math.max(0,c),d>u?(u+d)/2:Math.min(0,u)||Math.max(0,d))}function L1(){var t=u8,a=d8,s=m8,o=f8,c=h8,u=[0,1/0],d=[[-1/0,-1/0],[1/0,1/0]],m=250,p=Dc,g=hu("start","zoom","end"),y,x,b,j=500,S=150,C=0,_=10;function E($){$.property("__zoom",fy).on("wheel.zoom",q,{passive:!1}).on("mousedown.zoom",H).on("dblclick.zoom",Q).filter(c).on("touchstart.zoom",I).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",te).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}E.transform=function($,G,O,z){var U=$.selection?$.selection():$;U.property("__zoom",fy),$!==U?w($,G,O,z):U.interrupt().each(function(){D(this,arguments).event(z).start().zoom(null,typeof G=="function"?G.apply(this,arguments):G).end()})},E.scaleBy=function($,G,O,z){E.scaleTo($,function(){var U=this.__zoom.k,L=typeof G=="function"?G.apply(this,arguments):G;return U*L},O,z)},E.scaleTo=function($,G,O,z){E.transform($,function(){var U=a.apply(this,arguments),L=this.__zoom,W=O==null?A(U):typeof O=="function"?O.apply(this,arguments):O,B=L.invert(W),P=typeof G=="function"?G.apply(this,arguments):G;return s(T(R(L,P),W,B),U,d)},O,z)},E.translateBy=function($,G,O,z){E.transform($,function(){return s(this.__zoom.translate(typeof G=="function"?G.apply(this,arguments):G,typeof O=="function"?O.apply(this,arguments):O),a.apply(this,arguments),d)},null,z)},E.translateTo=function($,G,O,z,U){E.transform($,function(){var L=a.apply(this,arguments),W=this.__zoom,B=z==null?A(L):typeof z=="function"?z.apply(this,arguments):z;return s(xu.translate(B[0],B[1]).scale(W.k).translate(typeof G=="function"?-G.apply(this,arguments):-G,typeof O=="function"?-O.apply(this,arguments):-O),L,d)},z,U)};function R($,G){return G=Math.max(u[0],Math.min(u[1],G)),G===$.k?$:new ga(G,$.x,$.y)}function T($,G,O){var z=G[0]-O[0]*$.k,U=G[1]-O[1]*$.k;return z===$.x&&U===$.y?$:new ga($.k,z,U)}function A($){return[(+$[0][0]+ +$[1][0])/2,(+$[0][1]+ +$[1][1])/2]}function w($,G,O,z){$.on("start.zoom",function(){D(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){D(this,arguments).event(z).end()}).tween("zoom",function(){var U=this,L=arguments,W=D(U,L).event(z),B=a.apply(U,L),P=O==null?A(B):typeof O=="function"?O.apply(U,L):O,ne=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),se=U.__zoom,re=typeof G=="function"?G.apply(U,L):G,de=p(se.invert(P).concat(ne/se.k),re.invert(P).concat(ne/re.k));return function(ue){if(ue===1)ue=re;else{var V=de(ue),ce=ne/V[2];ue=new ga(ce,P[0]-V[0]*ce,P[1]-V[1]*ce)}W.zoom(null,ue)}})}function D($,G,O){return!O&&$.__zooming||new M($,G)}function M($,G){this.that=$,this.args=G,this.active=0,this.sourceEvent=null,this.extent=a.apply($,G),this.taps=0}M.prototype={event:function($){return $&&(this.sourceEvent=$),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function($,G){return this.mouse&&$!=="mouse"&&(this.mouse[1]=G.invert(this.mouse[0])),this.touch0&&$!=="touch"&&(this.touch0[1]=G.invert(this.touch0[0])),this.touch1&&$!=="touch"&&(this.touch1[1]=G.invert(this.touch1[0])),this.that.__zoom=G,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function($){var G=Qt(this.that).datum();g.call($,this.that,new c8($,{sourceEvent:this.sourceEvent,target:E,transform:this.that.__zoom,dispatch:g}),G)}};function q($,...G){if(!t.apply(this,arguments))return;var O=D(this,G).event($),z=this.__zoom,U=Math.max(u[0],Math.min(u[1],z.k*Math.pow(2,o.apply(this,arguments)))),L=wn($);if(O.wheel)(O.mouse[0][0]!==L[0]||O.mouse[0][1]!==L[1])&&(O.mouse[1]=z.invert(O.mouse[0]=L)),clearTimeout(O.wheel);else{if(z.k===U)return;O.mouse=[L,z.invert(L)],Lc(this),O.start()}ro($),O.wheel=setTimeout(W,S),O.zoom("mouse",s(T(R(z,U),O.mouse[0],O.mouse[1]),O.extent,d));function W(){O.wheel=null,O.end()}}function H($,...G){if(b||!t.apply(this,arguments))return;var O=$.currentTarget,z=D(this,G,!0).event($),U=Qt($.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",ne,!0),L=wn($,O),W=$.clientX,B=$.clientY;v1($.view),ah($),z.mouse=[L,this.__zoom.invert(L)],Lc(this),z.start();function P(se){if(ro(se),!z.moved){var re=se.clientX-W,de=se.clientY-B;z.moved=re*re+de*de>C}z.event(se).zoom("mouse",s(T(z.that.__zoom,z.mouse[0]=wn(se,O),z.mouse[1]),z.extent,d))}function ne(se){U.on("mousemove.zoom mouseup.zoom",null),w1(se.view,z.moved),ro(se),z.event(se).end()}}function Q($,...G){if(t.apply(this,arguments)){var O=this.__zoom,z=wn($.changedTouches?$.changedTouches[0]:$,this),U=O.invert(z),L=O.k*($.shiftKey?.5:2),W=s(T(R(O,L),z,U),a.apply(this,G),d);ro($),m>0?Qt(this).transition().duration(m).call(w,W,z,$):Qt(this).call(E.transform,W,z,$)}}function I($,...G){if(t.apply(this,arguments)){var O=$.touches,z=O.length,U=D(this,G,$.changedTouches.length===z).event($),L,W,B,P;for(ah($),W=0;W<z;++W)B=O[W],P=wn(B,this),P=[P,this.__zoom.invert(P),B.identifier],U.touch0?!U.touch1&&U.touch0[2]!==P[2]&&(U.touch1=P,U.taps=0):(U.touch0=P,L=!0,U.taps=1+!!y);y&&(y=clearTimeout(y)),L&&(U.taps<2&&(x=P[0],y=setTimeout(function(){y=null},j)),Lc(this),U.start())}}function Z($,...G){if(this.__zooming){var O=D(this,G).event($),z=$.changedTouches,U=z.length,L,W,B,P;for(ro($),L=0;L<U;++L)W=z[L],B=wn(W,this),O.touch0&&O.touch0[2]===W.identifier?O.touch0[0]=B:O.touch1&&O.touch1[2]===W.identifier&&(O.touch1[0]=B);if(W=O.that.__zoom,O.touch1){var ne=O.touch0[0],se=O.touch0[1],re=O.touch1[0],de=O.touch1[1],ue=(ue=re[0]-ne[0])*ue+(ue=re[1]-ne[1])*ue,V=(V=de[0]-se[0])*V+(V=de[1]-se[1])*V;W=R(W,Math.sqrt(ue/V)),B=[(ne[0]+re[0])/2,(ne[1]+re[1])/2],P=[(se[0]+de[0])/2,(se[1]+de[1])/2]}else if(O.touch0)B=O.touch0[0],P=O.touch0[1];else return;O.zoom("touch",s(T(W,B,P),O.extent,d))}}function te($,...G){if(this.__zooming){var O=D(this,G).event($),z=$.changedTouches,U=z.length,L,W;for(ah($),b&&clearTimeout(b),b=setTimeout(function(){b=null},j),L=0;L<U;++L)W=z[L],O.touch0&&O.touch0[2]===W.identifier?delete O.touch0:O.touch1&&O.touch1[2]===W.identifier&&delete O.touch1;if(O.touch1&&!O.touch0&&(O.touch0=O.touch1,delete O.touch1),O.touch0)O.touch0[1]=this.__zoom.invert(O.touch0[0]);else if(O.end(),O.taps===2&&(W=wn(W,this),Math.hypot(x[0]-W[0],x[1]-W[1])<_)){var B=Qt(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return E.wheelDelta=function($){return arguments.length?(o=typeof $=="function"?$:yc(+$),E):o},E.filter=function($){return arguments.length?(t=typeof $=="function"?$:yc(!!$),E):t},E.touchable=function($){return arguments.length?(c=typeof $=="function"?$:yc(!!$),E):c},E.extent=function($){return arguments.length?(a=typeof $=="function"?$:yc([[+$[0][0],+$[0][1]],[+$[1][0],+$[1][1]]]),E):a},E.scaleExtent=function($){return arguments.length?(u[0]=+$[0],u[1]=+$[1],E):[u[0],u[1]]},E.translateExtent=function($){return arguments.length?(d[0][0]=+$[0][0],d[1][0]=+$[1][0],d[0][1]=+$[0][1],d[1][1]=+$[1][1],E):[[d[0][0],d[0][1]],[d[1][0],d[1][1]]]},E.constrain=function($){return arguments.length?(s=$,E):s},E.duration=function($){return arguments.length?(m=+$,E):m},E.interpolate=function($){return arguments.length?(p=$,E):p},E.on=function(){var $=g.on.apply(g,arguments);return $===g?E:$},E.clickDistance=function($){return arguments.length?(C=($=+$)*$,E):Math.sqrt(C)},E.tapDistance=function($){return arguments.length?(_=+$,E):_},E}const Vn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:a,sourceHandle:s,targetHandle:o})=>`Couldn't create edge for ${t} handle id: "${t==="source"?s:o}", edge id: ${a}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},vo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],H1=["Enter"," ","Escape"],$1={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:a,y:s})=>`Moved selected node ${t}. New position, x: ${a}, y: ${s}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Xr;(function(t){t.Strict="strict",t.Loose="loose"})(Xr||(Xr={}));var Hs;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(Hs||(Hs={}));var wo;(function(t){t.Partial="partial",t.Full="full"})(wo||(wo={}));const q1={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var ts;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(ts||(ts={}));var Jc;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Jc||(Jc={}));var xe;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(xe||(xe={}));const hy={[xe.Left]:xe.Right,[xe.Right]:xe.Left,[xe.Top]:xe.Bottom,[xe.Bottom]:xe.Top};function U1(t){return t===null?null:t?"valid":"invalid"}const V1=t=>"id"in t&&"source"in t&&"target"in t,p8=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),ym=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),Oo=(t,a=[0,0])=>{const{width:s,height:o}=Na(t),c=t.origin??a,u=s*c[0],d=o*c[1];return{x:t.position.x-u,y:t.position.y-d}},g8=(t,a={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const s=t.reduce((o,c)=>{const u=typeof c=="string";let d=!a.nodeLookup&&!u?c:void 0;a.nodeLookup&&(d=u?a.nodeLookup.get(c):ym(c)?c:a.nodeLookup.get(c.id));const m=d?eu(d,a.nodeOrigin):{x:0,y:0,x2:0,y2:0};return yu(o,m)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return bu(s)},Bo=(t,a={})=>{let s={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return t.forEach(c=>{(a.filter===void 0||a.filter(c))&&(s=yu(s,eu(c)),o=!0)}),o?bu(s):{x:0,y:0,width:0,height:0}},bm=(t,a,[s,o,c]=[0,0,1],u=!1,d=!1)=>{const m={...Ho(a,[s,o,c]),width:a.width/c,height:a.height/c},p=[];for(const g of t.values()){const{measured:y,selectable:x=!0,hidden:b=!1}=g;if(d&&!x||b)continue;const j=y.width??g.width??g.initialWidth??null,S=y.height??g.height??g.initialHeight??null,C=jo(m,Qr(g)),_=(j??0)*(S??0),E=u&&C>0;(!g.internals.handleBounds||E||C>=_||g.dragging)&&p.push(g)}return p},x8=(t,a)=>{const s=new Set;return t.forEach(o=>{s.add(o.id)}),a.filter(o=>s.has(o.source)||s.has(o.target))};function y8(t,a){const s=new Map,o=a?.nodes?new Set(a.nodes.map(c=>c.id)):null;return t.forEach(c=>{c.measured.width&&c.measured.height&&(a?.includeHiddenNodes||!c.hidden)&&(!o||o.has(c.id))&&s.set(c.id,c)}),s}async function b8({nodes:t,width:a,height:s,panZoom:o,minZoom:c,maxZoom:u},d){if(t.size===0)return Promise.resolve(!0);const m=y8(t,d),p=Bo(m),g=vm(p,a,s,d?.minZoom??c,d?.maxZoom??u,d?.padding??.1);return await o.setViewport(g,{duration:d?.duration,ease:d?.ease,interpolate:d?.interpolate}),Promise.resolve(!0)}function Y1({nodeId:t,nextPosition:a,nodeLookup:s,nodeOrigin:o=[0,0],nodeExtent:c,onError:u}){const d=s.get(t),m=d.parentId?s.get(d.parentId):void 0,{x:p,y:g}=m?m.internals.positionAbsolute:{x:0,y:0},y=d.origin??o;let x=d.extent||c;if(d.extent==="parent"&&!d.expandParent)if(!m)u?.("005",Vn.error005());else{const j=m.measured.width,S=m.measured.height;j&&S&&(x=[[p,g],[p+j,g+S]])}else m&&Fr(d.extent)&&(x=[[d.extent[0][0]+p,d.extent[0][1]+g],[d.extent[1][0]+p,d.extent[1][1]+g]]);const b=Fr(x)?Us(a,x,d.measured):a;return(d.measured.width===void 0||d.measured.height===void 0)&&u?.("015",Vn.error015()),{position:{x:b.x-p+(d.measured.width??0)*y[0],y:b.y-g+(d.measured.height??0)*y[1]},positionAbsolute:b}}async function v8({nodesToRemove:t=[],edgesToRemove:a=[],nodes:s,edges:o,onBeforeDelete:c}){const u=new Set(t.map(b=>b.id)),d=[];for(const b of s){if(b.deletable===!1)continue;const j=u.has(b.id),S=!j&&b.parentId&&d.find(C=>C.id===b.parentId);(j||S)&&d.push(b)}const m=new Set(a.map(b=>b.id)),p=o.filter(b=>b.deletable!==!1),y=x8(d,p);for(const b of p)m.has(b.id)&&!y.find(S=>S.id===b.id)&&y.push(b);if(!c)return{edges:y,nodes:d};const x=await c({nodes:d,edges:y});return typeof x=="boolean"?x?{edges:y,nodes:d}:{edges:[],nodes:[]}:x}const Gr=(t,a=0,s=1)=>Math.min(Math.max(t,a),s),Us=(t={x:0,y:0},a,s)=>({x:Gr(t.x,a[0][0],a[1][0]-(s?.width??0)),y:Gr(t.y,a[0][1],a[1][1]-(s?.height??0))});function P1(t,a,s){const{width:o,height:c}=Na(s),{x:u,y:d}=s.internals.positionAbsolute;return Us(t,[[u,d],[u+o,d+c]],a)}const my=(t,a,s)=>t<a?Gr(Math.abs(t-a),1,a)/a:t>s?-Gr(Math.abs(t-s),1,a)/a:0,I1=(t,a,s=15,o=40)=>{const c=my(t.x,o,a.width-o)*s,u=my(t.y,o,a.height-o)*s;return[c,u]},yu=(t,a)=>({x:Math.min(t.x,a.x),y:Math.min(t.y,a.y),x2:Math.max(t.x2,a.x2),y2:Math.max(t.y2,a.y2)}),Bh=({x:t,y:a,width:s,height:o})=>({x:t,y:a,x2:t+s,y2:a+o}),bu=({x:t,y:a,x2:s,y2:o})=>({x:t,y:a,width:s-t,height:o-a}),Qr=(t,a=[0,0])=>{const{x:s,y:o}=ym(t)?t.internals.positionAbsolute:Oo(t,a);return{x:s,y:o,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},eu=(t,a=[0,0])=>{const{x:s,y:o}=ym(t)?t.internals.positionAbsolute:Oo(t,a);return{x:s,y:o,x2:s+(t.measured?.width??t.width??t.initialWidth??0),y2:o+(t.measured?.height??t.height??t.initialHeight??0)}},X1=(t,a)=>bu(yu(Bh(t),Bh(a))),jo=(t,a)=>{const s=Math.max(0,Math.min(t.x+t.width,a.x+a.width)-Math.max(t.x,a.x)),o=Math.max(0,Math.min(t.y+t.height,a.y+a.height)-Math.max(t.y,a.y));return Math.ceil(s*o)},py=t=>Nn(t.width)&&Nn(t.height)&&Nn(t.x)&&Nn(t.y),Nn=t=>!isNaN(t)&&isFinite(t),w8=(t,a)=>{},Lo=(t,a=[1,1])=>({x:a[0]*Math.round(t.x/a[0]),y:a[1]*Math.round(t.y/a[1])}),Ho=({x:t,y:a},[s,o,c],u=!1,d=[1,1])=>{const m={x:(t-s)/c,y:(a-o)/c};return u?Lo(m,d):m},tu=({x:t,y:a},[s,o,c])=>({x:t*c+s,y:a*c+o});function kr(t,a){if(typeof t=="number")return Math.floor((a-a/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const s=parseFloat(t);if(!Number.isNaN(s))return Math.floor(s)}if(typeof t=="string"&&t.endsWith("%")){const s=parseFloat(t);if(!Number.isNaN(s))return Math.floor(a*s*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function j8(t,a,s){if(typeof t=="string"||typeof t=="number"){const o=kr(t,s),c=kr(t,a);return{top:o,right:c,bottom:o,left:c,x:c*2,y:o*2}}if(typeof t=="object"){const o=kr(t.top??t.y??0,s),c=kr(t.bottom??t.y??0,s),u=kr(t.left??t.x??0,a),d=kr(t.right??t.x??0,a);return{top:o,right:d,bottom:c,left:u,x:u+d,y:o+c}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function N8(t,a,s,o,c,u){const{x:d,y:m}=tu(t,[a,s,o]),{x:p,y:g}=tu({x:t.x+t.width,y:t.y+t.height},[a,s,o]),y=c-p,x=u-g;return{left:Math.floor(d),top:Math.floor(m),right:Math.floor(y),bottom:Math.floor(x)}}const vm=(t,a,s,o,c,u)=>{const d=j8(u,a,s),m=(a-d.x)/t.width,p=(s-d.y)/t.height,g=Math.min(m,p),y=Gr(g,o,c),x=t.x+t.width/2,b=t.y+t.height/2,j=a/2-x*y,S=s/2-b*y,C=N8(t,j,S,y,a,s),_={left:Math.min(C.left-d.left,0),top:Math.min(C.top-d.top,0),right:Math.min(C.right-d.right,0),bottom:Math.min(C.bottom-d.bottom,0)};return{x:j-_.left+_.right,y:S-_.top+_.bottom,zoom:y}},No=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Fr(t){return t!=null&&t!=="parent"}function Na(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function G1(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function Q1(t,a={width:0,height:0},s,o,c){const u={...t},d=o.get(s);if(d){const m=d.origin||c;u.x+=d.internals.positionAbsolute.x-(a.width??0)*m[0],u.y+=d.internals.positionAbsolute.y-(a.height??0)*m[1]}return u}function gy(t,a){if(t.size!==a.size)return!1;for(const s of t)if(!a.has(s))return!1;return!0}function S8(){let t,a;return{promise:new Promise((o,c)=>{t=o,a=c}),resolve:t,reject:a}}function _8(t){return{...$1,...t||{}}}function ho(t,{snapGrid:a=[0,0],snapToGrid:s=!1,transform:o,containerBounds:c}){const{x:u,y:d}=Sn(t),m=Ho({x:u-(c?.left??0),y:d-(c?.top??0)},o),{x:p,y:g}=s?Lo(m,a):m;return{xSnapped:p,ySnapped:g,...m}}const wm=t=>({width:t.offsetWidth,height:t.offsetHeight}),F1=t=>t?.getRootNode?.()||window?.document,E8=["INPUT","SELECT","TEXTAREA"];function Z1(t){const a=t.composedPath?.()?.[0]||t.target;return a?.nodeType!==1?!1:E8.includes(a.nodeName)||a.hasAttribute("contenteditable")||!!a.closest(".nokey")}const W1=t=>"clientX"in t,Sn=(t,a)=>{const s=W1(t),o=s?t.clientX:t.touches?.[0].clientX,c=s?t.clientY:t.touches?.[0].clientY;return{x:o-(a?.left??0),y:c-(a?.top??0)}},xy=(t,a,s,o,c)=>{const u=a.querySelectorAll(`.${t}`);return!u||!u.length?null:Array.from(u).map(d=>{const m=d.getBoundingClientRect();return{id:d.getAttribute("data-handleid"),type:t,nodeId:c,position:d.getAttribute("data-handlepos"),x:(m.left-s.left)/o,y:(m.top-s.top)/o,...wm(d)}})};function K1({sourceX:t,sourceY:a,targetX:s,targetY:o,sourceControlX:c,sourceControlY:u,targetControlX:d,targetControlY:m}){const p=t*.125+c*.375+d*.375+s*.125,g=a*.125+u*.375+m*.375+o*.125,y=Math.abs(p-t),x=Math.abs(g-a);return[p,g,y,x]}function bc(t,a){return t>=0?.5*t:a*25*Math.sqrt(-t)}function yy({pos:t,x1:a,y1:s,x2:o,y2:c,c:u}){switch(t){case xe.Left:return[a-bc(a-o,u),s];case xe.Right:return[a+bc(o-a,u),s];case xe.Top:return[a,s-bc(s-c,u)];case xe.Bottom:return[a,s+bc(c-s,u)]}}function J1({sourceX:t,sourceY:a,sourcePosition:s=xe.Bottom,targetX:o,targetY:c,targetPosition:u=xe.Top,curvature:d=.25}){const[m,p]=yy({pos:s,x1:t,y1:a,x2:o,y2:c,c:d}),[g,y]=yy({pos:u,x1:o,y1:c,x2:t,y2:a,c:d}),[x,b,j,S]=K1({sourceX:t,sourceY:a,targetX:o,targetY:c,sourceControlX:m,sourceControlY:p,targetControlX:g,targetControlY:y});return[`M${t},${a} C${m},${p} ${g},${y} ${o},${c}`,x,b,j,S]}function ev({sourceX:t,sourceY:a,targetX:s,targetY:o}){const c=Math.abs(s-t)/2,u=s<t?s+c:s-c,d=Math.abs(o-a)/2,m=o<a?o+d:o-d;return[u,m,c,d]}function C8({sourceNode:t,targetNode:a,selected:s=!1,zIndex:o=0,elevateOnSelect:c=!1,zIndexMode:u="basic"}){if(u==="manual")return o;const d=c&&s?o+1e3:o,m=Math.max(t.parentId||c&&t.selected?t.internals.z:0,a.parentId||c&&a.selected?a.internals.z:0);return d+m}function T8({sourceNode:t,targetNode:a,width:s,height:o,transform:c}){const u=yu(eu(t),eu(a));u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d={x:-c[0]/c[2],y:-c[1]/c[2],width:s/c[2],height:o/c[2]};return jo(d,bu(u))>0}const M8=({source:t,sourceHandle:a,target:s,targetHandle:o})=>`xy-edge__${t}${a||""}-${s}${o||""}`,A8=(t,a)=>a.some(s=>s.source===t.source&&s.target===t.target&&(s.sourceHandle===t.sourceHandle||!s.sourceHandle&&!t.sourceHandle)&&(s.targetHandle===t.targetHandle||!s.targetHandle&&!t.targetHandle)),tv=(t,a,s={})=>{if(!t.source||!t.target)return a;const o=s.getEdgeId||M8;let c;return V1(t)?c={...t}:c={...t,id:o(t)},A8(c,a)?a:(c.sourceHandle===null&&delete c.sourceHandle,c.targetHandle===null&&delete c.targetHandle,a.concat(c))};function nv({sourceX:t,sourceY:a,targetX:s,targetY:o}){const[c,u,d,m]=ev({sourceX:t,sourceY:a,targetX:s,targetY:o});return[`M ${t},${a}L ${s},${o}`,c,u,d,m]}const by={[xe.Left]:{x:-1,y:0},[xe.Right]:{x:1,y:0},[xe.Top]:{x:0,y:-1},[xe.Bottom]:{x:0,y:1}},k8=({source:t,sourcePosition:a=xe.Bottom,target:s})=>a===xe.Left||a===xe.Right?t.x<s.x?{x:1,y:0}:{x:-1,y:0}:t.y<s.y?{x:0,y:1}:{x:0,y:-1},vy=(t,a)=>Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2));function R8({source:t,sourcePosition:a=xe.Bottom,target:s,targetPosition:o=xe.Top,center:c,offset:u,stepPosition:d}){const m=by[a],p=by[o],g={x:t.x+m.x*u,y:t.y+m.y*u},y={x:s.x+p.x*u,y:s.y+p.y*u},x=k8({source:g,sourcePosition:a,target:y}),b=x.x!==0?"x":"y",j=x[b];let S=[],C,_;const E={x:0,y:0},R={x:0,y:0},[,,T,A]=ev({sourceX:t.x,sourceY:t.y,targetX:s.x,targetY:s.y});if(m[b]*p[b]===-1){b==="x"?(C=c.x??g.x+(y.x-g.x)*d,_=c.y??(g.y+y.y)/2):(C=c.x??(g.x+y.x)/2,_=c.y??g.y+(y.y-g.y)*d);const D=[{x:C,y:g.y},{x:C,y:y.y}],M=[{x:g.x,y:_},{x:y.x,y:_}];m[b]===j?S=b==="x"?D:M:S=b==="x"?M:D}else{const D=[{x:g.x,y:y.y}],M=[{x:y.x,y:g.y}];if(b==="x"?S=m.x===j?M:D:S=m.y===j?D:M,a===o){const Z=Math.abs(t[b]-s[b]);if(Z<=u){const te=Math.min(u-1,u-Z);m[b]===j?E[b]=(g[b]>t[b]?-1:1)*te:R[b]=(y[b]>s[b]?-1:1)*te}}if(a!==o){const Z=b==="x"?"y":"x",te=m[b]===p[Z],$=g[Z]>y[Z],G=g[Z]<y[Z];(m[b]===1&&(!te&&$||te&&G)||m[b]!==1&&(!te&&G||te&&$))&&(S=b==="x"?D:M)}const q={x:g.x+E.x,y:g.y+E.y},H={x:y.x+R.x,y:y.y+R.y},Q=Math.max(Math.abs(q.x-S[0].x),Math.abs(H.x-S[0].x)),I=Math.max(Math.abs(q.y-S[0].y),Math.abs(H.y-S[0].y));Q>=I?(C=(q.x+H.x)/2,_=S[0].y):(C=S[0].x,_=(q.y+H.y)/2)}return[[t,{x:g.x+E.x,y:g.y+E.y},...S,{x:y.x+R.x,y:y.y+R.y},s],C,_,T,A]}function z8(t,a,s,o){const c=Math.min(vy(t,a)/2,vy(a,s)/2,o),{x:u,y:d}=a;if(t.x===u&&u===s.x||t.y===d&&d===s.y)return`L${u} ${d}`;if(t.y===d){const g=t.x<s.x?-1:1,y=t.y<s.y?1:-1;return`L ${u+c*g},${d}Q ${u},${d} ${u},${d+c*y}`}const m=t.x<s.x?1:-1,p=t.y<s.y?-1:1;return`L ${u},${d+c*p}Q ${u},${d} ${u+c*m},${d}`}function Lh({sourceX:t,sourceY:a,sourcePosition:s=xe.Bottom,targetX:o,targetY:c,targetPosition:u=xe.Top,borderRadius:d=5,centerX:m,centerY:p,offset:g=20,stepPosition:y=.5}){const[x,b,j,S,C]=R8({source:{x:t,y:a},sourcePosition:s,target:{x:o,y:c},targetPosition:u,center:{x:m,y:p},offset:g,stepPosition:y});return[x.reduce((E,R,T)=>{let A="";return T>0&&T<x.length-1?A=z8(x[T-1],R,x[T+1],d):A=`${T===0?"M":"L"}${R.x} ${R.y}`,E+=A,E},""),b,j,S,C]}function wy(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function D8(t){const{sourceNode:a,targetNode:s}=t;if(!wy(a)||!wy(s))return null;const o=a.internals.handleBounds||jy(a.handles),c=s.internals.handleBounds||jy(s.handles),u=Ny(o?.source??[],t.sourceHandle),d=Ny(t.connectionMode===Xr.Strict?c?.target??[]:(c?.target??[]).concat(c?.source??[]),t.targetHandle);if(!u||!d)return t.onError?.("008",Vn.error008(u?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const m=u?.position||xe.Bottom,p=d?.position||xe.Top,g=Vs(a,u,m),y=Vs(s,d,p);return{sourceX:g.x,sourceY:g.y,targetX:y.x,targetY:y.y,sourcePosition:m,targetPosition:p}}function jy(t){if(!t)return null;const a=[],s=[];for(const o of t)o.width=o.width??1,o.height=o.height??1,o.type==="source"?a.push(o):o.type==="target"&&s.push(o);return{source:a,target:s}}function Vs(t,a,s=xe.Left,o=!1){const c=(a?.x??0)+t.internals.positionAbsolute.x,u=(a?.y??0)+t.internals.positionAbsolute.y,{width:d,height:m}=a??Na(t);if(o)return{x:c+d/2,y:u+m/2};switch(a?.position??s){case xe.Top:return{x:c+d/2,y:u};case xe.Right:return{x:c+d,y:u+m/2};case xe.Bottom:return{x:c+d/2,y:u+m};case xe.Left:return{x:c,y:u+m/2}}}function Ny(t,a){return t&&(a?t.find(s=>s.id===a):t[0])||null}function Hh(t,a){return t?typeof t=="string"?t:`${a?`${a}__`:""}${Object.keys(t).sort().map(o=>`${o}=${t[o]}`).join("&")}`:""}function O8(t,{id:a,defaultColor:s,defaultMarkerStart:o,defaultMarkerEnd:c}){const u=new Set;return t.reduce((d,m)=>([m.markerStart||o,m.markerEnd||c].forEach(p=>{if(p&&typeof p=="object"){const g=Hh(p,a);u.has(g)||(d.push({id:g,color:p.color||s,...p}),u.add(g))}}),d),[]).sort((d,m)=>d.id.localeCompare(m.id))}const av=1e3,B8=10,jm={nodeOrigin:[0,0],nodeExtent:vo,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},L8={...jm,checkEquality:!0};function Nm(t,a){const s={...t};for(const o in a)a[o]!==void 0&&(s[o]=a[o]);return s}function H8(t,a,s){const o=Nm(jm,s);for(const c of t.values())if(c.parentId)_m(c,t,a,o);else{const u=Oo(c,o.nodeOrigin),d=Fr(c.extent)?c.extent:o.nodeExtent,m=Us(u,d,Na(c));c.internals.positionAbsolute=m}}function $8(t,a){if(!t.handles)return t.measured?a?.internals.handleBounds:void 0;const s=[],o=[];for(const c of t.handles){const u={id:c.id,width:c.width??1,height:c.height??1,nodeId:t.id,x:c.x,y:c.y,position:c.position,type:c.type};c.type==="source"?s.push(u):c.type==="target"&&o.push(u)}return{source:s,target:o}}function Sm(t){return t==="manual"}function $h(t,a,s,o={}){const c=Nm(L8,o),u={i:0},d=new Map(a),m=c?.elevateNodesOnSelect&&!Sm(c.zIndexMode)?av:0;let p=t.length>0;a.clear(),s.clear();for(const g of t){let y=d.get(g.id);if(c.checkEquality&&g===y?.internals.userNode)a.set(g.id,y);else{const x=Oo(g,c.nodeOrigin),b=Fr(g.extent)?g.extent:c.nodeExtent,j=Us(x,b,Na(g));y={...c.defaults,...g,measured:{width:g.measured?.width,height:g.measured?.height},internals:{positionAbsolute:j,handleBounds:$8(g,y),z:sv(g,m,c.zIndexMode),userNode:g}},a.set(g.id,y)}(y.measured===void 0||y.measured.width===void 0||y.measured.height===void 0)&&!y.hidden&&(p=!1),g.parentId&&_m(y,a,s,o,u)}return p}function q8(t,a){if(!t.parentId)return;const s=a.get(t.parentId);s?s.set(t.id,t):a.set(t.parentId,new Map([[t.id,t]]))}function _m(t,a,s,o,c){const{elevateNodesOnSelect:u,nodeOrigin:d,nodeExtent:m,zIndexMode:p}=Nm(jm,o),g=t.parentId,y=a.get(g);if(!y){console.warn(`Parent node ${g} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}q8(t,s),c&&!y.parentId&&y.internals.rootParentIndex===void 0&&p==="auto"&&(y.internals.rootParentIndex=++c.i,y.internals.z=y.internals.z+c.i*B8),c&&y.internals.rootParentIndex!==void 0&&(c.i=y.internals.rootParentIndex);const x=u&&!Sm(p)?av:0,{x:b,y:j,z:S}=U8(t,y,d,m,x,p),{positionAbsolute:C}=t.internals,_=b!==C.x||j!==C.y;(_||S!==t.internals.z)&&a.set(t.id,{...t,internals:{...t.internals,positionAbsolute:_?{x:b,y:j}:C,z:S}})}function sv(t,a,s){const o=Nn(t.zIndex)?t.zIndex:0;return Sm(s)?o:o+(t.selected?a:0)}function U8(t,a,s,o,c,u){const{x:d,y:m}=a.internals.positionAbsolute,p=Na(t),g=Oo(t,s),y=Fr(t.extent)?Us(g,t.extent,p):g;let x=Us({x:d+y.x,y:m+y.y},o,p);t.extent==="parent"&&(x=P1(x,p,a));const b=sv(t,c,u),j=a.internals.z??0;return{x:x.x,y:x.y,z:j>=b?j+1:b}}function Em(t,a,s,o=[0,0]){const c=[],u=new Map;for(const d of t){const m=a.get(d.parentId);if(!m)continue;const p=u.get(d.parentId)?.expandedRect??Qr(m),g=X1(p,d.rect);u.set(d.parentId,{expandedRect:g,parent:m})}return u.size>0&&u.forEach(({expandedRect:d,parent:m},p)=>{const g=m.internals.positionAbsolute,y=Na(m),x=m.origin??o,b=d.x<g.x?Math.round(Math.abs(g.x-d.x)):0,j=d.y<g.y?Math.round(Math.abs(g.y-d.y)):0,S=Math.max(y.width,Math.round(d.width)),C=Math.max(y.height,Math.round(d.height)),_=(S-y.width)*x[0],E=(C-y.height)*x[1];(b>0||j>0||_||E)&&(c.push({id:p,type:"position",position:{x:m.position.x-b+_,y:m.position.y-j+E}}),s.get(p)?.forEach(R=>{t.some(T=>T.id===R.id)||c.push({id:R.id,type:"position",position:{x:R.position.x+b,y:R.position.y+j}})})),(y.width<d.width||y.height<d.height||b||j)&&c.push({id:p,type:"dimensions",setAttributes:!0,dimensions:{width:S+(b?x[0]*b-_:0),height:C+(j?x[1]*j-E:0)}})}),c}function V8(t,a,s,o,c,u,d){const m=o?.querySelector(".xyflow__viewport");let p=!1;if(!m)return{changes:[],updatedInternals:p};const g=[],y=window.getComputedStyle(m),{m22:x}=new window.DOMMatrixReadOnly(y.transform),b=[];for(const j of t.values()){const S=a.get(j.id);if(!S)continue;if(S.hidden){a.set(S.id,{...S,internals:{...S.internals,handleBounds:void 0}}),p=!0;continue}const C=wm(j.nodeElement),_=S.measured.width!==C.width||S.measured.height!==C.height;if(!!(C.width&&C.height&&(_||!S.internals.handleBounds||j.force))){const R=j.nodeElement.getBoundingClientRect(),T=Fr(S.extent)?S.extent:u;let{positionAbsolute:A}=S.internals;S.parentId&&S.extent==="parent"?A=P1(A,C,a.get(S.parentId)):T&&(A=Us(A,T,C));const w={...S,measured:C,internals:{...S.internals,positionAbsolute:A,handleBounds:{source:xy("source",j.nodeElement,R,x,S.id),target:xy("target",j.nodeElement,R,x,S.id)}}};a.set(S.id,w),S.parentId&&_m(w,a,s,{nodeOrigin:c,zIndexMode:d}),p=!0,_&&(g.push({id:S.id,type:"dimensions",dimensions:C}),S.expandParent&&S.parentId&&b.push({id:S.id,parentId:S.parentId,rect:Qr(w,c)}))}}if(b.length>0){const j=Em(b,a,s,c);g.push(...j)}return{changes:g,updatedInternals:p}}async function Y8({delta:t,panZoom:a,transform:s,translateExtent:o,width:c,height:u}){if(!a||!t.x&&!t.y)return Promise.resolve(!1);const d=await a.setViewportConstrained({x:s[0]+t.x,y:s[1]+t.y,zoom:s[2]},[[0,0],[c,u]],o),m=!!d&&(d.x!==s[0]||d.y!==s[1]||d.k!==s[2]);return Promise.resolve(m)}function Sy(t,a,s,o,c,u){let d=c;const m=o.get(d)||new Map;o.set(d,m.set(s,a)),d=`${c}-${t}`;const p=o.get(d)||new Map;if(o.set(d,p.set(s,a)),u){d=`${c}-${t}-${u}`;const g=o.get(d)||new Map;o.set(d,g.set(s,a))}}function rv(t,a,s){t.clear(),a.clear();for(const o of s){const{source:c,target:u,sourceHandle:d=null,targetHandle:m=null}=o,p={edgeId:o.id,source:c,target:u,sourceHandle:d,targetHandle:m},g=`${c}-${d}--${u}-${m}`,y=`${u}-${m}--${c}-${d}`;Sy("source",p,y,t,c,d),Sy("target",p,g,t,u,m),a.set(o.id,o)}}function iv(t,a){if(!t.parentId)return!1;const s=a.get(t.parentId);return s?s.selected?!0:iv(s,a):!1}function _y(t,a,s){let o=t;do{if(o?.matches?.(a))return!0;if(o===s)return!1;o=o?.parentElement}while(o);return!1}function P8(t,a,s,o){const c=new Map;for(const[u,d]of t)if((d.selected||d.id===o)&&(!d.parentId||!iv(d,t))&&(d.draggable||a&&typeof d.draggable>"u")){const m=t.get(u);m&&c.set(u,{id:u,position:m.position||{x:0,y:0},distance:{x:s.x-m.internals.positionAbsolute.x,y:s.y-m.internals.positionAbsolute.y},extent:m.extent,parentId:m.parentId,origin:m.origin,expandParent:m.expandParent,internals:{positionAbsolute:m.internals.positionAbsolute||{x:0,y:0}},measured:{width:m.measured.width??0,height:m.measured.height??0}})}return c}function sh({nodeId:t,dragItems:a,nodeLookup:s,dragging:o=!0}){const c=[];for(const[d,m]of a){const p=s.get(d)?.internals.userNode;p&&c.push({...p,position:m.position,dragging:o})}if(!t)return[c[0],c];const u=s.get(t)?.internals.userNode;return[u?{...u,position:a.get(t)?.position||u.position,dragging:o}:c[0],c]}function I8({dragItems:t,snapGrid:a,x:s,y:o}){const c=t.values().next().value;if(!c)return null;const u={x:s-c.distance.x,y:o-c.distance.y},d=Lo(u,a);return{x:d.x-u.x,y:d.y-u.y}}function X8({onNodeMouseDown:t,getStoreItems:a,onDragStart:s,onDrag:o,onDragStop:c}){let u={x:null,y:null},d=0,m=new Map,p=!1,g={x:0,y:0},y=null,x=!1,b=null,j=!1,S=!1,C=null;function _({noDragClassName:R,handleSelector:T,domNode:A,isSelectable:w,nodeId:D,nodeClickDistance:M=0}){b=Qt(A);function q({x:Z,y:te}){const{nodeLookup:$,nodeExtent:G,snapGrid:O,snapToGrid:z,nodeOrigin:U,onNodeDrag:L,onSelectionDrag:W,onError:B,updateNodePositions:P}=a();u={x:Z,y:te};let ne=!1;const se=m.size>1,re=se&&G?Bh(Bo(m)):null,de=se&&z?I8({dragItems:m,snapGrid:O,x:Z,y:te}):null;for(const[ue,V]of m){if(!$.has(ue))continue;let ce={x:Z-V.distance.x,y:te-V.distance.y};z&&(ce=de?{x:Math.round(ce.x+de.x),y:Math.round(ce.y+de.y)}:Lo(ce,O));let he=null;if(se&&G&&!V.extent&&re){const{positionAbsolute:be}=V.internals,Se=be.x-re.x+G[0][0],Ae=be.x+V.measured.width-re.x2+G[1][0],Ee=be.y-re.y+G[0][1],$e=be.y+V.measured.height-re.y2+G[1][1];he=[[Se,Ee],[Ae,$e]]}const{position:ve,positionAbsolute:ge}=Y1({nodeId:ue,nextPosition:ce,nodeLookup:$,nodeExtent:he||G,nodeOrigin:U,onError:B});ne=ne||V.position.x!==ve.x||V.position.y!==ve.y,V.position=ve,V.internals.positionAbsolute=ge}if(S=S||ne,!!ne&&(P(m,!0),C&&(o||L||!D&&W))){const[ue,V]=sh({nodeId:D,dragItems:m,nodeLookup:$});o?.(C,m,ue,V),L?.(C,ue,V),D||W?.(C,V)}}async function H(){if(!y)return;const{transform:Z,panBy:te,autoPanSpeed:$,autoPanOnNodeDrag:G}=a();if(!G){p=!1,cancelAnimationFrame(d);return}const[O,z]=I1(g,y,$);(O!==0||z!==0)&&(u.x=(u.x??0)-O/Z[2],u.y=(u.y??0)-z/Z[2],await te({x:O,y:z})&&q(u)),d=requestAnimationFrame(H)}function Q(Z){const{nodeLookup:te,multiSelectionActive:$,nodesDraggable:G,transform:O,snapGrid:z,snapToGrid:U,selectNodesOnDrag:L,onNodeDragStart:W,onSelectionDragStart:B,unselectNodesAndEdges:P}=a();x=!0,(!L||!w)&&!$&&D&&(te.get(D)?.selected||P()),w&&L&&D&&t?.(D);const ne=ho(Z.sourceEvent,{transform:O,snapGrid:z,snapToGrid:U,containerBounds:y});if(u=ne,m=P8(te,G,ne,D),m.size>0&&(s||W||!D&&B)){const[se,re]=sh({nodeId:D,dragItems:m,nodeLookup:te});s?.(Z.sourceEvent,m,se,re),W?.(Z.sourceEvent,se,re),D||B?.(Z.sourceEvent,re)}}const I=j1().clickDistance(M).on("start",Z=>{const{domNode:te,nodeDragThreshold:$,transform:G,snapGrid:O,snapToGrid:z}=a();y=te?.getBoundingClientRect()||null,j=!1,S=!1,C=Z.sourceEvent,$===0&&Q(Z),u=ho(Z.sourceEvent,{transform:G,snapGrid:O,snapToGrid:z,containerBounds:y}),g=Sn(Z.sourceEvent,y)}).on("drag",Z=>{const{autoPanOnNodeDrag:te,transform:$,snapGrid:G,snapToGrid:O,nodeDragThreshold:z,nodeLookup:U}=a(),L=ho(Z.sourceEvent,{transform:$,snapGrid:G,snapToGrid:O,containerBounds:y});if(C=Z.sourceEvent,(Z.sourceEvent.type==="touchmove"&&Z.sourceEvent.touches.length>1||D&&!U.has(D))&&(j=!0),!j){if(!p&&te&&x&&(p=!0,H()),!x){const W=Sn(Z.sourceEvent,y),B=W.x-g.x,P=W.y-g.y;Math.sqrt(B*B+P*P)>z&&Q(Z)}(u.x!==L.xSnapped||u.y!==L.ySnapped)&&m&&x&&(g=Sn(Z.sourceEvent,y),q(L))}}).on("end",Z=>{if(!(!x||j)&&(p=!1,x=!1,cancelAnimationFrame(d),m.size>0)){const{nodeLookup:te,updateNodePositions:$,onNodeDragStop:G,onSelectionDragStop:O}=a();if(S&&($(m,!1),S=!1),c||G||!D&&O){const[z,U]=sh({nodeId:D,dragItems:m,nodeLookup:te,dragging:!1});c?.(Z.sourceEvent,m,z,U),G?.(Z.sourceEvent,z,U),D||O?.(Z.sourceEvent,U)}}}).filter(Z=>{const te=Z.target;return!Z.button&&(!R||!_y(te,`.${R}`,A))&&(!T||_y(te,T,A))});b.call(I)}function E(){b?.on(".drag",null)}return{update:_,destroy:E}}function G8(t,a,s){const o=[],c={x:t.x-s,y:t.y-s,width:s*2,height:s*2};for(const u of a.values())jo(c,Qr(u))>0&&o.push(u);return o}const Q8=250;function F8(t,a,s,o){let c=[],u=1/0;const d=G8(t,s,a+Q8);for(const m of d){const p=[...m.internals.handleBounds?.source??[],...m.internals.handleBounds?.target??[]];for(const g of p){if(o.nodeId===g.nodeId&&o.type===g.type&&o.id===g.id)continue;const{x:y,y:x}=Vs(m,g,g.position,!0),b=Math.sqrt(Math.pow(y-t.x,2)+Math.pow(x-t.y,2));b>a||(b<u?(c=[{...g,x:y,y:x}],u=b):b===u&&c.push({...g,x:y,y:x}))}}if(!c.length)return null;if(c.length>1){const m=o.type==="source"?"target":"source";return c.find(p=>p.type===m)??c[0]}return c[0]}function ov(t,a,s,o,c,u=!1){const d=o.get(t);if(!d)return null;const m=c==="strict"?d.internals.handleBounds?.[a]:[...d.internals.handleBounds?.source??[],...d.internals.handleBounds?.target??[]],p=(s?m?.find(g=>g.id===s):m?.[0])??null;return p&&u?{...p,...Vs(d,p,p.position,!0)}:p}function lv(t,a){return t||(a?.classList.contains("target")?"target":a?.classList.contains("source")?"source":null)}function Z8(t,a){let s=null;return a?s=!0:t&&!a&&(s=!1),s}const cv=()=>!0;function W8(t,{connectionMode:a,connectionRadius:s,handleId:o,nodeId:c,edgeUpdaterType:u,isTarget:d,domNode:m,nodeLookup:p,lib:g,autoPanOnConnect:y,flowId:x,panBy:b,cancelConnection:j,onConnectStart:S,onConnect:C,onConnectEnd:_,isValidConnection:E=cv,onReconnectEnd:R,updateConnection:T,getTransform:A,getFromHandle:w,autoPanSpeed:D,dragThreshold:M=1,handleDomNode:q}){const H=F1(t.target);let Q=0,I;const{x:Z,y:te}=Sn(t),$=lv(u,q),G=m?.getBoundingClientRect();let O=!1;if(!G||!$)return;const z=ov(c,$,o,p,a);if(!z)return;let U=Sn(t,G),L=!1,W=null,B=!1,P=null;function ne(){if(!y||!G)return;const[ve,ge]=I1(U,G,D);b({x:ve,y:ge}),Q=requestAnimationFrame(ne)}const se={...z,nodeId:c,type:$,position:z.position},re=p.get(c);let ue={inProgress:!0,isValid:null,from:Vs(re,se,xe.Left,!0),fromHandle:se,fromPosition:se.position,fromNode:re,to:U,toHandle:null,toPosition:hy[se.position],toNode:null,pointer:U};function V(){O=!0,T(ue),S?.(t,{nodeId:c,handleId:o,handleType:$})}M===0&&V();function ce(ve){if(!O){const{x:$e,y:ze}=Sn(ve),yt=$e-Z,pt=ze-te;if(!(yt*yt+pt*pt>M*M))return;V()}if(!w()||!se){he(ve);return}const ge=A();U=Sn(ve,G),I=F8(Ho(U,ge,!1,[1,1]),s,p,se),L||(ne(),L=!0);const be=uv(ve,{handle:I,connectionMode:a,fromNodeId:c,fromHandleId:o,fromType:d?"target":"source",isValidConnection:E,doc:H,lib:g,flowId:x,nodeLookup:p});P=be.handleDomNode,W=be.connection,B=Z8(!!I,be.isValid);const Se=p.get(c),Ae=Se?Vs(Se,se,xe.Left,!0):ue.from,Ee={...ue,from:Ae,isValid:B,to:be.toHandle&&B?tu({x:be.toHandle.x,y:be.toHandle.y},ge):U,toHandle:be.toHandle,toPosition:B&&be.toHandle?be.toHandle.position:hy[se.position],toNode:be.toHandle?p.get(be.toHandle.nodeId):null,pointer:U};T(Ee),ue=Ee}function he(ve){if(!("touches"in ve&&ve.touches.length>0)){if(O){(I||P)&&W&&B&&C?.(W);const{inProgress:ge,...be}=ue,Se={...be,toPosition:ue.toHandle?ue.toPosition:null};_?.(ve,Se),u&&R?.(ve,Se)}j(),cancelAnimationFrame(Q),L=!1,B=!1,W=null,P=null,H.removeEventListener("mousemove",ce),H.removeEventListener("mouseup",he),H.removeEventListener("touchmove",ce),H.removeEventListener("touchend",he)}}H.addEventListener("mousemove",ce),H.addEventListener("mouseup",he),H.addEventListener("touchmove",ce),H.addEventListener("touchend",he)}function uv(t,{handle:a,connectionMode:s,fromNodeId:o,fromHandleId:c,fromType:u,doc:d,lib:m,flowId:p,isValidConnection:g=cv,nodeLookup:y}){const x=u==="target",b=a?d.querySelector(`.${m}-flow__handle[data-id="${p}-${a?.nodeId}-${a?.id}-${a?.type}"]`):null,{x:j,y:S}=Sn(t),C=d.elementFromPoint(j,S),_=C?.classList.contains(`${m}-flow__handle`)?C:b,E={handleDomNode:_,isValid:!1,connection:null,toHandle:null};if(_){const R=lv(void 0,_),T=_.getAttribute("data-nodeid"),A=_.getAttribute("data-handleid"),w=_.classList.contains("connectable"),D=_.classList.contains("connectableend");if(!T||!R)return E;const M={source:x?T:o,sourceHandle:x?A:c,target:x?o:T,targetHandle:x?c:A};E.connection=M;const H=w&&D&&(s===Xr.Strict?x&&R==="source"||!x&&R==="target":T!==o||A!==c);E.isValid=H&&g(M),E.toHandle=ov(T,R,A,y,s,!0)}return E}const qh={onPointerDown:W8,isValid:uv};function K8({domNode:t,panZoom:a,getTransform:s,getViewScale:o}){const c=Qt(t);function u({translateExtent:m,width:p,height:g,zoomStep:y=1,pannable:x=!0,zoomable:b=!0,inversePan:j=!1}){const S=T=>{if(T.sourceEvent.type!=="wheel"||!a)return;const A=s(),w=T.sourceEvent.ctrlKey&&No()?10:1,D=-T.sourceEvent.deltaY*(T.sourceEvent.deltaMode===1?.05:T.sourceEvent.deltaMode?1:.002)*y,M=A[2]*Math.pow(2,D*w);a.scaleTo(M)};let C=[0,0];const _=T=>{(T.sourceEvent.type==="mousedown"||T.sourceEvent.type==="touchstart")&&(C=[T.sourceEvent.clientX??T.sourceEvent.touches[0].clientX,T.sourceEvent.clientY??T.sourceEvent.touches[0].clientY])},E=T=>{const A=s();if(T.sourceEvent.type!=="mousemove"&&T.sourceEvent.type!=="touchmove"||!a)return;const w=[T.sourceEvent.clientX??T.sourceEvent.touches[0].clientX,T.sourceEvent.clientY??T.sourceEvent.touches[0].clientY],D=[w[0]-C[0],w[1]-C[1]];C=w;const M=o()*Math.max(A[2],Math.log(A[2]))*(j?-1:1),q={x:A[0]-D[0]*M,y:A[1]-D[1]*M},H=[[0,0],[p,g]];a.setViewportConstrained({x:q.x,y:q.y,zoom:A[2]},H,m)},R=L1().on("start",_).on("zoom",x?E:null).on("zoom.wheel",b?S:null);c.call(R,{})}function d(){c.on("zoom",null)}return{update:u,destroy:d,pointer:wn}}const vu=t=>({x:t.x,y:t.y,zoom:t.k}),rh=({x:t,y:a,zoom:s})=>xu.translate(t,a).scale(s),Dr=(t,a)=>t.target.closest(`.${a}`),dv=(t,a)=>a===2&&Array.isArray(t)&&t.includes(2),J8=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,ih=(t,a=0,s=J8,o=()=>{})=>{const c=typeof a=="number"&&a>0;return c||o(),c?t.transition().duration(a).ease(s).on("end",o):t},fv=t=>{const a=t.ctrlKey&&No()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*a};function eT({zoomPanValues:t,noWheelClassName:a,d3Selection:s,d3Zoom:o,panOnScrollMode:c,panOnScrollSpeed:u,zoomOnPinch:d,onPanZoomStart:m,onPanZoom:p,onPanZoomEnd:g}){return y=>{if(Dr(y,a))return y.ctrlKey&&y.preventDefault(),!1;y.preventDefault(),y.stopImmediatePropagation();const x=s.property("__zoom").k||1;if(y.ctrlKey&&d){const _=wn(y),E=fv(y),R=x*Math.pow(2,E);o.scaleTo(s,R,_,y);return}const b=y.deltaMode===1?20:1;let j=c===Hs.Vertical?0:y.deltaX*b,S=c===Hs.Horizontal?0:y.deltaY*b;!No()&&y.shiftKey&&c!==Hs.Vertical&&(j=y.deltaY*b,S=0),o.translateBy(s,-(j/x)*u,-(S/x)*u,{internal:!0});const C=vu(s.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(p?.(y,C),t.panScrollTimeout=setTimeout(()=>{g?.(y,C),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,m?.(y,C))}}function tT({noWheelClassName:t,preventScrolling:a,d3ZoomHandler:s}){return function(o,c){const u=o.type==="wheel",d=!a&&u&&!o.ctrlKey,m=Dr(o,t);if(o.ctrlKey&&u&&m&&o.preventDefault(),d||m)return null;o.preventDefault(),s.call(this,o,c)}}function nT({zoomPanValues:t,onDraggingChange:a,onPanZoomStart:s}){return o=>{if(o.sourceEvent?.internal)return;const c=vu(o.transform);t.mouseButton=o.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=c,o.sourceEvent?.type==="mousedown"&&a(!0),s&&s?.(o.sourceEvent,c)}}function aT({zoomPanValues:t,panOnDrag:a,onPaneContextMenu:s,onTransformChange:o,onPanZoom:c}){return u=>{t.usedRightMouseButton=!!(s&&dv(a,t.mouseButton??0)),u.sourceEvent?.sync||o([u.transform.x,u.transform.y,u.transform.k]),c&&!u.sourceEvent?.internal&&c?.(u.sourceEvent,vu(u.transform))}}function sT({zoomPanValues:t,panOnDrag:a,panOnScroll:s,onDraggingChange:o,onPanZoomEnd:c,onPaneContextMenu:u}){return d=>{if(!d.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,u&&dv(a,t.mouseButton??0)&&!t.usedRightMouseButton&&d.sourceEvent&&u(d.sourceEvent),t.usedRightMouseButton=!1,o(!1),c)){const m=vu(d.transform);t.prevViewport=m,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{c?.(d.sourceEvent,m)},s?150:0)}}}function rT({zoomActivationKeyPressed:t,zoomOnScroll:a,zoomOnPinch:s,panOnDrag:o,panOnScroll:c,zoomOnDoubleClick:u,userSelectionActive:d,noWheelClassName:m,noPanClassName:p,lib:g,connectionInProgress:y}){return x=>{const b=t||a,j=s&&x.ctrlKey,S=x.type==="wheel";if(x.button===1&&x.type==="mousedown"&&(Dr(x,`${g}-flow__node`)||Dr(x,`${g}-flow__edge`)))return!0;if(!o&&!b&&!c&&!u&&!s||d||y&&!S||Dr(x,m)&&S||Dr(x,p)&&(!S||c&&S&&!t)||!s&&x.ctrlKey&&S)return!1;if(!s&&x.type==="touchstart"&&x.touches?.length>1)return x.preventDefault(),!1;if(!b&&!c&&!j&&S||!o&&(x.type==="mousedown"||x.type==="touchstart")||Array.isArray(o)&&!o.includes(x.button)&&x.type==="mousedown")return!1;const C=Array.isArray(o)&&o.includes(x.button)||!x.button||x.button<=1;return(!x.ctrlKey||S)&&C}}function iT({domNode:t,minZoom:a,maxZoom:s,translateExtent:o,viewport:c,onPanZoom:u,onPanZoomStart:d,onPanZoomEnd:m,onDraggingChange:p}){const g={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},y=t.getBoundingClientRect(),x=L1().scaleExtent([a,s]).translateExtent(o),b=Qt(t).call(x);R({x:c.x,y:c.y,zoom:Gr(c.zoom,a,s)},[[0,0],[y.width,y.height]],o);const j=b.on("wheel.zoom"),S=b.on("dblclick.zoom");x.wheelDelta(fv);function C(I,Z){return b?new Promise(te=>{x?.interpolate(Z?.interpolate==="linear"?fo:Dc).transform(ih(b,Z?.duration,Z?.ease,()=>te(!0)),I)}):Promise.resolve(!1)}function _({noWheelClassName:I,noPanClassName:Z,onPaneContextMenu:te,userSelectionActive:$,panOnScroll:G,panOnDrag:O,panOnScrollMode:z,panOnScrollSpeed:U,preventScrolling:L,zoomOnPinch:W,zoomOnScroll:B,zoomOnDoubleClick:P,zoomActivationKeyPressed:ne,lib:se,onTransformChange:re,connectionInProgress:de,paneClickDistance:ue,selectionOnDrag:V}){$&&!g.isZoomingOrPanning&&E();const ce=G&&!ne&&!$;x.clickDistance(V?1/0:!Nn(ue)||ue<0?0:ue);const he=ce?eT({zoomPanValues:g,noWheelClassName:I,d3Selection:b,d3Zoom:x,panOnScrollMode:z,panOnScrollSpeed:U,zoomOnPinch:W,onPanZoomStart:d,onPanZoom:u,onPanZoomEnd:m}):tT({noWheelClassName:I,preventScrolling:L,d3ZoomHandler:j});if(b.on("wheel.zoom",he,{passive:!1}),!$){const ge=nT({zoomPanValues:g,onDraggingChange:p,onPanZoomStart:d});x.on("start",ge);const be=aT({zoomPanValues:g,panOnDrag:O,onPaneContextMenu:!!te,onPanZoom:u,onTransformChange:re});x.on("zoom",be);const Se=sT({zoomPanValues:g,panOnDrag:O,panOnScroll:G,onPaneContextMenu:te,onPanZoomEnd:m,onDraggingChange:p});x.on("end",Se)}const ve=rT({zoomActivationKeyPressed:ne,panOnDrag:O,zoomOnScroll:B,panOnScroll:G,zoomOnDoubleClick:P,zoomOnPinch:W,userSelectionActive:$,noPanClassName:Z,noWheelClassName:I,lib:se,connectionInProgress:de});x.filter(ve),P?b.on("dblclick.zoom",S):b.on("dblclick.zoom",null)}function E(){x.on("zoom",null)}async function R(I,Z,te){const $=rh(I),G=x?.constrain()($,Z,te);return G&&await C(G),new Promise(O=>O(G))}async function T(I,Z){const te=rh(I);return await C(te,Z),new Promise($=>$(te))}function A(I){if(b){const Z=rh(I),te=b.property("__zoom");(te.k!==I.zoom||te.x!==I.x||te.y!==I.y)&&x?.transform(b,Z,null,{sync:!0})}}function w(){const I=b?B1(b.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function D(I,Z){return b?new Promise(te=>{x?.interpolate(Z?.interpolate==="linear"?fo:Dc).scaleTo(ih(b,Z?.duration,Z?.ease,()=>te(!0)),I)}):Promise.resolve(!1)}function M(I,Z){return b?new Promise(te=>{x?.interpolate(Z?.interpolate==="linear"?fo:Dc).scaleBy(ih(b,Z?.duration,Z?.ease,()=>te(!0)),I)}):Promise.resolve(!1)}function q(I){x?.scaleExtent(I)}function H(I){x?.translateExtent(I)}function Q(I){const Z=!Nn(I)||I<0?0:I;x?.clickDistance(Z)}return{update:_,destroy:E,setViewport:T,setViewportConstrained:R,getViewport:w,scaleTo:D,scaleBy:M,setScaleExtent:q,setTranslateExtent:H,syncViewport:A,setClickDistance:Q}}var Zr;(function(t){t.Line="line",t.Handle="handle"})(Zr||(Zr={}));function oT({width:t,prevWidth:a,height:s,prevHeight:o,affectsX:c,affectsY:u}){const d=t-a,m=s-o,p=[d>0?1:d<0?-1:0,m>0?1:m<0?-1:0];return d&&c&&(p[0]=p[0]*-1),m&&u&&(p[1]=p[1]*-1),p}function Ey(t){const a=t.includes("right")||t.includes("left"),s=t.includes("bottom")||t.includes("top"),o=t.includes("left"),c=t.includes("top");return{isHorizontal:a,isVertical:s,affectsX:o,affectsY:c}}function Ja(t,a){return Math.max(0,a-t)}function es(t,a){return Math.max(0,t-a)}function vc(t,a,s){return Math.max(0,a-t,t-s)}function Cy(t,a){return t?!a:a}function lT(t,a,s,o,c,u,d,m){let{affectsX:p,affectsY:g}=a;const{isHorizontal:y,isVertical:x}=a,b=y&&x,{xSnapped:j,ySnapped:S}=s,{minWidth:C,maxWidth:_,minHeight:E,maxHeight:R}=o,{x:T,y:A,width:w,height:D,aspectRatio:M}=t;let q=Math.floor(y?j-t.pointerX:0),H=Math.floor(x?S-t.pointerY:0);const Q=w+(p?-q:q),I=D+(g?-H:H),Z=-u[0]*w,te=-u[1]*D;let $=vc(Q,C,_),G=vc(I,E,R);if(d){let U=0,L=0;p&&q<0?U=Ja(T+q+Z,d[0][0]):!p&&q>0&&(U=es(T+Q+Z,d[1][0])),g&&H<0?L=Ja(A+H+te,d[0][1]):!g&&H>0&&(L=es(A+I+te,d[1][1])),$=Math.max($,U),G=Math.max(G,L)}if(m){let U=0,L=0;p&&q>0?U=es(T+q,m[0][0]):!p&&q<0&&(U=Ja(T+Q,m[1][0])),g&&H>0?L=es(A+H,m[0][1]):!g&&H<0&&(L=Ja(A+I,m[1][1])),$=Math.max($,U),G=Math.max(G,L)}if(c){if(y){const U=vc(Q/M,E,R)*M;if($=Math.max($,U),d){let L=0;!p&&!g||p&&!g&&b?L=es(A+te+Q/M,d[1][1])*M:L=Ja(A+te+(p?q:-q)/M,d[0][1])*M,$=Math.max($,L)}if(m){let L=0;!p&&!g||p&&!g&&b?L=Ja(A+Q/M,m[1][1])*M:L=es(A+(p?q:-q)/M,m[0][1])*M,$=Math.max($,L)}}if(x){const U=vc(I*M,C,_)/M;if(G=Math.max(G,U),d){let L=0;!p&&!g||g&&!p&&b?L=es(T+I*M+Z,d[1][0])/M:L=Ja(T+(g?H:-H)*M+Z,d[0][0])/M,G=Math.max(G,L)}if(m){let L=0;!p&&!g||g&&!p&&b?L=Ja(T+I*M,m[1][0])/M:L=es(T+(g?H:-H)*M,m[0][0])/M,G=Math.max(G,L)}}}H=H+(H<0?G:-G),q=q+(q<0?$:-$),c&&(b?Q>I*M?H=(Cy(p,g)?-q:q)/M:q=(Cy(p,g)?-H:H)*M:y?(H=q/M,g=p):(q=H*M,p=g));const O=p?T+q:T,z=g?A+H:A;return{width:w+(p?-q:q),height:D+(g?-H:H),x:u[0]*q*(p?-1:1)+O,y:u[1]*H*(g?-1:1)+z}}const hv={width:0,height:0,x:0,y:0},cT={...hv,pointerX:0,pointerY:0,aspectRatio:1};function uT(t){return[[0,0],[t.measured.width,t.measured.height]]}function dT(t,a,s){const o=a.position.x+t.position.x,c=a.position.y+t.position.y,u=t.measured.width??0,d=t.measured.height??0,m=s[0]*u,p=s[1]*d;return[[o-m,c-p],[o+u-m,c+d-p]]}function fT({domNode:t,nodeId:a,getStoreItems:s,onChange:o,onEnd:c}){const u=Qt(t);let d={controlDirection:Ey("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function m({controlPosition:g,boundaries:y,keepAspectRatio:x,resizeDirection:b,onResizeStart:j,onResize:S,onResizeEnd:C,shouldResize:_}){let E={...hv},R={...cT};d={boundaries:y,resizeDirection:b,keepAspectRatio:x,controlDirection:Ey(g)};let T,A=null,w=[],D,M,q,H=!1;const Q=j1().on("start",I=>{const{nodeLookup:Z,transform:te,snapGrid:$,snapToGrid:G,nodeOrigin:O,paneDomNode:z}=s();if(T=Z.get(a),!T)return;A=z?.getBoundingClientRect()??null;const{xSnapped:U,ySnapped:L}=ho(I.sourceEvent,{transform:te,snapGrid:$,snapToGrid:G,containerBounds:A});E={width:T.measured.width??0,height:T.measured.height??0,x:T.position.x??0,y:T.position.y??0},R={...E,pointerX:U,pointerY:L,aspectRatio:E.width/E.height},D=void 0,T.parentId&&(T.extent==="parent"||T.expandParent)&&(D=Z.get(T.parentId),M=D&&T.extent==="parent"?uT(D):void 0),w=[],q=void 0;for(const[W,B]of Z)if(B.parentId===a&&(w.push({id:W,position:{...B.position},extent:B.extent}),B.extent==="parent"||B.expandParent)){const P=dT(B,T,B.origin??O);q?q=[[Math.min(P[0][0],q[0][0]),Math.min(P[0][1],q[0][1])],[Math.max(P[1][0],q[1][0]),Math.max(P[1][1],q[1][1])]]:q=P}j?.(I,{...E})}).on("drag",I=>{const{transform:Z,snapGrid:te,snapToGrid:$,nodeOrigin:G}=s(),O=ho(I.sourceEvent,{transform:Z,snapGrid:te,snapToGrid:$,containerBounds:A}),z=[];if(!T)return;const{x:U,y:L,width:W,height:B}=E,P={},ne=T.origin??G,{width:se,height:re,x:de,y:ue}=lT(R,d.controlDirection,O,d.boundaries,d.keepAspectRatio,ne,M,q),V=se!==W,ce=re!==B,he=de!==U&&V,ve=ue!==L&&ce;if(!he&&!ve&&!V&&!ce)return;if((he||ve||ne[0]===1||ne[1]===1)&&(P.x=he?de:E.x,P.y=ve?ue:E.y,E.x=P.x,E.y=P.y,w.length>0)){const Ae=de-U,Ee=ue-L;for(const $e of w)$e.position={x:$e.position.x-Ae+ne[0]*(se-W),y:$e.position.y-Ee+ne[1]*(re-B)},z.push($e)}if((V||ce)&&(P.width=V&&(!d.resizeDirection||d.resizeDirection==="horizontal")?se:E.width,P.height=ce&&(!d.resizeDirection||d.resizeDirection==="vertical")?re:E.height,E.width=P.width,E.height=P.height),D&&T.expandParent){const Ae=ne[0]*(P.width??0);P.x&&P.x<Ae&&(E.x=Ae,R.x=R.x-(P.x-Ae));const Ee=ne[1]*(P.height??0);P.y&&P.y<Ee&&(E.y=Ee,R.y=R.y-(P.y-Ee))}const ge=oT({width:E.width,prevWidth:W,height:E.height,prevHeight:B,affectsX:d.controlDirection.affectsX,affectsY:d.controlDirection.affectsY}),be={...E,direction:ge};_?.(I,be)!==!1&&(H=!0,S?.(I,be),o(P,z))}).on("end",I=>{H&&(C?.(I,{...E}),c?.({...E}),H=!1)});u.call(Q)}function p(){u.on(".drag",null)}return{update:m,destroy:p}}var oh={exports:{}},lh={},ch={exports:{}},uh={};var Ty;function hT(){if(Ty)return uh;Ty=1;var t=_o();function a(x,b){return x===b&&(x!==0||1/x===1/b)||x!==x&&b!==b}var s=typeof Object.is=="function"?Object.is:a,o=t.useState,c=t.useEffect,u=t.useLayoutEffect,d=t.useDebugValue;function m(x,b){var j=b(),S=o({inst:{value:j,getSnapshot:b}}),C=S[0].inst,_=S[1];return u(function(){C.value=j,C.getSnapshot=b,p(C)&&_({inst:C})},[x,j,b]),c(function(){return p(C)&&_({inst:C}),x(function(){p(C)&&_({inst:C})})},[x]),d(j),j}function p(x){var b=x.getSnapshot;x=x.value;try{var j=b();return!s(x,j)}catch{return!0}}function g(x,b){return b()}var y=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?g:m;return uh.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:y,uh}var My;function mT(){return My||(My=1,ch.exports=hT()),ch.exports}var Ay;function pT(){if(Ay)return lh;Ay=1;var t=_o(),a=mT();function s(g,y){return g===y&&(g!==0||1/g===1/y)||g!==g&&y!==y}var o=typeof Object.is=="function"?Object.is:s,c=a.useSyncExternalStore,u=t.useRef,d=t.useEffect,m=t.useMemo,p=t.useDebugValue;return lh.useSyncExternalStoreWithSelector=function(g,y,x,b,j){var S=u(null);if(S.current===null){var C={hasValue:!1,value:null};S.current=C}else C=S.current;S=m(function(){function E(D){if(!R){if(R=!0,T=D,D=b(D),j!==void 0&&C.hasValue){var M=C.value;if(j(M,D))return A=M}return A=D}if(M=A,o(T,D))return M;var q=b(D);return j!==void 0&&j(M,q)?(T=D,M):(T=D,A=q)}var R=!1,T,A,w=x===void 0?null:x;return[function(){return E(y())},w===null?void 0:function(){return E(w())}]},[y,x,b,j]);var _=c(g,S[0],S[1]);return d(function(){C.hasValue=!0,C.value=_},[_]),p(_),_},lh}var ky;function gT(){return ky||(ky=1,oh.exports=pT()),oh.exports}var xT=gT();const yT=Vh(xT),bT={},Ry=t=>{let a;const s=new Set,o=(y,x)=>{const b=typeof y=="function"?y(a):y;if(!Object.is(b,a)){const j=a;a=x??(typeof b!="object"||b===null)?b:Object.assign({},a,b),s.forEach(S=>S(a,j))}},c=()=>a,p={setState:o,getState:c,getInitialState:()=>g,subscribe:y=>(s.add(y),()=>s.delete(y)),destroy:()=>{(bT?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},g=a=t(o,c,p);return p},vT=t=>t?Ry(t):Ry,{useDebugValue:wT}=zr,{useSyncExternalStoreWithSelector:jT}=yT,NT=t=>t;function mv(t,a=NT,s){const o=jT(t.subscribe,t.getState,t.getServerState||t.getInitialState,a,s);return wT(o),o}const zy=(t,a)=>{const s=vT(t),o=(c,u=a)=>mv(s,c,u);return Object.assign(o,s),o},ST=(t,a)=>t?zy(t,a):zy;function We(t,a){if(Object.is(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;if(t instanceof Map&&a instanceof Map){if(t.size!==a.size)return!1;for(const[o,c]of t)if(!Object.is(c,a.get(o)))return!1;return!0}if(t instanceof Set&&a instanceof Set){if(t.size!==a.size)return!1;for(const o of t)if(!a.has(o))return!1;return!0}const s=Object.keys(t);if(s.length!==Object.keys(a).length)return!1;for(const o of s)if(!Object.prototype.hasOwnProperty.call(a,o)||!Object.is(t[o],a[o]))return!1;return!0}const wu=N.createContext(null),_T=wu.Provider,pv=Vn.error001();function Oe(t,a){const s=N.useContext(wu);if(s===null)throw new Error(pv);return mv(s,t,a)}function Ke(){const t=N.useContext(wu);if(t===null)throw new Error(pv);return N.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const Dy={display:"none"},ET={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},gv="react-flow__node-desc",xv="react-flow__edge-desc",CT="react-flow__aria-live",TT=t=>t.ariaLiveMessage,MT=t=>t.ariaLabelConfig;function AT({rfId:t}){const a=Oe(TT);return r.jsx("div",{id:`${CT}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:ET,children:a})}function kT({rfId:t,disableKeyboardA11y:a}){const s=Oe(MT);return r.jsxs(r.Fragment,{children:[r.jsx("div",{id:`${gv}-${t}`,style:Dy,children:a?s["node.a11yDescription.default"]:s["node.a11yDescription.keyboardDisabled"]}),r.jsx("div",{id:`${xv}-${t}`,style:Dy,children:s["edge.a11yDescription.default"]}),!a&&r.jsx(AT,{rfId:t})]})}const ju=N.forwardRef(({position:t="top-left",children:a,className:s,style:o,...c},u)=>{const d=`${t}`.split("-");return r.jsx("div",{className:ut(["react-flow__panel",s,...d]),style:o,ref:u,...c,children:a})});ju.displayName="Panel";function RT({proOptions:t,position:a="bottom-right"}){return t?.hideAttribution?null:r.jsx(ju,{position:a,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:r.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const zT=t=>{const a=[],s=[];for(const[,o]of t.nodeLookup)o.selected&&a.push(o.internals.userNode);for(const[,o]of t.edgeLookup)o.selected&&s.push(o);return{selectedNodes:a,selectedEdges:s}},wc=t=>t.id;function DT(t,a){return We(t.selectedNodes.map(wc),a.selectedNodes.map(wc))&&We(t.selectedEdges.map(wc),a.selectedEdges.map(wc))}function OT({onSelectionChange:t}){const a=Ke(),{selectedNodes:s,selectedEdges:o}=Oe(zT,DT);return N.useEffect(()=>{const c={nodes:s,edges:o};t?.(c),a.getState().onSelectionChangeHandlers.forEach(u=>u(c))},[s,o,t]),null}const BT=t=>!!t.onSelectionChangeHandlers;function LT({onSelectionChange:t}){const a=Oe(BT);return t||a?r.jsx(OT,{onSelectionChange:t}):null}const yv=[0,0],HT={x:0,y:0,zoom:1},$T=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Oy=[...$T,"rfId"],qT=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges}),By={translateExtent:vo,nodeOrigin:yv,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function UT(t){const{setNodes:a,setEdges:s,setMinZoom:o,setMaxZoom:c,setTranslateExtent:u,setNodeExtent:d,reset:m,setDefaultNodesAndEdges:p}=Oe(qT,We),g=Ke();N.useEffect(()=>(p(t.defaultNodes,t.defaultEdges),()=>{y.current=By,m()}),[]);const y=N.useRef(By);return N.useEffect(()=>{for(const x of Oy){const b=t[x],j=y.current[x];b!==j&&(typeof t[x]>"u"||(x==="nodes"?a(b):x==="edges"?s(b):x==="minZoom"?o(b):x==="maxZoom"?c(b):x==="translateExtent"?u(b):x==="nodeExtent"?d(b):x==="ariaLabelConfig"?g.setState({ariaLabelConfig:_8(b)}):x==="fitView"?g.setState({fitViewQueued:b}):x==="fitViewOptions"?g.setState({fitViewOptions:b}):g.setState({[x]:b})))}y.current=t},Oy.map(x=>t[x])),null}function Ly(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function VT(t){const[a,s]=N.useState(t==="system"?null:t);return N.useEffect(()=>{if(t!=="system"){s(t);return}const o=Ly(),c=()=>s(o?.matches?"dark":"light");return c(),o?.addEventListener("change",c),()=>{o?.removeEventListener("change",c)}},[t]),a!==null?a:Ly()?.matches?"dark":"light"}const Hy=typeof document<"u"?document:null;function So(t=null,a={target:Hy,actInsideInputWithModifier:!0}){const[s,o]=N.useState(!1),c=N.useRef(!1),u=N.useRef(new Set([])),[d,m]=N.useMemo(()=>{if(t!==null){const g=(Array.isArray(t)?t:[t]).filter(x=>typeof x=="string").map(x=>x.replace("+",`
`).replace(`

`,`
+`).split(`
`)),y=g.reduce((x,b)=>x.concat(...b),[]);return[g,y]}return[[],[]]},[t]);return N.useEffect(()=>{const p=a?.target??Hy,g=a?.actInsideInputWithModifier??!0;if(t!==null){const y=j=>{if(c.current=j.ctrlKey||j.metaKey||j.shiftKey||j.altKey,(!c.current||c.current&&!g)&&Z1(j))return!1;const C=qy(j.code,m);if(u.current.add(j[C]),$y(d,u.current,!1)){const _=j.composedPath?.()?.[0]||j.target,E=_?.nodeName==="BUTTON"||_?.nodeName==="A";a.preventDefault!==!1&&(c.current||!E)&&j.preventDefault(),o(!0)}},x=j=>{const S=qy(j.code,m);$y(d,u.current,!0)?(o(!1),u.current.clear()):u.current.delete(j[S]),j.key==="Meta"&&u.current.clear(),c.current=!1},b=()=>{u.current.clear(),o(!1)};return p?.addEventListener("keydown",y),p?.addEventListener("keyup",x),window.addEventListener("blur",b),window.addEventListener("contextmenu",b),()=>{p?.removeEventListener("keydown",y),p?.removeEventListener("keyup",x),window.removeEventListener("blur",b),window.removeEventListener("contextmenu",b)}}},[t,o]),s}function $y(t,a,s){return t.filter(o=>s||o.length===a.size).some(o=>o.every(c=>a.has(c)))}function qy(t,a){return a.includes(t)?"code":"key"}const YT=()=>{const t=Ke();return N.useMemo(()=>({zoomIn:a=>{const{panZoom:s}=t.getState();return s?s.scaleBy(1.2,{duration:a?.duration}):Promise.resolve(!1)},zoomOut:a=>{const{panZoom:s}=t.getState();return s?s.scaleBy(1/1.2,{duration:a?.duration}):Promise.resolve(!1)},zoomTo:(a,s)=>{const{panZoom:o}=t.getState();return o?o.scaleTo(a,{duration:s?.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(a,s)=>{const{transform:[o,c,u],panZoom:d}=t.getState();return d?(await d.setViewport({x:a.x??o,y:a.y??c,zoom:a.zoom??u},s),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[a,s,o]=t.getState().transform;return{x:a,y:s,zoom:o}},setCenter:async(a,s,o)=>t.getState().setCenter(a,s,o),fitBounds:async(a,s)=>{const{width:o,height:c,minZoom:u,maxZoom:d,panZoom:m}=t.getState(),p=vm(a,o,c,u,d,s?.padding??.1);return m?(await m.setViewport(p,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(a,s={})=>{const{transform:o,snapGrid:c,snapToGrid:u,domNode:d}=t.getState();if(!d)return a;const{x:m,y:p}=d.getBoundingClientRect(),g={x:a.x-m,y:a.y-p},y=s.snapGrid??c,x=s.snapToGrid??u;return Ho(g,o,x,y)},flowToScreenPosition:a=>{const{transform:s,domNode:o}=t.getState();if(!o)return a;const{x:c,y:u}=o.getBoundingClientRect(),d=tu(a,s);return{x:d.x+c,y:d.y+u}}}),[])};function bv(t,a){const s=[],o=new Map,c=[];for(const u of t)if(u.type==="add"){c.push(u);continue}else if(u.type==="remove"||u.type==="replace")o.set(u.id,[u]);else{const d=o.get(u.id);d?d.push(u):o.set(u.id,[u])}for(const u of a){const d=o.get(u.id);if(!d){s.push(u);continue}if(d[0].type==="remove")continue;if(d[0].type==="replace"){s.push({...d[0].item});continue}const m={...u};for(const p of d)PT(p,m);s.push(m)}return c.length&&c.forEach(u=>{u.index!==void 0?s.splice(u.index,0,{...u.item}):s.push({...u.item})}),s}function PT(t,a){switch(t.type){case"select":{a.selected=t.selected;break}case"position":{typeof t.position<"u"&&(a.position=t.position),typeof t.dragging<"u"&&(a.dragging=t.dragging);break}case"dimensions":{typeof t.dimensions<"u"&&(a.measured={...t.dimensions},t.setAttributes&&((t.setAttributes===!0||t.setAttributes==="width")&&(a.width=t.dimensions.width),(t.setAttributes===!0||t.setAttributes==="height")&&(a.height=t.dimensions.height))),typeof t.resizing=="boolean"&&(a.resizing=t.resizing);break}}}function vv(t,a){return bv(t,a)}function wv(t,a){return bv(t,a)}function zs(t,a){return{id:t,type:"select",selected:a}}function Or(t,a=new Set,s=!1){const o=[];for(const[c,u]of t){const d=a.has(c);!(u.selected===void 0&&!d)&&u.selected!==d&&(s&&(u.selected=d),o.push(zs(u.id,d)))}return o}function Uy({items:t=[],lookup:a}){const s=[],o=new Map(t.map(c=>[c.id,c]));for(const[c,u]of t.entries()){const d=a.get(u.id),m=d?.internals?.userNode??d;m!==void 0&&m!==u&&s.push({id:u.id,item:u,type:"replace"}),m===void 0&&s.push({item:u,type:"add",index:c})}for(const[c]of a)o.get(c)===void 0&&s.push({id:c,type:"remove"});return s}function Vy(t){return{id:t.id,type:"remove"}}const Yy=t=>p8(t),IT=t=>V1(t);function jv(t){return N.forwardRef(t)}const XT=typeof window<"u"?N.useLayoutEffect:N.useEffect;function Py(t){const[a,s]=N.useState(BigInt(0)),[o]=N.useState(()=>GT(()=>s(c=>c+BigInt(1))));return XT(()=>{const c=o.get();c.length&&(t(c),o.reset())},[a]),o}function GT(t){let a=[];return{get:()=>a,reset:()=>{a=[]},push:s=>{a.push(s),t()}}}const Nv=N.createContext(null);function QT({children:t}){const a=Ke(),s=N.useCallback(m=>{const{nodes:p=[],setNodes:g,hasDefaultNodes:y,onNodesChange:x,nodeLookup:b,fitViewQueued:j,onNodesChangeMiddlewareMap:S}=a.getState();let C=p;for(const E of m)C=typeof E=="function"?E(C):E;let _=Uy({items:C,lookup:b});for(const E of S.values())_=E(_);y&&g(C),_.length>0?x?.(_):j&&window.requestAnimationFrame(()=>{const{fitViewQueued:E,nodes:R,setNodes:T}=a.getState();E&&T(R)})},[]),o=Py(s),c=N.useCallback(m=>{const{edges:p=[],setEdges:g,hasDefaultEdges:y,onEdgesChange:x,edgeLookup:b}=a.getState();let j=p;for(const S of m)j=typeof S=="function"?S(j):S;y?g(j):x&&x(Uy({items:j,lookup:b}))},[]),u=Py(c),d=N.useMemo(()=>({nodeQueue:o,edgeQueue:u}),[]);return r.jsx(Nv.Provider,{value:d,children:t})}function FT(){const t=N.useContext(Nv);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}const ZT=t=>!!t.panZoom;function Cm(){const t=YT(),a=Ke(),s=FT(),o=Oe(ZT),c=N.useMemo(()=>{const u=x=>a.getState().nodeLookup.get(x),d=x=>{s.nodeQueue.push(x)},m=x=>{s.edgeQueue.push(x)},p=x=>{const{nodeLookup:b,nodeOrigin:j}=a.getState(),S=Yy(x)?x:b.get(x.id),C=S.parentId?Q1(S.position,S.measured,S.parentId,b,j):S.position,_={...S,position:C,width:S.measured?.width??S.width,height:S.measured?.height??S.height};return Qr(_)},g=(x,b,j={replace:!1})=>{d(S=>S.map(C=>{if(C.id===x){const _=typeof b=="function"?b(C):b;return j.replace&&Yy(_)?_:{...C,..._}}return C}))},y=(x,b,j={replace:!1})=>{m(S=>S.map(C=>{if(C.id===x){const _=typeof b=="function"?b(C):b;return j.replace&&IT(_)?_:{...C,..._}}return C}))};return{getNodes:()=>a.getState().nodes.map(x=>({...x})),getNode:x=>u(x)?.internals.userNode,getInternalNode:u,getEdges:()=>{const{edges:x=[]}=a.getState();return x.map(b=>({...b}))},getEdge:x=>a.getState().edgeLookup.get(x),setNodes:d,setEdges:m,addNodes:x=>{const b=Array.isArray(x)?x:[x];s.nodeQueue.push(j=>[...j,...b])},addEdges:x=>{const b=Array.isArray(x)?x:[x];s.edgeQueue.push(j=>[...j,...b])},toObject:()=>{const{nodes:x=[],edges:b=[],transform:j}=a.getState(),[S,C,_]=j;return{nodes:x.map(E=>({...E})),edges:b.map(E=>({...E})),viewport:{x:S,y:C,zoom:_}}},deleteElements:async({nodes:x=[],edges:b=[]})=>{const{nodes:j,edges:S,onNodesDelete:C,onEdgesDelete:_,triggerNodeChanges:E,triggerEdgeChanges:R,onDelete:T,onBeforeDelete:A}=a.getState(),{nodes:w,edges:D}=await v8({nodesToRemove:x,edgesToRemove:b,nodes:j,edges:S,onBeforeDelete:A}),M=D.length>0,q=w.length>0;if(M){const H=D.map(Vy);_?.(D),R(H)}if(q){const H=w.map(Vy);C?.(w),E(H)}return(q||M)&&T?.({nodes:w,edges:D}),{deletedNodes:w,deletedEdges:D}},getIntersectingNodes:(x,b=!0,j)=>{const S=py(x),C=S?x:p(x),_=j!==void 0;return C?(j||a.getState().nodes).filter(E=>{const R=a.getState().nodeLookup.get(E.id);if(R&&!S&&(E.id===x.id||!R.internals.positionAbsolute))return!1;const T=Qr(_?E:R),A=jo(T,C);return b&&A>0||A>=T.width*T.height||A>=C.width*C.height}):[]},isNodeIntersecting:(x,b,j=!0)=>{const C=py(x)?x:p(x);if(!C)return!1;const _=jo(C,b);return j&&_>0||_>=b.width*b.height||_>=C.width*C.height},updateNode:g,updateNodeData:(x,b,j={replace:!1})=>{g(x,S=>{const C=typeof b=="function"?b(S):b;return j.replace?{...S,data:C}:{...S,data:{...S.data,...C}}},j)},updateEdge:y,updateEdgeData:(x,b,j={replace:!1})=>{y(x,S=>{const C=typeof b=="function"?b(S):b;return j.replace?{...S,data:C}:{...S,data:{...S.data,...C}}},j)},getNodesBounds:x=>{const{nodeLookup:b,nodeOrigin:j}=a.getState();return g8(x,{nodeLookup:b,nodeOrigin:j})},getHandleConnections:({type:x,id:b,nodeId:j})=>Array.from(a.getState().connectionLookup.get(`${j}-${x}${b?`-${b}`:""}`)?.values()??[]),getNodeConnections:({type:x,handleId:b,nodeId:j})=>Array.from(a.getState().connectionLookup.get(`${j}${x?b?`-${x}-${b}`:`-${x}`:""}`)?.values()??[]),fitView:async x=>{const b=a.getState().fitViewResolver??S8();return a.setState({fitViewQueued:!0,fitViewOptions:x,fitViewResolver:b}),s.nodeQueue.push(j=>[...j]),b.promise}}},[]);return N.useMemo(()=>({...c,...t,viewportInitialized:o}),[o])}const Iy=t=>t.selected,WT=typeof window<"u"?window:void 0;function KT({deleteKeyCode:t,multiSelectionKeyCode:a}){const s=Ke(),{deleteElements:o}=Cm(),c=So(t,{actInsideInputWithModifier:!1}),u=So(a,{target:WT});N.useEffect(()=>{if(c){const{edges:d,nodes:m}=s.getState();o({nodes:m.filter(Iy),edges:d.filter(Iy)}),s.setState({nodesSelectionActive:!1})}},[c]),N.useEffect(()=>{s.setState({multiSelectionActive:u})},[u])}function JT(t){const a=Ke();N.useEffect(()=>{const s=()=>{if(!t.current||!(t.current.checkVisibility?.()??!0))return!1;const o=wm(t.current);(o.height===0||o.width===0)&&a.getState().onError?.("004",Vn.error004()),a.setState({width:o.width||500,height:o.height||500})};if(t.current){s(),window.addEventListener("resize",s);const o=new ResizeObserver(()=>s());return o.observe(t.current),()=>{window.removeEventListener("resize",s),o&&t.current&&o.unobserve(t.current)}}},[])}const Nu={position:"absolute",width:"100%",height:"100%",top:0,left:0},eM=t=>({userSelectionActive:t.userSelectionActive,lib:t.lib,connectionInProgress:t.connection.inProgress});function tM({onPaneContextMenu:t,zoomOnScroll:a=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:c=.5,panOnScrollMode:u=Hs.Free,zoomOnDoubleClick:d=!0,panOnDrag:m=!0,defaultViewport:p,translateExtent:g,minZoom:y,maxZoom:x,zoomActivationKeyCode:b,preventScrolling:j=!0,children:S,noWheelClassName:C,noPanClassName:_,onViewportChange:E,isControlledViewport:R,paneClickDistance:T,selectionOnDrag:A}){const w=Ke(),D=N.useRef(null),{userSelectionActive:M,lib:q,connectionInProgress:H}=Oe(eM,We),Q=So(b),I=N.useRef();JT(D);const Z=N.useCallback(te=>{E?.({x:te[0],y:te[1],zoom:te[2]}),R||w.setState({transform:te})},[E,R]);return N.useEffect(()=>{if(D.current){I.current=iT({domNode:D.current,minZoom:y,maxZoom:x,translateExtent:g,viewport:p,onDraggingChange:O=>w.setState({paneDragging:O}),onPanZoomStart:(O,z)=>{const{onViewportChangeStart:U,onMoveStart:L}=w.getState();L?.(O,z),U?.(z)},onPanZoom:(O,z)=>{const{onViewportChange:U,onMove:L}=w.getState();L?.(O,z),U?.(z)},onPanZoomEnd:(O,z)=>{const{onViewportChangeEnd:U,onMoveEnd:L}=w.getState();L?.(O,z),U?.(z)}});const{x:te,y:$,zoom:G}=I.current.getViewport();return w.setState({panZoom:I.current,transform:[te,$,G],domNode:D.current.closest(".react-flow")}),()=>{I.current?.destroy()}}},[]),N.useEffect(()=>{I.current?.update({onPaneContextMenu:t,zoomOnScroll:a,zoomOnPinch:s,panOnScroll:o,panOnScrollSpeed:c,panOnScrollMode:u,zoomOnDoubleClick:d,panOnDrag:m,zoomActivationKeyPressed:Q,preventScrolling:j,noPanClassName:_,userSelectionActive:M,noWheelClassName:C,lib:q,onTransformChange:Z,connectionInProgress:H,selectionOnDrag:A,paneClickDistance:T})},[t,a,s,o,c,u,d,m,Q,j,_,M,C,q,Z,H,A,T]),r.jsx("div",{className:"react-flow__renderer",ref:D,style:Nu,children:S})}const nM=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function aM(){const{userSelectionActive:t,userSelectionRect:a}=Oe(nM,We);return t&&a?r.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:a.width,height:a.height,transform:`translate(${a.x}px, ${a.y}px)`}}):null}const dh=(t,a)=>s=>{s.target===a.current&&t?.(s)},sM=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,connectionInProgress:t.connection.inProgress,dragging:t.paneDragging});function rM({isSelecting:t,selectionKeyPressed:a,selectionMode:s=wo.Full,panOnDrag:o,paneClickDistance:c,selectionOnDrag:u,onSelectionStart:d,onSelectionEnd:m,onPaneClick:p,onPaneContextMenu:g,onPaneScroll:y,onPaneMouseEnter:x,onPaneMouseMove:b,onPaneMouseLeave:j,children:S}){const C=Ke(),{userSelectionActive:_,elementsSelectable:E,dragging:R,connectionInProgress:T}=Oe(sM,We),A=E&&(t||_),w=N.useRef(null),D=N.useRef(),M=N.useRef(new Set),q=N.useRef(new Set),H=N.useRef(!1),Q=U=>{if(H.current||T){H.current=!1;return}p?.(U),C.getState().resetSelectedElements(),C.setState({nodesSelectionActive:!1})},I=U=>{if(Array.isArray(o)&&o?.includes(2)){U.preventDefault();return}g?.(U)},Z=y?U=>y(U):void 0,te=U=>{H.current&&(U.stopPropagation(),H.current=!1)},$=U=>{const{domNode:L}=C.getState();if(D.current=L?.getBoundingClientRect(),!D.current)return;const W=U.target===w.current;if(!W&&!!U.target.closest(".nokey")||!t||!(u&&W||a)||U.button!==0||!U.isPrimary)return;U.target?.setPointerCapture?.(U.pointerId),H.current=!1;const{x:ne,y:se}=Sn(U.nativeEvent,D.current);C.setState({userSelectionRect:{width:0,height:0,startX:ne,startY:se,x:ne,y:se}}),W||(U.stopPropagation(),U.preventDefault())},G=U=>{const{userSelectionRect:L,transform:W,nodeLookup:B,edgeLookup:P,connectionLookup:ne,triggerNodeChanges:se,triggerEdgeChanges:re,defaultEdgeOptions:de,resetSelectedElements:ue}=C.getState();if(!D.current||!L)return;const{x:V,y:ce}=Sn(U.nativeEvent,D.current),{startX:he,startY:ve}=L;if(!H.current){const Ee=a?0:c;if(Math.hypot(V-he,ce-ve)<=Ee)return;ue(),d?.(U)}H.current=!0;const ge={startX:he,startY:ve,x:V<he?V:he,y:ce<ve?ce:ve,width:Math.abs(V-he),height:Math.abs(ce-ve)},be=M.current,Se=q.current;M.current=new Set(bm(B,ge,W,s===wo.Partial,!0).map(Ee=>Ee.id)),q.current=new Set;const Ae=de?.selectable??!0;for(const Ee of M.current){const $e=ne.get(Ee);if($e)for(const{edgeId:ze}of $e.values()){const yt=P.get(ze);yt&&(yt.selectable??Ae)&&q.current.add(ze)}}if(!gy(be,M.current)){const Ee=Or(B,M.current,!0);se(Ee)}if(!gy(Se,q.current)){const Ee=Or(P,q.current);re(Ee)}C.setState({userSelectionRect:ge,userSelectionActive:!0,nodesSelectionActive:!1})},O=U=>{U.button===0&&(U.target?.releasePointerCapture?.(U.pointerId),!_&&U.target===w.current&&C.getState().userSelectionRect&&Q?.(U),C.setState({userSelectionActive:!1,userSelectionRect:null}),H.current&&(m?.(U),C.setState({nodesSelectionActive:M.current.size>0})))},z=o===!0||Array.isArray(o)&&o.includes(0);return r.jsxs("div",{className:ut(["react-flow__pane",{draggable:z,dragging:R,selection:t}]),onClick:A?void 0:dh(Q,w),onContextMenu:dh(I,w),onWheel:dh(Z,w),onPointerEnter:A?void 0:x,onPointerMove:A?G:b,onPointerUp:A?O:void 0,onPointerDownCapture:A?$:void 0,onClickCapture:A?te:void 0,onPointerLeave:j,ref:w,style:Nu,children:[S,r.jsx(aM,{})]})}function Uh({id:t,store:a,unselect:s=!1,nodeRef:o}){const{addSelectedNodes:c,unselectNodesAndEdges:u,multiSelectionActive:d,nodeLookup:m,onError:p}=a.getState(),g=m.get(t);if(!g){p?.("012",Vn.error012(t));return}a.setState({nodesSelectionActive:!1}),g.selected?(s||g.selected&&d)&&(u({nodes:[g],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):c([t])}function Sv({nodeRef:t,disabled:a=!1,noDragClassName:s,handleSelector:o,nodeId:c,isSelectable:u,nodeClickDistance:d}){const m=Ke(),[p,g]=N.useState(!1),y=N.useRef();return N.useEffect(()=>{y.current=X8({getStoreItems:()=>m.getState(),onNodeMouseDown:x=>{Uh({id:x,store:m,nodeRef:t})},onDragStart:()=>{g(!0)},onDragStop:()=>{g(!1)}})},[]),N.useEffect(()=>{if(a)y.current?.destroy();else if(t.current)return y.current?.update({noDragClassName:s,handleSelector:o,domNode:t.current,isSelectable:u,nodeId:c,nodeClickDistance:d}),()=>{y.current?.destroy()}},[s,o,a,u,t,c]),p}const iM=t=>a=>a.selected&&(a.draggable||t&&typeof a.draggable>"u");function _v(){const t=Ke();return N.useCallback(s=>{const{nodeExtent:o,snapToGrid:c,snapGrid:u,nodesDraggable:d,onError:m,updateNodePositions:p,nodeLookup:g,nodeOrigin:y}=t.getState(),x=new Map,b=iM(d),j=c?u[0]:5,S=c?u[1]:5,C=s.direction.x*j*s.factor,_=s.direction.y*S*s.factor;for(const[,E]of g){if(!b(E))continue;let R={x:E.internals.positionAbsolute.x+C,y:E.internals.positionAbsolute.y+_};c&&(R=Lo(R,u));const{position:T,positionAbsolute:A}=Y1({nodeId:E.id,nextPosition:R,nodeLookup:g,nodeExtent:o,nodeOrigin:y,onError:m});E.position=T,E.internals.positionAbsolute=A,x.set(E.id,E)}p(x)},[])}const Tm=N.createContext(null),oM=Tm.Provider;Tm.Consumer;const Ev=()=>N.useContext(Tm),lM=t=>({connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName,rfId:t.rfId}),cM=(t,a,s)=>o=>{const{connectionClickStartHandle:c,connectionMode:u,connection:d}=o,{fromHandle:m,toHandle:p,isValid:g}=d,y=p?.nodeId===t&&p?.id===a&&p?.type===s;return{connectingFrom:m?.nodeId===t&&m?.id===a&&m?.type===s,connectingTo:y,clickConnecting:c?.nodeId===t&&c?.id===a&&c?.type===s,isPossibleEndHandle:u===Xr.Strict?m?.type!==s:t!==m?.nodeId||a!==m?.id,connectionInProcess:!!m,clickConnectionInProcess:!!c,valid:y&&g}};function uM({type:t="source",position:a=xe.Top,isValidConnection:s,isConnectable:o=!0,isConnectableStart:c=!0,isConnectableEnd:u=!0,id:d,onConnect:m,children:p,className:g,onMouseDown:y,onTouchStart:x,...b},j){const S=d||null,C=t==="target",_=Ke(),E=Ev(),{connectOnClick:R,noPanClassName:T,rfId:A}=Oe(lM,We),{connectingFrom:w,connectingTo:D,clickConnecting:M,isPossibleEndHandle:q,connectionInProcess:H,clickConnectionInProcess:Q,valid:I}=Oe(cM(E,S,t),We);E||_.getState().onError?.("010",Vn.error010());const Z=G=>{const{defaultEdgeOptions:O,onConnect:z,hasDefaultEdges:U}=_.getState(),L={...O,...G};if(U){const{edges:W,setEdges:B}=_.getState();B(tv(L,W))}z?.(L),m?.(L)},te=G=>{if(!E)return;const O=W1(G.nativeEvent);if(c&&(O&&G.button===0||!O)){const z=_.getState();qh.onPointerDown(G.nativeEvent,{handleDomNode:G.currentTarget,autoPanOnConnect:z.autoPanOnConnect,connectionMode:z.connectionMode,connectionRadius:z.connectionRadius,domNode:z.domNode,nodeLookup:z.nodeLookup,lib:z.lib,isTarget:C,handleId:S,nodeId:E,flowId:z.rfId,panBy:z.panBy,cancelConnection:z.cancelConnection,onConnectStart:z.onConnectStart,onConnectEnd:z.onConnectEnd,updateConnection:z.updateConnection,onConnect:Z,isValidConnection:s||z.isValidConnection,getTransform:()=>_.getState().transform,getFromHandle:()=>_.getState().connection.fromHandle,autoPanSpeed:z.autoPanSpeed,dragThreshold:z.connectionDragThreshold})}O?y?.(G):x?.(G)},$=G=>{const{onClickConnectStart:O,onClickConnectEnd:z,connectionClickStartHandle:U,connectionMode:L,isValidConnection:W,lib:B,rfId:P,nodeLookup:ne,connection:se}=_.getState();if(!E||!U&&!c)return;if(!U){O?.(G.nativeEvent,{nodeId:E,handleId:S,handleType:t}),_.setState({connectionClickStartHandle:{nodeId:E,type:t,id:S}});return}const re=F1(G.target),de=s||W,{connection:ue,isValid:V}=qh.isValid(G.nativeEvent,{handle:{nodeId:E,id:S,type:t},connectionMode:L,fromNodeId:U.nodeId,fromHandleId:U.id||null,fromType:U.type,isValidConnection:de,flowId:P,doc:re,lib:B,nodeLookup:ne});V&&ue&&Z(ue);const ce=structuredClone(se);delete ce.inProgress,ce.toPosition=ce.toHandle?ce.toHandle.position:null,z?.(G,ce),_.setState({connectionClickStartHandle:null})};return r.jsx("div",{"data-handleid":S,"data-nodeid":E,"data-handlepos":a,"data-id":`${A}-${E}-${S}-${t}`,className:ut(["react-flow__handle",`react-flow__handle-${a}`,"nodrag",T,g,{source:!C,target:C,connectable:o,connectablestart:c,connectableend:u,clickconnecting:M,connectingfrom:w,connectingto:D,valid:I,connectionindicator:o&&(!H||q)&&(H||Q?u:c)}]),onMouseDown:te,onTouchStart:te,onClick:R?$:void 0,ref:j,...b,children:p})}const Wr=N.memo(jv(uM));function dM({data:t,isConnectable:a,sourcePosition:s=xe.Bottom}){return r.jsxs(r.Fragment,{children:[t?.label,r.jsx(Wr,{type:"source",position:s,isConnectable:a})]})}function fM({data:t,isConnectable:a,targetPosition:s=xe.Top,sourcePosition:o=xe.Bottom}){return r.jsxs(r.Fragment,{children:[r.jsx(Wr,{type:"target",position:s,isConnectable:a}),t?.label,r.jsx(Wr,{type:"source",position:o,isConnectable:a})]})}function hM(){return null}function mM({data:t,isConnectable:a,targetPosition:s=xe.Top}){return r.jsxs(r.Fragment,{children:[r.jsx(Wr,{type:"target",position:s,isConnectable:a}),t?.label]})}const nu={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Xy={input:dM,default:fM,output:mM,group:hM};function pM(t){return t.internals.handleBounds===void 0?{width:t.width??t.initialWidth??t.style?.width,height:t.height??t.initialHeight??t.style?.height}:{width:t.width??t.style?.width,height:t.height??t.style?.height}}const gM=t=>{const{width:a,height:s,x:o,y:c}=Bo(t.nodeLookup,{filter:u=>!!u.selected});return{width:Nn(a)?a:null,height:Nn(s)?s:null,userSelectionActive:t.userSelectionActive,transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]}) translate(${o}px,${c}px)`}};function xM({onSelectionContextMenu:t,noPanClassName:a,disableKeyboardA11y:s}){const o=Ke(),{width:c,height:u,transformString:d,userSelectionActive:m}=Oe(gM,We),p=_v(),g=N.useRef(null);if(N.useEffect(()=>{s||g.current?.focus({preventScroll:!0})},[s]),Sv({nodeRef:g}),m||!c||!u)return null;const y=t?b=>{const j=o.getState().nodes.filter(S=>S.selected);t(b,j)}:void 0,x=b=>{Object.prototype.hasOwnProperty.call(nu,b.key)&&(b.preventDefault(),p({direction:nu[b.key],factor:b.shiftKey?4:1}))};return r.jsx("div",{className:ut(["react-flow__nodesselection","react-flow__container",a]),style:{transform:d},children:r.jsx("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:y,tabIndex:s?void 0:-1,onKeyDown:s?void 0:x,style:{width:c,height:u}})})}const Gy=typeof window<"u"?window:void 0,yM=t=>({nodesSelectionActive:t.nodesSelectionActive,userSelectionActive:t.userSelectionActive});function Cv({children:t,onPaneClick:a,onPaneMouseEnter:s,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:u,onPaneScroll:d,paneClickDistance:m,deleteKeyCode:p,selectionKeyCode:g,selectionOnDrag:y,selectionMode:x,onSelectionStart:b,onSelectionEnd:j,multiSelectionKeyCode:S,panActivationKeyCode:C,zoomActivationKeyCode:_,elementsSelectable:E,zoomOnScroll:R,zoomOnPinch:T,panOnScroll:A,panOnScrollSpeed:w,panOnScrollMode:D,zoomOnDoubleClick:M,panOnDrag:q,defaultViewport:H,translateExtent:Q,minZoom:I,maxZoom:Z,preventScrolling:te,onSelectionContextMenu:$,noWheelClassName:G,noPanClassName:O,disableKeyboardA11y:z,onViewportChange:U,isControlledViewport:L}){const{nodesSelectionActive:W,userSelectionActive:B}=Oe(yM,We),P=So(g,{target:Gy}),ne=So(C,{target:Gy}),se=ne||q,re=ne||A,de=y&&se!==!0,ue=P||B||de;return KT({deleteKeyCode:p,multiSelectionKeyCode:S}),r.jsx(tM,{onPaneContextMenu:u,elementsSelectable:E,zoomOnScroll:R,zoomOnPinch:T,panOnScroll:re,panOnScrollSpeed:w,panOnScrollMode:D,zoomOnDoubleClick:M,panOnDrag:!P&&se,defaultViewport:H,translateExtent:Q,minZoom:I,maxZoom:Z,zoomActivationKeyCode:_,preventScrolling:te,noWheelClassName:G,noPanClassName:O,onViewportChange:U,isControlledViewport:L,paneClickDistance:m,selectionOnDrag:de,children:r.jsxs(rM,{onSelectionStart:b,onSelectionEnd:j,onPaneClick:a,onPaneMouseEnter:s,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:u,onPaneScroll:d,panOnDrag:se,isSelecting:!!ue,selectionMode:x,selectionKeyPressed:P,paneClickDistance:m,selectionOnDrag:de,children:[t,W&&r.jsx(xM,{onSelectionContextMenu:$,noPanClassName:O,disableKeyboardA11y:z})]})})}Cv.displayName="FlowRenderer";const bM=N.memo(Cv),vM=t=>a=>t?bm(a.nodeLookup,{x:0,y:0,width:a.width,height:a.height},a.transform,!0).map(s=>s.id):Array.from(a.nodeLookup.keys());function wM(t){return Oe(N.useCallback(vM(t),[t]),We)}const jM=t=>t.updateNodeInternals;function NM(){const t=Oe(jM),[a]=N.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(s=>{const o=new Map;s.forEach(c=>{const u=c.target.getAttribute("data-id");o.set(u,{id:u,nodeElement:c.target,force:!0})}),t(o)}));return N.useEffect(()=>()=>{a?.disconnect()},[a]),a}function SM({node:t,nodeType:a,hasDimensions:s,resizeObserver:o}){const c=Ke(),u=N.useRef(null),d=N.useRef(null),m=N.useRef(t.sourcePosition),p=N.useRef(t.targetPosition),g=N.useRef(a),y=s&&!!t.internals.handleBounds;return N.useEffect(()=>{u.current&&!t.hidden&&(!y||d.current!==u.current)&&(d.current&&o?.unobserve(d.current),o?.observe(u.current),d.current=u.current)},[y,t.hidden]),N.useEffect(()=>()=>{d.current&&(o?.unobserve(d.current),d.current=null)},[]),N.useEffect(()=>{if(u.current){const x=g.current!==a,b=m.current!==t.sourcePosition,j=p.current!==t.targetPosition;(x||b||j)&&(g.current=a,m.current=t.sourcePosition,p.current=t.targetPosition,c.getState().updateNodeInternals(new Map([[t.id,{id:t.id,nodeElement:u.current,force:!0}]])))}},[t.id,a,t.sourcePosition,t.targetPosition]),u}function _M({id:t,onClick:a,onMouseEnter:s,onMouseMove:o,onMouseLeave:c,onContextMenu:u,onDoubleClick:d,nodesDraggable:m,elementsSelectable:p,nodesConnectable:g,nodesFocusable:y,resizeObserver:x,noDragClassName:b,noPanClassName:j,disableKeyboardA11y:S,rfId:C,nodeTypes:_,nodeClickDistance:E,onError:R}){const{node:T,internals:A,isParent:w}=Oe(V=>{const ce=V.nodeLookup.get(t),he=V.parentLookup.has(t);return{node:ce,internals:ce.internals,isParent:he}},We);let D=T.type||"default",M=_?.[D]||Xy[D];M===void 0&&(R?.("003",Vn.error003(D)),D="default",M=_?.default||Xy.default);const q=!!(T.draggable||m&&typeof T.draggable>"u"),H=!!(T.selectable||p&&typeof T.selectable>"u"),Q=!!(T.connectable||g&&typeof T.connectable>"u"),I=!!(T.focusable||y&&typeof T.focusable>"u"),Z=Ke(),te=G1(T),$=SM({node:T,nodeType:D,hasDimensions:te,resizeObserver:x}),G=Sv({nodeRef:$,disabled:T.hidden||!q,noDragClassName:b,handleSelector:T.dragHandle,nodeId:t,isSelectable:H,nodeClickDistance:E}),O=_v();if(T.hidden)return null;const z=Na(T),U=pM(T),L=H||q||a||s||o||c,W=s?V=>s(V,{...A.userNode}):void 0,B=o?V=>o(V,{...A.userNode}):void 0,P=c?V=>c(V,{...A.userNode}):void 0,ne=u?V=>u(V,{...A.userNode}):void 0,se=d?V=>d(V,{...A.userNode}):void 0,re=V=>{const{selectNodesOnDrag:ce,nodeDragThreshold:he}=Z.getState();H&&(!ce||!q||he>0)&&Uh({id:t,store:Z,nodeRef:$}),a&&a(V,{...A.userNode})},de=V=>{if(!(Z1(V.nativeEvent)||S)){if(H1.includes(V.key)&&H){const ce=V.key==="Escape";Uh({id:t,store:Z,unselect:ce,nodeRef:$})}else if(q&&T.selected&&Object.prototype.hasOwnProperty.call(nu,V.key)){V.preventDefault();const{ariaLabelConfig:ce}=Z.getState();Z.setState({ariaLiveMessage:ce["node.a11yDescription.ariaLiveMessage"]({direction:V.key.replace("Arrow","").toLowerCase(),x:~~A.positionAbsolute.x,y:~~A.positionAbsolute.y})}),O({direction:nu[V.key],factor:V.shiftKey?4:1})}}},ue=()=>{if(S||!$.current?.matches(":focus-visible"))return;const{transform:V,width:ce,height:he,autoPanOnNodeFocus:ve,setCenter:ge}=Z.getState();if(!ve)return;bm(new Map([[t,T]]),{x:0,y:0,width:ce,height:he},V,!0).length>0||ge(T.position.x+z.width/2,T.position.y+z.height/2,{zoom:V[2]})};return r.jsx("div",{className:ut(["react-flow__node",`react-flow__node-${D}`,{[j]:q},T.className,{selected:T.selected,selectable:H,parent:w,draggable:q,dragging:G}]),ref:$,style:{zIndex:A.z,transform:`translate(${A.positionAbsolute.x}px,${A.positionAbsolute.y}px)`,pointerEvents:L?"all":"none",visibility:te?"visible":"hidden",...T.style,...U},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:W,onMouseMove:B,onMouseLeave:P,onContextMenu:ne,onClick:re,onDoubleClick:se,onKeyDown:I?de:void 0,tabIndex:I?0:void 0,onFocus:I?ue:void 0,role:T.ariaRole??(I?"group":void 0),"aria-roledescription":"node","aria-describedby":S?void 0:`${gv}-${C}`,"aria-label":T.ariaLabel,...T.domAttributes,children:r.jsx(oM,{value:t,children:r.jsx(M,{id:t,data:T.data,type:D,positionAbsoluteX:A.positionAbsolute.x,positionAbsoluteY:A.positionAbsolute.y,selected:T.selected??!1,selectable:H,draggable:q,deletable:T.deletable??!0,isConnectable:Q,sourcePosition:T.sourcePosition,targetPosition:T.targetPosition,dragging:G,dragHandle:T.dragHandle,zIndex:A.z,parentId:T.parentId,...z})})})}var EM=N.memo(_M);const CM=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,onError:t.onError});function Tv(t){const{nodesDraggable:a,nodesConnectable:s,nodesFocusable:o,elementsSelectable:c,onError:u}=Oe(CM,We),d=wM(t.onlyRenderVisibleElements),m=NM();return r.jsx("div",{className:"react-flow__nodes",style:Nu,children:d.map(p=>r.jsx(EM,{id:p,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:m,nodesDraggable:a,nodesConnectable:s,nodesFocusable:o,elementsSelectable:c,nodeClickDistance:t.nodeClickDistance,onError:u},p))})}Tv.displayName="NodeRenderer";const TM=N.memo(Tv);function MM(t){return Oe(N.useCallback(s=>{if(!t)return s.edges.map(c=>c.id);const o=[];if(s.width&&s.height)for(const c of s.edges){const u=s.nodeLookup.get(c.source),d=s.nodeLookup.get(c.target);u&&d&&T8({sourceNode:u,targetNode:d,width:s.width,height:s.height,transform:s.transform})&&o.push(c.id)}return o},[t]),We)}const AM=({color:t="none",strokeWidth:a=1})=>{const s={strokeWidth:a,...t&&{stroke:t}};return r.jsx("polyline",{className:"arrow",style:s,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},kM=({color:t="none",strokeWidth:a=1})=>{const s={strokeWidth:a,...t&&{stroke:t,fill:t}};return r.jsx("polyline",{className:"arrowclosed",style:s,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Qy={[Jc.Arrow]:AM,[Jc.ArrowClosed]:kM};function RM(t){const a=Ke();return N.useMemo(()=>Object.prototype.hasOwnProperty.call(Qy,t)?Qy[t]:(a.getState().onError?.("009",Vn.error009(t)),null),[t])}const zM=({id:t,type:a,color:s,width:o=12.5,height:c=12.5,markerUnits:u="strokeWidth",strokeWidth:d,orient:m="auto-start-reverse"})=>{const p=RM(a);return p?r.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${o}`,markerHeight:`${c}`,viewBox:"-10 -10 20 20",markerUnits:u,orient:m,refX:"0",refY:"0",children:r.jsx(p,{color:s,strokeWidth:d})}):null},Mv=({defaultColor:t,rfId:a})=>{const s=Oe(u=>u.edges),o=Oe(u=>u.defaultEdgeOptions),c=N.useMemo(()=>O8(s,{id:a,defaultColor:t,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[s,o,a,t]);return c.length?r.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:r.jsx("defs",{children:c.map(u=>r.jsx(zM,{id:u.id,type:u.type,color:u.color,width:u.width,height:u.height,markerUnits:u.markerUnits,strokeWidth:u.strokeWidth,orient:u.orient},u.id))})}):null};Mv.displayName="MarkerDefinitions";var DM=N.memo(Mv);function Av({x:t,y:a,label:s,labelStyle:o,labelShowBg:c=!0,labelBgStyle:u,labelBgPadding:d=[2,4],labelBgBorderRadius:m=2,children:p,className:g,...y}){const[x,b]=N.useState({x:1,y:0,width:0,height:0}),j=ut(["react-flow__edge-textwrapper",g]),S=N.useRef(null);return N.useEffect(()=>{if(S.current){const C=S.current.getBBox();b({x:C.x,y:C.y,width:C.width,height:C.height})}},[s]),s?r.jsxs("g",{transform:`translate(${t-x.width/2} ${a-x.height/2})`,className:j,visibility:x.width?"visible":"hidden",...y,children:[c&&r.jsx("rect",{width:x.width+2*d[0],x:-d[0],y:-d[1],height:x.height+2*d[1],className:"react-flow__edge-textbg",style:u,rx:m,ry:m}),r.jsx("text",{className:"react-flow__edge-text",y:x.height/2,dy:"0.3em",ref:S,style:o,children:s}),p]}):null}Av.displayName="EdgeText";const OM=N.memo(Av);function Su({path:t,labelX:a,labelY:s,label:o,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:m,labelBgBorderRadius:p,interactionWidth:g=20,...y}){return r.jsxs(r.Fragment,{children:[r.jsx("path",{...y,d:t,fill:"none",className:ut(["react-flow__edge-path",y.className])}),g?r.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}):null,o&&Nn(a)&&Nn(s)?r.jsx(OM,{x:a,y:s,label:o,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:m,labelBgBorderRadius:p}):null]})}function Fy({pos:t,x1:a,y1:s,x2:o,y2:c}){return t===xe.Left||t===xe.Right?[.5*(a+o),s]:[a,.5*(s+c)]}function kv({sourceX:t,sourceY:a,sourcePosition:s=xe.Bottom,targetX:o,targetY:c,targetPosition:u=xe.Top}){const[d,m]=Fy({pos:s,x1:t,y1:a,x2:o,y2:c}),[p,g]=Fy({pos:u,x1:o,y1:c,x2:t,y2:a}),[y,x,b,j]=K1({sourceX:t,sourceY:a,targetX:o,targetY:c,sourceControlX:d,sourceControlY:m,targetControlX:p,targetControlY:g});return[`M${t},${a} C${d},${m} ${p},${g} ${o},${c}`,y,x,b,j]}function Rv(t){return N.memo(({id:a,sourceX:s,sourceY:o,targetX:c,targetY:u,sourcePosition:d,targetPosition:m,label:p,labelStyle:g,labelShowBg:y,labelBgStyle:x,labelBgPadding:b,labelBgBorderRadius:j,style:S,markerEnd:C,markerStart:_,interactionWidth:E})=>{const[R,T,A]=kv({sourceX:s,sourceY:o,sourcePosition:d,targetX:c,targetY:u,targetPosition:m}),w=t.isInternal?void 0:a;return r.jsx(Su,{id:w,path:R,labelX:T,labelY:A,label:p,labelStyle:g,labelShowBg:y,labelBgStyle:x,labelBgPadding:b,labelBgBorderRadius:j,style:S,markerEnd:C,markerStart:_,interactionWidth:E})})}const BM=Rv({isInternal:!1}),zv=Rv({isInternal:!0});BM.displayName="SimpleBezierEdge";zv.displayName="SimpleBezierEdgeInternal";function Dv(t){return N.memo(({id:a,sourceX:s,sourceY:o,targetX:c,targetY:u,label:d,labelStyle:m,labelShowBg:p,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:x,style:b,sourcePosition:j=xe.Bottom,targetPosition:S=xe.Top,markerEnd:C,markerStart:_,pathOptions:E,interactionWidth:R})=>{const[T,A,w]=Lh({sourceX:s,sourceY:o,sourcePosition:j,targetX:c,targetY:u,targetPosition:S,borderRadius:E?.borderRadius,offset:E?.offset,stepPosition:E?.stepPosition}),D=t.isInternal?void 0:a;return r.jsx(Su,{id:D,path:T,labelX:A,labelY:w,label:d,labelStyle:m,labelShowBg:p,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:x,style:b,markerEnd:C,markerStart:_,interactionWidth:R})})}const Ov=Dv({isInternal:!1}),Bv=Dv({isInternal:!0});Ov.displayName="SmoothStepEdge";Bv.displayName="SmoothStepEdgeInternal";function Lv(t){return N.memo(({id:a,...s})=>{const o=t.isInternal?void 0:a;return r.jsx(Ov,{...s,id:o,pathOptions:N.useMemo(()=>({borderRadius:0,offset:s.pathOptions?.offset}),[s.pathOptions?.offset])})})}const LM=Lv({isInternal:!1}),Hv=Lv({isInternal:!0});LM.displayName="StepEdge";Hv.displayName="StepEdgeInternal";function $v(t){return N.memo(({id:a,sourceX:s,sourceY:o,targetX:c,targetY:u,label:d,labelStyle:m,labelShowBg:p,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:x,style:b,markerEnd:j,markerStart:S,interactionWidth:C})=>{const[_,E,R]=nv({sourceX:s,sourceY:o,targetX:c,targetY:u}),T=t.isInternal?void 0:a;return r.jsx(Su,{id:T,path:_,labelX:E,labelY:R,label:d,labelStyle:m,labelShowBg:p,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:x,style:b,markerEnd:j,markerStart:S,interactionWidth:C})})}const HM=$v({isInternal:!1}),qv=$v({isInternal:!0});HM.displayName="StraightEdge";qv.displayName="StraightEdgeInternal";function Uv(t){return N.memo(({id:a,sourceX:s,sourceY:o,targetX:c,targetY:u,sourcePosition:d=xe.Bottom,targetPosition:m=xe.Top,label:p,labelStyle:g,labelShowBg:y,labelBgStyle:x,labelBgPadding:b,labelBgBorderRadius:j,style:S,markerEnd:C,markerStart:_,pathOptions:E,interactionWidth:R})=>{const[T,A,w]=J1({sourceX:s,sourceY:o,sourcePosition:d,targetX:c,targetY:u,targetPosition:m,curvature:E?.curvature}),D=t.isInternal?void 0:a;return r.jsx(Su,{id:D,path:T,labelX:A,labelY:w,label:p,labelStyle:g,labelShowBg:y,labelBgStyle:x,labelBgPadding:b,labelBgBorderRadius:j,style:S,markerEnd:C,markerStart:_,interactionWidth:R})})}const $M=Uv({isInternal:!1}),Vv=Uv({isInternal:!0});$M.displayName="BezierEdge";Vv.displayName="BezierEdgeInternal";const Zy={default:Vv,straight:qv,step:Hv,smoothstep:Bv,simplebezier:zv},Wy={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},qM=(t,a,s)=>s===xe.Left?t-a:s===xe.Right?t+a:t,UM=(t,a,s)=>s===xe.Top?t-a:s===xe.Bottom?t+a:t,Ky="react-flow__edgeupdater";function Jy({position:t,centerX:a,centerY:s,radius:o=10,onMouseDown:c,onMouseEnter:u,onMouseOut:d,type:m}){return r.jsx("circle",{onMouseDown:c,onMouseEnter:u,onMouseOut:d,className:ut([Ky,`${Ky}-${m}`]),cx:qM(a,o,t),cy:UM(s,o,t),r:o,stroke:"transparent",fill:"transparent"})}function VM({isReconnectable:t,reconnectRadius:a,edge:s,sourceX:o,sourceY:c,targetX:u,targetY:d,sourcePosition:m,targetPosition:p,onReconnect:g,onReconnectStart:y,onReconnectEnd:x,setReconnecting:b,setUpdateHover:j}){const S=Ke(),C=(A,w)=>{if(A.button!==0)return;const{autoPanOnConnect:D,domNode:M,isValidConnection:q,connectionMode:H,connectionRadius:Q,lib:I,onConnectStart:Z,onConnectEnd:te,cancelConnection:$,nodeLookup:G,rfId:O,panBy:z,updateConnection:U}=S.getState(),L=w.type==="target",W=(ne,se)=>{b(!1),x?.(ne,s,w.type,se)},B=ne=>g?.(s,ne),P=(ne,se)=>{b(!0),y?.(A,s,w.type),Z?.(ne,se)};qh.onPointerDown(A.nativeEvent,{autoPanOnConnect:D,connectionMode:H,connectionRadius:Q,domNode:M,handleId:w.id,nodeId:w.nodeId,nodeLookup:G,isTarget:L,edgeUpdaterType:w.type,lib:I,flowId:O,cancelConnection:$,panBy:z,isValidConnection:q,onConnect:B,onConnectStart:P,onConnectEnd:te,onReconnectEnd:W,updateConnection:U,getTransform:()=>S.getState().transform,getFromHandle:()=>S.getState().connection.fromHandle,dragThreshold:S.getState().connectionDragThreshold,handleDomNode:A.currentTarget})},_=A=>C(A,{nodeId:s.target,id:s.targetHandle??null,type:"target"}),E=A=>C(A,{nodeId:s.source,id:s.sourceHandle??null,type:"source"}),R=()=>j(!0),T=()=>j(!1);return r.jsxs(r.Fragment,{children:[(t===!0||t==="source")&&r.jsx(Jy,{position:m,centerX:o,centerY:c,radius:a,onMouseDown:_,onMouseEnter:R,onMouseOut:T,type:"source"}),(t===!0||t==="target")&&r.jsx(Jy,{position:p,centerX:u,centerY:d,radius:a,onMouseDown:E,onMouseEnter:R,onMouseOut:T,type:"target"})]})}function YM({id:t,edgesFocusable:a,edgesReconnectable:s,elementsSelectable:o,onClick:c,onDoubleClick:u,onContextMenu:d,onMouseEnter:m,onMouseMove:p,onMouseLeave:g,reconnectRadius:y,onReconnect:x,onReconnectStart:b,onReconnectEnd:j,rfId:S,edgeTypes:C,noPanClassName:_,onError:E,disableKeyboardA11y:R}){let T=Oe(ge=>ge.edgeLookup.get(t));const A=Oe(ge=>ge.defaultEdgeOptions);T=A?{...A,...T}:T;let w=T.type||"default",D=C?.[w]||Zy[w];D===void 0&&(E?.("011",Vn.error011(w)),w="default",D=C?.default||Zy.default);const M=!!(T.focusable||a&&typeof T.focusable>"u"),q=typeof x<"u"&&(T.reconnectable||s&&typeof T.reconnectable>"u"),H=!!(T.selectable||o&&typeof T.selectable>"u"),Q=N.useRef(null),[I,Z]=N.useState(!1),[te,$]=N.useState(!1),G=Ke(),{zIndex:O,sourceX:z,sourceY:U,targetX:L,targetY:W,sourcePosition:B,targetPosition:P}=Oe(N.useCallback(ge=>{const be=ge.nodeLookup.get(T.source),Se=ge.nodeLookup.get(T.target);if(!be||!Se)return{zIndex:T.zIndex,...Wy};const Ae=D8({id:t,sourceNode:be,targetNode:Se,sourceHandle:T.sourceHandle||null,targetHandle:T.targetHandle||null,connectionMode:ge.connectionMode,onError:E});return{zIndex:C8({selected:T.selected,zIndex:T.zIndex,sourceNode:be,targetNode:Se,elevateOnSelect:ge.elevateEdgesOnSelect,zIndexMode:ge.zIndexMode}),...Ae||Wy}},[T.source,T.target,T.sourceHandle,T.targetHandle,T.selected,T.zIndex]),We),ne=N.useMemo(()=>T.markerStart?`url('#${Hh(T.markerStart,S)}')`:void 0,[T.markerStart,S]),se=N.useMemo(()=>T.markerEnd?`url('#${Hh(T.markerEnd,S)}')`:void 0,[T.markerEnd,S]);if(T.hidden||z===null||U===null||L===null||W===null)return null;const re=ge=>{const{addSelectedEdges:be,unselectNodesAndEdges:Se,multiSelectionActive:Ae}=G.getState();H&&(G.setState({nodesSelectionActive:!1}),T.selected&&Ae?(Se({nodes:[],edges:[T]}),Q.current?.blur()):be([t])),c&&c(ge,T)},de=u?ge=>{u(ge,{...T})}:void 0,ue=d?ge=>{d(ge,{...T})}:void 0,V=m?ge=>{m(ge,{...T})}:void 0,ce=p?ge=>{p(ge,{...T})}:void 0,he=g?ge=>{g(ge,{...T})}:void 0,ve=ge=>{if(!R&&H1.includes(ge.key)&&H){const{unselectNodesAndEdges:be,addSelectedEdges:Se}=G.getState();ge.key==="Escape"?(Q.current?.blur(),be({edges:[T]})):Se([t])}};return r.jsx("svg",{style:{zIndex:O},children:r.jsxs("g",{className:ut(["react-flow__edge",`react-flow__edge-${w}`,T.className,_,{selected:T.selected,animated:T.animated,inactive:!H&&!c,updating:I,selectable:H}]),onClick:re,onDoubleClick:de,onContextMenu:ue,onMouseEnter:V,onMouseMove:ce,onMouseLeave:he,onKeyDown:M?ve:void 0,tabIndex:M?0:void 0,role:T.ariaRole??(M?"group":"img"),"aria-roledescription":"edge","data-id":t,"data-testid":`rf__edge-${t}`,"aria-label":T.ariaLabel===null?void 0:T.ariaLabel||`Edge from ${T.source} to ${T.target}`,"aria-describedby":M?`${xv}-${S}`:void 0,ref:Q,...T.domAttributes,children:[!te&&r.jsx(D,{id:t,source:T.source,target:T.target,type:T.type,selected:T.selected,animated:T.animated,selectable:H,deletable:T.deletable??!0,label:T.label,labelStyle:T.labelStyle,labelShowBg:T.labelShowBg,labelBgStyle:T.labelBgStyle,labelBgPadding:T.labelBgPadding,labelBgBorderRadius:T.labelBgBorderRadius,sourceX:z,sourceY:U,targetX:L,targetY:W,sourcePosition:B,targetPosition:P,data:T.data,style:T.style,sourceHandleId:T.sourceHandle,targetHandleId:T.targetHandle,markerStart:ne,markerEnd:se,pathOptions:"pathOptions"in T?T.pathOptions:void 0,interactionWidth:T.interactionWidth}),q&&r.jsx(VM,{edge:T,isReconnectable:q,reconnectRadius:y,onReconnect:x,onReconnectStart:b,onReconnectEnd:j,sourceX:z,sourceY:U,targetX:L,targetY:W,sourcePosition:B,targetPosition:P,setUpdateHover:Z,setReconnecting:$})]})})}var PM=N.memo(YM);const IM=t=>({edgesFocusable:t.edgesFocusable,edgesReconnectable:t.edgesReconnectable,elementsSelectable:t.elementsSelectable,connectionMode:t.connectionMode,onError:t.onError});function Yv({defaultMarkerColor:t,onlyRenderVisibleElements:a,rfId:s,edgeTypes:o,noPanClassName:c,onReconnect:u,onEdgeContextMenu:d,onEdgeMouseEnter:m,onEdgeMouseMove:p,onEdgeMouseLeave:g,onEdgeClick:y,reconnectRadius:x,onEdgeDoubleClick:b,onReconnectStart:j,onReconnectEnd:S,disableKeyboardA11y:C}){const{edgesFocusable:_,edgesReconnectable:E,elementsSelectable:R,onError:T}=Oe(IM,We),A=MM(a);return r.jsxs("div",{className:"react-flow__edges",children:[r.jsx(DM,{defaultColor:t,rfId:s}),A.map(w=>r.jsx(PM,{id:w,edgesFocusable:_,edgesReconnectable:E,elementsSelectable:R,noPanClassName:c,onReconnect:u,onContextMenu:d,onMouseEnter:m,onMouseMove:p,onMouseLeave:g,onClick:y,reconnectRadius:x,onDoubleClick:b,onReconnectStart:j,onReconnectEnd:S,rfId:s,onError:T,edgeTypes:o,disableKeyboardA11y:C},w))]})}Yv.displayName="EdgeRenderer";const XM=N.memo(Yv),GM=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function QM({children:t}){const a=Oe(GM);return r.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:a},children:t})}function FM(t){const a=Cm(),s=N.useRef(!1);N.useEffect(()=>{!s.current&&a.viewportInitialized&&t&&(setTimeout(()=>t(a),1),s.current=!0)},[t,a.viewportInitialized])}const ZM=t=>t.panZoom?.syncViewport;function WM(t){const a=Oe(ZM),s=Ke();return N.useEffect(()=>{t&&(a?.(t),s.setState({transform:[t.x,t.y,t.zoom]}))},[t,a]),null}function KM(t){return t.connection.inProgress?{...t.connection,to:Ho(t.connection.to,t.transform)}:{...t.connection}}function JM(t){return KM}function eA(t){const a=JM();return Oe(a,We)}const tA=t=>({nodesConnectable:t.nodesConnectable,isValid:t.connection.isValid,inProgress:t.connection.inProgress,width:t.width,height:t.height});function nA({containerStyle:t,style:a,type:s,component:o}){const{nodesConnectable:c,width:u,height:d,isValid:m,inProgress:p}=Oe(tA,We);return!(u&&c&&p)?null:r.jsx("svg",{style:t,width:u,height:d,className:"react-flow__connectionline react-flow__container",children:r.jsx("g",{className:ut(["react-flow__connection",U1(m)]),children:r.jsx(Pv,{style:a,type:s,CustomComponent:o,isValid:m})})})}const Pv=({style:t,type:a=ts.Bezier,CustomComponent:s,isValid:o})=>{const{inProgress:c,from:u,fromNode:d,fromHandle:m,fromPosition:p,to:g,toNode:y,toHandle:x,toPosition:b,pointer:j}=eA();if(!c)return;if(s)return r.jsx(s,{connectionLineType:a,connectionLineStyle:t,fromNode:d,fromHandle:m,fromX:u.x,fromY:u.y,toX:g.x,toY:g.y,fromPosition:p,toPosition:b,connectionStatus:U1(o),toNode:y,toHandle:x,pointer:j});let S="";const C={sourceX:u.x,sourceY:u.y,sourcePosition:p,targetX:g.x,targetY:g.y,targetPosition:b};switch(a){case ts.Bezier:[S]=J1(C);break;case ts.SimpleBezier:[S]=kv(C);break;case ts.Step:[S]=Lh({...C,borderRadius:0});break;case ts.SmoothStep:[S]=Lh(C);break;default:[S]=nv(C)}return r.jsx("path",{d:S,fill:"none",className:"react-flow__connection-path",style:t})};Pv.displayName="ConnectionLine";const aA={};function eb(t=aA){N.useRef(t),Ke(),N.useEffect(()=>{},[t])}function sA(){Ke(),N.useRef(!1),N.useEffect(()=>{},[])}function Iv({nodeTypes:t,edgeTypes:a,onInit:s,onNodeClick:o,onEdgeClick:c,onNodeDoubleClick:u,onEdgeDoubleClick:d,onNodeMouseEnter:m,onNodeMouseMove:p,onNodeMouseLeave:g,onNodeContextMenu:y,onSelectionContextMenu:x,onSelectionStart:b,onSelectionEnd:j,connectionLineType:S,connectionLineStyle:C,connectionLineComponent:_,connectionLineContainerStyle:E,selectionKeyCode:R,selectionOnDrag:T,selectionMode:A,multiSelectionKeyCode:w,panActivationKeyCode:D,zoomActivationKeyCode:M,deleteKeyCode:q,onlyRenderVisibleElements:H,elementsSelectable:Q,defaultViewport:I,translateExtent:Z,minZoom:te,maxZoom:$,preventScrolling:G,defaultMarkerColor:O,zoomOnScroll:z,zoomOnPinch:U,panOnScroll:L,panOnScrollSpeed:W,panOnScrollMode:B,zoomOnDoubleClick:P,panOnDrag:ne,onPaneClick:se,onPaneMouseEnter:re,onPaneMouseMove:de,onPaneMouseLeave:ue,onPaneScroll:V,onPaneContextMenu:ce,paneClickDistance:he,nodeClickDistance:ve,onEdgeContextMenu:ge,onEdgeMouseEnter:be,onEdgeMouseMove:Se,onEdgeMouseLeave:Ae,reconnectRadius:Ee,onReconnect:$e,onReconnectStart:ze,onReconnectEnd:yt,noDragClassName:pt,noWheelClassName:hn,noPanClassName:En,disableKeyboardA11y:Cn,nodeExtent:at,rfId:Pn,viewport:mn,onViewportChange:Jt}){return eb(t),eb(a),sA(),FM(s),WM(mn),r.jsx(bM,{onPaneClick:se,onPaneMouseEnter:re,onPaneMouseMove:de,onPaneMouseLeave:ue,onPaneContextMenu:ce,onPaneScroll:V,paneClickDistance:he,deleteKeyCode:q,selectionKeyCode:R,selectionOnDrag:T,selectionMode:A,onSelectionStart:b,onSelectionEnd:j,multiSelectionKeyCode:w,panActivationKeyCode:D,zoomActivationKeyCode:M,elementsSelectable:Q,zoomOnScroll:z,zoomOnPinch:U,zoomOnDoubleClick:P,panOnScroll:L,panOnScrollSpeed:W,panOnScrollMode:B,panOnDrag:ne,defaultViewport:I,translateExtent:Z,minZoom:te,maxZoom:$,onSelectionContextMenu:x,preventScrolling:G,noDragClassName:pt,noWheelClassName:hn,noPanClassName:En,disableKeyboardA11y:Cn,onViewportChange:Jt,isControlledViewport:!!mn,children:r.jsxs(QM,{children:[r.jsx(XM,{edgeTypes:a,onEdgeClick:c,onEdgeDoubleClick:d,onReconnect:$e,onReconnectStart:ze,onReconnectEnd:yt,onlyRenderVisibleElements:H,onEdgeContextMenu:ge,onEdgeMouseEnter:be,onEdgeMouseMove:Se,onEdgeMouseLeave:Ae,reconnectRadius:Ee,defaultMarkerColor:O,noPanClassName:En,disableKeyboardA11y:Cn,rfId:Pn}),r.jsx(nA,{style:C,type:S,component:_,containerStyle:E}),r.jsx("div",{className:"react-flow__edgelabel-renderer"}),r.jsx(TM,{nodeTypes:t,onNodeClick:o,onNodeDoubleClick:u,onNodeMouseEnter:m,onNodeMouseMove:p,onNodeMouseLeave:g,onNodeContextMenu:y,nodeClickDistance:ve,onlyRenderVisibleElements:H,noPanClassName:En,noDragClassName:pt,disableKeyboardA11y:Cn,nodeExtent:at,rfId:Pn}),r.jsx("div",{className:"react-flow__viewport-portal"})]})})}Iv.displayName="GraphView";const rA=N.memo(Iv),tb=({nodes:t,edges:a,defaultNodes:s,defaultEdges:o,width:c,height:u,fitView:d,fitViewOptions:m,minZoom:p=.5,maxZoom:g=2,nodeOrigin:y,nodeExtent:x,zIndexMode:b="basic"}={})=>{const j=new Map,S=new Map,C=new Map,_=new Map,E=o??a??[],R=s??t??[],T=y??[0,0],A=x??vo;rv(C,_,E);const w=$h(R,j,S,{nodeOrigin:T,nodeExtent:A,zIndexMode:b});let D=[0,0,1];if(d&&c&&u){const M=Bo(j,{filter:I=>!!((I.width||I.initialWidth)&&(I.height||I.initialHeight))}),{x:q,y:H,zoom:Q}=vm(M,c,u,p,g,m?.padding??.1);D=[q,H,Q]}return{rfId:"1",width:c??0,height:u??0,transform:D,nodes:R,nodesInitialized:w,nodeLookup:j,parentLookup:S,edges:E,edgeLookup:_,connectionLookup:C,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:s!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:p,maxZoom:g,translateExtent:vo,nodeExtent:A,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Xr.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:T,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:d??!1,fitViewOptions:m,fitViewResolver:null,connection:{...q1},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:w8,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:$1,zIndexMode:b,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},iA=({nodes:t,edges:a,defaultNodes:s,defaultEdges:o,width:c,height:u,fitView:d,fitViewOptions:m,minZoom:p,maxZoom:g,nodeOrigin:y,nodeExtent:x,zIndexMode:b})=>ST((j,S)=>{async function C(){const{nodeLookup:_,panZoom:E,fitViewOptions:R,fitViewResolver:T,width:A,height:w,minZoom:D,maxZoom:M}=S();E&&(await b8({nodes:_,width:A,height:w,panZoom:E,minZoom:D,maxZoom:M},R),T?.resolve(!0),j({fitViewResolver:null}))}return{...tb({nodes:t,edges:a,width:c,height:u,fitView:d,fitViewOptions:m,minZoom:p,maxZoom:g,nodeOrigin:y,nodeExtent:x,defaultNodes:s,defaultEdges:o,zIndexMode:b}),setNodes:_=>{const{nodeLookup:E,parentLookup:R,nodeOrigin:T,elevateNodesOnSelect:A,fitViewQueued:w,zIndexMode:D}=S(),M=$h(_,E,R,{nodeOrigin:T,nodeExtent:x,elevateNodesOnSelect:A,checkEquality:!0,zIndexMode:D});w&&M?(C(),j({nodes:_,nodesInitialized:M,fitViewQueued:!1,fitViewOptions:void 0})):j({nodes:_,nodesInitialized:M})},setEdges:_=>{const{connectionLookup:E,edgeLookup:R}=S();rv(E,R,_),j({edges:_})},setDefaultNodesAndEdges:(_,E)=>{if(_){const{setNodes:R}=S();R(_),j({hasDefaultNodes:!0})}if(E){const{setEdges:R}=S();R(E),j({hasDefaultEdges:!0})}},updateNodeInternals:_=>{const{triggerNodeChanges:E,nodeLookup:R,parentLookup:T,domNode:A,nodeOrigin:w,nodeExtent:D,debug:M,fitViewQueued:q,zIndexMode:H}=S(),{changes:Q,updatedInternals:I}=V8(_,R,T,A,w,D,H);I&&(H8(R,T,{nodeOrigin:w,nodeExtent:D,zIndexMode:H}),q?(C(),j({fitViewQueued:!1,fitViewOptions:void 0})):j({}),Q?.length>0&&(M&&console.log("React Flow: trigger node changes",Q),E?.(Q)))},updateNodePositions:(_,E=!1)=>{const R=[];let T=[];const{nodeLookup:A,triggerNodeChanges:w,connection:D,updateConnection:M,onNodesChangeMiddlewareMap:q}=S();for(const[H,Q]of _){const I=A.get(H),Z=!!(I?.expandParent&&I?.parentId&&Q?.position),te={id:H,type:"position",position:Z?{x:Math.max(0,Q.position.x),y:Math.max(0,Q.position.y)}:Q.position,dragging:E};if(I&&D.inProgress&&D.fromNode.id===I.id){const $=Vs(I,D.fromHandle,xe.Left,!0);M({...D,from:$})}Z&&I.parentId&&R.push({id:H,parentId:I.parentId,rect:{...Q.internals.positionAbsolute,width:Q.measured.width??0,height:Q.measured.height??0}}),T.push(te)}if(R.length>0){const{parentLookup:H,nodeOrigin:Q}=S(),I=Em(R,A,H,Q);T.push(...I)}for(const H of q.values())T=H(T);w(T)},triggerNodeChanges:_=>{const{onNodesChange:E,setNodes:R,nodes:T,hasDefaultNodes:A,debug:w}=S();if(_?.length){if(A){const D=vv(_,T);R(D)}w&&console.log("React Flow: trigger node changes",_),E?.(_)}},triggerEdgeChanges:_=>{const{onEdgesChange:E,setEdges:R,edges:T,hasDefaultEdges:A,debug:w}=S();if(_?.length){if(A){const D=wv(_,T);R(D)}w&&console.log("React Flow: trigger edge changes",_),E?.(_)}},addSelectedNodes:_=>{const{multiSelectionActive:E,edgeLookup:R,nodeLookup:T,triggerNodeChanges:A,triggerEdgeChanges:w}=S();if(E){const D=_.map(M=>zs(M,!0));A(D);return}A(Or(T,new Set([..._]),!0)),w(Or(R))},addSelectedEdges:_=>{const{multiSelectionActive:E,edgeLookup:R,nodeLookup:T,triggerNodeChanges:A,triggerEdgeChanges:w}=S();if(E){const D=_.map(M=>zs(M,!0));w(D);return}w(Or(R,new Set([..._]))),A(Or(T,new Set,!0))},unselectNodesAndEdges:({nodes:_,edges:E}={})=>{const{edges:R,nodes:T,nodeLookup:A,triggerNodeChanges:w,triggerEdgeChanges:D}=S(),M=_||T,q=E||R,H=M.map(I=>{const Z=A.get(I.id);return Z&&(Z.selected=!1),zs(I.id,!1)}),Q=q.map(I=>zs(I.id,!1));w(H),D(Q)},setMinZoom:_=>{const{panZoom:E,maxZoom:R}=S();E?.setScaleExtent([_,R]),j({minZoom:_})},setMaxZoom:_=>{const{panZoom:E,minZoom:R}=S();E?.setScaleExtent([R,_]),j({maxZoom:_})},setTranslateExtent:_=>{S().panZoom?.setTranslateExtent(_),j({translateExtent:_})},resetSelectedElements:()=>{const{edges:_,nodes:E,triggerNodeChanges:R,triggerEdgeChanges:T,elementsSelectable:A}=S();if(!A)return;const w=E.reduce((M,q)=>q.selected?[...M,zs(q.id,!1)]:M,[]),D=_.reduce((M,q)=>q.selected?[...M,zs(q.id,!1)]:M,[]);R(w),T(D)},setNodeExtent:_=>{const{nodes:E,nodeLookup:R,parentLookup:T,nodeOrigin:A,elevateNodesOnSelect:w,nodeExtent:D,zIndexMode:M}=S();_[0][0]===D[0][0]&&_[0][1]===D[0][1]&&_[1][0]===D[1][0]&&_[1][1]===D[1][1]||($h(E,R,T,{nodeOrigin:A,nodeExtent:_,elevateNodesOnSelect:w,checkEquality:!1,zIndexMode:M}),j({nodeExtent:_}))},panBy:_=>{const{transform:E,width:R,height:T,panZoom:A,translateExtent:w}=S();return Y8({delta:_,panZoom:A,transform:E,translateExtent:w,width:R,height:T})},setCenter:async(_,E,R)=>{const{width:T,height:A,maxZoom:w,panZoom:D}=S();if(!D)return Promise.resolve(!1);const M=typeof R?.zoom<"u"?R.zoom:w;return await D.setViewport({x:T/2-_*M,y:A/2-E*M,zoom:M},{duration:R?.duration,ease:R?.ease,interpolate:R?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{j({connection:{...q1}})},updateConnection:_=>{j({connection:_})},reset:()=>j({...tb()})}},Object.is);function oA({initialNodes:t,initialEdges:a,defaultNodes:s,defaultEdges:o,initialWidth:c,initialHeight:u,initialMinZoom:d,initialMaxZoom:m,initialFitViewOptions:p,fitView:g,nodeOrigin:y,nodeExtent:x,zIndexMode:b,children:j}){const[S]=N.useState(()=>iA({nodes:t,edges:a,defaultNodes:s,defaultEdges:o,width:c,height:u,fitView:g,minZoom:d,maxZoom:m,fitViewOptions:p,nodeOrigin:y,nodeExtent:x,zIndexMode:b}));return r.jsx(_T,{value:S,children:r.jsx(QT,{children:j})})}function lA({children:t,nodes:a,edges:s,defaultNodes:o,defaultEdges:c,width:u,height:d,fitView:m,fitViewOptions:p,minZoom:g,maxZoom:y,nodeOrigin:x,nodeExtent:b,zIndexMode:j}){return N.useContext(wu)?r.jsx(r.Fragment,{children:t}):r.jsx(oA,{initialNodes:a,initialEdges:s,defaultNodes:o,defaultEdges:c,initialWidth:u,initialHeight:d,fitView:m,initialFitViewOptions:p,initialMinZoom:g,initialMaxZoom:y,nodeOrigin:x,nodeExtent:b,zIndexMode:j,children:t})}const cA={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function uA({nodes:t,edges:a,defaultNodes:s,defaultEdges:o,className:c,nodeTypes:u,edgeTypes:d,onNodeClick:m,onEdgeClick:p,onInit:g,onMove:y,onMoveStart:x,onMoveEnd:b,onConnect:j,onConnectStart:S,onConnectEnd:C,onClickConnectStart:_,onClickConnectEnd:E,onNodeMouseEnter:R,onNodeMouseMove:T,onNodeMouseLeave:A,onNodeContextMenu:w,onNodeDoubleClick:D,onNodeDragStart:M,onNodeDrag:q,onNodeDragStop:H,onNodesDelete:Q,onEdgesDelete:I,onDelete:Z,onSelectionChange:te,onSelectionDragStart:$,onSelectionDrag:G,onSelectionDragStop:O,onSelectionContextMenu:z,onSelectionStart:U,onSelectionEnd:L,onBeforeDelete:W,connectionMode:B,connectionLineType:P=ts.Bezier,connectionLineStyle:ne,connectionLineComponent:se,connectionLineContainerStyle:re,deleteKeyCode:de="Backspace",selectionKeyCode:ue="Shift",selectionOnDrag:V=!1,selectionMode:ce=wo.Full,panActivationKeyCode:he="Space",multiSelectionKeyCode:ve=No()?"Meta":"Control",zoomActivationKeyCode:ge=No()?"Meta":"Control",snapToGrid:be,snapGrid:Se,onlyRenderVisibleElements:Ae=!1,selectNodesOnDrag:Ee,nodesDraggable:$e,autoPanOnNodeFocus:ze,nodesConnectable:yt,nodesFocusable:pt,nodeOrigin:hn=yv,edgesFocusable:En,edgesReconnectable:Cn,elementsSelectable:at=!0,defaultViewport:Pn=HT,minZoom:mn=.5,maxZoom:Jt=2,translateExtent:In=vo,preventScrolling:pn=!0,nodeExtent:Xn,defaultMarkerColor:ls="#b1b1b7",zoomOnScroll:ii=!0,zoomOnPinch:cs=!0,panOnScroll:Ct=!1,panOnScrollSpeed:Tn=.5,panOnScrollMode:Tt=Hs.Free,zoomOnDoubleClick:Cu=!0,panOnDrag:Tu=!0,onPaneClick:Mu,onPaneMouseEnter:Ps,onPaneMouseMove:Is,onPaneMouseLeave:Xs,onPaneScroll:Gn,onPaneContextMenu:Gs,paneClickDistance:us=1,nodeClickDistance:Au=0,children:Uo,onReconnect:oi,onReconnectStart:ds,onReconnectEnd:ku,onEdgeContextMenu:Vo,onEdgeDoubleClick:Yo,onEdgeMouseEnter:Po,onEdgeMouseMove:li,onEdgeMouseLeave:ci,reconnectRadius:Io=10,onNodesChange:Xo,onEdgesChange:Mn,noDragClassName:dt="nodrag",noWheelClassName:Nt="nowheel",noPanClassName:Qn="nopan",fitView:Qs,fitViewOptions:Go,connectOnClick:Ru,attributionPosition:Qo,proOptions:fs,defaultEdgeOptions:ui,elevateNodesOnSelect:Sa=!0,elevateEdgesOnSelect:_a=!1,disableKeyboardA11y:Ea=!1,autoPanOnConnect:Ca,autoPanOnNodeDrag:st,autoPanSpeed:Fo,connectionRadius:Zo,isValidConnection:Fn,onError:Ta,style:zu,id:di,nodeDragThreshold:Wo,connectionDragThreshold:Du,viewport:Fs,onViewportChange:Zs,width:gn,height:kt,colorMode:Ko="light",debug:Ou,onScroll:Ws,ariaLabelConfig:Jo,zIndexMode:hs="basic",...Bu},Rt){const ms=di||"1",el=VT(Ko),fi=N.useCallback(Zn=>{Zn.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ws?.(Zn)},[Ws]);return r.jsx("div",{"data-testid":"rf__wrapper",...Bu,onScroll:fi,style:{...zu,...cA},ref:Rt,className:ut(["react-flow",c,el]),id:di,role:"application",children:r.jsxs(lA,{nodes:t,edges:a,width:gn,height:kt,fitView:Qs,fitViewOptions:Go,minZoom:mn,maxZoom:Jt,nodeOrigin:hn,nodeExtent:Xn,zIndexMode:hs,children:[r.jsx(rA,{onInit:g,onNodeClick:m,onEdgeClick:p,onNodeMouseEnter:R,onNodeMouseMove:T,onNodeMouseLeave:A,onNodeContextMenu:w,onNodeDoubleClick:D,nodeTypes:u,edgeTypes:d,connectionLineType:P,connectionLineStyle:ne,connectionLineComponent:se,connectionLineContainerStyle:re,selectionKeyCode:ue,selectionOnDrag:V,selectionMode:ce,deleteKeyCode:de,multiSelectionKeyCode:ve,panActivationKeyCode:he,zoomActivationKeyCode:ge,onlyRenderVisibleElements:Ae,defaultViewport:Pn,translateExtent:In,minZoom:mn,maxZoom:Jt,preventScrolling:pn,zoomOnScroll:ii,zoomOnPinch:cs,zoomOnDoubleClick:Cu,panOnScroll:Ct,panOnScrollSpeed:Tn,panOnScrollMode:Tt,panOnDrag:Tu,onPaneClick:Mu,onPaneMouseEnter:Ps,onPaneMouseMove:Is,onPaneMouseLeave:Xs,onPaneScroll:Gn,onPaneContextMenu:Gs,paneClickDistance:us,nodeClickDistance:Au,onSelectionContextMenu:z,onSelectionStart:U,onSelectionEnd:L,onReconnect:oi,onReconnectStart:ds,onReconnectEnd:ku,onEdgeContextMenu:Vo,onEdgeDoubleClick:Yo,onEdgeMouseEnter:Po,onEdgeMouseMove:li,onEdgeMouseLeave:ci,reconnectRadius:Io,defaultMarkerColor:ls,noDragClassName:dt,noWheelClassName:Nt,noPanClassName:Qn,rfId:ms,disableKeyboardA11y:Ea,nodeExtent:Xn,viewport:Fs,onViewportChange:Zs}),r.jsx(UT,{nodes:t,edges:a,defaultNodes:s,defaultEdges:o,onConnect:j,onConnectStart:S,onConnectEnd:C,onClickConnectStart:_,onClickConnectEnd:E,nodesDraggable:$e,autoPanOnNodeFocus:ze,nodesConnectable:yt,nodesFocusable:pt,edgesFocusable:En,edgesReconnectable:Cn,elementsSelectable:at,elevateNodesOnSelect:Sa,elevateEdgesOnSelect:_a,minZoom:mn,maxZoom:Jt,nodeExtent:Xn,onNodesChange:Xo,onEdgesChange:Mn,snapToGrid:be,snapGrid:Se,connectionMode:B,translateExtent:In,connectOnClick:Ru,defaultEdgeOptions:ui,fitView:Qs,fitViewOptions:Go,onNodesDelete:Q,onEdgesDelete:I,onDelete:Z,onNodeDragStart:M,onNodeDrag:q,onNodeDragStop:H,onSelectionDrag:G,onSelectionDragStart:$,onSelectionDragStop:O,onMove:y,onMoveStart:x,onMoveEnd:b,noPanClassName:Qn,nodeOrigin:hn,rfId:ms,autoPanOnConnect:Ca,autoPanOnNodeDrag:st,autoPanSpeed:Fo,onError:Ta,connectionRadius:Zo,isValidConnection:Fn,selectNodesOnDrag:Ee,nodeDragThreshold:Wo,connectionDragThreshold:Du,onBeforeDelete:W,debug:Ou,ariaLabelConfig:Jo,zIndexMode:hs}),r.jsx(LT,{onSelectionChange:te}),Uo,r.jsx(RT,{proOptions:fs,position:Qo}),r.jsx(kT,{rfId:ms,disableKeyboardA11y:Ea})]})})}var dA=jv(uA);function fA({dimensions:t,lineWidth:a,variant:s,className:o}){return r.jsx("path",{strokeWidth:a,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`,className:ut(["react-flow__background-pattern",s,o])})}function hA({radius:t,className:a}){return r.jsx("circle",{cx:t,cy:t,r:t,className:ut(["react-flow__background-pattern","dots",a])})}var ss;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(ss||(ss={}));const mA={[ss.Dots]:1,[ss.Lines]:1,[ss.Cross]:6},pA=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function Xv({id:t,variant:a=ss.Dots,gap:s=20,size:o,lineWidth:c=1,offset:u=0,color:d,bgColor:m,style:p,className:g,patternClassName:y}){const x=N.useRef(null),{transform:b,patternId:j}=Oe(pA,We),S=o||mA[a],C=a===ss.Dots,_=a===ss.Cross,E=Array.isArray(s)?s:[s,s],R=[E[0]*b[2]||1,E[1]*b[2]||1],T=S*b[2],A=Array.isArray(u)?u:[u,u],w=_?[T,T]:R,D=[A[0]*b[2]||1+w[0]/2,A[1]*b[2]||1+w[1]/2],M=`${j}${t||""}`;return r.jsxs("svg",{className:ut(["react-flow__background",g]),style:{...p,...Nu,"--xy-background-color-props":m,"--xy-background-pattern-color-props":d},ref:x,"data-testid":"rf__background",children:[r.jsx("pattern",{id:M,x:b[0]%R[0],y:b[1]%R[1],width:R[0],height:R[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${D[0]},-${D[1]})`,children:C?r.jsx(hA,{radius:T/2,className:y}):r.jsx(fA,{dimensions:w,lineWidth:c,variant:a,className:y})}),r.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${M})`})]})}Xv.displayName="Background";const gA=N.memo(Xv);function xA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:r.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function yA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:r.jsx("path",{d:"M0 0h32v4.2H0z"})})}function bA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:r.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function vA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:r.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function wA(){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:r.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function jc({children:t,className:a,...s}){return r.jsx("button",{type:"button",className:ut(["react-flow__controls-button",a]),...s,children:t})}const jA=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom,ariaLabelConfig:t.ariaLabelConfig});function Gv({style:t,showZoom:a=!0,showFitView:s=!0,showInteractive:o=!0,fitViewOptions:c,onZoomIn:u,onZoomOut:d,onFitView:m,onInteractiveChange:p,className:g,children:y,position:x="bottom-left",orientation:b="vertical","aria-label":j}){const S=Ke(),{isInteractive:C,minZoomReached:_,maxZoomReached:E,ariaLabelConfig:R}=Oe(jA,We),{zoomIn:T,zoomOut:A,fitView:w}=Cm(),D=()=>{T(),u?.()},M=()=>{A(),d?.()},q=()=>{w(c),m?.()},H=()=>{S.setState({nodesDraggable:!C,nodesConnectable:!C,elementsSelectable:!C}),p?.(!C)},Q=b==="horizontal"?"horizontal":"vertical";return r.jsxs(ju,{className:ut(["react-flow__controls",Q,g]),position:x,style:t,"data-testid":"rf__controls","aria-label":j??R["controls.ariaLabel"],children:[a&&r.jsxs(r.Fragment,{children:[r.jsx(jc,{onClick:D,className:"react-flow__controls-zoomin",title:R["controls.zoomIn.ariaLabel"],"aria-label":R["controls.zoomIn.ariaLabel"],disabled:E,children:r.jsx(xA,{})}),r.jsx(jc,{onClick:M,className:"react-flow__controls-zoomout",title:R["controls.zoomOut.ariaLabel"],"aria-label":R["controls.zoomOut.ariaLabel"],disabled:_,children:r.jsx(yA,{})})]}),s&&r.jsx(jc,{className:"react-flow__controls-fitview",onClick:q,title:R["controls.fitView.ariaLabel"],"aria-label":R["controls.fitView.ariaLabel"],children:r.jsx(bA,{})}),o&&r.jsx(jc,{className:"react-flow__controls-interactive",onClick:H,title:R["controls.interactive.ariaLabel"],"aria-label":R["controls.interactive.ariaLabel"],children:C?r.jsx(wA,{}):r.jsx(vA,{})}),y]})}Gv.displayName="Controls";const NA=N.memo(Gv);function SA({id:t,x:a,y:s,width:o,height:c,style:u,color:d,strokeColor:m,strokeWidth:p,className:g,borderRadius:y,shapeRendering:x,selected:b,onClick:j}){const{background:S,backgroundColor:C}=u||{},_=d||S||C;return r.jsx("rect",{className:ut(["react-flow__minimap-node",{selected:b},g]),x:a,y:s,rx:y,ry:y,width:o,height:c,style:{fill:_,stroke:m,strokeWidth:p},shapeRendering:x,onClick:j?E=>j(E,t):void 0})}const _A=N.memo(SA),EA=t=>t.nodes.map(a=>a.id),fh=t=>t instanceof Function?t:()=>t;function CA({nodeStrokeColor:t,nodeColor:a,nodeClassName:s="",nodeBorderRadius:o=5,nodeStrokeWidth:c,nodeComponent:u=_A,onClick:d}){const m=Oe(EA,We),p=fh(a),g=fh(t),y=fh(s),x=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return r.jsx(r.Fragment,{children:m.map(b=>r.jsx(MA,{id:b,nodeColorFunc:p,nodeStrokeColorFunc:g,nodeClassNameFunc:y,nodeBorderRadius:o,nodeStrokeWidth:c,NodeComponent:u,onClick:d,shapeRendering:x},b))})}function TA({id:t,nodeColorFunc:a,nodeStrokeColorFunc:s,nodeClassNameFunc:o,nodeBorderRadius:c,nodeStrokeWidth:u,shapeRendering:d,NodeComponent:m,onClick:p}){const{node:g,x:y,y:x,width:b,height:j}=Oe(S=>{const{internals:C}=S.nodeLookup.get(t),_=C.userNode,{x:E,y:R}=C.positionAbsolute,{width:T,height:A}=Na(_);return{node:_,x:E,y:R,width:T,height:A}},We);return!g||g.hidden||!G1(g)?null:r.jsx(m,{x:y,y:x,width:b,height:j,style:g.style,selected:!!g.selected,className:o(g),color:a(g),borderRadius:c,strokeColor:s(g),strokeWidth:u,shapeRendering:d,onClick:p,id:g.id})}const MA=N.memo(TA);var AA=N.memo(CA);const kA=200,RA=150,zA=t=>!t.hidden,DA=t=>{const a={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:a,boundingRect:t.nodeLookup.size>0?X1(Bo(t.nodeLookup,{filter:zA}),a):a,rfId:t.rfId,panZoom:t.panZoom,translateExtent:t.translateExtent,flowWidth:t.width,flowHeight:t.height,ariaLabelConfig:t.ariaLabelConfig}},OA="react-flow__minimap-desc";function Qv({style:t,className:a,nodeStrokeColor:s,nodeColor:o,nodeClassName:c="",nodeBorderRadius:u=5,nodeStrokeWidth:d,nodeComponent:m,bgColor:p,maskColor:g,maskStrokeColor:y,maskStrokeWidth:x,position:b="bottom-right",onClick:j,onNodeClick:S,pannable:C=!1,zoomable:_=!1,ariaLabel:E,inversePan:R,zoomStep:T=1,offsetScale:A=5}){const w=Ke(),D=N.useRef(null),{boundingRect:M,viewBB:q,rfId:H,panZoom:Q,translateExtent:I,flowWidth:Z,flowHeight:te,ariaLabelConfig:$}=Oe(DA,We),G=t?.width??kA,O=t?.height??RA,z=M.width/G,U=M.height/O,L=Math.max(z,U),W=L*G,B=L*O,P=A*L,ne=M.x-(W-M.width)/2-P,se=M.y-(B-M.height)/2-P,re=W+P*2,de=B+P*2,ue=`${OA}-${H}`,V=N.useRef(0),ce=N.useRef();V.current=L,N.useEffect(()=>{if(D.current&&Q)return ce.current=K8({domNode:D.current,panZoom:Q,getTransform:()=>w.getState().transform,getViewScale:()=>V.current}),()=>{ce.current?.destroy()}},[Q]),N.useEffect(()=>{ce.current?.update({translateExtent:I,width:Z,height:te,inversePan:R,pannable:C,zoomStep:T,zoomable:_})},[C,_,R,T,I,Z,te]);const he=j?be=>{const[Se,Ae]=ce.current?.pointer(be)||[0,0];j(be,{x:Se,y:Ae})}:void 0,ve=S?N.useCallback((be,Se)=>{const Ae=w.getState().nodeLookup.get(Se).internals.userNode;S(be,Ae)},[]):void 0,ge=E??$["minimap.ariaLabel"];return r.jsx(ju,{position:b,style:{...t,"--xy-minimap-background-color-props":typeof p=="string"?p:void 0,"--xy-minimap-mask-background-color-props":typeof g=="string"?g:void 0,"--xy-minimap-mask-stroke-color-props":typeof y=="string"?y:void 0,"--xy-minimap-mask-stroke-width-props":typeof x=="number"?x*L:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof s=="string"?s:void 0,"--xy-minimap-node-stroke-width-props":typeof d=="number"?d:void 0},className:ut(["react-flow__minimap",a]),"data-testid":"rf__minimap",children:r.jsxs("svg",{width:G,height:O,viewBox:`${ne} ${se} ${re} ${de}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":ue,ref:D,onClick:he,children:[ge&&r.jsx("title",{id:ue,children:ge}),r.jsx(AA,{onClick:ve,nodeColor:o,nodeStrokeColor:s,nodeBorderRadius:u,nodeClassName:c,nodeStrokeWidth:d,nodeComponent:m}),r.jsx("path",{className:"react-flow__minimap-mask",d:`M${ne-P},${se-P}h${re+P*2}v${de+P*2}h${-re-P*2}z
        M${q.x},${q.y}h${q.width}v${q.height}h${-q.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Qv.displayName="MiniMap";const BA=N.memo(Qv),LA=t=>a=>t?`${Math.max(1/a.transform[2],1)}`:void 0,HA={[Zr.Line]:"right",[Zr.Handle]:"bottom-right"};function $A({nodeId:t,position:a,variant:s=Zr.Handle,className:o,style:c=void 0,children:u,color:d,minWidth:m=10,minHeight:p=10,maxWidth:g=Number.MAX_VALUE,maxHeight:y=Number.MAX_VALUE,keepAspectRatio:x=!1,resizeDirection:b,autoScale:j=!0,shouldResize:S,onResizeStart:C,onResize:_,onResizeEnd:E}){const R=Ev(),T=typeof t=="string"?t:R,A=Ke(),w=N.useRef(null),D=s===Zr.Handle,M=Oe(N.useCallback(LA(D&&j),[D,j]),We),q=N.useRef(null),H=a??HA[s];N.useEffect(()=>{if(!(!w.current||!T))return q.current||(q.current=fT({domNode:w.current,nodeId:T,getStoreItems:()=>{const{nodeLookup:I,transform:Z,snapGrid:te,snapToGrid:$,nodeOrigin:G,domNode:O}=A.getState();return{nodeLookup:I,transform:Z,snapGrid:te,snapToGrid:$,nodeOrigin:G,paneDomNode:O}},onChange:(I,Z)=>{const{triggerNodeChanges:te,nodeLookup:$,parentLookup:G,nodeOrigin:O}=A.getState(),z=[],U={x:I.x,y:I.y},L=$.get(T);if(L&&L.expandParent&&L.parentId){const W=L.origin??O,B=I.width??L.measured.width??0,P=I.height??L.measured.height??0,ne={id:L.id,parentId:L.parentId,rect:{width:B,height:P,...Q1({x:I.x??L.position.x,y:I.y??L.position.y},{width:B,height:P},L.parentId,$,W)}},se=Em([ne],$,G,O);z.push(...se),U.x=I.x?Math.max(W[0]*B,I.x):void 0,U.y=I.y?Math.max(W[1]*P,I.y):void 0}if(U.x!==void 0&&U.y!==void 0){const W={id:T,type:"position",position:{...U}};z.push(W)}if(I.width!==void 0&&I.height!==void 0){const B={id:T,type:"dimensions",resizing:!0,setAttributes:b?b==="horizontal"?"width":"height":!0,dimensions:{width:I.width,height:I.height}};z.push(B)}for(const W of Z){const B={...W,type:"position"};z.push(B)}te(z)},onEnd:({width:I,height:Z})=>{const te={id:T,type:"dimensions",resizing:!1,dimensions:{width:I,height:Z}};A.getState().triggerNodeChanges([te])}})),q.current.update({controlPosition:H,boundaries:{minWidth:m,minHeight:p,maxWidth:g,maxHeight:y},keepAspectRatio:x,resizeDirection:b,onResizeStart:C,onResize:_,onResizeEnd:E,shouldResize:S}),()=>{q.current?.destroy()}},[H,m,p,g,y,x,C,_,E,S]);const Q=H.split("-");return r.jsx("div",{className:ut(["react-flow__resize-control","nodrag",...Q,s,o]),ref:w,style:{...c,scale:M,...d&&{[D?"backgroundColor":"borderColor"]:d}},children:u})}N.memo($A);const hh=[{id:"trigger-1",type:"trigger",position:{x:250,y:50},data:{label:"Inicio",config:{type:"classification",conditions:{intent:["sales"]}}}}],qA=[],ri=Mb((t,a)=>({flowId:null,flowName:"Nuevo Flujo",flowSlug:null,isActive:!1,isSaved:!0,nodes:hh,edges:qA,selectedNode:null,selectedEdge:null,isSidebarOpen:!0,isPropertiesOpen:!1,onNodesChange:s=>{t({nodes:vv(s,a().nodes),isSaved:!1})},onEdgesChange:s=>{t({edges:wv(s,a().edges),isSaved:!1})},onConnect:s=>{t({edges:tv({...s,type:"smoothstep",animated:!0,style:{stroke:"#25D366",strokeWidth:2}},a().edges),isSaved:!1})},addNode:(s,o)=>{const c=`${s}-${Date.now()}`,d={id:c,type:s,position:o,data:{trigger:{label:"Trigger",config:{type:"classification",conditions:{}}},message:{label:"Mensaje",content:"Escribe tu mensaje aqu..."},question:{label:"Pregunta",content:"Cul es tu opcin?",variable:"respuesta",options:[]},condition:{label:"Condicin",conditions:[]},action:{label:"Accin",action:"",payload:{}},transfer:{label:"Transferir",content:"Transfiriendo a un agente..."},end:{label:"Fin"}}[s]||{label:s}};return t({nodes:[...a().nodes,d],isSaved:!1}),c},updateNodeData:(s,o)=>{t({nodes:a().nodes.map(c=>c.id===s?{...c,data:{...c.data,...o}}:c),isSaved:!1})},deleteNode:s=>{t({nodes:a().nodes.filter(o=>o.id!==s),edges:a().edges.filter(o=>o.source!==s&&o.target!==s),selectedNode:null,isSaved:!1})},setSelectedNode:s=>t({selectedNode:s,isPropertiesOpen:!!s}),setSelectedEdge:s=>t({selectedEdge:s}),clearSelection:()=>t({selectedNode:null,selectedEdge:null}),toggleSidebar:()=>t({isSidebarOpen:!a().isSidebarOpen}),toggleProperties:()=>t({isPropertiesOpen:!a().isPropertiesOpen}),setFlowMeta:s=>t({flowId:s.id,flowName:s.name,flowSlug:s.slug,isActive:s.is_active}),loadFlow:s=>{const o={trigger:"Inicio",message:"Mensaje",question:"Pregunta",condition:"Condicin",action:"Accin",transfer:"Transferir",end:"Fin"},c=(s.nodes||[]).map(u=>{let d=o[u.type]||u.type;return u.content&&u.content.length>0&&(d=u.content.substring(0,25)+(u.content.length>25?"...":"")),u.action&&(d=`Accin: ${u.action}`),{id:u.id,type:u.type,position:u.position||{x:250,y:50},data:{label:d,content:u.content,variable:u.variable,options:u.options,conditions:u.conditions,action:u.action,payload:u.payload,config:u.config||(u.type==="trigger"?s.trigger_config:void 0)}}});t({flowId:s.id,flowName:s.name,flowSlug:s.slug,isActive:s.is_active,nodes:c.length>0?c:hh,edges:s.connections?.map(u=>({id:`${u.from}-${u.to}`,source:u.from,target:u.to,type:"smoothstep",animated:!0,label:u.label,style:{stroke:"#25D366",strokeWidth:2}}))||[],isSaved:!0})},resetFlow:()=>t({flowId:null,flowName:"Nuevo Flujo",flowSlug:null,isActive:!1,nodes:hh,edges:[],selectedNode:null,isSaved:!0}),markSaved:()=>t({isSaved:!0}),exportFlow:()=>{const s=a();return{name:s.flowName,trigger_config:s.nodes.find(o=>o.type==="trigger")?.data.config||{},nodes:s.nodes.map(o=>({id:o.id,type:o.type,content:o.data.content,variable:o.data.variable,options:o.data.options,conditions:o.data.conditions,action:o.data.action,payload:o.data.payload,position:o.position})),connections:s.edges.map(o=>({from:o.source,to:o.target,label:o.label}))}}}));function UA({onTestClick:t}){const{flowId:a,flowName:s,isActive:o,isSaved:c,exportFlow:u,markSaved:d,loadFlow:m,resetFlow:p,setFlowMeta:g}=ri(),[y,x]=N.useState(!1),[b,j]=N.useState(!1),[S,C]=N.useState([]),[_,E]=N.useState(s),R=async()=>{x(!0);try{const M=u();if(M.name=_,a)await E_(a,M);else{const q=await __(M);g({id:q.id,name:_,slug:q.slug,is_active:!1})}d(),alert("Flujo guardado correctamente")}catch(M){alert("Error al guardar: "+M.message)}finally{x(!1)}},T=async()=>{if(!a){alert("Primero guarda el flujo");return}try{await i1(a,!o),g({id:a,name:_,is_active:!o}),alert(o?"Flujo desactivado":"Flujo activado")}catch(M){alert("Error: "+M.message)}},A=async()=>{try{const M=await r1();C(M.flows||[]),j(!0)}catch(M){alert("Error cargando flujos: "+M.message)}},w=async M=>{try{const q=await Ch(M.id);m(q.flow),E(q.flow.name),j(!1)}catch(q){alert("Error cargando flujo: "+q.message)}},D=()=>{!c&&!confirm("Tienes cambios sin guardar. Continuar?")||(p(),E("Nuevo Flujo"))};return r.jsxs("div",{style:{height:"56px",background:"white",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("span",{style:{fontSize:"24px"},children:""}),r.jsx("span",{style:{fontWeight:600,color:"#075E54"},children:"Flow Builder"})]}),r.jsx("div",{style:{borderLeft:"1px solid #e5e7eb",height:"24px"}}),r.jsx("input",{type:"text",value:_,onChange:M=>E(M.target.value),style:{border:"none",fontSize:"15px",fontWeight:500,background:"transparent",width:"200px"},placeholder:"Nombre del flujo"}),!c&&r.jsx("span",{style:{fontSize:"11px",background:"#fef3c7",color:"#92400e",padding:"2px 8px",borderRadius:"4px"},children:"Sin guardar"}),o&&r.jsx("span",{style:{fontSize:"11px",background:"#d1fae5",color:"#065f46",padding:"2px 8px",borderRadius:"4px"},children:"Activo"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("button",{onClick:t,style:{padding:"8px 16px",background:"linear-gradient(135deg, #075E54 0%, #128C7E 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:500},children:" Probar"}),r.jsx("div",{style:{borderLeft:"1px solid #e5e7eb",height:"24px",margin:"0 4px"}}),r.jsx("button",{onClick:D,style:{padding:"8px 16px",background:"white",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"13px"},children:"+ Nuevo"}),r.jsx("button",{onClick:A,style:{padding:"8px 16px",background:"white",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"13px"},children:" Abrir"}),r.jsx("button",{onClick:R,disabled:y,style:{padding:"8px 16px",background:"#25D366",color:"white",border:"none",borderRadius:"6px",cursor:y?"wait":"pointer",fontSize:"13px",fontWeight:500},children:y?"Guardando...":" Guardar"}),a&&r.jsx("button",{onClick:T,style:{padding:"8px 16px",background:o?"#fee2e2":"#d1fae5",color:o?"#dc2626":"#065f46",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:500},children:o?" Desactivar":" Activar"})]}),b&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",width:"400px",maxHeight:"500px",overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"16px"},children:[r.jsx("h3",{style:{margin:0},children:"Seleccionar flujo"}),r.jsx("button",{onClick:()=>j(!1),style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px"},children:""})]}),S.length===0?r.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:"No hay flujos guardados"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:S.map(M=>r.jsxs("div",{onClick:()=>w(M),style:{padding:"12px",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseOver:q=>q.currentTarget.style.background="#f9fafb",onMouseOut:q=>q.currentTarget.style.background="white",children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:500},children:M.name}),r.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:M.slug})]}),M.is_active&&r.jsx("span",{style:{fontSize:"10px",background:"#d1fae5",color:"#065f46",padding:"2px 6px",borderRadius:"4px"},children:"Activo"})]},M.id))})]})})]})}const VA=[{type:"trigger",label:"Trigger",icon:"",color:"#667eea",description:"Inicio del flujo"},{type:"message",label:"Mensaje",icon:"",color:"#25D366",description:"Enviar mensaje"},{type:"question",label:"Pregunta",icon:"",color:"#34B7F1",description:"Preguntar y esperar"},{type:"condition",label:"Condicin",icon:"",color:"#f59e0b",description:"Bifurcacin"},{type:"action",label:"Accin",icon:"",color:"#6366f1",description:"Ejecutar accin"},{type:"ai_response",label:"Respuesta IA",icon:"",color:"#8b5cf6",description:"Generar con IA"},{type:"webhook",label:"Webhook",icon:"",color:"#f97316",description:"Llamar API externa"},{type:"delay",label:"Espera",icon:"",color:"#64748b",description:"Pausar X segundos"},{type:"transfer",label:"Transferir",icon:"",color:"#ec4899",description:"Pasar a humano"},{type:"end",label:"Fin",icon:"",color:"#ef4444",description:"Terminar flujo"}];function YA(){const{isSidebarOpen:t,toggleSidebar:a}=ri(),s=(o,c)=>{o.dataTransfer.setData("application/reactflow",c),o.dataTransfer.effectAllowed="move"};return t?r.jsxs("div",{style:{width:"240px",background:"white",borderRight:"1px solid #e5e7eb",padding:"16px",display:"flex",flexDirection:"column",height:"100%"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[r.jsx("h3",{style:{margin:0,fontSize:"14px",fontWeight:600},children:"Nodos"}),r.jsx("button",{onClick:a,style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",color:"#6b7280"},children:""})]}),r.jsx("p",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"16px"},children:"Arrastra los nodos al canvas para construir tu flujo"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:VA.map(o=>r.jsxs("div",{draggable:!0,onDragStart:c=>s(c,o.type),style:{padding:"10px 12px",borderRadius:"8px",cursor:"grab",display:"flex",alignItems:"center",gap:"10px",background:`${o.color}15`,border:`1px solid ${o.color}30`,transition:"all 0.2s"},onMouseOver:c=>{c.currentTarget.style.transform="translateX(4px)",c.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},onMouseOut:c=>{c.currentTarget.style.transform="none",c.currentTarget.style.boxShadow="none"},children:[r.jsx("span",{style:{fontSize:"20px"},children:o.icon}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:500,fontSize:"13px"},children:o.label}),r.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:o.description})]})]},o.type))})]}):r.jsxs("button",{onClick:a,style:{position:"absolute",left:10,top:10,zIndex:10,background:"white",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[r.jsx("span",{children:""})," Nodos"]})}const nb={trigger:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none"},message:{background:"white",border:"2px solid #25D366"},question:{background:"white",border:"2px solid #34B7F1"},condition:{background:"#fef3c7",border:"2px solid #f59e0b"},action:{background:"#e0e7ff",border:"2px solid #6366f1"},transfer:{background:"#fce7f3",border:"2px solid #ec4899"},end:{background:"#fee2e2",border:"2px solid #ef4444"}},PA={trigger:"",message:"",question:"",condition:"",action:"",transfer:"",end:""};function IA({id:t,data:a,type:s,selected:o}){const c=nb[s]||nb.message,u=PA[s]||"",d=s!=="end",m=s!=="trigger";return r.jsxs("div",{style:{...c,padding:"12px 16px",borderRadius:"8px",minWidth:"180px",maxWidth:"250px",boxShadow:o?"0 0 0 2px #3b82f6":"0 2px 8px rgba(0,0,0,0.1)",cursor:"pointer"},children:[m&&r.jsx(Wr,{type:"target",position:xe.Top,style:{background:"#6b7280",width:10,height:10}}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[r.jsx("span",{style:{fontSize:"16px"},children:u}),r.jsx("strong",{style:{fontSize:"13px"},children:a.label||s})]}),a.content&&r.jsxs("div",{style:{fontSize:"11px",opacity:.8,marginTop:"4px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.content.substring(0,40),a.content.length>40?"...":""]}),a.options&&a.options.length>0&&r.jsxs("div",{style:{fontSize:"10px",marginTop:"6px",opacity:.7},children:[a.options.length," opciones"]}),d&&r.jsx(Wr,{type:"source",position:xe.Bottom,style:{background:"#25D366",width:10,height:10}})]})}const ks=N.memo(IA),XA={trigger:t=>r.jsx(ks,{...t,type:"trigger"}),message:t=>r.jsx(ks,{...t,type:"message"}),question:t=>r.jsx(ks,{...t,type:"question"}),condition:t=>r.jsx(ks,{...t,type:"condition"}),action:t=>r.jsx(ks,{...t,type:"action"}),transfer:t=>r.jsx(ks,{...t,type:"transfer"}),end:t=>r.jsx(ks,{...t,type:"end"})};function GA(){const t=N.useRef(null),{nodes:a,edges:s,onNodesChange:o,onEdgesChange:c,onConnect:u,addNode:d,setSelectedNode:m}=ri(),p=N.useCallback(b=>{b.preventDefault(),b.dataTransfer.dropEffect="move"},[]),g=N.useCallback(b=>{b.preventDefault();const j=b.dataTransfer.getData("application/reactflow");if(!j)return;const S=t.current.getBoundingClientRect(),C={x:b.clientX-S.left-90,y:b.clientY-S.top-25};d(j,C)},[d]),y=N.useCallback((b,j)=>{m(j)},[m]),x=N.useCallback(()=>{m(null)},[m]);return r.jsx("div",{ref:t,style:{flex:1,height:"100%"},children:r.jsxs(dA,{nodes:a,edges:s,onNodesChange:o,onEdgesChange:c,onConnect:u,onDrop:g,onDragOver:p,onNodeClick:y,onPaneClick:x,nodeTypes:XA,fitView:!0,snapToGrid:!0,snapGrid:[15,15],defaultEdgeOptions:{type:"smoothstep",animated:!0,style:{stroke:"#25D366",strokeWidth:2}},children:[r.jsx(gA,{color:"#e5e7eb",gap:20}),r.jsx(NA,{}),r.jsx(BA,{nodeColor:b=>({trigger:"#667eea",message:"#25D366",question:"#34B7F1",condition:"#f59e0b",action:"#6366f1",transfer:"#ec4899",end:"#ef4444"})[b.type]||"#6b7280",maskColor:"rgba(255, 255, 255, 0.8)"})]})})}const QA=[{value:"sales",label:"Ventas",color:"#10b981"},{value:"support",label:"Soporte",color:"#3b82f6"},{value:"complaint",label:"Quejas",color:"#ef4444"},{value:"info",label:"Informacin",color:"#8b5cf6"},{value:"greeting",label:"Saludo",color:"#f59e0b"}],FA=[{value:"low",label:"Baja"},{value:"medium",label:"Media"},{value:"high",label:"Alta"},{value:"critical",label:"Crtica"}];function ZA(){const{selectedNode:t,updateNodeData:a,deleteNode:s,isPropertiesOpen:o,toggleProperties:c}=ri(),[u,d]=N.useState({}),[m,p]=N.useState({type:"keyword",keywords:[],conditions:{}}),[g,y]=N.useState([]),x=At(w=>w.token);N.useEffect(()=>{t&&(d(t.data||{}),t.type==="trigger"&&t.data?.config&&p(t.data.config))},[t]),N.useEffect(()=>{t?.type==="transfer"&&g.length===0&&x&&fetch("/api/departments",{headers:{Authorization:`Bearer ${x}`}}).then(w=>w.json()).then(w=>y(w.departments||[])).catch(()=>{})},[t?.type,x]);const b=(w,D)=>{const M={...u,[w]:D};d(M),a(t.id,{[w]:D})},j=(w,D,M)=>{const q=[...u.options||[]];q[w]={...q[w],[D]:M},b("options",q)},S=()=>{const w=[...u.options||[],{label:"Nueva opcin",value:""}];b("options",w)},C=w=>{const D=u.options.filter((M,q)=>q!==w);b("options",D)},_=w=>{const D={type:w,keywords:[],conditions:{}};p(D),a(t.id,{config:D})},E=w=>{const D=w.split(",").map(q=>q.trim()).filter(q=>q),M={...m,keywords:D};p(M),a(t.id,{config:M})},R=w=>{const D=m.conditions?.intent||[];let M;D.includes(w)?M=D.filter(H=>H!==w):M=[...D,w];const q={...m,conditions:{...m.conditions,intent:M}};p(q),a(t.id,{config:q})},T=w=>{const D={...m,conditions:{...m.conditions,urgency:w}};p(D),a(t.id,{config:D})},A=w=>{const D={...m,conditions:{...m.conditions,min_lead_score:parseInt(w)||0}};p(D),a(t.id,{config:D})};return!o||!t?null:r.jsxs("div",{style:{width:"300px",background:"white",borderLeft:"1px solid #e5e7eb",padding:"16px",height:"100%",overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[r.jsx("h3",{style:{margin:0,fontSize:"14px",fontWeight:600},children:"Propiedades"}),r.jsx("button",{onClick:c,style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",color:"#6b7280"},children:""})]}),r.jsxs("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"16px"},children:["Tipo: ",r.jsx("strong",{children:t.type})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Etiqueta"}),r.jsx("input",{type:"text",value:u.label||"",onChange:w=>b("label",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"}})]}),t.type==="trigger"&&r.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,marginBottom:"12px",color:"#475569"},children:"Configuracin del Trigger"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"6px",color:"#64748b"},children:"Tipo de activacin"}),r.jsx("div",{style:{display:"flex",gap:"6px"},children:[{value:"keyword",label:"Palabras clave"},{value:"classification",label:"Clasificacin"},{value:"always",label:"Siempre"}].map(w=>r.jsx("button",{onClick:()=>_(w.value),style:{flex:1,padding:"8px 4px",fontSize:"11px",border:m.type===w.value?"2px solid #25D366":"1px solid #d1d5db",borderRadius:"6px",background:m.type===w.value?"#dcfce7":"white",color:m.type===w.value?"#166534":"#6b7280",cursor:"pointer",fontWeight:m.type===w.value?600:400},children:w.label},w.value))})]}),m.type==="keyword"&&r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#64748b"},children:"Palabras clave (separadas por coma)"}),r.jsx("input",{type:"text",value:(m.keywords||[]).join(", "),onChange:w=>E(w.target.value),placeholder:"precio, costo, cotizar, cuanto",style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}}),r.jsx("p",{style:{fontSize:"10px",color:"#94a3b8",marginTop:"4px"},children:"El flujo se activa si el mensaje contiene alguna de estas palabras"})]}),m.type==="classification"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"6px",color:"#64748b"},children:"Intenciones del mensaje"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:QA.map(w=>{const D=(m.conditions?.intent||[]).includes(w.value);return r.jsxs("button",{onClick:()=>R(w.value),style:{padding:"6px 10px",fontSize:"11px",border:D?`2px solid ${w.color}`:"1px solid #d1d5db",borderRadius:"16px",background:D?`${w.color}20`:"white",color:D?w.color:"#6b7280",cursor:"pointer",fontWeight:D?600:400},children:[D&&" ",w.label]},w.value)})})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#64748b"},children:"Urgencia mnima"}),r.jsxs("select",{value:m.conditions?.urgency||"",onChange:w=>T(w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},children:[r.jsx("option",{value:"",children:"Cualquiera"}),FA.map(w=>r.jsx("option",{value:w.value,children:w.label},w.value))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#64748b"},children:"Lead score mnimo"}),r.jsx("input",{type:"number",min:"0",max:"100",value:m.conditions?.min_lead_score||0,onChange:w=>A(w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}}),r.jsx("p",{style:{fontSize:"10px",color:"#94a3b8",marginTop:"4px"},children:"Solo activa si el lead tiene este puntaje o ms (0-100)"})]})]}),m.type==="always"&&r.jsx("div",{style:{padding:"12px",background:"#fef3c7",borderRadius:"6px",border:"1px solid #fcd34d"},children:r.jsx("p",{style:{fontSize:"11px",color:"#92400e",margin:0},children:" Este flujo se activar para TODOS los mensajes entrantes que no coincidan con otros flujos. salo como flujo por defecto."})})]}),["message","question","transfer"].includes(t.type)&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Contenido del mensaje"}),r.jsx("textarea",{value:u.content||"",onChange:w=>b("content",w.target.value),rows:4,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px",resize:"vertical"},placeholder:"Escribe el mensaje..."}),r.jsxs("p",{style:{fontSize:"11px",color:"#6b7280",marginTop:"4px"},children:["Usa ","{{variable}}"," para insertar variables"]})]}),t.type==="transfer"&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Departamento destino"}),r.jsxs("select",{value:u.targetDepartmentId||"",onChange:w=>b("targetDepartmentId",w.target.value?Number(w.target.value):null),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"},children:[r.jsx("option",{value:"",children:"Auto (detectar por intent)"}),g.filter(w=>w.active).map(w=>r.jsx("option",{value:w.id,children:w.display_name||w.name},w.id))]}),r.jsx("p",{style:{fontSize:"11px",color:"#6b7280",marginTop:"4px"},children:'Si seleccionas "Auto", se usar el intent detectado para asignar departamento'})]}),t.type==="question"&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Guardar respuesta en variable"}),r.jsx("input",{type:"text",value:u.variable||"",onChange:w=>b("variable",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"},placeholder:"nombre_variable"})]}),t.type==="question"&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"8px"},children:"Opciones de respuesta"}),(u.options||[]).map((w,D)=>r.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[r.jsx("input",{type:"text",value:w.label,onChange:M=>j(D,"label",M.target.value),placeholder:"Texto",style:{flex:1,padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}}),r.jsx("input",{type:"text",value:w.value,onChange:M=>j(D,"value",M.target.value),placeholder:"Valor",style:{width:"80px",padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}}),r.jsx("button",{onClick:()=>C(D),style:{background:"#fee2e2",border:"none",borderRadius:"4px",padding:"0 8px",cursor:"pointer",color:"#ef4444"},children:""})]},D)),r.jsx("button",{onClick:S,style:{background:"#f3f4f6",border:"1px dashed #d1d5db",borderRadius:"6px",padding:"8px",width:"100%",cursor:"pointer",fontSize:"12px"},children:"+ Agregar opcin"})]}),t.type==="action"&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,marginBottom:"4px"},children:"Tipo de accin"}),r.jsxs("select",{value:u.action||"",onChange:w=>b("action",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"},children:[r.jsx("option",{value:"",children:"Selecciona..."}),r.jsx("option",{value:"notify_sales",children:"Notificar a ventas"}),r.jsx("option",{value:"create_ticket",children:"Crear ticket"}),r.jsx("option",{value:"save_lead",children:"Guardar lead"}),r.jsx("option",{value:"send_email",children:"Enviar email"}),r.jsx("option",{value:"webhook",children:"Llamar webhook"}),r.jsx("option",{value:"search_faq",children:"Buscar en FAQ"})]})]}),t.type==="ai_response"&&r.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#f5f3ff",borderRadius:"8px",border:"1px solid #c4b5fd"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,marginBottom:"12px",color:"#5b21b6"},children:" Configuracin de IA"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Prompt del sistema"}),r.jsx("textarea",{value:u.system_prompt||"",onChange:w=>b("system_prompt",w.target.value),rows:3,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",resize:"vertical"},placeholder:"Eres un asistente de ventas amable y profesional..."})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Prompt del usuario"}),r.jsx("textarea",{value:u.user_prompt||"",onChange:w=>b("user_prompt",w.target.value),rows:2,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",resize:"vertical"},placeholder:"El cliente pregunta: {{initial_message}}"}),r.jsxs("p",{style:{fontSize:"10px",color:"#94a3b8",marginTop:"4px"},children:["Usa ","{{variable}}"," para insertar datos dinmicos"]})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Modelo"}),r.jsxs("select",{value:u.model||"gpt-4o-mini",onChange:w=>b("model",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},children:[r.jsx("option",{value:"gpt-4o-mini",children:"GPT-4o Mini (rpido)"}),r.jsx("option",{value:"gpt-4o",children:"GPT-4o (preciso)"}),r.jsx("option",{value:"gpt-4-turbo",children:"GPT-4 Turbo"})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Temperatura"}),r.jsx("input",{type:"number",min:"0",max:"1",step:"0.1",value:u.temperature||.7,onChange:w=>b("temperature",parseFloat(w.target.value)),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Max tokens"}),r.jsx("input",{type:"number",min:"50",max:"2000",step:"50",value:u.max_tokens||200,onChange:w=>b("max_tokens",parseInt(w.target.value)),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Guardar respuesta en variable (opcional)"}),r.jsx("input",{type:"text",value:u.variable||"",onChange:w=>b("variable",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},placeholder:"ai_response"})]})]}),t.type==="webhook"&&r.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#fff7ed",borderRadius:"8px",border:"1px solid #fed7aa"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,marginBottom:"12px",color:"#c2410c"},children:" Configuracin de Webhook"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"URL del endpoint"}),r.jsx("input",{type:"text",value:u.url||"",onChange:w=>b("url",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},placeholder:"https://api.ejemplo.com/endpoint"})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Mtodo HTTP"}),r.jsxs("select",{value:u.method||"POST",onChange:w=>b("method",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},children:[r.jsx("option",{value:"GET",children:"GET"}),r.jsx("option",{value:"POST",children:"POST"}),r.jsx("option",{value:"PUT",children:"PUT"}),r.jsx("option",{value:"PATCH",children:"PATCH"}),r.jsx("option",{value:"DELETE",children:"DELETE"})]})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Headers (JSON)"}),r.jsx("textarea",{value:u.headers||`{
  "Content-Type": "application/json"
}`,onChange:w=>b("headers",w.target.value),rows:3,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"11px",fontFamily:"monospace",resize:"vertical"}})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsxs("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:["Body (JSON) - Usa ","{{variable}}"," para datos dinmicos"]}),r.jsx("textarea",{value:u.body||`{
  "phone": "{{phone}}",
  "message": "{{initial_message}}"
}`,onChange:w=>b("body",w.target.value),rows:4,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"11px",fontFamily:"monospace",resize:"vertical"}})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Timeout (ms)"}),r.jsx("input",{type:"number",min:"1000",max:"30000",step:"1000",value:u.timeout||5e3,onChange:w=>b("timeout",parseInt(w.target.value)),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Guardar respuesta en variable"}),r.jsx("input",{type:"text",value:u.variable||"",onChange:w=>b("variable",w.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px"},placeholder:"api_response"})]})]}),t.type==="delay"&&r.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #cbd5e1"},children:[r.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,marginBottom:"12px",color:"#475569"},children:" Configuracin de Espera"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:500,marginBottom:"4px",color:"#6b7280"},children:"Segundos de espera"}),r.jsx("input",{type:"number",min:"1",max:"60",step:"1",value:u.seconds||2,onChange:w=>b("seconds",parseInt(w.target.value)),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px"}}),r.jsx("p",{style:{fontSize:"10px",color:"#94a3b8",marginTop:"4px"},children:"Entre 1 y 60 segundos. Recomendado: 2-5 seg para parecer ms humano."})]}),r.jsx("div",{children:r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[r.jsx("input",{type:"checkbox",checked:u.typing_indicator!==!1,onChange:w=>b("typing_indicator",w.target.checked),style:{width:"16px",height:"16px"}}),r.jsx("span",{style:{fontSize:"12px",color:"#374151"},children:'Mostrar "escribiendo..." mientras espera'})]})})]}),r.jsx("div",{style:{marginTop:"24px",paddingTop:"16px",borderTop:"1px solid #e5e7eb"},children:r.jsx("button",{onClick:()=>s(t.id),style:{width:"100%",padding:"10px",background:"#fee2e2",border:"1px solid #fecaca",borderRadius:"6px",color:"#dc2626",cursor:"pointer",fontWeight:500,fontSize:"13px"},children:" Eliminar nodo"})})]})}function WA({isOpen:t,onClose:a}){const{nodes:s,edges:o,flowName:c}=ri(),[u,d]=N.useState([]),[m,p]=N.useState(""),[g,y]=N.useState(null),[x,b]=N.useState({}),[j,S]=N.useState(!1),[C,_]=N.useState(null),[E,R]=N.useState("local"),[T,A]=N.useState(!1),w=N.useRef(null);N.useEffect(()=>{w.current?.scrollIntoView({behavior:"smooth"})},[u]),N.useEffect(()=>{t&&D()},[t]);const D=()=>{d([{type:"system",text:`Simulando flujo: "${c}"`},{type:"system",text:"Escribe un mensaje para iniciar..."}]),b({}),y(null),S(!0),_(null)},M=z=>s.find(U=>U.id===z),q=(z,U=null)=>{const L=o.find(W=>!(W.source!==z||U&&W.label&&W.label!==U));return L?M(L.target):null},H=()=>s.find(z=>z.type==="trigger"),Q=async z=>{if(!z){Z("system"," Flujo terminado (no hay siguiente nodo)"),S(!0);return}switch(_(z.id),y(z.id),await te(300),z.type){case"trigger":Z("system"," Trigger activado");const U=q(z.id);Q(U);break;case"message":const L=I(z.data.content||"Mensaje vaco");Z("bot",L),await te(500);const W=q(z.id);Q(W);break;case"question":const B=I(z.data.content||"?");Z("bot",B),z.data.options&&z.data.options.length>0&&Z("options",z.data.options),S(!0),y(z.id);break;case"condition":Z("system"," Evaluando condicin..."),await te(300);const P=z.data.conditions||[];let ne=null;for(const Ee of P){if(Ee.else){ne=Ee.goto;break}const $e=Ee.if?.match(/(\w+)\s*==\s*["']?(\w+)["']?/);if($e){const[,ze,yt]=$e;if(x[ze]===yt){ne=Ee.goto,Z("system",` Condicin cumplida: ${ze} = ${yt}`);break}}}const se=M(ne)||q(z.id);Q(se);break;case"action":Z("system",` Ejecutando accin: ${z.data.action||"sin definir"}`),await te(500);const re=q(z.id);Q(re);break;case"ai_response":Z("system"," Generando respuesta con IA..."),A(!0),await te(1500),A(!1);const de=z.data.system_prompt||"",ue=I(z.data.user_prompt||""),V=`[Respuesta IA simulada]
${de.substring(0,50)}...
Para: "${ue.substring(0,50)}..."`;Z("bot",V),z.data.variable&&(b(Ee=>({...Ee,[z.data.variable]:"respuesta_ia_simulada"})),Z("system",` Variable "${z.data.variable}" = respuesta IA`)),await te(300);const ce=q(z.id);Q(ce);break;case"webhook":Z("system",` Llamando webhook: ${z.data.url||"URL no definida"}`),Z("system",`   Mtodo: ${z.data.method||"POST"}`),A(!0),await te(1e3),A(!1);const he={success:!0,data:{status:"ok",simulated:!0}};Z("system",` Webhook respondi: ${JSON.stringify(he).substring(0,50)}...`),z.data.variable&&b(Ee=>({...Ee,[z.data.variable]:he}));const ve=q(z.id);Q(ve);break;case"delay":const ge=z.data.seconds||2,be=z.data.typing_indicator!==!1;Z("system",` Esperando ${ge} segundos...`),be&&A(!0),await te(ge*1e3),be&&A(!1);const Se=q(z.id);Q(Se);break;case"transfer":Z("bot",z.data.content||"Transfiriendo a un agente..."),Z("system"," Conversacin transferida a humano"),S(!0);break;case"end":Z("system"," Flujo completado"),S(!0);break;default:Z("system",`Nodo desconocido: ${z.type}`);const Ae=q(z.id);Q(Ae)}},I=z=>z&&z.replace(/\{\{(\w+)\}\}/g,(U,L)=>x[L]||U),Z=(z,U)=>{d(L=>[...L,{type:z,text:U,time:new Date}])},te=z=>new Promise(U=>setTimeout(U,z)),$=()=>{if(!m.trim())return;const z=m.trim();p(""),Z("user",z),S(!1);const U=M(g);if(U?.type==="question"&&U.data.variable){let L=z;if(U.data.options){const W=U.data.options.find(B=>B.label.toLowerCase()===z.toLowerCase()||B.value===z);W&&(L=W.value)}b(W=>({...W,[U.data.variable]:L})),Z("system",` Variable "${U.data.variable}" = "${L}"`),setTimeout(()=>{const W=q(g);Q(W)},300)}else if(!g){const L=H();L?Q(L):Z("system"," No hay nodo Trigger en el flujo")}},G=z=>{p(z.label),setTimeout(()=>$(),100)},O=z=>{z.key==="Enter"&&!z.shiftKey&&(z.preventDefault(),$())};return t?r.jsxs("div",{style:{position:"fixed",right:"20px",bottom:"20px",width:"380px",height:"550px",background:"white",borderRadius:"16px",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",zIndex:1e3,overflow:"hidden"},children:[r.jsxs("div",{style:{background:"linear-gradient(135deg, #075E54 0%, #128C7E 100%)",color:"white",padding:"12px 16px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:600,fontSize:"15px"},children:" Simulador de Chat"}),r.jsx("div",{style:{fontSize:"12px",opacity:.8},children:"Prueba tu flujo aqu"})]}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsx("button",{onClick:D,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"12px"},children:""}),r.jsx("button",{onClick:a,style:{background:"none",border:"none",color:"white",fontSize:"20px",cursor:"pointer",padding:"0 4px"},children:""})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"4px"},children:[r.jsx("button",{onClick:()=>R("local"),style:{flex:1,background:E==="local"?"white":"transparent",color:E==="local"?"#075E54":"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"11px",fontWeight:E==="local"?600:400},children:"Local"}),r.jsx("button",{onClick:()=>R("server"),style:{flex:1,background:E==="server"?"white":"transparent",color:E==="server"?"#075E54":"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"11px",fontWeight:E==="server"?600:400},children:"Servidor"})]})]}),Object.keys(x).length>0&&r.jsxs("div",{style:{background:"#f0fdf4",padding:"8px 16px",fontSize:"11px",borderBottom:"1px solid #e5e7eb"},children:[r.jsx("strong",{children:"Variables:"})," ",Object.entries(x).map(([z,U])=>r.jsxs("span",{style:{background:"#dcfce7",padding:"2px 6px",borderRadius:"4px",marginLeft:"4px"},children:[z,"=",typeof U=="object"?JSON.stringify(U).substring(0,30)+"...":String(U)]},z))]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"16px",background:"#e5ddd5",backgroundImage:'url("data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%239C92AC" fill-opacity="0.05"%3E%3Cpath d="M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")'},children:[u.map((z,U)=>r.jsx(KA,{message:z,onOptionClick:G},U)),T&&r.jsx("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"8px"},children:r.jsxs("div",{style:{background:"white",padding:"12px 16px",borderRadius:"12px 12px 12px 0",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",display:"flex",gap:"4px"},children:[r.jsx("span",{className:"typing-dot",style:{width:"8px",height:"8px",background:"#90a3ae",borderRadius:"50%",animation:"typing 1.4s infinite ease-in-out",animationDelay:"0s"}}),r.jsx("span",{className:"typing-dot",style:{width:"8px",height:"8px",background:"#90a3ae",borderRadius:"50%",animation:"typing 1.4s infinite ease-in-out",animationDelay:"0.2s"}}),r.jsx("span",{className:"typing-dot",style:{width:"8px",height:"8px",background:"#90a3ae",borderRadius:"50%",animation:"typing 1.4s infinite ease-in-out",animationDelay:"0.4s"}})]})}),r.jsx("div",{ref:w})]}),r.jsxs("div",{style:{padding:"12px",background:"#f0f2f5",display:"flex",gap:"8px"},children:[r.jsx("input",{type:"text",value:m,onChange:z=>p(z.target.value),onKeyPress:O,placeholder:j?"Escribe un mensaje...":"Esperando respuesta...",disabled:!j,style:{flex:1,padding:"10px 16px",border:"none",borderRadius:"24px",fontSize:"14px",outline:"none"}}),r.jsx("button",{onClick:$,disabled:!j||!m.trim(),style:{background:"#25D366",color:"white",border:"none",borderRadius:"50%",width:"40px",height:"40px",cursor:j&&m.trim()?"pointer":"not-allowed",opacity:j&&m.trim()?1:.5,fontSize:"18px"},children:""})]})]}):null}function KA({message:t,onOptionClick:a}){const{type:s,text:o}=t,c=d=>typeof d=="object"&&d!==null?JSON.stringify(d,null,2):String(d);if(s==="system")return r.jsx("div",{style:{textAlign:"center",margin:"8px 0",fontSize:"11px",color:"#667781",background:"rgba(255,255,255,0.8)",padding:"4px 12px",borderRadius:"8px",display:"inline-block",width:"100%"},children:c(o)});if(s==="options")return r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",margin:"8px 0"},children:o.map((d,m)=>r.jsx("button",{onClick:()=>a(d),style:{background:"white",border:"1px solid #25D366",color:"#25D366",padding:"8px 16px",borderRadius:"16px",cursor:"pointer",fontSize:"13px",fontWeight:500},children:d.label},m))});const u=s==="user";return r.jsx("div",{style:{display:"flex",justifyContent:u?"flex-end":"flex-start",marginBottom:"8px"},children:r.jsx("div",{style:{maxWidth:"80%",padding:"8px 12px",borderRadius:u?"12px 12px 0 12px":"12px 12px 12px 0",background:u?"#dcf8c6":"white",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",fontSize:"14px",lineHeight:"1.4",whiteSpace:"pre-wrap"},children:c(o)})})}const mh=[{title:"Bienvenido al Flow Builder!",description:"Crea flujos de conversacin para tu chatbot de WhatsApp de forma visual, sin escribir cdigo.",icon:"",image:null},{title:"Arrastra nodos al canvas",description:"En la barra izquierda encontrars los nodos disponibles. Arrstralos al canvas para construir tu flujo.",icon:"",tips:[" Mensaje: Enva un texto al usuario"," Pregunta: Espera una respuesta del usuario"," Condicin: Bifurca el flujo segn una variable"," Accin: Ejecuta una accin (notificar, guardar, etc.)"]},{title:"Conecta los nodos",description:"Arrastra desde el punto verde (salida) de un nodo hasta el punto gris (entrada) de otro para conectarlos.",icon:"",tips:["El flujo siempre empieza en el Trigger","Puedes tener mltiples caminos con Condiciones","Termina con un nodo Fin o Transferir"]},{title:"Configura cada nodo",description:"Haz clic en un nodo para ver sus propiedades a la derecha. Ah puedes editar el contenido, opciones y variables.",icon:"",tips:["Usa {{variable}} para insertar datos dinmicos","Las preguntas guardan la respuesta en una variable","Las condiciones evalan esas variables"]},{title:"Guarda y activa!",description:"Cuando termines, guarda tu flujo y actvalo para que empiece a responder mensajes automticamente.",icon:"",tips:["Puedes tener varios flujos, pero solo algunos activos",'Usa "Abrir" para cargar flujos guardados',"Las plantillas te dan flujos de ejemplo para empezar"]}];function JA({onComplete:t}){const[a,s]=N.useState(0),[o,c]=N.useState(!1),u=mh[a],d=a===mh.length-1,m=()=>{d?c(!0):s(a+1)},p=()=>{t(null)},g=y=>{t(y)};return o?r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"600px",width:"90%"},children:[r.jsx("h2",{style:{margin:"0 0 8px 0",fontSize:"24px"},children:"Cmo quieres empezar?"}),r.jsx("p",{style:{color:"#6b7280",margin:"0 0 24px 0"},children:"Puedes empezar desde cero o usar una plantilla predefinida"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[r.jsx(Nc,{icon:"",title:"Empezar vaco",description:"Canvas en blanco para crear tu propio flujo",onClick:()=>g(null)}),r.jsx(Nc,{icon:"",title:"Embudo de Ventas",description:"Califica leads y gualos a la compra",onClick:()=>g("sales_funnel"),color:"#25D366"}),r.jsx(Nc,{icon:"",title:"Embudo de Soporte",description:"Resuelve dudas con FAQ y escala a humanos",onClick:()=>g("support_funnel"),color:"#34B7F1"}),r.jsx(Nc,{icon:"",title:"Captura de Leads",description:"Recolecta informacin de contacto",onClick:()=>g("lead_capture"),color:"#f59e0b"})]}),r.jsx("button",{onClick:()=>g(null),style:{marginTop:"16px",padding:"8px",background:"none",border:"none",color:"#6b7280",cursor:"pointer",fontSize:"13px",width:"100%"},children:"Saltar y empezar vaco "})]})}):r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"90%",textAlign:"center"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"8px",marginBottom:"24px"},children:mh.map((y,x)=>r.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:x===a?"#25D366":"#e5e7eb",transition:"background 0.2s"}},x))}),r.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:u.icon}),r.jsx("h2",{style:{margin:"0 0 12px 0",fontSize:"24px",color:"#111827"},children:u.title}),r.jsx("p",{style:{color:"#6b7280",margin:"0 0 20px 0",lineHeight:"1.6"},children:u.description}),u.tips&&r.jsx("div",{style:{background:"#f9fafb",borderRadius:"8px",padding:"16px",textAlign:"left",marginBottom:"24px"},children:u.tips.map((y,x)=>r.jsx("div",{style:{fontSize:"13px",color:"#4b5563",marginBottom:x<u.tips.length-1?"8px":0},children:y},x))}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:p,style:{padding:"12px 24px",background:"white",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"14px",color:"#6b7280"},children:"Saltar"}),r.jsx("button",{onClick:m,style:{padding:"12px 24px",background:"#25D366",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:d?"Empezar":"Siguiente"})]})]})})}function Nc({icon:t,title:a,description:s,onClick:o,color:c}){return r.jsxs("div",{onClick:o,style:{padding:"16px",border:"2px solid #e5e7eb",borderRadius:"12px",cursor:"pointer",transition:"all 0.2s",textAlign:"left"},onMouseOver:u=>{u.currentTarget.style.borderColor=c||"#25D366",u.currentTarget.style.transform="translateY(-2px)"},onMouseOut:u=>{u.currentTarget.style.borderColor="#e5e7eb",u.currentTarget.style.transform="none"},children:[r.jsx("div",{style:{fontSize:"28px",marginBottom:"8px"},children:t}),r.jsx("div",{style:{fontWeight:600,fontSize:"14px",marginBottom:"4px"},children:a}),r.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:s})]})}function ek(){const{id:t}=Qj(),[a,s]=N.useState(!1),[o,c]=N.useState(!1),[u,d]=N.useState(null),[m,p]=N.useState(!1),{loadFlow:g}=ri();N.useEffect(()=>{t?y(t):localStorage.getItem("flowbuilder_onboarding_seen")||c(!0)},[t]);const y=async j=>{p(!0);try{const S=await Ch(j);if(S.flow)g(S.flow),x(`Flujo "${S.flow.name}" cargado correctamente`,"success");else throw new Error("No se pudo obtener los datos del flujo")}catch(S){console.error("Error loading flow:",S),x(`Error al cargar flujo: ${S.message}`,"error")}finally{p(!1)}},x=(j,S="info")=>{d({message:j,type:S}),setTimeout(()=>d(null),4e3)},b=async j=>{if(localStorage.setItem("flowbuilder_onboarding_seen","true"),c(!1),j){p(!0);try{console.log("Creating flow from template:",j);const S=await o1(j,null);if(console.log("Template created, result:",S),S.id){const C=await Ch(S.id);if(console.log("Flow data loaded:",C),C.flow)g(C.flow),x(`Flujo "${C.flow.name}" cargado correctamente`,"success");else throw new Error("No se pudo obtener los datos del flujo")}else throw new Error("No se recibi el ID del flujo creado")}catch(S){console.error("Error loading template:",S),x(`Error al cargar template: ${S.message}`,"error")}finally{p(!1)}}};return r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[r.jsx(UA,{onTestClick:()=>s(!0)}),r.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[r.jsx(YA,{}),r.jsx(GA,{}),r.jsx(ZA,{})]}),r.jsxs("button",{onClick:()=>s(!0),style:{position:"fixed",right:"20px",bottom:"20px",background:"linear-gradient(135deg, #075E54 0%, #25D366 100%)",color:"white",border:"none",borderRadius:"50px",padding:"14px 24px",cursor:"pointer",boxShadow:"0 4px 15px rgba(37, 211, 102, 0.4)",fontSize:"14px",fontWeight:600,display:a?"none":"flex",alignItems:"center",gap:"8px",zIndex:100},children:[r.jsx("span",{style:{fontSize:"18px"},children:""}),"Probar flujo"]}),m&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:r.jsxs("div",{style:{background:"white",padding:"24px 32px",borderRadius:"12px",display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx("div",{style:{width:"24px",height:"24px",border:"3px solid #e5e7eb",borderTop:"3px solid #25D366",borderRadius:"50%",animation:"spin 1s linear infinite"}}),r.jsx("span",{children:"Cargando flujo..."})]})}),u&&r.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",padding:"12px 20px",borderRadius:"8px",background:u.type==="success"?"#10b981":u.type==="error"?"#ef4444":"#3b82f6",color:"white",fontWeight:500,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1002,animation:"slideIn 0.3s ease"},children:[u.type==="success"&&" ",u.type==="error"&&" ",u.message]}),r.jsx(WA,{isOpen:a,onClose:()=>s(!1)}),o&&r.jsx(JA,{onComplete:b})]})}const Mm="/api/flow-logs";async function Am(t,a){if(!t.ok){let s=a;try{const o=await t.json();o.error&&(s=o.error)}catch{}throw new Error(s)}return t.json()}async function tk(t={}){const a=new URLSearchParams(t).toString(),s=await fetch(`${Mm}?${a}`);return Am(s,"Error al cargar logs")}async function nk(t){const a=await fetch(`${Mm}/${t}`);return Am(a,"Log no encontrado")}async function ak(t=7){const a=await fetch(`${Mm}/stats/summary?days=${t}`);return Am(a,"Error al cargar estadsticas")}const io={completed:{label:"Completado",color:"#10b981",icon:qc},failed:{label:"Fallido",color:"#ef4444",icon:Jh},transferred:{label:"Transferido",color:"#f59e0b",icon:Zh},running:{label:"En progreso",color:"#3b82f6",icon:ns},timeout:{label:"Timeout",color:"#6b7280",icon:qr}};function sk(){const[t,a]=N.useState([]),[s,o]=N.useState(null),[c,u]=N.useState(!0),[d,m]=N.useState(null),[p,g]=N.useState(!1),[y,x]=N.useState({status:"",phone:"",flow_id:""});N.useEffect(()=>{b()},[]);const b=async()=>{u(!0);try{const[_,E]=await Promise.all([tk({limit:50,...y}),ak(7)]);a(_.logs||[]),o(E.stats)}catch(_){console.error("Error loading logs:",_)}finally{u(!1)}},j=async _=>{g(!0);try{const E=await nk(_.id);m(E.log)}catch(E){console.error("Error loading log detail:",E)}finally{g(!1)}},S=(_,E)=>{x(R=>({...R,[_]:E}))},C=()=>{b()};return c?r.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Logs de Ejecucin"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Historial de ejecucin de flujos"})]}),r.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 transition",children:[r.jsx(os,{className:"w-4 h-4"}),"Actualizar"]})]}),s&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Total ejecuciones"}),r.jsx("p",{className:"text-2xl font-bold text-gray-800",children:s.total_executions||0}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"ltimos 7 das"})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Tasa de completado"}),r.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[s.completion_rate||0,"%"]}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[s.completed||0," completados"]})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Fallidos"}),r.jsx("p",{className:"text-2xl font-bold text-red-500",children:s.failed||0}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Requieren atencin"})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo promedio"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.avg_duration_ms?`${Math.round(s.avg_duration_ms)}ms`:"-"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Por ejecucin"})]})]}),r.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm mb-6",children:r.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(tm,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Filtrar:"})]}),r.jsxs("select",{value:y.status,onChange:_=>S("status",_.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:"completed",children:"Completados"}),r.jsx("option",{value:"failed",children:"Fallidos"}),r.jsx("option",{value:"transferred",children:"Transferidos"}),r.jsx("option",{value:"running",children:"En progreso"})]}),r.jsx("input",{type:"text",value:y.phone,onChange:_=>S("phone",_.target.value),placeholder:"Telfono...",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none w-40"}),r.jsx("button",{onClick:C,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm transition",children:"Aplicar"})]})}),r.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:t.length===0?r.jsxs("div",{className:"p-12 text-center text-gray-400",children:[r.jsx(ns,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"No hay logs de ejecucin"}),r.jsx("p",{className:"text-sm mt-1",children:"Los logs aparecern cuando se ejecuten flujos"})]}):r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left text-xs text-gray-500 uppercase tracking-wider",children:[r.jsx("th",{className:"px-4 py-3",children:"Fecha"}),r.jsx("th",{className:"px-4 py-3",children:"Flujo"}),r.jsx("th",{className:"px-4 py-3",children:"Telfono"}),r.jsx("th",{className:"px-4 py-3",children:"Estado"}),r.jsx("th",{className:"px-4 py-3",children:"Nodos"}),r.jsx("th",{className:"px-4 py-3",children:"Duracin"}),r.jsx("th",{className:"px-4 py-3"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(_=>{const E=io[_.status]||io.running,R=E.icon;return r.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[r.jsxs("td",{className:"px-4 py-3 text-sm",children:[r.jsx("div",{className:"text-gray-800",children:uu(new Date(_.started_at),"dd/MM HH:mm")}),r.jsx("div",{className:"text-xs text-gray-400",children:ai(new Date(_.started_at),{addSuffix:!0,locale:is})})]}),r.jsxs("td",{className:"px-4 py-3",children:[r.jsx("div",{className:"font-medium text-gray-800",children:_.flow_name||"Sin nombre"}),r.jsx("div",{className:"text-xs text-gray-400",children:_.trigger_type})]}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ru,{className:"w-3 h-3 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-700",children:_.phone})]})}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{background:`${E.color}20`,color:E.color},children:[r.jsx(R,{className:"w-3 h-3"}),E.label]})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:_.total_nodes_executed||0}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:_.total_duration_ms?`${Math.round(_.total_duration_ms)}ms`:"-"}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("button",{onClick:()=>j(_),className:"p-2 hover:bg-gray-100 rounded-lg transition",title:"Ver detalle",children:r.jsx(To,{className:"w-4 h-4 text-gray-400"})})})]},_.id)})})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>m(null),children:r.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[80vh] overflow-auto m-4",onClick:_=>_.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:"Detalle de Ejecucin"}),r.jsx("button",{onClick:()=>m(null),className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(qn,{className:"w-4 h-4"})})]}),p?r.jsx("div",{className:"p-8 text-center",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"})}):r.jsxs("div",{className:"p-4 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Flujo"}),r.jsx("p",{className:"font-medium",children:d.flow_name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Telfono"}),r.jsx("p",{className:"font-medium",children:d.phone})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Mensaje trigger"}),r.jsx("p",{className:"text-sm bg-gray-100 p-2 rounded",children:d.trigger_message||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Estado final"}),r.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{background:`${io[d.status]?.color}20`,color:io[d.status]?.color},children:io[d.status]?.label})]})]}),d.variables&&Object.keys(d.variables).length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Variables capturadas"}),r.jsx("div",{className:"bg-gray-50 rounded-lg p-3 space-y-1",children:Object.entries(d.variables).map(([_,E])=>r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsxs("span",{className:"font-mono text-purple-600",children:[_,":"]}),r.jsx("span",{className:"text-gray-700",children:String(E)})]},_))})]}),d.steps&&d.steps.length>0&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Nodos ejecutados"}),r.jsx("div",{className:"space-y-2",children:d.steps.map((_,E)=>r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-xs font-medium",children:E+1}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium text-sm",children:_.node_id}),r.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-200 rounded text-gray-600",children:_.node_type}),r.jsxs("span",{className:"text-xs text-gray-400",children:[_.duration_ms,"ms"]})]}),_.output&&r.jsx("p",{className:"text-sm text-gray-600 mt-1 break-words",children:_.output})]})]},E))})]}),d.error_message&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[r.jsx("p",{className:"text-xs text-red-600 font-medium mb-1",children:"Error"}),r.jsx("p",{className:"text-sm text-red-700",children:d.error_message}),d.error_node_id&&r.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["En nodo: ",d.error_node_id]})]})]})]})})]})}const _u="/api/leads";async function Eu(t,a){if(!t.ok){let s=a;try{const o=await t.json();o.error&&(s=o.error)}catch{}throw new Error(s)}return t.json()}async function rk(t={}){const a=new URLSearchParams(t).toString(),s=await fetch(`${_u}?${a}`);return Eu(s,"Error al cargar leads")}async function ik(){const t=await fetch(`${_u}/stats`);return Eu(t,"Error al cargar estadsticas")}async function ok(t,a){const s=await fetch(`${_u}/${encodeURIComponent(t)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return Eu(s,"Error al actualizar lead")}async function lk(t,a,s){const o=await fetch(`${_u}/${encodeURIComponent(t)}/adjust-score`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adjustment:a,reason:s})});return Eu(o,"Error al ajustar score")}const Sc={new:{label:"Nuevo",color:"#6b7280",bg:"#f3f4f6"},engaged:{label:"Interesado",color:"#3b82f6",bg:"#dbeafe"},qualified:{label:"Calificado",color:"#10b981",bg:"#d1fae5"},customer:{label:"Cliente",color:"#8b5cf6",bg:"#ede9fe"},inactive:{label:"Inactivo",color:"#9ca3af",bg:"#f9fafb"}},ab={hot:{color:"#ef4444",label:"Caliente",range:"80-100"},warm:{color:"#f59e0b",label:"Tibio",range:"50-79"},cold:{color:"#3b82f6",label:"Fro",range:"20-49"},new:{color:"#6b7280",label:"Nuevo",range:"0-19"}};function ck(t){return t>=80?"hot":t>=50?"warm":t>=20?"cold":"new"}function uk(){const t=Ys(),[a,s]=N.useState([]),[o,c]=N.useState(null),[u,d]=N.useState(!0),[m,p]=N.useState(null),[g,y]=N.useState({status:"",min_score:"",search:"",sort_by:"current_score",sort_dir:"desc"});N.useEffect(()=>{x()},[]);const x=async()=>{d(!0);try{const[_,E]=await Promise.all([rk({limit:100,...g}),ik()]);s(_.leads||[]),c(E)}catch(_){console.error("Error loading leads:",_)}finally{d(!1)}},b=(_,E)=>{y(R=>({...R,[_]:E}))},j=()=>{x()},S=async(_,E)=>{try{await ok(_,{status:E}),x()}catch(R){console.error("Error updating lead:",R)}},C=async(_,E)=>{try{await lk(_,E,"Manual adjustment"),x()}catch(R){console.error("Error adjusting score:",R)}};return u?r.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Gestin de Leads"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Administra y califica tus leads"})]}),r.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 transition",children:[r.jsx(os,{className:"w-4 h-4"}),"Actualizar"]})]}),o&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Total Leads"}),r.jsx("p",{className:"text-2xl font-bold text-gray-800",children:o.stats?.total_leads||0})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Score Promedio"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o.stats?.avg_score||0})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Nuevos"}),r.jsx("p",{className:"text-2xl font-bold text-gray-600",children:o.stats?.new_leads||0})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Calificados"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:o.stats?.qualified_leads||0})]}),r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Clientes"}),r.jsx("p",{className:"text-2xl font-bold text-purple-600",children:o.stats?.customers||0})]})]}),o?.score_distribution&&r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm mb-6",children:[r.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Distribucin de Scores"}),r.jsx("div",{className:"flex gap-4",children:Object.entries(ab).map(([_,E])=>{const R=o.score_distribution.find(T=>T.category===_)?.count||0;return r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:E.color}}),r.jsxs("span",{className:"text-sm text-gray-600",children:[E.label,": ",r.jsx("strong",{children:R})]})]},_)})})]}),r.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm mb-6",children:r.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(tm,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Filtrar:"})]}),r.jsxs("div",{className:"relative",children:[r.jsx(sm,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),r.jsx("input",{type:"text",value:g.search,onChange:_=>b("search",_.target.value),placeholder:"Buscar...",className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none w-48"})]}),r.jsxs("select",{value:g.status,onChange:_=>b("status",_.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:"",children:"Todos los estados"}),Object.entries(Sc).map(([_,E])=>r.jsx("option",{value:_,children:E.label},_))]}),r.jsxs("select",{value:g.min_score,onChange:_=>b("min_score",_.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:"",children:"Todos los scores"}),r.jsx("option",{value:"80",children:"Score 80+ (Caliente)"}),r.jsx("option",{value:"50",children:"Score 50+ (Tibio)"}),r.jsx("option",{value:"20",children:"Score 20+ (Fro)"})]}),r.jsxs("select",{value:`${g.sort_by}-${g.sort_dir}`,onChange:_=>{const[E,R]=_.target.value.split("-");b("sort_by",E),b("sort_dir",R)},className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:"current_score-desc",children:"Mayor score"}),r.jsx("option",{value:"current_score-asc",children:"Menor score"}),r.jsx("option",{value:"last_interaction-desc",children:"Ms reciente"}),r.jsx("option",{value:"total_messages-desc",children:"Ms mensajes"})]}),r.jsx("button",{onClick:j,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm transition",children:"Aplicar"})]})}),r.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:a.length===0?r.jsxs("div",{className:"p-12 text-center text-gray-400",children:[r.jsx(lu,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"No hay leads registrados"}),r.jsx("p",{className:"text-sm mt-1",children:"Los leads se crean automticamente cuando interactan"})]}):r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 text-left text-xs text-gray-500 uppercase tracking-wider",children:[r.jsx("th",{className:"px-4 py-3",children:"Lead"}),r.jsx("th",{className:"px-4 py-3",children:"Score"}),r.jsx("th",{className:"px-4 py-3",children:"Estado"}),r.jsx("th",{className:"px-4 py-3",children:"Mensajes"}),r.jsx("th",{className:"px-4 py-3",children:"ltima actividad"}),r.jsx("th",{className:"px-4 py-3",children:"Acciones"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:a.map(_=>{const E=ck(_.current_score),R=ab[E],T=Sc[_.status]||Sc.new;return r.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-green-600 font-medium",children:_.contact_name?.[0]?.toUpperCase()||_.phone.slice(-2)})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-800",children:_.contact_name||"Sin nombre"}),r.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[r.jsx(ru,{className:"w-3 h-3"}),_.phone]})]})]})}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm",style:{background:`${R.color}20`,color:R.color},children:_.current_score}),r.jsxs("div",{className:"flex flex-col gap-0.5",children:[r.jsx("button",{onClick:()=>C(_.phone,5),className:"p-1 hover:bg-green-100 rounded text-green-600",title:"+5 puntos",children:r.jsx(am,{className:"w-3 h-3"})}),r.jsx("button",{onClick:()=>C(_.phone,-5),className:"p-1 hover:bg-red-100 rounded text-red-600",title:"-5 puntos",children:r.jsx(Rb,{className:"w-3 h-3"})})]})]})}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("select",{value:_.status,onChange:A=>S(_.phone,A.target.value),className:"px-2 py-1 rounded-full text-xs font-medium border-0 cursor-pointer",style:{background:T.bg,color:T.color},children:Object.entries(Sc).map(([A,w])=>r.jsx("option",{value:A,children:w.label},A))})}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[r.jsx(qt,{className:"w-4 h-4"}),_.total_messages||_.message_count||0]})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:_.last_interaction?ai(new Date(_.last_interaction),{addSuffix:!0,locale:is}):"-"}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("button",{onClick:()=>t(`/conversations?phone=${encodeURIComponent(_.phone)}`),className:"p-2 hover:bg-gray-100 rounded-lg transition",title:"Ver conversacin",children:r.jsx(To,{className:"w-4 h-4 text-gray-400"})})})]},_.phone)})})]})})]})}const $o="/api/flow-analytics";async function qo(t,a){if(!t.ok){let s=a;try{const o=await t.json();o.error&&(s=o.error)}catch{}throw new Error(s)}return t.json()}async function dk(t=7){const a=await fetch(`${$o}/summary?days=${t}`);return qo(a,"Error al cargar resumen")}async function fk(t=14){const a=await fetch(`${$o}/timeline?days=${t}`);return qo(a,"Error al cargar timeline")}async function hk(t=7){const a=await fetch(`${$o}/by-flow?days=${t}`);return qo(a,"Error al cargar mtricas por flujo")}async function mk(t=7){const a=await fetch(`${$o}/by-hour?days=${t}`);return qo(a,"Error al cargar distribucin horaria")}async function pk(t=7){const a=await fetch(`${$o}/trigger-types?days=${t}`);return qo(a,"Error al cargar tipos de trigger")}function gk(){const[t,a]=N.useState(null),[s,o]=N.useState([]),[c,u]=N.useState([]),[d,m]=N.useState([]),[p,g]=N.useState([]),[y,x]=N.useState(!0),[b,j]=N.useState(7);N.useEffect(()=>{S()},[b]);const S=async()=>{x(!0);try{const[E,R,T,A,w]=await Promise.all([dk(b),fk(b),hk(b),mk(b),pk(b)]);a(E.summary),o(R.timeline||[]),u(T.flows||[]),m(A.hourly||[]),g(w.trigger_types||[])}catch(E){console.error("Error loading analytics:",E)}finally{x(!1)}};if(y)return r.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})});const C=Math.max(...s.map(E=>E.total),1),_=Math.max(...d.map(E=>E.executions),1);return r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Analytics de Flujos"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Mtricas y anlisis de rendimiento"})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("select",{value:b,onChange:E=>j(parseInt(E.target.value)),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",children:[r.jsx("option",{value:7,children:"ltimos 7 das"}),r.jsx("option",{value:14,children:"ltimos 14 das"}),r.jsx("option",{value:30,children:"ltimos 30 das"})]}),r.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 transition",children:[r.jsx(os,{className:"w-4 h-4"}),"Actualizar"]})]})]}),t&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[r.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Total Ejecuciones"}),r.jsx("p",{className:"text-3xl font-bold text-gray-800 mt-1",children:t.executions.total}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.executions.unique_users," usuarios nicos"]})]}),r.jsx("div",{className:"p-3 bg-blue-50 rounded-xl",children:r.jsx(ns,{className:"w-6 h-6 text-blue-600"})})]})}),r.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Tasa de Completado"}),r.jsxs("p",{className:"text-3xl font-bold text-green-600 mt-1",children:[t.executions.completion_rate,"%"]}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.executions.completed," completados"]})]}),r.jsx("div",{className:"p-3 bg-green-50 rounded-xl",children:r.jsx(qc,{className:"w-6 h-6 text-green-600"})})]})}),r.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Fallidos"}),r.jsx("p",{className:"text-3xl font-bold text-red-500 mt-1",children:t.executions.failed}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.executions.transferred," transferidos"]})]}),r.jsx("div",{className:"p-3 bg-red-50 rounded-xl",children:r.jsx(Jh,{className:"w-6 h-6 text-red-500"})})]})}),r.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo Promedio"}),r.jsxs("p",{className:"text-3xl font-bold text-purple-600 mt-1",children:[t.executions.avg_duration_ms,"ms"]}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.executions.avg_nodes," nodos promedio"]})]}),r.jsx("div",{className:"p-3 bg-purple-50 rounded-xl",children:r.jsx(qr,{className:"w-6 h-6 text-purple-600"})})]})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6 mb-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(Vc,{className:"w-5 h-5 text-gray-400"}),"Ejecuciones por da"]}),s.length===0?r.jsx("div",{className:"text-center text-gray-400 py-8",children:"No hay datos para mostrar"}):r.jsx("div",{className:"flex items-end gap-2 h-40",children:s.map((E,R)=>r.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[r.jsxs("div",{className:"w-full flex flex-col gap-0.5",style:{height:"120px"},children:[r.jsx("div",{className:"w-full bg-green-500 rounded-t",style:{height:`${E.completed/C*100}%`},title:`Completados: ${E.completed}`}),r.jsx("div",{className:"w-full bg-red-400",style:{height:`${E.failed/C*100}%`},title:`Fallidos: ${E.failed}`}),r.jsx("div",{className:"w-full bg-yellow-400 rounded-b",style:{height:`${E.transferred/C*100}%`},title:`Transferidos: ${E.transferred}`})]}),r.jsx("div",{className:"text-xs text-gray-400 mt-2",children:uu(new Date(E.date),"dd/MM")})]},R))}),r.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-gray-100",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-green-500"}),r.jsx("span",{className:"text-xs text-gray-500",children:"Completados"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-red-400"}),r.jsx("span",{className:"text-xs text-gray-500",children:"Fallidos"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-yellow-400"}),r.jsx("span",{className:"text-xs text-gray-500",children:"Transferidos"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(nm,{className:"w-5 h-5 text-gray-400"}),"Rendimiento por Flujo"]}),c.length===0?r.jsx("div",{className:"text-center text-gray-400 py-8",children:"No hay flujos configurados"}):r.jsx("div",{className:"space-y-3",children:c.slice(0,5).map((E,R)=>r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center text-sm font-medium text-gray-600",children:R+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-medium text-gray-800 truncate",children:E.flow_name}),r.jsxs("span",{className:"text-sm text-gray-500",children:[E.recent_executions," ejecuciones"]})]}),r.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[r.jsx("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-green-500",style:{width:`${E.completion_rate}%`}})}),r.jsxs("span",{className:"text-xs text-gray-400",children:[E.completion_rate,"%"]})]})]})]},E.flow_id))}),r.jsx(Ds,{to:"/flows",className:"block text-center text-sm text-green-600 hover:text-green-700 mt-4 pt-4 border-t border-gray-100",children:"Ver todos los flujos"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(qr,{className:"w-5 h-5 text-gray-400"}),"Actividad por Hora"]}),r.jsx("div",{className:"flex items-end gap-1 h-32",children:d.map((E,R)=>r.jsx("div",{className:"flex-1 bg-blue-500 rounded-t transition-all hover:bg-blue-600",style:{height:`${E.executions/_*100}%`,minHeight:E.executions>0?"4px":"0"},title:`${E.hour}:00 - ${E.executions} ejecuciones`},R))}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[r.jsx("span",{children:"00:00"}),r.jsx("span",{children:"06:00"}),r.jsx("span",{children:"12:00"}),r.jsx("span",{children:"18:00"}),r.jsx("span",{children:"23:00"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(Kh,{className:"w-5 h-5 text-gray-400"}),"Distribucin por Tipo de Trigger"]}),p.length===0?r.jsx("div",{className:"text-center text-gray-400 py-8",children:"No hay datos de triggers"}):r.jsx("div",{className:"flex gap-6",children:p.map((E,R)=>{const T=["#10b981","#3b82f6","#f59e0b","#8b5cf6","#ec4899"],A=T[R%T.length],w=p.reduce((M,q)=>M+q.count,0),D=w>0?Math.round(E.count/w*100):0;return r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2",style:{background:`${A}20`},children:r.jsxs("span",{className:"text-xl font-bold",style:{color:A},children:[D,"%"]})}),r.jsx("p",{className:"text-sm font-medium text-gray-800 capitalize",children:E.trigger_type}),r.jsxs("p",{className:"text-xs text-gray-400",children:[E.count," ejecuciones"]})]},E.trigger_type)})})]})]})}function xk(){const[t,a]=N.useState([]),[s,o]=N.useState(null),[c,u]=N.useState({running:0,connectedMonitors:0}),[d,m]=N.useState(!1);return N.useEffect(()=>{const p=new EventSource("/api/flow-monitor/stream");return p.onopen=()=>m(!0),p.onerror=()=>m(!1),p.onmessage=g=>{const y=JSON.parse(g.data);switch(y.type){case"connected":u({running:y.activeCount,connectedMonitors:0});break;case"active_execution":a(x=>x.find(j=>j.executionId===y.executionId)?x:[y,...x]);break;case"flow_started":a(x=>[y,...x]);break;case"node_started":case"node_completed":a(x=>x.map(b=>b.executionId===y.executionId?{...b,currentNodeId:y.nodeId,currentNodeType:y.nodeType,variables:y.variables,steps:y.type==="node_completed"?[...b.steps||[],{nodeId:y.nodeId,nodeType:y.nodeType,durationMs:y.durationMs,status:y.status,timestamp:y.timestamp}]:b.steps}:b));break;case"flow_completed":case"flow_error":case"flow_transferred":a(x=>x.map(b=>b.executionId===y.executionId?{...b,status:y.type.replace("flow_",""),completedAt:y.timestamp}:b));break}},()=>p.close()},[]),r.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[r.jsx("header",{className:"bg-white border-b px-6 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Monitor de Flujos"}),r.jsx("p",{className:"text-gray-500",children:"Tiempo real"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${d?"bg-green-500":"bg-red-500"}`}),r.jsx("span",{className:"text-sm text-gray-600",children:d?"Conectado":"Desconectado"})]}),r.jsxs("div",{className:"text-sm text-gray-600",children:[t.filter(p=>!p.status).length," ejecuciones activas"]})]})]})}),r.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[r.jsxs("aside",{className:"w-80 bg-white border-r overflow-y-auto",children:[r.jsx("div",{className:"p-4 border-b",children:r.jsx("h2",{className:"font-semibold text-gray-700",children:"Ejecuciones"})}),r.jsx("div",{className:"divide-y",children:t.length===0?r.jsx("div",{className:"p-8 text-center text-gray-400",children:"Sin ejecuciones"}):t.map(p=>r.jsx("button",{onClick:()=>o(p),className:`w-full p-4 text-left hover:bg-gray-50 transition ${s?.executionId===p.executionId?"bg-green-50":""}`,children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(ru,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),r.jsx("span",{className:"font-mono text-sm text-gray-700 truncate",children:p.phone})]}),r.jsx("p",{className:"text-xs text-gray-500 truncate mb-1",children:p.flowName||p.flowSlug}),p.currentNodeId&&r.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[r.jsx(ns,{className:"w-3 h-3 text-green-500"}),r.jsx("span",{className:"text-gray-600",children:p.currentNodeId})]})]}),r.jsxs("div",{children:[p.status==="completed"&&r.jsx(qc,{className:"w-5 h-5 text-green-500"}),p.status==="error"&&r.jsx(Jh,{className:"w-5 h-5 text-red-500"}),p.status==="transferred"&&r.jsx(Bs,{className:"w-5 h-5 text-yellow-500"}),!p.status&&r.jsx(ns,{className:"w-5 h-5 text-green-500 animate-pulse"})]})]})},p.executionId))})]}),r.jsx("main",{className:"flex-1 flex",children:s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex-1 p-6 overflow-auto",children:r.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-700 mb-4",children:"Ejecucin del Flujo"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Flujo:"}),r.jsx("p",{className:"font-medium",children:s.flowName})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Telfono:"}),r.jsx("p",{className:"font-mono text-sm",children:s.phone})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Nodo Actual:"}),r.jsx("p",{className:"font-mono text-sm",children:s.currentNodeId||"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Tipo de Nodo:"}),r.jsx("p",{className:"font-mono text-sm",children:s.currentNodeType||"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),r.jsxs("p",{className:"font-medium",children:[s.status==="completed"&&"Completado ",s.status==="error"&&"Error ",s.status==="transferred"&&"Transferido ",!s.status&&"En ejecucin..."]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Iniciado:"}),r.jsx("p",{className:"text-sm",children:s.timestamp?new Date(s.timestamp).toLocaleString("es-CL"):"N/A"})]}),s.completedAt&&r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Completado:"}),r.jsx("p",{className:"text-sm",children:new Date(s.completedAt).toLocaleString("es-CL")})]})]})]})}),r.jsxs("aside",{className:"w-96 bg-white border-l overflow-y-auto",children:[r.jsx("div",{className:"p-4 border-b",children:r.jsx("h2",{className:"font-semibold text-gray-700",children:"Detalles"})}),r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Variables"}),r.jsx("div",{className:"bg-gray-50 rounded p-3 font-mono text-xs",children:r.jsx("pre",{className:"whitespace-pre-wrap break-words",children:JSON.stringify(s.variables||{},null,2)})})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Timeline"}),r.jsx("div",{className:"space-y-2",children:s.steps&&s.steps.length>0?s.steps.map((p,g)=>r.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[r.jsx(qc,{className:"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium text-gray-700",children:p.nodeId}),r.jsxs("p",{className:"text-gray-500",children:[p.nodeType,"  ",p.durationMs,"ms"]}),p.timestamp&&r.jsx("p",{className:"text-gray-400",children:new Date(p.timestamp).toLocaleTimeString("es-CL")})]})]},g)):r.jsx("p",{className:"text-gray-400 text-sm",children:"Sin eventos an"})})]})]})]})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:r.jsxs("div",{className:"text-center",children:[r.jsx(ns,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),r.jsx("p",{children:"Selecciona una ejecucin para ver detalles"})]})})})]})]})}const Rr=()=>{const t=At.getState().token;return{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}}};function yk(){const[t,a]=N.useState([]),[s,o]=N.useState([]),[c,u]=N.useState(!0),[d,m]=N.useState(!1),[p,g]=N.useState(null),[y,x]=N.useState({}),[b,j]=N.useState({username:"",password:"",name:"",email:"",role:"agent",departmentId:"",avatarColor:"#6366f1"}),[S,C]=N.useState(""),[_,E]=N.useState(!1),R=async()=>{try{const[H,Q]=await Promise.all([fetch("/api/agents",{headers:Rr()}),fetch("/api/departments",{headers:Rr()})]),I=await H.json(),Z=await Q.json();I.ok&&a(I.agents),Z.ok&&o(Z.departments)}catch(H){console.error("Error loading data:",H)}finally{u(!1)}};N.useEffect(()=>{R()},[]);const T=()=>{g(null),j({username:"",password:"",name:"",email:"",role:"agent",departmentId:"",avatarColor:"#6366f1"}),C(""),m(!0)},A=H=>{g(H),j({username:H.username,password:"",name:H.name,email:H.email||"",role:H.role,departmentId:H.department_id||"",avatarColor:H.avatar_color||"#6366f1"}),C(""),m(!0)},w=async H=>{H.preventDefault(),C(""),E(!0);try{const Q={name:b.name,email:b.email||null,role:b.role,departmentId:b.departmentId?Number(b.departmentId):null,avatarColor:b.avatarColor};if(p){b.password&&(Q.password=b.password);const Z=await(await fetch(`/api/agents/${p.id}`,{method:"PUT",headers:Rr(),body:JSON.stringify(Q)})).json();if(!Z.ok)throw new Error(Z.error)}else{Q.username=b.username,Q.password=b.password;const Z=await(await fetch("/api/agents",{method:"POST",headers:Rr(),body:JSON.stringify(Q)})).json();if(!Z.ok)throw new Error(Z.error)}m(!1),R()}catch(Q){C(Q.message)}finally{E(!1)}},D=async H=>{if(confirm(`Desactivar agente "${H.name}"?`))try{await fetch(`/api/agents/${H.id}`,{method:"DELETE",headers:Rr()}),R()}catch(Q){alert("Error: "+Q.message)}},M=async H=>{if(confirm(`Regenerar API key de "${H.name}"? La anterior dejara de funcionar.`))try{const I=await(await fetch(`/api/agents/${H.id}/regenerate-api-key`,{method:"POST",headers:Rr()})).json();I.ok&&(R(),alert(`Nueva API key: ${I.apiKey}`))}catch(Q){alert("Error: "+Q.message)}},q=["#6366f1","#22c55e","#ef4444","#f59e0b","#3b82f6","#ec4899","#8b5cf6","#14b8a6","#f97316","#06b6d4"];return c?r.jsx("div",{className:"p-8 flex justify-center",children:r.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full"})}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agentes"}),r.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Gestiona los agentes del sistema"})]}),r.jsxs("button",{onClick:T,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2.5 rounded-lg transition font-medium",children:[r.jsx(Yr,{className:"w-4 h-4"})," Nuevo Agente"]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Agente"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Rol"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Departamento"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Estado"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"API Key"}),r.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Ultimo Login"}),r.jsx("th",{className:"text-right px-6 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Acciones"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-100",children:[t.map(H=>r.jsxs("tr",{className:`hover:bg-gray-50 ${H.status==="inactive"?"opacity-50":""}`,children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-9 h-9 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:H.avatar_color||"#6366f1"},children:r.jsx("span",{className:"text-white text-sm font-medium",children:H.name?.[0]?.toUpperCase()})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900 text-sm",children:H.name}),r.jsxs("p",{className:"text-xs text-gray-400",children:["@",H.username]})]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${H.role==="supervisor"?"bg-purple-50 text-purple-700":"bg-blue-50 text-blue-700"}`,children:[H.role==="supervisor"?r.jsx(ni,{className:"w-3 h-3"}):r.jsx(Bs,{className:"w-3 h-3"}),H.role==="supervisor"?"Supervisor":"Agente"]})}),r.jsx("td",{className:"px-6 py-4",children:H.department_name?r.jsx("span",{className:"text-sm px-2 py-1 rounded-full",style:{backgroundColor:`${H.department_color}20`,color:H.department_color},children:H.department_name}):r.jsx("span",{className:"text-xs text-gray-400",children:"Sin asignar"})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H.status==="active"?"bg-green-50 text-green-700":"bg-gray-100 text-gray-500"}`,children:H.status==="active"?"Activo":"Inactivo"})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("code",{className:"text-xs text-gray-400 font-mono",children:y[H.id]?H.api_key:H.api_key?"":"-"}),H.api_key&&r.jsx("button",{onClick:()=>x(Q=>({...Q,[H.id]:!Q[H.id]})),className:"p-1 text-gray-400 hover:text-gray-600",children:y[H.id]?r.jsx(MS,{className:"w-3 h-3"}):r.jsx(em,{className:"w-3 h-3"})})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"text-xs text-gray-400",children:H.last_login?new Date(H.last_login).toLocaleString("es-CL"):"Nunca"})}),r.jsx("td",{className:"px-6 py-4 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-1",children:[r.jsx("button",{onClick:()=>A(H),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Editar",children:r.jsx(iu,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>M(H),className:"p-2 text-gray-400 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg",title:"Regenerar API Key",children:r.jsx(qS,{className:"w-4 h-4"})}),H.status==="active"&&r.jsx("button",{onClick:()=>D(H),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Desactivar",children:r.jsx(Mo,{className:"w-4 h-4"})})]})})]},H.id)),!t.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"text-center py-12 text-gray-400",children:"No hay agentes. Crea el primero."})})]})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:p?"Editar Agente":"Nuevo Agente"}),S&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4",children:S}),r.jsxs("form",{onSubmit:w,className:"space-y-4",children:[!p&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),r.jsx("input",{type:"text",value:b.username,onChange:H=>j({...b,username:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,minLength:3})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:p?"Nueva Contrasena (dejar vacio para no cambiar)":"Contrasena"}),r.jsx("input",{type:"password",value:b.password,onChange:H=>j({...b,password:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!p,minLength:6})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo"}),r.jsx("input",{type:"text",value:b.name,onChange:H=>j({...b,name:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (opcional)"}),r.jsx("input",{type:"email",value:b.email,onChange:H=>j({...b,email:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),r.jsxs("select",{value:b.role,onChange:H=>j({...b,role:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"agent",children:"Agente"}),r.jsx("option",{value:"supervisor",children:"Supervisor"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),r.jsxs("select",{value:b.departmentId,onChange:H=>j({...b,departmentId:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"",children:"Sin asignar"}),s.filter(H=>H.active).map(H=>r.jsx("option",{value:H.id,children:H.display_name},H.id))]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color avatar"}),r.jsx("div",{className:"flex gap-2",children:q.map(H=>r.jsx("button",{type:"button",onClick:()=>j({...b,avatarColor:H}),className:`w-8 h-8 rounded-full transition ${b.avatarColor===H?"ring-2 ring-offset-2 ring-gray-400":""}`,style:{backgroundColor:H}},H))})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancelar"}),r.jsx("button",{type:"submit",disabled:_,className:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition disabled:opacity-50",children:_?"Guardando...":p?"Guardar":"Crear"})]})]})]})})]})}const _c=()=>{const t=At.getState().token;return{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}}};function bk(){const[t,a]=N.useState([]),[s,o]=N.useState(!0),[c,u]=N.useState(!1),[d,m]=N.useState(null),[p,g]=N.useState({name:"",displayName:"",icon:"MessageSquare",color:"#6f42c1",autoAssignIntents:""}),[y,x]=N.useState(""),[b,j]=N.useState(!1),S=async()=>{try{const D=await(await fetch("/api/departments",{headers:_c()})).json();D.ok&&a(D.departments)}catch(w){console.error("Error loading departments:",w)}finally{o(!1)}};N.useEffect(()=>{S()},[]);const C=()=>{m(null),g({name:"",displayName:"",icon:"MessageSquare",color:"#6f42c1",autoAssignIntents:""}),x(""),u(!0)},_=w=>{m(w);const D=w.auto_assign_intents,M=Array.isArray(D)?D.join(", "):typeof D=="string"?JSON.parse(D||"[]").join(", "):"";g({name:w.name,displayName:w.display_name,icon:w.icon||"MessageSquare",color:w.color||"#6f42c1",autoAssignIntents:M}),x(""),u(!0)},E=async w=>{w.preventDefault(),x(""),j(!0);try{const D=p.autoAssignIntents.split(",").map(M=>M.trim().toLowerCase()).filter(Boolean);if(d){const q=await(await fetch(`/api/departments/${d.id}`,{method:"PUT",headers:_c(),body:JSON.stringify({displayName:p.displayName,icon:p.icon,color:p.color,autoAssignIntents:D})})).json();if(!q.ok)throw new Error(q.error)}else{const q=await(await fetch("/api/departments",{method:"POST",headers:_c(),body:JSON.stringify({name:p.name.toLowerCase().replace(/\s+/g,"_"),displayName:p.displayName,icon:p.icon,color:p.color,autoAssignIntents:D})})).json();if(!q.ok)throw new Error(q.error)}u(!1),S()}catch(D){x(D.message)}finally{j(!1)}},R=async w=>{if(confirm(`Desactivar departamento "${w.display_name}"?`))try{const M=await(await fetch(`/api/departments/${w.id}`,{method:"DELETE",headers:_c()})).json();if(!M.ok)throw new Error(M.error);S()}catch(D){alert("Error: "+D.message)}},T=["#28a745","#17a2b8","#ffc107","#6f42c1","#dc3545","#fd7e14","#20c997","#6610f2","#e83e8c","#007bff"],A=["MessageSquare","ShoppingCart","Wrench","Package","Phone","Mail","Star","Heart","Zap","Globe"];return s?r.jsx("div",{className:"p-8 flex justify-center",children:r.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full"})}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Departamentos"}),r.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Organiza los agentes por area"})]}),r.jsxs("button",{onClick:C,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2.5 rounded-lg transition font-medium",children:[r.jsx(am,{className:"w-4 h-4"})," Nuevo Departamento"]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(w=>{const D=Array.isArray(w.auto_assign_intents)?w.auto_assign_intents:JSON.parse(w.auto_assign_intents||"[]");return r.jsxs("div",{className:`bg-white rounded-xl border-2 p-5 ${w.active?"border-gray-200":"border-gray-100 opacity-50"}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${w.color}20`},children:r.jsx("span",{className:"text-lg",style:{color:w.color},children:w.icon==="ShoppingCart"?"":w.icon==="Wrench"?"":w.icon==="Package"?"":""})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:w.display_name}),r.jsxs("p",{className:"text-xs text-gray-400",children:["@",w.name]})]})]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>_(w),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",children:r.jsx(iu,{className:"w-4 h-4"})}),w.name!=="general"&&w.active&&r.jsx("button",{onClick:()=>R(w),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",children:r.jsx(Mo,{className:"w-4 h-4"})})]})]}),r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsxs("span",{className:"text-xs text-gray-500",children:[w.agent_count||0," agentes"]}),r.jsx("span",{className:"w-1 h-1 bg-gray-300 rounded-full"}),r.jsx("span",{className:`text-xs ${w.active?"text-green-600":"text-gray-400"}`,children:w.active?"Activo":"Inactivo"})]}),D.length>0&&r.jsxs("div",{children:[r.jsxs("p",{className:"text-xs text-gray-400 mb-1.5 flex items-center gap-1",children:[r.jsx(p4,{className:"w-3 h-3"})," Intents auto-asignados:"]}),r.jsx("div",{className:"flex flex-wrap gap-1",children:D.map((M,q)=>r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600",children:M},q))})]})]},w.id)})}),c&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:d?"Editar Departamento":"Nuevo Departamento"}),y&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4",children:y}),r.jsxs("form",{onSubmit:E,className:"space-y-4",children:[!d&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Identificador (slug)"}),r.jsx("input",{type:"text",value:p.name,onChange:w=>g({...p,name:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,placeholder:"ej: ventas, soporte"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre visible"}),r.jsx("input",{type:"text",value:p.displayName,onChange:w=>g({...p,displayName:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,placeholder:"ej: Ventas, Soporte Tecnico"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),r.jsx("div",{className:"flex gap-2",children:T.map(w=>r.jsx("button",{type:"button",onClick:()=>g({...p,color:w}),className:`w-8 h-8 rounded-full transition ${p.color===w?"ring-2 ring-offset-2 ring-gray-400":""}`,style:{backgroundColor:w}},w))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icono"}),r.jsx("select",{value:p.icon,onChange:w=>g({...p,icon:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:A.map(w=>r.jsx("option",{value:w,children:w},w))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Intents para auto-asignacion"}),r.jsx("input",{type:"text",value:p.autoAssignIntents,onChange:w=>g({...p,autoAssignIntents:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"ventas, comprar, precio (separados por coma)"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Cuando el chatbot detecta estos intents, asigna automaticamente a este departamento."})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancelar"}),r.jsx("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition disabled:opacity-50",children:b?"Guardando...":d?"Guardar":"Crear"})]})]})]})})]})}const fn="/api/learning",ht=()=>{const t=At.getState().token;return{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}}};async function mt(t){const a=await t.json();if(!t.ok||!a.ok)throw new Error(a.error||"Error en la solicitud");return a}async function vk(){const t=await fetch(`${fn}/stats`,{headers:ht()});return mt(t)}async function wk(t={}){const a=Object.fromEntries(Object.entries(t).filter(([,c])=>c!==""&&c!=null)),s=new URLSearchParams(a).toString(),o=await fetch(`${fn}/pairs${s?"?"+s:""}`,{headers:ht()});return mt(o)}async function sb(t,a){const s=await fetch(`${fn}/pairs/${t}`,{method:"PATCH",headers:ht(),body:JSON.stringify({status:a})});return mt(s)}async function jk(t){const a=await fetch(`${fn}/pairs/${t}`,{method:"DELETE",headers:ht()});return mt(a)}async function Nk(t,a){const s=await fetch(`${fn}/reprocess`,{method:"POST",headers:ht(),body:JSON.stringify({from:t||void 0,to:a||void 0})});return mt(s)}async function Sk(t=!0){const a=await fetch(`${fn}/prices?active=${t}`,{headers:ht()});return mt(a)}async function _k(t){const a=await fetch(`${fn}/prices`,{method:"POST",headers:ht(),body:JSON.stringify(t)});return mt(a)}async function Ek(t,a){const s=await fetch(`${fn}/prices/${t}`,{method:"PUT",headers:ht(),body:JSON.stringify(a)});return mt(s)}async function Ck(t){const a=await fetch(`${fn}/prices/${t}`,{method:"DELETE",headers:ht()});return mt(a)}async function rb(t=!1){const a=await fetch(`${fn}/brain-report${t?"?force=true":""}`,{headers:ht()});return mt(a)}async function Tk(){const t=await fetch("/api/chatbot/config",{headers:ht()});return mt(t)}async function Mk(t){const a=await fetch("/api/chatbot/config",{method:"PUT",headers:ht(),body:JSON.stringify(t)});return mt(a)}async function Ak(t=null){const a=t?`?phone=${encodeURIComponent(t)}`:"",s=await fetch(`/api/chatbot/current-prompt${a}`,{headers:ht()});return mt(s)}async function kk(t=50,a=0){const s=await fetch(`/api/chat/bot-conversations?limit=${t}&offset=${a}`,{headers:ht()});return mt(s)}async function Rk(t){const a=await fetch(`/api/chat/bot-conversations/${t}/messages`,{headers:ht()});return mt(a)}async function zk(t,a,s){const o=await fetch(`/api/chat/bot-conversations/${t}/correct`,{method:"POST",headers:ht(),body:JSON.stringify({messageId:a,correctedAnswer:s})});return mt(o)}async function Dk(t,a,s=!1){const o=await fetch("/api/chat/simulate",{method:"POST",headers:ht(),body:JSON.stringify({phone:t,message:a,debug:s})});return mt(o)}async function Ok(t,a){const s=await fetch(`${fn}/quick-correct`,{method:"POST",headers:ht(),body:JSON.stringify({question:t,correctedAnswer:a})});return mt(s)}async function Bk(t){const a=await fetch(`${fn}/behavioral-rules`,{method:"POST",headers:ht(),body:JSON.stringify(t)});return mt(a)}function Lk({onSubmit:t,onCancel:a,submitting:s}){const[o,c]=N.useState("factual"),[u,d]=N.useState(""),[m,p]=N.useState(""),g=()=>{if(o==="factual"){if(!u.trim())return;t({type:"factual",content:u.trim()})}else{if(!m.trim())return;t({type:"behavioral",content:m.trim()})}},y=o==="factual"?u.trim().length>0:m.trim().length>0;return r.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 shadow-sm",children:[r.jsxs("div",{className:"flex gap-2 mb-3",children:[r.jsx("button",{onClick:()=>c("factual"),className:`flex-1 text-[11px] font-medium py-1.5 px-3 rounded-lg transition ${o==="factual"?"bg-blue-600 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:"Respuesta incorrecta"}),r.jsx("button",{onClick:()=>c("behavioral"),className:`flex-1 text-[11px] font-medium py-1.5 px-3 rounded-lg transition ${o==="behavioral"?"bg-purple-600 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:"Regla de comportamiento"})]}),o==="factual"&&r.jsxs("div",{children:[r.jsx("textarea",{value:u,onChange:x=>d(x.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-gray-800 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Cual es la respuesta correcta?",autoFocus:!0}),r.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Esto creara un nuevo par Q&A aprobado"})]}),o==="behavioral"&&r.jsxs("div",{children:[r.jsx("textarea",{value:m,onChange:x=>p(x.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-gray-800 bg-white focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none",placeholder:"Ej: Nunca ofrezcas descuentos sin autorizacion",autoFocus:!0}),r.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Esta regla se agregara a las instrucciones permanentes"})]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsxs("button",{onClick:g,disabled:s||!y,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium text-white transition disabled:opacity-50 ${o==="factual"?"bg-blue-600 hover:bg-blue-700":"bg-purple-600 hover:bg-purple-700"}`,children:[r.jsx(Et,{className:"w-3 h-3"}),s?"Guardando...":"Guardar"]}),r.jsxs("button",{onClick:a,className:"flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 text-gray-600 rounded-lg text-xs hover:bg-gray-50 transition",children:[r.jsx(qn,{className:"w-3 h-3"}),"Cancelar"]})]})]})}function Hk({message:t,index:a,correcting:s,onStartCorrection:o,onSubmitCorrection:c,onCancelCorrection:u,onRetest:d,submitting:m}){const{role:p,text:g,time:y,corrected:x,correctionType:b}=t;return p==="system"?r.jsx("div",{className:"flex justify-center",children:r.jsx("span",{className:"text-[10px] text-red-500 bg-red-50 px-3 py-1 rounded-full",children:g})}):p==="user"?r.jsx("div",{className:"flex justify-end",children:r.jsxs("div",{className:"max-w-[80%] rounded-2xl px-4 py-2.5 bg-indigo-600 text-white",children:[r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g}),r.jsx("span",{className:"text-[9px] opacity-50 block mt-1",children:y instanceof Date?y.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"}):new Date(y).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})})]})}):r.jsx("div",{className:"flex justify-start",children:r.jsxs("div",{className:"max-w-[80%]",children:[r.jsxs("div",{className:"rounded-2xl px-4 py-2.5 bg-white text-gray-800 border border-gray-200 shadow-sm",children:[r.jsx("span",{className:"text-[9px] font-semibold uppercase tracking-wider text-purple-500 block mb-1",children:"BOT IA"}),r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g}),r.jsxs("div",{className:"flex items-center justify-between mt-1.5 gap-3",children:[r.jsx("span",{className:"text-[9px] opacity-50",children:y instanceof Date?y.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"}):new Date(y).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})}),r.jsxs("div",{className:"flex items-center gap-2",children:[x&&b==="factual"&&r.jsxs("span",{className:"text-[9px] font-semibold text-green-600 flex items-center gap-0.5 bg-green-50 px-1.5 py-0.5 rounded-full",children:[r.jsx(Et,{className:"w-2.5 h-2.5"})," Corregido"]}),x&&b==="behavioral"&&r.jsxs("span",{className:"text-[9px] font-semibold text-purple-600 flex items-center gap-0.5 bg-purple-50 px-1.5 py-0.5 rounded-full",children:[r.jsx(ni,{className:"w-2.5 h-2.5"})," Regla agregada"]}),x&&r.jsxs("button",{onClick:()=>d(a),className:"text-[9px] font-semibold text-amber-600 hover:text-amber-700 flex items-center gap-0.5 bg-amber-50 px-1.5 py-0.5 rounded-full transition",children:[r.jsx(Ob,{className:"w-2.5 h-2.5"})," Re-probar"]}),!x&&r.jsxs("button",{onClick:()=>o(a),className:"text-[9px] font-semibold text-purple-600 hover:text-purple-800 flex items-center gap-0.5 transition",children:[r.jsx(zb,{className:"w-2.5 h-2.5"})," Corregir"]})]})]})]}),s===a&&r.jsx("div",{className:"mt-2",children:r.jsx(Lk,{onSubmit:j=>c(a,j),onCancel:u,submitting:m})})]})})}function $k({messages:t,input:a,setInput:s,loading:o,onSend:c,onReset:u,correcting:d,setCorrecting:m,onSubmitCorrection:p,submitting:g,onRetest:y,endRef:x}){const b=j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),c())};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50",children:[t.length===0&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx(qt,{className:"w-10 h-10 text-gray-300 mx-auto mb-3"}),r.jsx("p",{className:"text-sm text-gray-400",children:"Escribe un mensaje para probar la IA"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Usa el mismo motor que WhatsApp real"})]}),t.map((j,S)=>r.jsx(Hk,{message:j,index:S,correcting:d,onStartCorrection:C=>m(C),onSubmitCorrection:p,onCancelCorrection:()=>m(null),onRetest:y,submitting:g},S)),o&&r.jsx("div",{className:"flex justify-start",children:r.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl px-4 py-3 shadow-sm",children:r.jsxs("div",{className:"flex gap-1.5",children:[r.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),r.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),r.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),r.jsx("div",{ref:x})]}),r.jsx("div",{className:"border-t border-gray-200 p-3 bg-white flex-shrink-0",children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",value:a,onChange:j=>s(j.target.value),onKeyDown:b,placeholder:"Escribe un mensaje...",className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",disabled:o,autoFocus:!0}),r.jsx("button",{onClick:c,disabled:o||!a.trim(),className:"bg-indigo-600 hover:bg-indigo-700 text-white p-2.5 rounded-xl transition disabled:opacity-50",children:r.jsx(rm,{className:"w-4 h-4"})})]})})]})}function qk({stats:t,flashField:a}){const[s,o]=N.useState(!1);if(!t)return null;const{approvedPairs:c=0,activePrices:u=0,behavioralRules:d=0,instructionsChars:m=0,model:p="desconocido",fidelityLevel:g="medium",temperature:y=.4}=t;return r.jsxs("div",{className:"bg-amber-50 border-b border-amber-200 flex-shrink-0",children:[r.jsxs("button",{onClick:()=>o(!s),className:"w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-amber-100/50 transition",children:[r.jsx(Ln,{className:"w-4 h-4 text-amber-600 flex-shrink-0"}),r.jsxs("span",{className:"text-[11px] text-amber-800 font-medium flex-1 truncate",children:[c," Q&A | ",u," Precios | ",p," | temp ",y]}),s?r.jsx(pS,{className:"w-3.5 h-3.5 text-amber-500 flex-shrink-0"}):r.jsx(To,{className:"w-3.5 h-3.5 text-amber-500 flex-shrink-0"})]}),s&&r.jsxs("div",{className:"px-3 pb-3 grid grid-cols-3 gap-2",children:[r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(rs,{className:"w-3 h-3 text-indigo-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Q&A"})]}),r.jsx("span",{className:"text-sm font-bold text-gray-800",children:c})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(Ur,{className:"w-3 h-3 text-green-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Precios"})]}),r.jsx("span",{className:"text-sm font-bold text-gray-800",children:u})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(ni,{className:"w-3 h-3 text-purple-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Reglas"})]}),r.jsx("span",{className:"text-sm font-bold text-gray-800",children:d})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(ti,{className:"w-3 h-3 text-blue-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Instrucciones"})]}),r.jsxs("span",{className:"text-sm font-bold text-gray-800",children:[m," chars"]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(Vr,{className:"w-3 h-3 text-amber-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Modelo"})]}),r.jsx("span",{className:"text-[11px] font-bold text-gray-800",children:p})]}),r.jsxs("div",{className:"bg-white rounded-lg p-2 border border-amber-100",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[r.jsx(ou,{className:"w-3 h-3 text-red-500"}),r.jsx("span",{className:"text-[9px] font-semibold text-gray-500 uppercase",children:"Fidelidad"})]}),r.jsx("span",{className:"text-[11px] font-bold text-gray-800 capitalize",children:g})]})]})]})}const ib={completed:{circle:"bg-green-50 text-green-600 border-green-200",icon:Et},skipped:{circle:"bg-gray-50 text-gray-400 border-gray-200",icon:Rb},processing:{circle:"bg-blue-100 text-blue-600 border-blue-200 animate-pulse",icon:PS},error:{circle:"bg-red-50 text-red-600 border-red-200",icon:qn}};function ob({step:t,expanded:a,onToggle:s,animationDelay:o=0,children:c}){const{id:u,label:d,summary:m,timing:p,status:g,detail:y,icon:x}=t,b=ib[g]||ib.completed,j=b.icon;return r.jsx("div",{className:"relative",style:{animation:`stepAppear 0.3s ease-out ${o}ms both`},children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:`w-[30px] h-[30px] rounded-full border flex items-center justify-center flex-shrink-0 ${b.circle}`,style:g==="processing"?{animation:"pulseGlow 2s ease-in-out infinite"}:{},children:x?r.jsx(x,{className:"w-3.5 h-3.5"}):r.jsx(j,{className:`w-3.5 h-3.5 ${g==="processing"?"animate-spin":""}`})}),r.jsxs("div",{className:"flex-1 min-w-0 pt-0.5",children:[r.jsxs("div",{className:`flex items-center gap-2 ${y||c?"cursor-pointer":""}`,onClick:()=>(y||c)&&s(u),children:[r.jsx("span",{className:"text-xs font-medium text-gray-700",children:d}),m&&r.jsx("span",{className:"text-[10px] text-gray-400 truncate",children:m}),r.jsxs("div",{className:"flex items-center gap-1.5 ml-auto flex-shrink-0",children:[p!=null&&r.jsxs("span",{className:"text-[10px] font-mono bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded",children:[p,"ms"]}),(y||c)&&r.jsx(To,{className:`w-3 h-3 text-gray-400 transition-transform duration-200 ${a?"rotate-90":""}`})]})]}),r.jsxs("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${a?"max-h-[500px] opacity-100 mt-2":"max-h-0 opacity-0"}`,children:[y&&r.jsx("div",{className:"bg-gray-50 rounded-lg p-2.5 text-[10px] font-mono text-gray-600 whitespace-pre-wrap break-all",children:typeof y=="string"?y:JSON.stringify(y,null,2)}),c&&r.jsx("div",{className:"pl-2 border-l-2 border-gray-100 space-y-2 mt-1",children:c})]})]})]})})}function Uk(t){if(!t)return[];const a=[];a.push({id:"message_received",label:"Mensaje recibido",summary:t.inputMessage?`"${t.inputMessage.slice(0,40)}${t.inputMessage.length>40?"...":""}"`:"",timing:0,status:"completed",icon:qt,detail:t.entry?{phone:t.entry.phone,channel:t.entry.channel,sessionId:t.entry.sessionId,sessionCreated:t.sessionCreated}:null});const s=t.modeCheck;a.push({id:"session_mode",label:"Modo sesion",summary:s?`${s.mode} (${s.modeSource})  ${s.outcome}`:"automatic",timing:null,status:s?.outcome==="proceed"?"completed":s?"error":"skipped",icon:ni,detail:s||null});const o=t.globalKeyword;a.push({id:"global_keywords",label:"Keywords globales",summary:o?.matched?`Match: "${o.keyword}"  ${o.action}`:"Sin match",timing:null,status:o?.matched?"completed":"skipped",icon:Ao,detail:o||null});const c=t.sessionState;a.push({id:"active_session",label:"Sesion activa",summary:c?.hasActiveSession?`Flujo #${c.flowId} en nodo ${c.currentNodeId}`:"Sin flujo activo",timing:null,status:c?.hasActiveSession?"completed":"skipped",icon:os,detail:c||null});const u=t.classification;a.push({id:"classification",label:"Clasificacion",summary:u?.ran?`Intent: ${u.intent?.type||"unknown"} (${Math.round((u.intent?.confidence||0)*100)}%)  ${u.sentiment||"neutral"}  Lead: ${u.leadScore?.value||0}`:"No ejecutada",timing:u?.durationMs||null,status:u?.ran?"completed":"skipped",icon:ou,expandable:!0,detail:u||null});const d=t.flowMatching;a.push({id:"flow_match",label:"Match flujos",summary:d?`${d.activeFlowCount||0} flujos  ${d.outcome==="flow_matched"?`Match: ${d.matchedFlow?.flowName}`:d.outcome==="default_used"?"Default usado":"Sin match  AI"}`:"No evaluado",timing:null,status:d?.outcome==="flow_matched"?"completed":d?.outcome==="no_match"?"skipped":"completed",icon:nm,expandable:!!d?.flowsEvaluated?.length,detail:d?{...d,flowsDetail:d.flowsEvaluated?.map(p=>`${p.matched?"":""} ${p.flowName} (${p.triggerType})  ${p.reason||""}`)}:null});const m=t.aiFallback;if(m){const p=[];p.push({id:"ai_contact",label:"Contacto",summary:m.userName?`${m.userName}`:"Sin nombre",timing:null,status:"completed",icon:Bs,detail:m.contactFields||null});const g=m.knowledge,y=g?(g.vectorSearch?.results?.length||0)+(g.bm25Search?.resultsCount||0):0;p.push({id:"ai_knowledge",label:"Conocimiento",summary:g?`${g.combinedCount||0} pares (vector: ${g.vectorSearch?.results?.length||0}, BM25: ${g.bm25Search?.resultsCount||0})`:"0 pares",timing:g?.vectorSearch?.durationMs||null,status:y>0?"completed":"skipped",icon:rs,expandable:y>0,detail:g?{retrieverAvailable:g.retrieverAvailable,vectorResults:g.vectorSearch?.results||[],bm25Results:g.bm25Search?.results||[]}:null});const x=m.priceQuery;p.push({id:"ai_prices",label:"Precios",summary:x?x.isPriceQuery?`${x.pricesFound?.length||0} precios encontrados`:"No es consulta de precio":"No consultado",timing:x?.durationMs||null,status:x?.pricesFound?.length>0?"completed":"skipped",icon:Ur,detail:x||null});const b=m.conversationHistory;p.push({id:"ai_history",label:"Historial",summary:b?`${b.turnsLoaded||0} turnos`:"0 turnos",timing:null,status:b?.turnsLoaded>0?"completed":"skipped",icon:qr,detail:b||null});const j=m.prompt;p.push({id:"ai_prompt",label:"Prompt construido",summary:j?`~${j.estimatedTokens||"?"} tokens  ${j.totalMessagesInArray||"?"} msgs${j.knowledgeInjected?" +conocimiento":""}${j.behavioralRulesInjected?" +reglas":""}`:"",timing:null,status:"completed",icon:ti,expandable:!0,detail:j||null});const S=m.openaiCall;p.push({id:"ai_openai",label:"OpenAI",summary:S?`${S.model}  temp ${S.temperature}  ${S.durationMs}ms  ${S.totalTokens||"?"} tokens`:"Esperando...",timing:S?.durationMs||null,status:S?"completed":"processing",icon:Vr,expandable:!!S,detail:S?{model:S.model,temperature:S.temperature,maxTokens:S.maxTokens,durationMs:S.durationMs,promptTokens:S.promptTokens,completionTokens:S.completionTokens,finishReason:S.finishReason,responsePreview:S.responseText?.slice(0,200)}:null});const C=m.delivery;p.push({id:"ai_delivery",label:"Entrega",summary:C?`${C.splitInto} msg(s) enviados`:"",timing:null,status:C?"completed":"skipped",icon:rm,detail:C||null}),a.push({id:"ai_fallback",label:"AI Fallback",summary:t.result?.totalPipelineMs?`Total: ${t.result.totalPipelineMs}ms`:"",timing:t.result?.totalPipelineMs||null,status:m.error?"error":"completed",icon:Ln,detail:m.error||null,children:p})}return!m&&t.result&&a.push({id:"result",label:"Resultado",summary:`${t.result.type}  ${t.result.responseSent?"Respuesta enviada":"Sin respuesta"}`,timing:t.result.totalPipelineMs||null,status:t.result.responseSent?"completed":"skipped",icon:Et,detail:t.result}),a}function Vk(){return[{id:"message_received",label:"Mensaje recibido",summary:"",timing:0,status:"completed",icon:qt},{id:"session_mode",label:"Modo sesion",summary:"Evaluando...",timing:null,status:"processing",icon:ni},{id:"global_keywords",label:"Keywords globales",summary:"Buscando...",timing:null,status:"processing",icon:Ao},{id:"active_session",label:"Sesion activa",summary:"Verificando...",timing:null,status:"processing",icon:os},{id:"classification",label:"Clasificacion",summary:"Analizando...",timing:null,status:"processing",icon:ou},{id:"ai_fallback",label:"AI Fallback",summary:"Procesando...",timing:null,status:"processing",icon:Ln}]}function Yk({trace:t,isLoading:a}){const[s,o]=N.useState(new Set),c=d=>{o(m=>{const p=new Set(m);return p.has(d)?p.delete(d):p.add(d),p})},u=a&&!t?Vk():Uk(t);return!u.length&&!a?r.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[r.jsx(Ln,{className:"w-12 h-12 text-gray-200 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Envia un mensaje para ver el pipeline"}),r.jsx("p",{className:"text-[10px] text-gray-300 mt-1",children:"Cada paso del cerebro se mostrara aqui"})]}):r.jsxs("div",{className:"p-4 overflow-y-auto flex-1",children:[t?.result?.totalPipelineMs&&r.jsxs("div",{className:"mb-4 flex items-center gap-2 text-[10px]",children:[r.jsxs("span",{className:"px-2 py-0.5 bg-amber-50 text-amber-700 rounded-full font-semibold",children:["Total: ",t.result.totalPipelineMs,"ms"]}),r.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-500 rounded-full",children:t.result.type}),t.result.responseSent&&r.jsxs("span",{className:"px-2 py-0.5 bg-green-50 text-green-600 rounded-full",children:[t.result.responseTexts?.length||0," respuesta(s)"]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute left-[14px] top-[30px] bottom-0 w-0.5 bg-gray-200"}),r.jsx("div",{className:"space-y-3 relative",children:u.map((d,m)=>r.jsx(ob,{step:d,expanded:s.has(d.id),onToggle:c,animationDelay:m*100,children:d.children&&s.has(d.id)&&r.jsx("div",{className:"mt-2 ml-4 pl-6 border-l-2 border-blue-200 space-y-2",children:d.children.map((p,g)=>r.jsx(ob,{step:p,expanded:s.has(p.id),onToggle:c,animationDelay:g*60},p.id))})},d.id))})]})]})}function ph({label:t,labelColor:a,bgColor:s,textColor:o,content:c}){return c?r.jsxs("div",{className:"mb-4",children:[r.jsx("span",{className:`text-[10px] uppercase tracking-wider font-semibold ${a} block mb-1.5`,children:t}),r.jsx("pre",{className:`${s} ${o} rounded-lg p-3 text-[11px] overflow-x-auto whitespace-pre-wrap font-mono leading-relaxed max-h-[300px] overflow-y-auto`,children:c})]}):null}function Pk({trace:t}){if(!t)return r.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[r.jsx(Uc,{className:"w-10 h-10 text-gray-300 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400",children:"Sin datos de prompt"})]});const a=t.aiFallback||{},s=a.prompt||{},o=a.openaiCall||{},c=s.estimatedTokens||"?",u=s.totalSystemPromptChars||"?",d=o.model||"?",m=s.totalMessagesInArray||"?",p=s.systemPromptFull||null,g=s.behavioralRulesText||null,y=s.customInstructionsText||null,x=o.responseText||null;return r.jsxs("div",{className:"p-4 overflow-y-auto",children:[r.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[r.jsxs("span",{className:"text-[10px] font-medium px-2.5 py-1 rounded-full bg-amber-100 text-amber-800",children:["~",c," tokens"]}),r.jsxs("span",{className:"text-[10px] font-medium px-2.5 py-1 rounded-full bg-gray-100 text-gray-600",children:[u," chars"]}),r.jsx("span",{className:"text-[10px] font-medium px-2.5 py-1 rounded-full bg-indigo-100 text-indigo-700",children:d}),r.jsxs("span",{className:"text-[10px] font-medium px-2.5 py-1 rounded-full bg-purple-100 text-purple-700",children:[m," msgs"]})]}),r.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-4",children:[s.isCustomSystemPrompt&&r.jsx("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 font-medium",children:"Prompt personalizado"}),s.knowledgeInjected&&r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 font-medium",children:["+",s.knowledgePairsInjected," pares Q&A"]}),s.pricesInjected&&r.jsx("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-green-100 text-green-700 font-medium",children:"+precios"}),s.behavioralRulesInjected&&r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-purple-100 text-purple-700 font-medium",children:["+",s.behavioralRulesCount," reglas"]}),s.hasCustomInstructions&&r.jsx("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 font-medium",children:"+instrucciones admin"}),r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-500 font-medium",children:["Fidelidad: ",s.fidelityLevel||"?"]})]}),r.jsx(ph,{label:"System Prompt Completo",labelColor:"text-gray-400",bgColor:"bg-gray-900",textColor:"text-gray-100",content:p}),g&&r.jsx(ph,{label:"Reglas de Comportamiento",labelColor:"text-purple-400",bgColor:"bg-purple-950",textColor:"text-purple-100",content:g}),y&&r.jsx(ph,{label:"Instrucciones del Admin",labelColor:"text-yellow-400",bgColor:"bg-yellow-950",textColor:"text-yellow-100",content:y}),x&&r.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[r.jsxs("span",{className:"text-[10px] uppercase tracking-wider font-semibold text-emerald-500 flex items-center gap-1 mb-1.5",children:[r.jsx(Vr,{className:"w-3 h-3"})," Respuesta de OpenAI"]}),r.jsx("pre",{className:"bg-emerald-950 text-emerald-100 rounded-lg p-3 text-[11px] overflow-x-auto whitespace-pre-wrap font-mono leading-relaxed border border-emerald-800",children:x}),o.durationMs&&r.jsx("div",{className:"flex gap-2 mt-2",children:r.jsxs("span",{className:"text-[9px] text-gray-400",children:[o.durationMs,"ms  ",o.totalTokens||"?"," tokens  ",o.finishReason||"?"]})})]}),!p&&!x&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx(ti,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),r.jsx("p",{className:"text-xs text-gray-400",children:"No hay datos de prompt disponibles en este trace"}),r.jsx("p",{className:"text-[10px] text-gray-300 mt-1",children:"Asegurate de enviar un mensaje con Rayos X activado"})]})]})}function Ik({trace:t,sessionCorrections:a}){const s=t?.aiFallback||{},o=s.knowledge||{},c=o.vectorSearch?.results||[],u=o.bm25Search?.results||[],d=[...c,...u],m=s.priceQuery||{},p=m.pricesFound||[],g=a&&a.length>0,y=d.length>0,x=p.length>0;return r.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[g&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-semibold uppercase tracking-wider text-amber-600 mb-2 flex items-center gap-1",children:[r.jsx(vS,{className:"w-3 h-3"}),"Correcciones de esta sesion"]}),r.jsx("div",{className:"space-y-2",children:a.map((b,j)=>r.jsxs("div",{className:`rounded-lg p-3 border text-[11px] ${b.type==="factual"?"bg-blue-50 border-blue-200 text-blue-800":"bg-purple-50 border-purple-200 text-purple-800"}`,children:[r.jsx("div",{className:"flex items-center gap-1.5 mb-1",children:b.type==="factual"?r.jsxs(r.Fragment,{children:[r.jsx(Et,{className:"w-3 h-3"}),r.jsx("span",{className:"font-semibold",children:"Respuesta corregida"})]}):r.jsxs(r.Fragment,{children:[r.jsx(ni,{className:"w-3 h-3"}),r.jsx("span",{className:"font-semibold",children:"Regla agregada"})]})}),b.type==="factual"?r.jsxs(r.Fragment,{children:[b.question&&r.jsxs("p",{className:"text-[10px] opacity-70 mb-0.5",children:["P: ",b.question]}),r.jsxs("p",{children:["R: ",b.correctedAnswer]})]}):r.jsx("p",{children:b.rule})]},j))})]}),o.retrieverAvailable!==void 0&&r.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[r.jsxs("span",{className:`text-[9px] px-2 py-0.5 rounded-full font-medium ${o.retrieverAvailable?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:["Retriever: ",o.retrieverAvailable?"Disponible":"No disponible"]}),o.vectorSearch?.durationMs&&r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-500 font-medium",children:["Busqueda: ",o.vectorSearch.durationMs,"ms"]}),r.jsxs("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-600 font-medium",children:[o.combinedCount||0," resultados combinados"]})]}),c.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-semibold uppercase tracking-wider text-indigo-600 mb-2 flex items-center gap-1",children:[r.jsx(sm,{className:"w-3 h-3"}),"Busqueda vectorial (",c.length,")"]}),r.jsx("div",{className:"space-y-2",children:c.map((b,j)=>r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3 shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx("span",{className:"text-[9px] font-semibold px-1.5 py-0.5 rounded-full bg-indigo-50 text-indigo-600",children:b.source==="learned"?"Aprendido":b.source||"Vector"}),b.similarityScore!=null&&r.jsxs("span",{className:"text-[9px] font-mono text-gray-400",children:[Math.round((b.similarityScore||0)*100),"% similitud"]}),b.qualityScore!=null&&r.jsxs("span",{className:"text-[9px] font-mono text-amber-500",children:["Q:",b.qualityScore]})]}),r.jsxs("p",{className:"text-[11px] font-medium text-gray-700 mb-0.5",children:["P: ",b.question]}),r.jsxs("p",{className:"text-[11px] text-gray-500",children:["R: ",b.answerPreview]})]},`v-${j}`))})]}),u.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-semibold uppercase tracking-wider text-teal-600 mb-2 flex items-center gap-1",children:[r.jsx(rs,{className:"w-3 h-3"}),"Busqueda BM25 / FAQ (",u.length,")"]}),r.jsx("div",{className:"space-y-2",children:u.map((b,j)=>r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3 shadow-sm",children:[r.jsx("span",{className:"text-[9px] font-semibold px-1.5 py-0.5 rounded-full bg-teal-50 text-teal-600",children:b.source==="faq"?"FAQ":b.source||"BM25"}),r.jsxs("p",{className:"text-[11px] font-medium text-gray-700 mt-1.5 mb-0.5",children:["P: ",b.question]}),r.jsxs("p",{className:"text-[11px] text-gray-500",children:["R: ",b.answerPreview]})]},`b-${j}`))})]}),x&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-semibold uppercase tracking-wider text-green-600 mb-2 flex items-center gap-1",children:[r.jsx(Ur,{className:"w-3 h-3"}),"Precios encontrados (",p.length,")"]}),m.extractedProduct&&r.jsxs("p",{className:"text-[10px] text-gray-500 mb-2",children:["Producto detectado: ",r.jsx("span",{className:"font-medium text-gray-700",children:m.extractedProduct}),m.extractedVariant&&r.jsxs(r.Fragment,{children:["  Variante: ",r.jsx("span",{className:"font-medium text-gray-700",children:m.extractedVariant})]})]}),r.jsx("div",{className:"bg-green-50 rounded-lg border border-green-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-green-200",children:[r.jsx("th",{className:"text-left px-3 py-1.5 text-[9px] font-semibold text-green-700 uppercase",children:"Producto"}),r.jsx("th",{className:"text-left px-3 py-1.5 text-[9px] font-semibold text-green-700 uppercase",children:"Variante"}),r.jsx("th",{className:"text-right px-3 py-1.5 text-[9px] font-semibold text-green-700 uppercase",children:"Precio"})]})}),r.jsx("tbody",{className:"divide-y divide-green-100",children:p.map((b,j)=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-3 py-1.5 text-[11px] text-gray-700 font-medium",children:b.productName||"-"}),r.jsx("td",{className:"px-3 py-1.5 text-[11px] text-gray-500",children:b.variant||"-"}),r.jsxs("td",{className:"px-3 py-1.5 text-[11px] text-gray-700 font-mono text-right font-medium",children:["$",Number(b.price||0).toLocaleString("es-CL")]})]},j))})]})})]}),m.isPriceQuery&&!x&&r.jsxs("div",{className:"rounded-lg p-3 bg-yellow-50 border border-yellow-200 text-[11px] text-yellow-800",children:[r.jsx(Ur,{className:"w-3.5 h-3.5 inline mr-1"}),"Se detecto consulta de precio pero no se encontraron resultados",m.extractedProduct&&r.jsxs(r.Fragment,{children:[' para "',m.extractedProduct,'"']})]}),!y&&!x&&!g&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[r.jsx(rs,{className:"w-10 h-10 text-gray-300 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"No se inyecto conocimiento en esta respuesta"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"El bot puede haber respondido solo con el prompt base"})]})]})}function Xk({trace:t}){const s=(t?.aiFallback||{}).conversationHistory||{},o=s.turns||[],c=s.turnsLoaded||o.length;return o.length?r.jsxs("div",{className:"p-4 overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(qt,{className:"w-4 h-4 text-purple-500"}),r.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:[c," turnos cargados como contexto"]})]}),r.jsx("div",{className:"space-y-2",children:o.map((u,d)=>{const m=u.direction==="incoming"||u.direction==="in",p=u.text||"";return r.jsx("div",{className:`flex ${m?"justify-start":"justify-end"}`,children:r.jsxs("div",{className:`max-w-[85%] rounded-xl px-3 py-2 ${m?"bg-gray-100 text-gray-700":"bg-purple-50 text-purple-800 border border-purple-200"}`,children:[!m&&r.jsx("span",{className:"text-[8px] font-semibold uppercase tracking-wider text-purple-500 block mb-0.5",children:"BOT"}),r.jsx("p",{className:"text-[11px] whitespace-pre-wrap leading-relaxed",children:p}),u.timestamp&&r.jsx("span",{className:"text-[8px] opacity-40 block mt-0.5",children:new Date(u.timestamp).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})})]})},d)})})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[r.jsx(qr,{className:"w-10 h-10 text-gray-300 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Sin historial de conversacion"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Este es el primer mensaje de la sesion"})]})}const Gk=[{id:"pipeline",label:"Pipeline",icon:ns},{id:"prompt",label:"Prompt",icon:Uc},{id:"knowledge",label:"Conocimiento",icon:rs},{id:"history",label:"Historial",icon:qt}];function Qk({activeTab:t,setActiveTab:a,trace:s,knowledgeStats:o,sessionCorrections:c,isLoading:u}){return r.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[o&&r.jsx(qk,{stats:o}),r.jsx("div",{className:"flex border-b border-gray-200 bg-white px-2 flex-shrink-0",children:Gk.map(d=>{const m=d.icon,p=t===d.id;return r.jsxs("button",{onClick:()=>a(d.id),className:`flex items-center gap-1.5 px-3 py-2.5 text-[11px] font-medium border-b-2 transition ${p?"border-amber-500 text-amber-700 bg-amber-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(m,{className:"w-3.5 h-3.5"}),d.label]},d.id)})}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:!s&&!u?r.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[r.jsx(Ao,{className:"w-10 h-10 text-amber-300 mb-3"}),r.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Envia un mensaje para ver el pipeline"}),r.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"El debug se activa con cada mensaje"})]}):r.jsxs(r.Fragment,{children:[t==="pipeline"&&r.jsx(Yk,{trace:s,isLoading:u}),t==="prompt"&&r.jsx(Pk,{trace:s}),t==="knowledge"&&r.jsx(Ik,{trace:s,sessionCorrections:c}),t==="history"&&r.jsx(Xk,{trace:s})]})})]})}function Fk({show:t,onClose:a}){const[s,o]=N.useState(!1),[c,u]=N.useState("pipeline"),[d,m]=N.useState([]),[p,g]=N.useState(""),[y,x]=N.useState(!1),[b,j]=N.useState(()=>`tester_admin_${Date.now()}`),[S,C]=N.useState(null),[_,E]=N.useState(null),[R,T]=N.useState([]),[A,w]=N.useState(null),[D,M]=N.useState(!1),q=N.useRef(null);N.useEffect(()=>{q.current&&q.current.scrollIntoView({behavior:"smooth"})},[d,y]);const H=async()=>{const te=p.trim();if(!(!te||y)){g(""),m($=>[...$,{role:"user",text:te,time:new Date}]),x(!0),C(null);try{const $=await Dk(b,te,s),G=$.responses||[],O=$.trace||null;if(G.length>0?m(z=>[...z,...G.map(U=>({role:"bot",text:U,time:new Date,trace:O,corrected:!1,correctionType:null}))]):m(z=>[...z,{role:"bot",text:"(sin respuesta del bot)",time:new Date,trace:O}]),O){C(O);const z=O.aiFallback||{},U=z.prompt||{},L=z.openaiCall||{};E({approvedPairs:U.knowledgePairsInjected||0,activePrices:z.priceQuery?.pricesFound?.length||0,behavioralRules:U.behavioralRulesCount||0,instructionsChars:U.totalSystemPromptChars||0,model:L.model||"unknown",fidelityLevel:U.fidelityLevel||"enhanced",temperature:L.temperature||.5})}}catch($){m(G=>[...G,{role:"system",text:"Error: "+$.message,time:new Date}])}finally{x(!1)}}},Q=()=>{m([]),j(`tester_admin_${Date.now()}`),C(null),E(null),T([]),w(null)},I=async(te,{type:$,content:G})=>{M(!0);try{if($==="factual"){let O="";for(let z=te-1;z>=0;z--)if(d[z].role==="user"){O=d[z].text;break}await Ok(O,G),m(z=>z.map((U,L)=>L===te?{...U,corrected:!0,correctionType:"factual"}:U)),T(z=>[...z,{type:"factual",index:te,question:O,correctedAnswer:G,time:new Date}])}else await Bk({rule:G}),m(O=>O.map((z,U)=>U===te?{...z,corrected:!0,correctionType:"behavioral"}:z)),T(O=>[...O,{type:"behavioral",index:te,rule:G,time:new Date}]);w(null)}catch(O){console.error("Error submitting correction:",O)}finally{M(!1)}},Z=async te=>{let $="";for(let G=te-1;G>=0;G--)if(d[G].role==="user"){$=d[G].text;break}$&&g($)};return t?r.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",children:[r.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:a}),r.jsxs("div",{className:`relative bg-white shadow-2xl flex flex-col h-full transition-all duration-500 ease-out ${s?"w-full max-w-[56rem]":"w-full max-w-md"}`,onClick:te=>te.stopPropagation(),children:[r.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 px-5 py-4 flex items-center justify-between flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-3 text-white",children:[r.jsx(Db,{className:"w-5 h-5"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-sm",children:"Probador IA"}),r.jsx("p",{className:"text-[10px] text-purple-200",children:"Prueba tu prompt en tiempo real"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>o(!s),className:`flex items-center gap-1.5 text-[10px] px-3 py-1.5 rounded-full font-semibold transition-all ${s?"bg-amber-400 text-amber-900 shadow-lg shadow-amber-400/30":"bg-white/20 text-white hover:bg-white/30"}`,children:[r.jsx(Ao,{className:"w-3.5 h-3.5"}),"Rayos X"]}),r.jsx("button",{onClick:Q,className:"text-[10px] bg-white/20 hover:bg-white/30 text-white px-2.5 py-1.5 rounded-full font-medium transition",children:r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(os,{className:"w-3 h-3"}),"Nueva conv."]})}),r.jsx("button",{onClick:a,className:"p-1 text-white/70 hover:text-white rounded",children:r.jsx(qn,{className:"w-5 h-5"})})]})]}),r.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[r.jsx("div",{className:`flex flex-col ${s?"w-[400px] flex-shrink-0 border-r border-gray-200":"flex-1"}`,children:r.jsx($k,{messages:d,input:p,setInput:g,loading:y,onSend:H,onReset:Q,correcting:A,setCorrecting:w,onSubmitCorrection:I,submitting:D,onRetest:Z,endRef:q})}),s&&r.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-gray-50",children:r.jsx(Qk,{activeTab:c,setActiveTab:u,trace:S,knowledgeStats:_,sessionCorrections:R,isLoading:y})})]})]})]}):null}const Zk=[{id:"brain",label:"Cerebro IA",icon:Ln},{id:"instructions",label:"Instrucciones",icon:ti},{id:"bot-conversations",label:"Conversaciones IA",icon:qt},{id:"dashboard",label:"Dashboard",icon:Kh},{id:"pairs",label:"Pares Q&A",icon:rs},{id:"prices",label:"Precios",icon:Ur}];function Wk({label:t,value:a}){const s=a>=80?"#10b981":a>=50?"#f59e0b":"#ef4444",o=2*Math.PI*36,c=o-a/100*o;return r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4 flex flex-col items-center",children:[r.jsxs("svg",{width:"88",height:"88",className:"mb-2",children:[r.jsx("circle",{cx:"44",cy:"44",r:"36",fill:"none",stroke:"#f3f4f6",strokeWidth:"8"}),r.jsx("circle",{cx:"44",cy:"44",r:"36",fill:"none",stroke:s,strokeWidth:"8",strokeDasharray:o,strokeDashoffset:c,strokeLinecap:"round",transform:"rotate(-90 44 44)",className:"transition-all duration-700"}),r.jsxs("text",{x:"44",y:"48",textAnchor:"middle",fontSize:"18",fontWeight:"bold",fill:"#1f2937",children:[a,"%"]})]}),r.jsx("span",{className:"text-xs text-gray-500 text-center",children:t})]})}const Kk={confianza_general:"Confianza General",cobertura_temas:"Cobertura de Temas",calidad_respuestas:"Calidad Respuestas",actualizacion_precios:"Precios Actualizados"},Jk={puede_responder_precios:"Responder Precios",puede_comparar_productos:"Comparar Productos",puede_recomendar:"Recomendar",puede_dar_plazos:"Informar Plazos",puede_informar_despacho:"Informar Despacho"},gh={pending:{label:"Pendiente",cls:"bg-yellow-50 text-yellow-700"},approved:{label:"Aprobado",cls:"bg-green-50 text-green-700"},rejected:{label:"Rechazado",cls:"bg-red-50 text-red-700"}};function e7(){const[t,a]=N.useState(null),[s,o]=N.useState(!0),[c,u]=N.useState(!1),[d,m]=N.useState(null),[p,g]=N.useState(!1),[y,x]=N.useState("");N.useEffect(()=>{b()},[]);const b=async()=>{o(!0),x("");try{const C=await rb(!1);a(C.report),m(C.generated_at),g(C.cached)}catch(C){x(C.message)}finally{o(!1)}},j=async()=>{u(!0),x("");try{const C=await rb(!0);a(C.report),m(C.generated_at),g(!1)}catch(C){x(C.message)}finally{u(!1)}};if(s)return r.jsx("div",{className:"flex items-center justify-center py-20",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})});if(y&&!t)return r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[r.jsx(oo,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),r.jsx("p",{className:"text-red-700",children:y}),r.jsx("button",{onClick:b,className:"mt-3 text-sm text-red-600 underline",children:"Reintentar"})]});const S=t?.ai_analysis;return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-8 text-white",children:r.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center",children:r.jsx(Ln,{className:"w-8 h-8"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Cerebro IA"}),r.jsxs("p",{className:"text-indigo-200 text-sm mt-1",children:[d?`Ultimo analisis: ${ai(new Date(d),{addSuffix:!0,locale:is})}`:"Sin analisis previo",p&&" (cacheado)"]})]})]}),r.jsxs("button",{onClick:j,disabled:c,className:"flex items-center gap-2 bg-white/20 hover:bg-white/30 px-4 py-2.5 rounded-lg transition disabled:opacity-50",children:[r.jsx(os,{className:`w-4 h-4 ${c?"animate-spin":""}`}),c?"Generando...":"Regenerar Analisis"]})]})}),t?.ai_available===!1&&r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 flex items-center gap-3",children:[r.jsx(oo,{className:"w-5 h-5 text-yellow-600 flex-shrink-0"}),r.jsx("p",{className:"text-yellow-800 text-sm",children:"OpenAI no configurado. Se muestran datos basicos sin analisis IA. Configure OPENAI_API_KEY para el reporte completo."})]}),t?.stats&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsx(un,{title:"Pares Aprobados",value:t.stats.approved,icon:rs,color:"green",subtitle:"Base de conocimiento"}),r.jsx(un,{title:"Pendientes",value:t.stats.pending,icon:oo,color:"yellow",subtitle:"Por revisar"}),r.jsx(un,{title:"Precios Activos",value:t.stats.active_prices,icon:Ur,color:"blue",subtitle:"Productos con precio"}),r.jsx(un,{title:"Calidad Promedio",value:`${t.stats.avg_quality||0}/100`,icon:Vc,color:"purple",subtitle:"Score Q&A"})]}),y&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm",children:y}),S?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:r.jsxs("div",{className:"border-l-4 border-indigo-500 pl-4",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[r.jsx(Vr,{className:"w-5 h-5 text-indigo-500"})," Resumen General"]}),r.jsx("p",{className:"text-gray-600 leading-relaxed",children:S.resumen})]})}),S.metricas_confianza&&r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(S.metricas_confianza).map(([C,_])=>r.jsx(Wk,{label:Kk[C]||C,value:Number(_)||0},C))}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(ou,{className:"w-5 h-5 text-green-500"})," Temas Dominados"]}),(S.temas_dominados||[]).length===0?r.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"Sin temas detectados aun"}):r.jsx("div",{className:"space-y-3",children:S.temas_dominados.map((C,_)=>r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:"text-gray-700 font-medium",children:C.tema}),r.jsxs("span",{className:"text-gray-500",children:[C.confianza,"% (",C.ejemplos," ej.)"]})]}),r.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${C.confianza}%`,backgroundColor:C.confianza>=80?"#10b981":C.confianza>=50?"#f59e0b":"#ef4444"}})}),C.detalle&&r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:C.detalle})]},_))})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(oo,{className:"w-5 h-5 text-yellow-500"})," Brechas de Conocimiento"]}),(S.brechas_conocimiento||[]).length===0?r.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"Sin brechas detectadas"}):r.jsx("div",{className:"space-y-3",children:S.brechas_conocimiento.map((C,_)=>r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${C.prioridad==="alta"?"bg-red-100 text-red-700":C.prioridad==="media"?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"}`,children:C.prioridad}),r.jsx("span",{className:"font-medium text-gray-800 text-sm",children:C.area})]}),r.jsx("p",{className:"text-gray-500 text-sm",children:C.descripcion})]},_))})]})]}),S.capacidades&&r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx(Ao,{className:"w-5 h-5 text-blue-500"})," Capacidades"]}),r.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(S.capacidades).map(([C,_])=>r.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${_?"bg-green-50 text-green-700":"bg-gray-100 text-gray-400"}`,children:[_?r.jsx(Et,{className:"w-4 h-4"}):r.jsx(qn,{className:"w-4 h-4"}),Jk[C]||C]},C))})]}),S.razonamiento&&r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[r.jsx(Ln,{className:"w-5 h-5 text-purple-500"})," Razonamiento"]}),r.jsx("p",{className:"text-gray-600 leading-relaxed italic",children:S.razonamiento})]}),S.recomendaciones?.length>0&&r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[r.jsx(Vc,{className:"w-5 h-5 text-indigo-500"})," Recomendaciones"]}),r.jsx("ul",{className:"space-y-2",children:S.recomendaciones.map((C,_)=>r.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-600",children:[r.jsx(Vr,{className:"w-4 h-4 text-indigo-400 mt-0.5 flex-shrink-0"}),C]},_))})]}),r.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-xs text-gray-400 flex items-center justify-between",children:[r.jsxs("span",{children:["Datos base: ",t?.stats?.approved||0," pares aprobados, ",t?.stats?.active_prices||0," precios"]}),r.jsx("span",{children:t?.ai_available?"Analisis generado por IA":"Datos sin analisis IA"})]})]}):r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-12 text-center",children:[r.jsx(Ln,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-400",children:'Sin datos de analisis. Aprueba pares Q&A y presiona "Regenerar Analisis".'})]})]})}function t7({stats:t}){if(!t)return r.jsx("p",{className:"text-gray-400 text-center py-8",children:"Cargando estadisticas..."});const a=Object.entries(t.by_channel||{}),s=a.reduce((o,[,c])=>o+c,0)||1;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsx(un,{title:"Total Pares",value:t.total,icon:rs,color:"blue",subtitle:"Q&A aprendidos"}),r.jsx(un,{title:"Aprobados",value:t.approved,icon:Et,color:"green",subtitle:`${t.with_embedding} con embedding`}),r.jsx(un,{title:"Pendientes",value:t.pending,icon:oo,color:"yellow",subtitle:"Por revisar"}),r.jsx(un,{title:"Calidad Promedio",value:`${t.avg_quality||0}/100`,icon:Vc,color:"purple",subtitle:"Score de calidad"})]}),a.length>0&&r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"Distribucion por Canal"}),r.jsx("div",{className:"space-y-3",children:a.map(([o,c])=>r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:"text-gray-700 font-medium capitalize",children:o}),r.jsxs("span",{className:"text-gray-500",children:[c," pares (",Math.round(c/s*100),"%)"]})]}),r.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-indigo-500 rounded-full transition-all",style:{width:`${Math.round(c/s*100)}%`}})})]},o))})]})]})}function n7(){const[t,a]=N.useState([]),[s,o]=N.useState(1),[c,u]=N.useState(1),[d,m]=N.useState(0),[p,g]=N.useState(!0),[y,x]=N.useState({status:"",channel:"",minQuality:""}),[b,j]=N.useState(null),[S,C]=N.useState(!1),[_,E]=N.useState({from:"",to:""}),[R,T]=N.useState(!1);N.useEffect(()=>{A()},[s,y]);const A=async()=>{g(!0);try{const Q=await wk({page:s,limit:20,...y});a(Q.pairs),u(Q.pages),m(Q.total)}catch(Q){console.error(Q)}finally{g(!1)}},w=async Q=>{try{await sb(Q,"approved"),A()}catch(I){alert(I.message)}},D=async Q=>{try{await sb(Q,"rejected"),A()}catch(I){alert(I.message)}},M=async Q=>{if(confirm("Eliminar este par permanentemente?"))try{await jk(Q),A()}catch(I){alert(I.message)}},q=async()=>{T(!0);try{const Q=await Nk(_.from,_.to);alert(`Reprocesadas: ${Q.processed} sesiones`),C(!1),A()}catch(Q){alert(Q.message)}finally{T(!1)}},H=(Q,I)=>{x(Z=>({...Z,[Q]:I})),o(1)};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs("select",{value:y.status,onChange:Q=>H("status",Q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:"pending",children:"Pendientes"}),r.jsx("option",{value:"approved",children:"Aprobados"}),r.jsx("option",{value:"rejected",children:"Rechazados"})]}),r.jsxs("select",{value:y.channel,onChange:Q=>H("channel",Q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"",children:"Todos los canales"}),r.jsx("option",{value:"whatsapp",children:"WhatsApp"}),r.jsx("option",{value:"instagram",children:"Instagram"})]}),r.jsx("input",{type:"number",placeholder:"Calidad min.",value:y.minQuality,onChange:Q=>H("minQuality",Q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm w-28",min:"0",max:"100"}),r.jsxs("span",{className:"text-sm text-gray-400 ml-auto",children:[d," pares en total"]}),r.jsxs("button",{onClick:()=>C(!0),className:"flex items-center gap-1 text-sm text-indigo-600 hover:text-indigo-700 font-medium",children:[r.jsx(os,{className:"w-4 h-4"})," Reprocesar"]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Pregunta"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Respuesta"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Calidad"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Canal"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Estado"}),r.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Acciones"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:p?r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-8 text-gray-400",children:"Cargando..."})}):t.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-12 text-gray-400",children:"No hay pares que coincidan con los filtros"})}):t.map(Q=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 max-w-[200px] truncate",children:Q.question}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-[250px] truncate",children:Q.answer}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("span",{className:`text-sm font-medium ${Q.quality_score>=80?"text-green-600":Q.quality_score>=50?"text-yellow-600":"text-red-600"}`,children:Q.quality_score})}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600 capitalize",children:Q.channel})}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${gh[Q.status]?.cls||""}`,children:gh[Q.status]?.label||Q.status})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-1",children:[r.jsx("button",{onClick:()=>j(Q),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Ver detalle",children:r.jsx(em,{className:"w-4 h-4"})}),Q.status!=="approved"&&r.jsx("button",{onClick:()=>w(Q.id),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg",title:"Aprobar",children:r.jsx(Et,{className:"w-4 h-4"})}),Q.status!=="rejected"&&r.jsx("button",{onClick:()=>D(Q.id),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded-lg",title:"Rechazar",children:r.jsx(qn,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>M(Q.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Eliminar",children:r.jsx(Mo,{className:"w-4 h-4"})})]})})]},Q.id))})]})}),c>1&&r.jsxs("div",{className:"flex items-center justify-center gap-4",children:[r.jsx("button",{onClick:()=>o(Q=>Math.max(1,Q-1)),disabled:s===1,className:"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-30",children:r.jsx(xS,{className:"w-5 h-5"})}),r.jsxs("span",{className:"text-sm text-gray-600",children:["Pagina ",s," de ",c]}),r.jsx("button",{onClick:()=>o(Q=>Math.min(c,Q+1)),disabled:s===c,className:"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-30",children:r.jsx(To,{className:"w-5 h-5"})})]}),b&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>j(null),children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg p-6",onClick:Q=>Q.stopPropagation(),children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Detalle del Par Q&A"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mb-1",children:"Pregunta del cliente"}),r.jsx("p",{className:"text-gray-800 bg-gray-50 rounded-lg p-3 text-sm",children:b.question})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mb-1",children:"Respuesta del agente"}),r.jsx("p",{className:"text-gray-800 bg-gray-50 rounded-lg p-3 text-sm whitespace-pre-wrap",children:b.answer})]}),r.jsxs("div",{className:"flex gap-4 text-sm text-gray-500",children:[r.jsxs("span",{children:["Calidad: ",r.jsx("strong",{className:"text-gray-700",children:b.quality_score})]}),r.jsxs("span",{children:["Canal: ",r.jsx("strong",{className:"text-gray-700 capitalize",children:b.channel})]}),r.jsxs("span",{children:["Estado: ",r.jsx("strong",{className:"text-gray-700",children:gh[b.status]?.label})]})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[b.status!=="approved"&&r.jsx("button",{onClick:()=>{w(b.id),j(null)},className:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition text-sm font-medium",children:"Aprobar"}),b.status!=="rejected"&&r.jsx("button",{onClick:()=>{D(b.id),j(null)},className:"flex-1 px-4 py-2.5 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition text-sm font-medium",children:"Rechazar"}),r.jsx("button",{onClick:()=>j(null),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition text-sm",children:"Cerrar"})]})]})}),S&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>C(!1),children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6",onClick:Q=>Q.stopPropagation(),children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Reprocesar Sesiones"}),r.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Extrae pares Q&A de conversaciones pasadas. Opcional: filtra por rango de fechas."}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Desde (opcional)"}),r.jsx("input",{type:"date",value:_.from,onChange:Q=>E(I=>({...I,from:Q.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hasta (opcional)"}),r.jsx("input",{type:"date",value:_.to,onChange:Q=>E(I=>({...I,to:Q.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>C(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition text-sm",children:"Cancelar"}),r.jsx("button",{onClick:q,disabled:R,className:"flex-1 px-4 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition text-sm font-medium disabled:opacity-50",children:R?"Procesando...":"Reprocesar"})]})]})})]})}function a7(){const[t,a]=N.useState([]),[s,o]=N.useState(!0),[c,u]=N.useState(!1),[d,m]=N.useState(!1),[p,g]=N.useState(null),[y,x]=N.useState({product_name:"",variant:"",price:"",currency:"CLP",notes:""}),[b,j]=N.useState(!1),[S,C]=N.useState("");N.useEffect(()=>{_()},[c]);const _=async()=>{o(!0);try{const w=await Sk(!c);a(w.prices)}catch(w){console.error(w)}finally{o(!1)}},E=()=>{g(null),x({product_name:"",variant:"",price:"",currency:"CLP",notes:""}),C(""),m(!0)},R=w=>{g(w),x({product_name:w.product_name,variant:w.variant||"",price:w.price,currency:w.currency||"CLP",notes:w.notes||""}),C(""),m(!0)},T=async w=>{w.preventDefault(),C(""),j(!0);try{p?await Ek(p.id,{product_name:y.product_name,variant:y.variant||null,price:Number(y.price),currency:y.currency,notes:y.notes||null}):await _k({product_name:y.product_name,variant:y.variant||null,price:Number(y.price),currency:y.currency,notes:y.notes||null}),m(!1),_()}catch(D){C(D.message)}finally{j(!1)}},A=async w=>{if(confirm("Desactivar este precio?"))try{await Ck(w),_()}catch(D){alert(D.message)}};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx("input",{type:"checkbox",checked:c,onChange:w=>u(w.target.checked),className:"rounded border-gray-300"}),"Mostrar inactivos"]}),r.jsxs("button",{onClick:E,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2.5 rounded-lg transition font-medium text-sm",children:[r.jsx(am,{className:"w-4 h-4"})," Nuevo Precio"]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Producto"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Variante"}),r.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Precio"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Estado"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Notas"}),r.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Acciones"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:s?r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-8 text-gray-400",children:"Cargando..."})}):t.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:"6",className:"text-center py-12 text-gray-400",children:"No hay precios. Crea el primero."})}):t.map(w=>r.jsxs("tr",{className:`hover:bg-gray-50 ${w.is_active?"":"opacity-50"}`,children:[r.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-800",children:w.product_name}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:w.variant||"-"}),r.jsxs("td",{className:"px-4 py-3 text-sm text-right font-mono font-medium text-gray-800",children:[w.currency," $",Number(w.price).toLocaleString("es-CL")]}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${w.is_active?"bg-green-50 text-green-700":"bg-gray-100 text-gray-500"}`,children:w.is_active?"Activo":"Inactivo"})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-[200px] truncate",children:w.notes||"-"}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-1",children:[r.jsx("button",{onClick:()=>R(w),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Editar",children:r.jsx(iu,{className:"w-4 h-4"})}),w.is_active&&r.jsx("button",{onClick:()=>A(w.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Desactivar",children:r.jsx(Mo,{className:"w-4 h-4"})})]})})]},w.id))})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>m(!1),children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",onClick:w=>w.stopPropagation(),children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:p?"Editar Precio":"Nuevo Precio"}),S&&r.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-2 rounded-lg text-sm mb-4",children:S}),r.jsxs("form",{onSubmit:T,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Producto"}),r.jsx("input",{type:"text",value:y.product_name,onChange:w=>x({...y,product_name:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,placeholder:"Ej: Colchon Spring"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Variante (opcional)"}),r.jsx("input",{type:"text",value:y.variant,onChange:w=>x({...y,variant:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Ej: King, Queen, 2 Plazas"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio"}),r.jsx("input",{type:"number",value:y.price,onChange:w=>x({...y,price:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,min:"0",step:"1"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda"}),r.jsxs("select",{value:y.currency,onChange:w=>x({...y,currency:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[r.jsx("option",{value:"CLP",children:"CLP"}),r.jsx("option",{value:"USD",children:"USD"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas (opcional)"}),r.jsx("input",{type:"text",value:y.notes,onChange:w=>x({...y,notes:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Ej: Precio promocional hasta Marzo"})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition text-sm",children:"Cancelar"}),r.jsx("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition text-sm font-medium disabled:opacity-50",children:b?"Guardando...":p?"Guardar":"Crear"})]})]})]})})]})}const lb=`Eres un vendedor humano de Respaldos Chile que conversa por WhatsApp e Instagram.
Respaldos Chile vende respaldos de cama, cabeceras y accesorios de dormitorio.

Hablas como una persona real, cercana y profesional (chileno neutro).
Nada de lenguaje robotico, corporativo ni de catalogo.

Los mensajes deben ser cortos y naturales:
- Maximo 3-4 lineas
- Una sola idea por mensaje
- Cierra siempre con una pregunta que avance la conversacion

Si conoces el nombre del cliente ({{nombre}}), usalo naturalmente.

FLUJO DE CONVERSACION:
1. Si es primer mensaje o saludo: responde con un saludo corto y pregunta abierta tipo "en que te puedo ayudar?" o "cuentame, en que andas?". NO menciones productos, respaldos, cabeceras ni nada especifico. El cliente puede querer cualquier cosa: comprar, reclamar, preguntar por un pedido, cotizar, o algo que no tiene nada que ver con respaldos.
2. Espera a que el cliente diga que necesita antes de asumir NADA.
3. Si falta info (medida, estilo, color): pregunta antes de recomendar. Una pregunta por mensaje. NO preguntes cosas obvias ni redundantes (ej: si quiere un respaldo de cama, no preguntes "donde lo vas a poner" porque es obvio que es en su dormitorio).
4. Si ya tienes contexto: sugiere maximo 2 opciones, condicionadas a lo que dijo el cliente.
5. Si el cliente tiene dudas: responde con calma, no contradigas, confirma si no sabes.
6. Si quiere comprar o pagar: "Te conecto con alguien del equipo para cerrar eso"
7. Nunca saltes etapas: no cotices sin contexto, no recomiendes sin entender.

Reglas estrictas:
- NUNCA asumas el motivo de contacto del cliente. Pregunta primero.
- NUNCA inventes materiales, modelos, estilos ni tipos de producto. Si no tienes info concreta de lo que vendemos, di "Dejame confirmarlo con el equipo y te respondo al tiro"
- No usar listas ni formato de catalogo
- No entregar fichas tecnicas ni especificaciones duras
- No inventar precios, plazos, stock ni condiciones
- No asumir medidas, colores ni disponibilidad
- No usar frases tipo "Estimado/a cliente" o "Le informamos que..."

Nunca emitas juicios genericos de gusto como:
"queda bonito", "es lindo", "es precioso", "te va a encantar".

Las recomendaciones deben ser siempre condicionadas al contexto del cliente:
"Suele funcionar bien cuando..."
"En espacios como el tuyo..."
"Por lo que me comentas..."
"Para el uso que buscas..."

Si no tienes certeza, responde exactamente:
"Dejame confirmarlo con el equipo y te respondo al tiro"

Usa solo informacion confirmada. Puedes mejorar redaccion y trato, pero sin cambiar datos.`;function s7(){const[t,a]=N.useState(null),[s,o]=N.useState(""),[c,u]=N.useState(""),[d,m]=N.useState(!1),[p,g]=N.useState(!0),[y,x]=N.useState(!1),[b,j]=N.useState(!1),[S,C]=N.useState(""),[_,E]=N.useState(!1),[R,T]=N.useState(null),[A,w]=N.useState(!1),[D,M]=N.useState(!1);N.useEffect(()=>{q()},[]);const q=async()=>{g(!0),C("");try{const I=await Tk();a(I.config),o(I.config?.custom_instructions||""),u(I.config?.system_prompt||""),I.config?.system_prompt&&m(!0)}catch(I){C(I.message)}finally{g(!1)}},H=async()=>{x(!0),j(!1),C("");try{const I=await Mk({...t,custom_instructions:s,system_prompt:c||null});I.config&&(a(I.config),o(I.config.custom_instructions||""),u(I.config.system_prompt||"")),j(!0),setTimeout(()=>j(!1),3e3)}catch(I){C("Error al guardar: "+I.message)}finally{x(!1)}},Q=async()=>{w(!0),E(!0);try{const I=await Ak();T(I)}catch(I){C(I.message)}finally{w(!1)}};return p?r.jsx("div",{className:"flex items-center justify-center py-20",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-8 text-white",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center",children:r.jsx(ti,{className:"w-8 h-8"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Instrucciones para la IA"}),r.jsx("p",{className:"text-blue-200 text-sm mt-1",children:"Escribe reglas, conocimiento y procedimientos que la IA debe seguir"})]})]})}),S&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm",children:S}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Prompt del sistema (cerebro general)"}),d?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>u(lb),className:"text-xs text-gray-500 hover:text-orange-600 font-medium flex items-center gap-1",children:[r.jsx(Ob,{className:"w-3.5 h-3.5"})," Restaurar default"]}),r.jsxs("button",{onClick:()=>{u(""),m(!1)},className:"text-xs text-gray-400 hover:text-red-500 font-medium flex items-center gap-1",children:[r.jsx(qn,{className:"w-3.5 h-3.5"})," Quitar"]})]}):r.jsxs("button",{onClick:()=>{m(!0),c||u(lb)},className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium flex items-center gap-1",children:[r.jsx(iu,{className:"w-3.5 h-3.5"})," Personalizar"]})]}),d?r.jsxs(r.Fragment,{children:[r.jsx("textarea",{value:c,onChange:I=>u(I.target.value),rows:12,className:"w-full px-4 py-3 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-y font-mono",placeholder:"Define la personalidad, tono y reglas base de la IA..."}),r.jsxs("p",{className:"mt-2 text-xs text-gray-400",children:["Este es el prompt base que define quien es la IA. Usa ",r.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"{{nombre}}"})," para inyectar el nombre del cliente."]})]}):r.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-sm text-gray-500",children:[r.jsx("p",{children:'Usando el prompt por defecto. Haz click en "Personalizar" para editarlo.'}),r.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Tip: Usa ",r.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"{{nombre}}"})," para inyectar el nombre del cliente automaticamente."]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Instrucciones adicionales"}),r.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Reglas especificas, conocimiento del negocio, procedimientos. Se agregan al prompt del sistema."}),r.jsx("textarea",{value:s,onChange:I=>o(I.target.value),rows:10,className:"w-full px-4 py-3 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-y font-mono",placeholder:`Ejemplos:
- Los modelos disponibles son: Venecia, Florencia, Roma, Milan
- Si preguntan por despacho: "Dentro de Santiago 3-5 dias habiles"
- Formas de pago: transferencia, tarjeta de credito, webpay
- Siempre ofrecer la opcion de hablar con un vendedor
- No dar informacion sobre competidores
- Horario de atencion: Lunes a Viernes 9:00 a 18:00`}),r.jsxs("div",{className:"flex items-center justify-between mt-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("button",{onClick:H,disabled:y,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-lg transition font-medium text-sm disabled:opacity-50",children:[r.jsx(l4,{className:"w-4 h-4"}),y?"Guardando...":"Guardar Todo"]}),b&&r.jsxs("span",{className:"text-green-600 text-sm font-medium flex items-center gap-1",children:[r.jsx(Et,{className:"w-4 h-4"})," Guardado"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("button",{onClick:Q,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-indigo-600 font-medium transition",children:[r.jsx(Uc,{className:"w-4 h-4"})," Ver Prompt"]}),r.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition font-medium text-sm",children:[r.jsx(Db,{className:"w-4 h-4"})," Probar IA"]})]})]})]}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-5",children:[r.jsxs("h3",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[r.jsx(Vr,{className:"w-5 h-5"})," Tips para mejores instrucciones"]}),r.jsxs("ul",{className:"space-y-2 text-sm text-blue-700",children:[r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),'Se especifico: "El despacho a Santiago demora 3-5 dias" es mejor que "informar plazos"']}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),"Incluye respuestas exactas para preguntas frecuentes"]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),'Los precios se manejan en la tab "Precios"  no los pongas aqui']}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),'Define el tono: "Responde como vendedor amigable, tutea al cliente"']}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx(Et,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),'Indica que NO hacer: "Nunca ofrezcas descuentos sin autorizacion"']})]})]}),_&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>E(!1),children:r.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",onClick:I=>I.stopPropagation(),children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[r.jsxs("h2",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(Uc,{className:"w-5 h-5 text-indigo-500"})," Prompt Actual"]}),r.jsx("button",{onClick:()=>E(!1),className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-lg",children:r.jsx(qn,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"overflow-y-auto p-6 space-y-4",children:A?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-500"})}):R?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-wrap gap-3 text-sm",children:[r.jsxs("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 rounded-full font-medium",children:["Modelo: ",R.model]}),r.jsxs("span",{className:"px-3 py-1 bg-green-50 text-green-700 rounded-full font-medium",children:["Conocimiento: ",R.knowledgeCount," pares"]}),r.jsxs("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full font-medium",children:["Precios: ",R.priceCount," activos"]}),r.jsxs("span",{className:"px-3 py-1 bg-purple-50 text-purple-700 rounded-full font-medium",children:["Fidelidad: ",R.fidelityLevel]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase mb-2",children:"System Prompt"}),r.jsx("pre",{className:"bg-gray-900 text-gray-100 rounded-xl p-4 text-sm overflow-x-auto whitespace-pre-wrap font-mono leading-relaxed",children:R.systemPrompt})]}),R.customInstructions&&r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[r.jsx("span",{className:"text-xs font-semibold text-blue-600 uppercase",children:"Tus instrucciones (incluidas arriba)"}),r.jsx("p",{className:"text-sm text-blue-800 mt-1 whitespace-pre-wrap",children:R.customInstructions})]})]}):r.jsx("p",{className:"text-gray-400 text-center py-8",children:"Error cargando prompt"})})]})}),r.jsx(Fk,{show:D,onClose:()=>M(!1)})]})}function r7(){const[t,a]=N.useState([]),[s,o]=N.useState(!0),[c,u]=N.useState(null),[d,m]=N.useState([]),[p,g]=N.useState(!1),[y,x]=N.useState(null),[b,j]=N.useState(""),[S,C]=N.useState(!1),[_,E]=N.useState(""),[R,T]=N.useState("");N.useEffect(()=>{A()},[]);const A=async()=>{o(!0),E("");try{const M=await kk();a(M.conversations||[])}catch(M){E(M.message)}finally{o(!1)}},w=async M=>{u(M),g(!0),x(null),E("");try{const q=await Rk(M);m(q.messages||[])}catch(q){E(q.message)}finally{g(!1)}},D=async M=>{if(b.trim()){C(!0),E(""),T("");try{const q=await zk(c,M,b);T(`Correccion guardada: "${q.question?.slice(0,40)}..."  nueva respuesta aprobada`),x(null),j(""),setTimeout(()=>T(""),5e3),await w(c)}catch(q){E(q.message)}finally{C(!1)}}};return s?r.jsx("div",{className:"flex items-center justify-center py-20",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):c?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("button",{onClick:()=>{u(null),m([])},className:"flex items-center gap-2 text-sm text-gray-600 hover:text-indigo-600 font-medium transition",children:[r.jsx(sS,{className:"w-4 h-4"})," Volver a conversaciones"]}),_&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm",children:_}),R&&r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-green-700 text-sm flex items-center gap-2",children:[r.jsx(Et,{className:"w-4 h-4"})," ",R]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:[r.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 text-sm",children:["Sesion #",c,"  ",d.length," mensajes"]}),p?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):r.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:d.map(M=>r.jsx("div",{className:`flex ${M.direction==="in"?"justify-start":"justify-end"}`,children:r.jsxs("div",{className:`max-w-[75%] rounded-2xl px-4 py-2.5 ${M.direction==="in"?"bg-gray-100 text-gray-800":M.is_ai_generated?"bg-purple-100 text-purple-900 border border-purple-200":"bg-indigo-600 text-white"}`,children:[M.direction==="out"&&M.is_ai_generated&&r.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wider opacity-70 block mb-1",children:"Bot IA"}),r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:M.text}),r.jsxs("div",{className:"flex items-center justify-between mt-1.5 gap-3",children:[r.jsx("span",{className:"text-[10px] opacity-60",children:new Date(M.created_at).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})}),M.direction==="out"&&M.is_ai_generated&&M.status!=="corrected"&&r.jsxs("button",{onClick:()=>{x(M.id),j("")},className:"text-[10px] font-semibold text-purple-700 hover:text-purple-900 flex items-center gap-0.5",children:[r.jsx(zb,{className:"w-3 h-3"})," Corregir"]}),M.status==="corrected"&&r.jsxs("span",{className:"text-[10px] font-semibold text-green-700 flex items-center gap-0.5",children:[r.jsx(Et,{className:"w-3 h-3"})," Corregido"]})]}),y===M.id&&r.jsxs("div",{className:"mt-3 pt-3 border-t border-purple-300",children:[r.jsx("label",{className:"block text-xs font-semibold text-purple-700 mb-1",children:"Respuesta correcta:"}),r.jsx("textarea",{value:b,onChange:q=>j(q.target.value),rows:3,className:"w-full px-3 py-2 border border-purple-300 rounded-lg text-sm text-gray-800 bg-white focus:ring-2 focus:ring-purple-500",placeholder:"Escribe la respuesta correcta que deberia dar el bot...",autoFocus:!0}),r.jsxs("div",{className:"flex gap-2 mt-2",children:[r.jsx("button",{onClick:()=>D(M.id),disabled:S||!b.trim(),className:"px-3 py-1.5 bg-purple-600 text-white rounded-lg text-xs font-medium disabled:opacity-50 hover:bg-purple-700",children:S?"Guardando...":"Guardar Correccion"}),r.jsx("button",{onClick:()=>x(null),className:"px-3 py-1.5 border border-purple-300 text-purple-700 rounded-lg text-xs hover:bg-purple-50",children:"Cancelar"})]})]})]})},M.id))})]})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-8 text-white",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center",children:r.jsx(qt,{className:"w-8 h-8"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Conversaciones del Bot"}),r.jsx("p",{className:"text-purple-200 text-sm mt-1",children:"Revisa y corrige las respuestas automaticas de la IA"})]})]})}),_&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm",children:_}),t.length===0?r.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-12 text-center",children:[r.jsx(qt,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-400",children:"Aun no hay conversaciones donde el bot haya respondido"}),r.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Cuando la IA responda mensajes, apareceran aqui"})]}):r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Sesion"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Telefono"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Msgs IA"}),r.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Total"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Ultimo mensaje"}),r.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase",children:"Fecha"}),r.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(M=>r.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>w(M.sessionId),children:[r.jsxs("td",{className:"px-4 py-3 text-sm font-medium text-gray-800",children:["#",M.sessionId]}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 font-mono",children:M.phone}),r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-purple-50 text-purple-700",children:[r.jsx(Ln,{className:"w-3 h-3"})," ",M.ai_message_count]})}),r.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-500",children:M.total_messages}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-[200px] truncate",children:M.last_message}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:M.last_message_at?ai(new Date(M.last_message_at),{addSuffix:!0,locale:is}):"-"}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(em,{className:"w-4 h-4 text-gray-400"})})]},M.sessionId))})]})})]})}function i7(){const[t,a]=N.useState("brain"),[s,o]=N.useState(null);return N.useEffect(()=>{vk().then(c=>o(c.stats)).catch(c=>console.error("Error loading learning stats:",c))},[]),r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Cerebro IA - Aprendizaje"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Sistema de conocimiento adquirido por la IA"})]}),r.jsx("div",{className:"flex gap-1 mb-6 bg-gray-100 rounded-xl p-1 w-fit",children:Zk.map(c=>{const u=c.icon;return r.jsxs("button",{onClick:()=>a(c.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition ${t===c.id?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[r.jsx(u,{className:"w-4 h-4"}),c.label]},c.id)})}),t==="brain"&&r.jsx(e7,{}),t==="instructions"&&r.jsx(s7,{}),t==="bot-conversations"&&r.jsx(r7,{}),t==="dashboard"&&r.jsx(t7,{stats:s}),t==="pairs"&&r.jsx(n7,{}),t==="prices"&&r.jsx(a7,{})]})}function o7({children:t}){return At(s=>s.isAuthenticated)?t:r.jsx($c,{to:"/login",replace:!0})}function pa({children:t}){return At(s=>s.agent)?.role!=="supervisor"?r.jsx($c,{to:"/dashboard",replace:!0}):t}function l7(){return r.jsxs(uN,{children:[r.jsx(_t,{path:"/login",element:r.jsx(M4,{})}),r.jsxs(_t,{path:"/",element:r.jsx(o7,{children:r.jsx(C4,{})}),children:[r.jsx(_t,{index:!0,element:r.jsx($c,{to:"/dashboard",replace:!0})}),r.jsx(_t,{path:"dashboard",element:r.jsx(j3,{})}),r.jsx(_t,{path:"conversations",element:r.jsx(S_,{})}),r.jsx(_t,{path:"agents",element:r.jsx(pa,{children:r.jsx(yk,{})})}),r.jsx(_t,{path:"departments",element:r.jsx(pa,{children:r.jsx(bk,{})})}),r.jsx(_t,{path:"flows",element:r.jsx(pa,{children:r.jsx(O_,{})})}),r.jsx(_t,{path:"flows/builder/:id?",element:r.jsx(pa,{children:r.jsx(ek,{})})}),r.jsx(_t,{path:"logs",element:r.jsx(pa,{children:r.jsx(sk,{})})}),r.jsx(_t,{path:"leads",element:r.jsx(pa,{children:r.jsx(uk,{})})}),r.jsx(_t,{path:"analytics",element:r.jsx(pa,{children:r.jsx(gk,{})})}),r.jsx(_t,{path:"monitor",element:r.jsx(pa,{children:r.jsx(xk,{})})}),r.jsx(_t,{path:"learning",element:r.jsx(pa,{children:r.jsx(i7,{})})})]}),r.jsx(_t,{path:"*",element:r.jsx($c,{to:"/dashboard",replace:!0})})]})}cj.createRoot(document.getElementById("root")).render(r.jsx(zr.StrictMode,{children:r.jsx(ON,{children:r.jsx(l7,{})})}));
